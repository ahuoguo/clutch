<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="resources/coqdoc.css" rel="stylesheet" type="text/css" />
<link href="resources/coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resources/config.js"></script>
<script type="text/javascript" src="resources/coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="../">Project Page</a>
      <a href="./indexpage.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">clutch.examples.crypto.ElGamal</h1>

<div class="code">
<span class="comment">(*&nbsp;ElGamal&nbsp;encryption&nbsp;has&nbsp;one-time&nbsp;secrecy&nbsp;against&nbsp;chosen&nbsp;plaintext&nbsp;attack,&nbsp;in<br/>
&nbsp;&nbsp;&nbsp;the&nbsp;real/random&nbsp;paradigm.&nbsp;Following&nbsp;Rosulek's&nbsp;"The&nbsp;Joy&nbsp;of&nbsp;Crypto".&nbsp;*)</span><br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">clutch</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="clutch.clutch.html#"><span class="id" title="library">clutch</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">clutch.examples.crypto</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#"><span class="id" title="library">valgroup</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">clutch.examples.crypto</span> <span class="id" title="keyword">Require</span> <a class="idref" href="clutch.examples.crypto.ElGamal_bijection.html#"><span class="id" title="library">ElGamal_bijection</span></a>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">mathcomp</span> <span class="id" title="keyword">Require</span> <span class="id" title="library">ssrnat</span>.<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="var">Warnings</span> "-notation-overridden,-ambiguous-paths".<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">mathcomp</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">zmodp</span> <span class="id" title="library">finset</span> <span class="id" title="library">ssrbool</span> <span class="id" title="library">fingroup.fingroup</span> <span class="id" title="library">solvable.cyclic</span>.<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="var">Warnings</span> "notation-overridden,ambiguous-paths".<br/>

<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="var">Default</span> <span class="id" title="keyword">Proof</span> <span class="id" title="var">Using</span> "Type*".<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="ElGamal" class="idref" href="#ElGamal"><span class="id" title="section">ElGamal</span></a>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">rel_red</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">iStartProof</span> ;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="var">iredrs</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">first</span> [<span class="id" title="var">rel_exp_r</span> | <span class="id" title="var">rel_mult_r</span> | <span class="id" title="var">rel_inv_r</span>]) ;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="var">iredls</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">first</span> [<span class="id" title="var">rel_exp_l</span> | <span class="id" title="var">rel_mult_l</span> | <span class="id" title="var">rel_inv_l</span>]).<br/>

<br/>
<span class="id" title="keyword">Context</span> `{<a id="clutchRGS0:2" class="idref" href="#clutchRGS0:2"><span class="id" title="binder">!</span></a><a id="clutchRGS0:2" class="idref" href="#clutchRGS0:2"><span class="id" title="binder">clutchRGS</span></a> <a id="clutchRGS0:2" class="idref" href="#clutchRGS0:2"><span class="id" title="binder">Σ</span></a>}.<br/>

<br/>
<span class="id" title="keyword">Context</span> {<a id="vg:3" class="idref" href="#vg:3"><span class="id" title="binder">vg</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#val_group"><span class="id" title="class">val_group</span></a>}. <span class="comment">(*&nbsp;A&nbsp;group&nbsp;on&nbsp;a&nbsp;subset&nbsp;of&nbsp;values.&nbsp;*)</span><br/>
<span class="id" title="keyword">Context</span> {<a id="cg:4" class="idref" href="#cg:4"><span class="id" title="binder">cg</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#clutch_group_struct"><span class="id" title="class">clutch_group_struct</span></a>}. <span class="comment">(*&nbsp;Implementations&nbsp;of&nbsp;the&nbsp;vg&nbsp;group&nbsp;operations&nbsp;*)</span><br/>
<span class="id" title="keyword">Context</span> {<a id="G:5" class="idref" href="#G:5"><span class="id" title="binder">G</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#clutch_group"><span class="id" title="class">clutch_group</span></a> (<span class="id" title="var">vg</span>:=<a class="idref" href="clutch.examples.crypto.ElGamal.html#ElGamal.vg"><span class="id" title="variable">vg</span></a>) (<span class="id" title="var">cg</span>:=<a class="idref" href="clutch.examples.crypto.ElGamal.html#ElGamal.cg"><span class="id" title="variable">cg</span></a>)}. <span class="comment">(*&nbsp;...satisfying&nbsp;the&nbsp;group&nbsp;laws.&nbsp;*)</span><br/>
<span class="id" title="keyword">Context</span> {<a id="cgg:6" class="idref" href="#cgg:6"><span class="id" title="binder">cgg</span></a> : @<a class="idref" href="clutch.examples.crypto.valgroup.html#clutch_group_generator"><span class="id" title="class">clutch_group_generator</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#ElGamal.vg"><span class="id" title="variable">vg</span></a>}. <span class="comment">(*&nbsp;G&nbsp;is&nbsp;generated&nbsp;by&nbsp;g.&nbsp;*)</span><br/>
<span class="id" title="keyword">Context</span> {<a id="3d409925eecfe9fac9d850edb88dd4e5" class="idref" href="#3d409925eecfe9fac9d850edb88dd4e5"><span class="id" title="binder">Δ</span></a> : <span class="id" title="definition">listO</span> (<a class="idref" href="clutch.rel_logic.model.html#lrelC"><span class="id" title="definition">lrelC</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#99baec5269a25e9e97a2520edb4e1412"><span class="id" title="variable">Σ</span></a>)}.<br/>

<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="keyword">Notation</span> <a id="T" class="idref" href="#T"><span class="id" title="abbreviation">T</span></a> := (<a class="idref" href="clutch.typing.interp.html#interp"><span class="id" title="definition">interp</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#9082db16b85b8b97e7d84dbc62092956"><span class="id" title="method">τ</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#9082db16b85b8b97e7d84dbc62092956"><span class="id" title="method">G</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#c60cf82b94a1f8e1c92704bf6cc308f9"><span class="id" title="variable">Δ</span></a>).<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="keyword">Notation</span> <a id="n" class="idref" href="#n"><span class="id" title="abbreviation">n</span></a> := (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#n''"><span class="id" title="method">n''</span></a>).<br/>

<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="keyword">Definition</span> <a id="rnd" class="idref" href="#rnd"><span class="id" title="definition">rnd</span></a> <a id="t:8" class="idref" href="#t:8"><span class="id" title="binder">t</span></a> := (<a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'rand'_x_'from'_x"><span class="id" title="notation">rand</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.examples.crypto.ElGamal.html#n"><span class="id" title="abbreviation">n</span></a> <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'rand'_x_'from'_x"><span class="id" title="notation">from</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#t:8"><span class="id" title="variable">t</span></a>)%<span class="id" title="var">E</span>.<br/>

<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#valgroup_notation"><span class="id" title="module">valgroup_notation</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#valgroup_tactics"><span class="id" title="module">valgroup_tactics</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;ElGamal&nbsp;public&nbsp;key&nbsp;encryption&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <a id="keygen" class="idref" href="#keygen"><span class="id" title="definition">keygen</span></a> : <a class="idref" href="clutch.prob_lang.lang.html#prob_lang.expr"><span class="id" title="inductive">expr</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#d2c3354f6c46df814e66d4c5c9b9c738"><span class="id" title="notation">λ</span></a><a class="idref" href="clutch.prob_lang.notation.html#d2c3354f6c46df814e66d4c5c9b9c738"><span class="id" title="notation">:</span></a><span class="id" title="notation">&lt;&gt;</span><a class="idref" href="clutch.prob_lang.notation.html#d2c3354f6c46df814e66d4c5c9b9c738"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "sk" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#rnd"><span class="id" title="definition">rnd</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.prob_lang.notation.html#3127c6bc552ca21a494fc6e3474a507d"><span class="id" title="notation">()</span></a> <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "pk" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#g"><span class="id" title="method">g</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#f1970a6c2d131dee839d9a93197e874c"><span class="id" title="notation">^</span></a>"sk" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">(</span></a>"sk"<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">,</span></a> "pk"<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">)</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="enc" class="idref" href="#enc"><span class="id" title="definition">enc</span></a> : <a class="idref" href="clutch.prob_lang.lang.html#prob_lang.expr"><span class="id" title="inductive">expr</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#d2c3354f6c46df814e66d4c5c9b9c738"><span class="id" title="notation">λ</span></a><a class="idref" href="clutch.prob_lang.notation.html#d2c3354f6c46df814e66d4c5c9b9c738"><span class="id" title="notation">:</span></a> "pk"<a class="idref" href="clutch.prob_lang.notation.html#d2c3354f6c46df814e66d4c5c9b9c738"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob_lang.notation.html#d2c3354f6c46df814e66d4c5c9b9c738"><span class="id" title="notation">λ</span></a><a class="idref" href="clutch.prob_lang.notation.html#d2c3354f6c46df814e66d4c5c9b9c738"><span class="id" title="notation">:</span></a> "msg"<a class="idref" href="clutch.prob_lang.notation.html#d2c3354f6c46df814e66d4c5c9b9c738"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "b" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#rnd"><span class="id" title="definition">rnd</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.prob_lang.notation.html#3127c6bc552ca21a494fc6e3474a507d"><span class="id" title="notation">()</span></a> <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "B" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#g"><span class="id" title="method">g</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#f1970a6c2d131dee839d9a93197e874c"><span class="id" title="notation">^</span></a>"b" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "X" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> "msg" <a class="idref" href="clutch.examples.crypto.valgroup.html#201a4374e413a582b090bede08aafac0"><span class="id" title="notation">·</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#201a4374e413a582b090bede08aafac0"><span class="id" title="notation">(</span></a>"pk"<a class="idref" href="clutch.examples.crypto.valgroup.html#f1970a6c2d131dee839d9a93197e874c"><span class="id" title="notation">^</span></a>"b"<a class="idref" href="clutch.examples.crypto.valgroup.html#201a4374e413a582b090bede08aafac0"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">(</span></a>"B"<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">,</span></a> "X"<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">)</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="dec" class="idref" href="#dec"><span class="id" title="definition">dec</span></a> : <a class="idref" href="clutch.prob_lang.lang.html#prob_lang.expr"><span class="id" title="inductive">expr</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#3d489cbe8f13619f2070e081d1ecd1f6"><span class="id" title="notation">λ</span></a><a class="idref" href="clutch.prob_lang.notation.html#3d489cbe8f13619f2070e081d1ecd1f6"><span class="id" title="notation">:</span></a>"sk" "BX"<a class="idref" href="clutch.prob_lang.notation.html#3d489cbe8f13619f2070e081d1ecd1f6"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">(</span></a>"B"<a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">,</span></a> "X"<a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">:=</span></a> "BX" <a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;"X" <a class="idref" href="clutch.examples.crypto.valgroup.html#201a4374e413a582b090bede08aafac0"><span class="id" title="notation">·</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#201a4374e413a582b090bede08aafac0"><span class="id" title="notation">(</span></a>"B"<a class="idref" href="clutch.examples.crypto.valgroup.html#f02567bd8aca590eaffb67a29bcff176"><span class="id" title="notation">^-</span></a>"sk"<a class="idref" href="clutch.examples.crypto.valgroup.html#201a4374e413a582b090bede08aafac0"><span class="id" title="notation">)</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;The&nbsp;syntactic&nbsp;and&nbsp;semantic&nbsp;type&nbsp;of&nbsp;the&nbsp;Diffie-Hellman&nbsp;game(s).&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <a id="208159eccf7e85aae5d432b571819b63" class="idref" href="#208159eccf7e85aae5d432b571819b63"><span class="id" title="definition">τ</span></a><a id="208159eccf7e85aae5d432b571819b63" class="idref" href="#208159eccf7e85aae5d432b571819b63"><span class="id" title="definition">_DH</span></a> := (<a class="idref" href="clutch.examples.crypto.valgroup.html#9082db16b85b8b97e7d84dbc62092956"><span class="id" title="method">τ</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#9082db16b85b8b97e7d84dbc62092956"><span class="id" title="method">G</span></a> <a class="idref" href="clutch.typing.types.html#7d3c2ce4409e0466c42f9ffb2e58ff9f"><span class="id" title="notation">*</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#9082db16b85b8b97e7d84dbc62092956"><span class="id" title="method">τ</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#9082db16b85b8b97e7d84dbc62092956"><span class="id" title="method">G</span></a> <a class="idref" href="clutch.typing.types.html#7d3c2ce4409e0466c42f9ffb2e58ff9f"><span class="id" title="notation">*</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#9082db16b85b8b97e7d84dbc62092956"><span class="id" title="method">τ</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#9082db16b85b8b97e7d84dbc62092956"><span class="id" title="method">G</span></a>)%<span class="id" title="var">ty</span>.<br/>
<span class="id" title="keyword">Definition</span> <a id="T_DH" class="idref" href="#T_DH"><span class="id" title="definition">T_DH</span></a> := <span class="id" title="keyword">Eval</span> <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> (<a class="idref" href="clutch.typing.interp.html#interp"><span class="id" title="definition">interp</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#208159eccf7e85aae5d432b571819b63"><span class="id" title="definition">τ</span></a><a class="idref" href="clutch.examples.crypto.ElGamal.html#208159eccf7e85aae5d432b571819b63"><span class="id" title="definition">_DH</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#c60cf82b94a1f8e1c92704bf6cc308f9"><span class="id" title="variable">Δ</span></a>).<br/>

<br/>
<span class="comment">(*&nbsp;The&nbsp;syntactic&nbsp;and&nbsp;semantic&nbsp;type&nbsp;of&nbsp;the&nbsp;ElGamal&nbsp;game(s).&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <a id="9fc5d2f065cb312100547e5efeaaf47d" class="idref" href="#9fc5d2f065cb312100547e5efeaaf47d"><span class="id" title="definition">τ</span></a><a id="9fc5d2f065cb312100547e5efeaaf47d" class="idref" href="#9fc5d2f065cb312100547e5efeaaf47d"><span class="id" title="definition">_EG</span></a> := (<a class="idref" href="clutch.examples.crypto.valgroup.html#9082db16b85b8b97e7d84dbc62092956"><span class="id" title="method">τ</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#9082db16b85b8b97e7d84dbc62092956"><span class="id" title="method">G</span></a> <a class="idref" href="clutch.typing.types.html#7d3c2ce4409e0466c42f9ffb2e58ff9f"><span class="id" title="notation">*</span></a> <a class="idref" href="clutch.typing.types.html#7d3c2ce4409e0466c42f9ffb2e58ff9f"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.typing.types.html#TInt"><span class="id" title="constructor">TInt</span></a> <a class="idref" href="clutch.typing.types.html#cf2aa254e4c9f9cb95db860c4555acd5"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.typing.types.html#2599395bdcdbb2edbbcec60bbf1ebff1"><span class="id" title="notation">()</span></a> <a class="idref" href="clutch.typing.types.html#b06448a1e61637d1227556b716988eba"><span class="id" title="notation">+</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#9082db16b85b8b97e7d84dbc62092956"><span class="id" title="method">τ</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#9082db16b85b8b97e7d84dbc62092956"><span class="id" title="method">G</span></a> <a class="idref" href="clutch.typing.types.html#7d3c2ce4409e0466c42f9ffb2e58ff9f"><span class="id" title="notation">*</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#9082db16b85b8b97e7d84dbc62092956"><span class="id" title="method">τ</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#9082db16b85b8b97e7d84dbc62092956"><span class="id" title="method">G</span></a><a class="idref" href="clutch.typing.types.html#7d3c2ce4409e0466c42f9ffb2e58ff9f"><span class="id" title="notation">)</span></a>)%<span class="id" title="var">ty</span>.<br/>
<span class="id" title="keyword">Definition</span> <a id="T_EG" class="idref" href="#T_EG"><span class="id" title="definition">T_EG</span></a> := <span class="id" title="keyword">Eval</span> <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> (<a class="idref" href="clutch.typing.interp.html#interp"><span class="id" title="definition">interp</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#9fc5d2f065cb312100547e5efeaaf47d"><span class="id" title="definition">τ</span></a><a class="idref" href="clutch.examples.crypto.ElGamal.html#9fc5d2f065cb312100547e5efeaaf47d"><span class="id" title="definition">_EG</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#c60cf82b94a1f8e1c92704bf6cc308f9"><span class="id" title="variable">Δ</span></a>).<br/>

<br/>
<span class="comment">(*&nbsp;The&nbsp;Decisional&nbsp;Diffie&nbsp;Hellman&nbsp;assumption&nbsp;says&nbsp;the&nbsp;following&nbsp;two&nbsp;programs&nbsp;are<br/>
&nbsp;&nbsp;&nbsp;PPT(n)&nbsp;indistinguishable.&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <a id="DH_real" class="idref" href="#DH_real"><span class="id" title="definition">DH_real</span></a> : <a class="idref" href="clutch.prob_lang.lang.html#prob_lang.expr"><span class="id" title="inductive">expr</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "a" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#rnd"><span class="id" title="definition">rnd</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.prob_lang.notation.html#3127c6bc552ca21a494fc6e3474a507d"><span class="id" title="notation">()</span></a> <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "b" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#rnd"><span class="id" title="definition">rnd</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.prob_lang.notation.html#3127c6bc552ca21a494fc6e3474a507d"><span class="id" title="notation">()</span></a> <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#g"><span class="id" title="method">g</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#f1970a6c2d131dee839d9a93197e874c"><span class="id" title="notation">^</span></a>"a"<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#g"><span class="id" title="method">g</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#f1970a6c2d131dee839d9a93197e874c"><span class="id" title="notation">^</span></a>"b"<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#g"><span class="id" title="method">g</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#f1970a6c2d131dee839d9a93197e874c"><span class="id" title="notation">^(</span></a>"a"<a class="idref" href="clutch.prob_lang.notation.html#da5221709ab13640970b110774ada169"><span class="id" title="notation">*</span></a>"b"<a class="idref" href="clutch.examples.crypto.valgroup.html#f1970a6c2d131dee839d9a93197e874c"><span class="id" title="notation">)</span></a><a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">)</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="DH_rand" class="idref" href="#DH_rand"><span class="id" title="definition">DH_rand</span></a> : <a class="idref" href="clutch.prob_lang.lang.html#prob_lang.expr"><span class="id" title="inductive">expr</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "a" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#rnd"><span class="id" title="definition">rnd</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.prob_lang.notation.html#3127c6bc552ca21a494fc6e3474a507d"><span class="id" title="notation">()</span></a> <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "b" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#rnd"><span class="id" title="definition">rnd</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.prob_lang.notation.html#3127c6bc552ca21a494fc6e3474a507d"><span class="id" title="notation">()</span></a> <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "c" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#rnd"><span class="id" title="definition">rnd</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.prob_lang.notation.html#3127c6bc552ca21a494fc6e3474a507d"><span class="id" title="notation">()</span></a> <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#g"><span class="id" title="method">g</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#f1970a6c2d131dee839d9a93197e874c"><span class="id" title="notation">^</span></a>"a"<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#g"><span class="id" title="method">g</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#f1970a6c2d131dee839d9a93197e874c"><span class="id" title="notation">^</span></a>"b"<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#g"><span class="id" title="method">g</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#f1970a6c2d131dee839d9a93197e874c"><span class="id" title="notation">^</span></a>"c"<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">)</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;Public&nbsp;key&nbsp;OTS-CPA*)</span><br/>
<span class="comment">(*&nbsp;In&nbsp;the&nbsp;random&nbsp;game,&nbsp;rather&nbsp;than&nbsp;encrypting&nbsp;the&nbsp;message,&nbsp;"query"&nbsp;returns&nbsp;a<br/>
&nbsp;&nbsp;&nbsp;random&nbsp;ciphertext,&nbsp;i.e.&nbsp;two&nbsp;random&nbsp;group&nbsp;elements&nbsp;(B,X).&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <a id="pk_rand" class="idref" href="#pk_rand"><span class="id" title="definition">pk_rand</span></a> : <a class="idref" href="clutch.prob_lang.lang.html#prob_lang.expr"><span class="id" title="inductive">expr</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">(</span></a>"sk"<a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">,</span></a> "pk"<a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#keygen"><span class="id" title="definition">keygen</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.prob_lang.notation.html#3127c6bc552ca21a494fc6e3474a507d"><span class="id" title="notation">()</span></a> <a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "count" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'ref'_x"><span class="id" title="notation">ref</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>0 <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "query" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.prob_lang.notation.html#d2c3354f6c46df814e66d4c5c9b9c738"><span class="id" title="notation">λ</span></a><a class="idref" href="clutch.prob_lang.notation.html#d2c3354f6c46df814e66d4c5c9b9c738"><span class="id" title="notation">:</span></a>"msg"<a class="idref" href="clutch.prob_lang.notation.html#d2c3354f6c46df814e66d4c5c9b9c738"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#17c2ca1c8de3c2d1c3310c8aa5669890"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#17c2ca1c8de3c2d1c3310c8aa5669890"><span class="id" title="notation">:</span></a><a class="idref" href="clutch.prob_lang.notation.html#17c2ca1c8de3c2d1c3310c8aa5669890"><span class="id" title="notation">m</span></a> "msg" <a class="idref" href="clutch.prob_lang.notation.html#17c2ca1c8de3c2d1c3310c8aa5669890"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int"><span class="id" title="method">vg_of_int</span></a> "msg" <a class="idref" href="clutch.prob_lang.notation.html#17c2ca1c8de3c2d1c3310c8aa5669890"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#13ed3a23ec3e61b54647b25e970eb6b7"><span class="id" title="notation">assert</span></a> <a class="idref" href="clutch.prob_lang.notation.html#13ed3a23ec3e61b54647b25e970eb6b7"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.prob_lang.notation.html#569b74bc432a2b233b93ae1b45418e26"><span class="id" title="notation">!</span></a>"count" <a class="idref" href="clutch.prob_lang.notation.html#268bceb185e8402e5a254d7b9bacc674"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>0<a class="idref" href="clutch.prob_lang.notation.html#13ed3a23ec3e61b54647b25e970eb6b7"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.prob_lang.notation.html#13ed3a23ec3e61b54647b25e970eb6b7"><span class="id" title="notation">;;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"count" <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:x_'&lt;-'_x"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>1 <a class="idref" href="clutch.prob_lang.notation.html#2ec28258c896f2c046d760685d2be2ab"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "b" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#rnd"><span class="id" title="definition">rnd</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.prob_lang.notation.html#3127c6bc552ca21a494fc6e3474a507d"><span class="id" title="notation">()</span></a> <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "x" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#rnd"><span class="id" title="definition">rnd</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.prob_lang.notation.html#3127c6bc552ca21a494fc6e3474a507d"><span class="id" title="notation">()</span></a> <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">(</span></a>"B"<a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">,</span></a> "X"<a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#g"><span class="id" title="method">g</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#f1970a6c2d131dee839d9a93197e874c"><span class="id" title="notation">^</span></a>"b"<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#g"><span class="id" title="method">g</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#f1970a6c2d131dee839d9a93197e874c"><span class="id" title="notation">^</span></a>"x"<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">(</span></a>"B"<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">,</span></a> "X"<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">(</span></a>"pk"<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">,</span></a> "query"<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">)</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;The&nbsp;real&nbsp;game&nbsp;instead&nbsp;encrypts&nbsp;the&nbsp;message&nbsp;in&nbsp;"query".&nbsp;Below,&nbsp;we&nbsp;transform<br/>
&nbsp;&nbsp;&nbsp;pk_real&nbsp;into&nbsp;C<span class="inlinecode"><span class="id" title="var">DH_real</span></span>&nbsp;and&nbsp;C<span class="inlinecode"><span class="id" title="var">DH_rnd</span></span>&nbsp;into&nbsp;pk_rnd.&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <a id="pk_real" class="idref" href="#pk_real"><span class="id" title="definition">pk_real</span></a> : <a class="idref" href="clutch.prob_lang.lang.html#prob_lang.expr"><span class="id" title="inductive">expr</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">(</span></a>"sk"<a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">,</span></a> "pk"<a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#keygen"><span class="id" title="definition">keygen</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.prob_lang.notation.html#3127c6bc552ca21a494fc6e3474a507d"><span class="id" title="notation">()</span></a> <a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "count" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'ref'_x"><span class="id" title="notation">ref</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>0 <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "query" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.prob_lang.notation.html#d2c3354f6c46df814e66d4c5c9b9c738"><span class="id" title="notation">λ</span></a><a class="idref" href="clutch.prob_lang.notation.html#d2c3354f6c46df814e66d4c5c9b9c738"><span class="id" title="notation">:</span></a>"msg"<a class="idref" href="clutch.prob_lang.notation.html#d2c3354f6c46df814e66d4c5c9b9c738"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#17c2ca1c8de3c2d1c3310c8aa5669890"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#17c2ca1c8de3c2d1c3310c8aa5669890"><span class="id" title="notation">:</span></a><a class="idref" href="clutch.prob_lang.notation.html#17c2ca1c8de3c2d1c3310c8aa5669890"><span class="id" title="notation">m</span></a> "msg" <a class="idref" href="clutch.prob_lang.notation.html#17c2ca1c8de3c2d1c3310c8aa5669890"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int"><span class="id" title="method">vg_of_int</span></a> "msg" <a class="idref" href="clutch.prob_lang.notation.html#17c2ca1c8de3c2d1c3310c8aa5669890"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#13ed3a23ec3e61b54647b25e970eb6b7"><span class="id" title="notation">assert</span></a> <a class="idref" href="clutch.prob_lang.notation.html#13ed3a23ec3e61b54647b25e970eb6b7"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.prob_lang.notation.html#569b74bc432a2b233b93ae1b45418e26"><span class="id" title="notation">!</span></a>"count" <a class="idref" href="clutch.prob_lang.notation.html#268bceb185e8402e5a254d7b9bacc674"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>0<a class="idref" href="clutch.prob_lang.notation.html#13ed3a23ec3e61b54647b25e970eb6b7"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.prob_lang.notation.html#13ed3a23ec3e61b54647b25e970eb6b7"><span class="id" title="notation">;;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"count" <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:x_'&lt;-'_x"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>1 <a class="idref" href="clutch.prob_lang.notation.html#2ec28258c896f2c046d760685d2be2ab"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.examples.crypto.ElGamal.html#enc"><span class="id" title="definition">enc</span></a> "pk" "msg" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">(</span></a>"pk"<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">,</span></a> "query"<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">)</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;Unfold&nbsp;definitions&nbsp;and&nbsp;label&nbsp;the&nbsp;flips.&nbsp;We&nbsp;need&nbsp;to&nbsp;label&nbsp;the&nbsp;flip&nbsp;in<br/>
&nbsp;&nbsp;&nbsp;"query"&nbsp;since&nbsp;it&nbsp;occurs&nbsp;in&nbsp;a&nbsp;closure,&nbsp;and&nbsp;we&nbsp;want&nbsp;to&nbsp;relate&nbsp;it&nbsp;to&nbsp;an<br/>
&nbsp;&nbsp;&nbsp;eager&nbsp;sampling&nbsp;in&nbsp;the&nbsp;set-up&nbsp;phase&nbsp;in&nbsp;order&nbsp;to&nbsp;make&nbsp;DH_real&nbsp;appear&nbsp;as&nbsp;a<br/>
&nbsp;&nbsp;&nbsp;sub-expression.&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <a id="pk_real_tape" class="idref" href="#pk_real_tape"><span class="id" title="definition">pk_real_tape</span></a> : <a class="idref" href="clutch.prob_lang.lang.html#prob_lang.expr"><span class="id" title="inductive">expr</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "β" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.prob_lang.notation.html#alloc"><span class="id" title="abbreviation">alloc</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.examples.crypto.ElGamal.html#n"><span class="id" title="abbreviation">n</span></a> <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "sk" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#rnd"><span class="id" title="definition">rnd</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.prob_lang.notation.html#3127c6bc552ca21a494fc6e3474a507d"><span class="id" title="notation">()</span></a> <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "pk" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#g"><span class="id" title="method">g</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#f1970a6c2d131dee839d9a93197e874c"><span class="id" title="notation">^</span></a>"sk" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "count" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'ref'_x"><span class="id" title="notation">ref</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>0 <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "query" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.prob_lang.notation.html#d2c3354f6c46df814e66d4c5c9b9c738"><span class="id" title="notation">λ</span></a><a class="idref" href="clutch.prob_lang.notation.html#d2c3354f6c46df814e66d4c5c9b9c738"><span class="id" title="notation">:</span></a>"msg"<a class="idref" href="clutch.prob_lang.notation.html#d2c3354f6c46df814e66d4c5c9b9c738"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#17c2ca1c8de3c2d1c3310c8aa5669890"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#17c2ca1c8de3c2d1c3310c8aa5669890"><span class="id" title="notation">:</span></a><a class="idref" href="clutch.prob_lang.notation.html#17c2ca1c8de3c2d1c3310c8aa5669890"><span class="id" title="notation">m</span></a> "msg" <a class="idref" href="clutch.prob_lang.notation.html#17c2ca1c8de3c2d1c3310c8aa5669890"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int"><span class="id" title="method">vg_of_int</span></a> "msg" <a class="idref" href="clutch.prob_lang.notation.html#17c2ca1c8de3c2d1c3310c8aa5669890"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#13ed3a23ec3e61b54647b25e970eb6b7"><span class="id" title="notation">assert</span></a> <a class="idref" href="clutch.prob_lang.notation.html#13ed3a23ec3e61b54647b25e970eb6b7"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.prob_lang.notation.html#569b74bc432a2b233b93ae1b45418e26"><span class="id" title="notation">!</span></a>"count" <a class="idref" href="clutch.prob_lang.notation.html#268bceb185e8402e5a254d7b9bacc674"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>0<a class="idref" href="clutch.prob_lang.notation.html#13ed3a23ec3e61b54647b25e970eb6b7"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.prob_lang.notation.html#13ed3a23ec3e61b54647b25e970eb6b7"><span class="id" title="notation">;;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"count" <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:x_'&lt;-'_x"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>1 <a class="idref" href="clutch.prob_lang.notation.html#2ec28258c896f2c046d760685d2be2ab"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "b" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#rnd"><span class="id" title="definition">rnd</span></a> "β" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "B" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#g"><span class="id" title="method">g</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#f1970a6c2d131dee839d9a93197e874c"><span class="id" title="notation">^</span></a>"b" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "C" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> "pk"<a class="idref" href="clutch.examples.crypto.valgroup.html#f1970a6c2d131dee839d9a93197e874c"><span class="id" title="notation">^</span></a>"b" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "X" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> "msg" <a class="idref" href="clutch.examples.crypto.valgroup.html#201a4374e413a582b090bede08aafac0"><span class="id" title="notation">·</span></a> "C" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">(</span></a>"B"<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">,</span></a> "X"<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">(</span></a>"pk"<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">,</span></a> "query"<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">)</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;Pull&nbsp;out&nbsp;DH_real/rand.&nbsp;This&nbsp;requires&nbsp;moving&nbsp;the&nbsp;sampling&nbsp;of&nbsp;"b"&nbsp;from&nbsp;"query"<br/>
&nbsp;&nbsp;&nbsp;to&nbsp;the&nbsp;initialisation.&nbsp;Only&nbsp;equivalent&nbsp;because&nbsp;"query"&nbsp;gets&nbsp;called&nbsp;only<br/>
&nbsp;&nbsp;&nbsp;once:&nbsp;only&nbsp;one&nbsp;message&nbsp;is&nbsp;encrypted,&nbsp;so&nbsp;only&nbsp;one&nbsp;nonce&nbsp;"b"&nbsp;is&nbsp;required,&nbsp;and<br/>
&nbsp;&nbsp;&nbsp;we&nbsp;can&nbsp;pre-sample&nbsp;it&nbsp;in&nbsp;the&nbsp;setup.&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="eC" class="idref" href="#eC"><span class="id" title="definition">eC</span></a> : <a class="idref" href="clutch.prob_lang.lang.html#prob_lang.expr"><span class="id" title="inductive">expr</span></a> :=<br/>
&nbsp;&nbsp;(<a class="idref" href="clutch.prob_lang.notation.html#d2c3354f6c46df814e66d4c5c9b9c738"><span class="id" title="notation">λ</span></a><a class="idref" href="clutch.prob_lang.notation.html#d2c3354f6c46df814e66d4c5c9b9c738"><span class="id" title="notation">:</span></a> "DH_real_or_rnd"<a class="idref" href="clutch.prob_lang.notation.html#d2c3354f6c46df814e66d4c5c9b9c738"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#3c85c3a73dc42bac35db8377412e1b2f"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#3c85c3a73dc42bac35db8377412e1b2f"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob_lang.notation.html#3c85c3a73dc42bac35db8377412e1b2f"><span class="id" title="notation">(</span></a>"pk"<a class="idref" href="clutch.prob_lang.notation.html#3c85c3a73dc42bac35db8377412e1b2f"><span class="id" title="notation">,</span></a> "B"<a class="idref" href="clutch.prob_lang.notation.html#3c85c3a73dc42bac35db8377412e1b2f"><span class="id" title="notation">,</span></a> "C"<a class="idref" href="clutch.prob_lang.notation.html#3c85c3a73dc42bac35db8377412e1b2f"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.prob_lang.notation.html#3c85c3a73dc42bac35db8377412e1b2f"><span class="id" title="notation">:=</span></a> "DH_real_or_rnd" <a class="idref" href="clutch.prob_lang.notation.html#3c85c3a73dc42bac35db8377412e1b2f"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "count" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'ref'_x"><span class="id" title="notation">ref</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>0 <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "query" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.prob_lang.notation.html#d2c3354f6c46df814e66d4c5c9b9c738"><span class="id" title="notation">λ</span></a><a class="idref" href="clutch.prob_lang.notation.html#d2c3354f6c46df814e66d4c5c9b9c738"><span class="id" title="notation">:</span></a> "msg"<a class="idref" href="clutch.prob_lang.notation.html#d2c3354f6c46df814e66d4c5c9b9c738"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#17c2ca1c8de3c2d1c3310c8aa5669890"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#17c2ca1c8de3c2d1c3310c8aa5669890"><span class="id" title="notation">:</span></a><a class="idref" href="clutch.prob_lang.notation.html#17c2ca1c8de3c2d1c3310c8aa5669890"><span class="id" title="notation">m</span></a> "msg" <a class="idref" href="clutch.prob_lang.notation.html#17c2ca1c8de3c2d1c3310c8aa5669890"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int"><span class="id" title="method">vg_of_int</span></a> "msg" <a class="idref" href="clutch.prob_lang.notation.html#17c2ca1c8de3c2d1c3310c8aa5669890"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#13ed3a23ec3e61b54647b25e970eb6b7"><span class="id" title="notation">assert</span></a> <a class="idref" href="clutch.prob_lang.notation.html#13ed3a23ec3e61b54647b25e970eb6b7"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.prob_lang.notation.html#569b74bc432a2b233b93ae1b45418e26"><span class="id" title="notation">!</span></a>"count" <a class="idref" href="clutch.prob_lang.notation.html#268bceb185e8402e5a254d7b9bacc674"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>0<a class="idref" href="clutch.prob_lang.notation.html#13ed3a23ec3e61b54647b25e970eb6b7"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.prob_lang.notation.html#13ed3a23ec3e61b54647b25e970eb6b7"><span class="id" title="notation">;;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"count" <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:x_'&lt;-'_x"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>1 <a class="idref" href="clutch.prob_lang.notation.html#2ec28258c896f2c046d760685d2be2ab"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "X" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> "msg" <a class="idref" href="clutch.examples.crypto.valgroup.html#201a4374e413a582b090bede08aafac0"><span class="id" title="notation">·</span></a> "C" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">(</span></a>"B"<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">,</span></a> "X"<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">(</span></a>"pk"<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">,</span></a> "query"<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">)</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="C" class="idref" href="#C"><span class="id" title="definition">C</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="clutch.prob_lang.lang.html#prob_lang.ectx_item"><span class="id" title="inductive">ectx_item</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="clutch.prob_lang.lang.html#prob_lang.AppRCtx"><span class="id" title="constructor">AppRCtx</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#eC"><span class="id" title="definition">eC</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>.<br/>
<span class="id" title="keyword">Definition</span> <a id="C_DH_real" class="idref" href="#C_DH_real"><span class="id" title="definition">C_DH_real</span></a> : <a class="idref" href="clutch.prob_lang.lang.html#prob_lang.expr"><span class="id" title="inductive">expr</span></a> := <a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#C"><span class="id" title="definition">C</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#DH_real"><span class="id" title="definition">DH_real</span></a>.<br/>
<span class="id" title="keyword">Definition</span> <a id="C_DH_rand" class="idref" href="#C_DH_rand"><span class="id" title="definition">C_DH_rand</span></a> : <a class="idref" href="clutch.prob_lang.lang.html#prob_lang.expr"><span class="id" title="inductive">expr</span></a> := <a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#C"><span class="id" title="definition">C</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#DH_rand"><span class="id" title="definition">DH_rand</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;Inline&nbsp;DH_rand&nbsp;and&nbsp;push&nbsp;the&nbsp;two&nbsp;random&nbsp;samplings&nbsp;not&nbsp;required&nbsp;for&nbsp;the&nbsp;key<br/>
&nbsp;&nbsp;&nbsp;generation&nbsp;back&nbsp;down&nbsp;(using&nbsp;tapes&nbsp;β&nbsp;and&nbsp;γ).&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <a id="pk_rand_tape" class="idref" href="#pk_rand_tape"><span class="id" title="definition">pk_rand_tape</span></a> : <a class="idref" href="clutch.prob_lang.lang.html#prob_lang.expr"><span class="id" title="inductive">expr</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "β" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.prob_lang.notation.html#alloc"><span class="id" title="abbreviation">alloc</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.examples.crypto.ElGamal.html#n"><span class="id" title="abbreviation">n</span></a> <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "γ" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.prob_lang.notation.html#alloc"><span class="id" title="abbreviation">alloc</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.examples.crypto.ElGamal.html#n"><span class="id" title="abbreviation">n</span></a> <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "sk" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#rnd"><span class="id" title="definition">rnd</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.prob_lang.notation.html#3127c6bc552ca21a494fc6e3474a507d"><span class="id" title="notation">()</span></a> <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "pk" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#g"><span class="id" title="method">g</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#f1970a6c2d131dee839d9a93197e874c"><span class="id" title="notation">^</span></a>"sk" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "count" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'ref'_x"><span class="id" title="notation">ref</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>0 <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "query" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.prob_lang.notation.html#d2c3354f6c46df814e66d4c5c9b9c738"><span class="id" title="notation">λ</span></a><a class="idref" href="clutch.prob_lang.notation.html#d2c3354f6c46df814e66d4c5c9b9c738"><span class="id" title="notation">:</span></a>"msg"<a class="idref" href="clutch.prob_lang.notation.html#d2c3354f6c46df814e66d4c5c9b9c738"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#17c2ca1c8de3c2d1c3310c8aa5669890"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#17c2ca1c8de3c2d1c3310c8aa5669890"><span class="id" title="notation">:</span></a><a class="idref" href="clutch.prob_lang.notation.html#17c2ca1c8de3c2d1c3310c8aa5669890"><span class="id" title="notation">m</span></a> "msg" <a class="idref" href="clutch.prob_lang.notation.html#17c2ca1c8de3c2d1c3310c8aa5669890"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int"><span class="id" title="method">vg_of_int</span></a> "msg" <a class="idref" href="clutch.prob_lang.notation.html#17c2ca1c8de3c2d1c3310c8aa5669890"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#13ed3a23ec3e61b54647b25e970eb6b7"><span class="id" title="notation">assert</span></a> <a class="idref" href="clutch.prob_lang.notation.html#13ed3a23ec3e61b54647b25e970eb6b7"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.prob_lang.notation.html#569b74bc432a2b233b93ae1b45418e26"><span class="id" title="notation">!</span></a>"count" <a class="idref" href="clutch.prob_lang.notation.html#268bceb185e8402e5a254d7b9bacc674"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>0<a class="idref" href="clutch.prob_lang.notation.html#13ed3a23ec3e61b54647b25e970eb6b7"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.prob_lang.notation.html#13ed3a23ec3e61b54647b25e970eb6b7"><span class="id" title="notation">;;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"count" <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:x_'&lt;-'_x"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>1 <a class="idref" href="clutch.prob_lang.notation.html#2ec28258c896f2c046d760685d2be2ab"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "b" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#rnd"><span class="id" title="definition">rnd</span></a> "β" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "c" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#rnd"><span class="id" title="definition">rnd</span></a> "γ" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "B" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#g"><span class="id" title="method">g</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#f1970a6c2d131dee839d9a93197e874c"><span class="id" title="notation">^</span></a>"b" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "C" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#g"><span class="id" title="method">g</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#f1970a6c2d131dee839d9a93197e874c"><span class="id" title="notation">^</span></a>"c" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "X" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> "msg" <a class="idref" href="clutch.examples.crypto.valgroup.html#201a4374e413a582b090bede08aafac0"><span class="id" title="notation">·</span></a> "C" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">(</span></a>"B"<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">,</span></a> "X"<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">(</span></a>"pk"<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">,</span></a> "query"<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">)</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;Finally,&nbsp;we&nbsp;connect&nbsp;pk_rand_tape&nbsp;to&nbsp;pk_rand.&nbsp;For&nbsp;this&nbsp;last&nbsp;step,&nbsp;we<br/>
&nbsp;&nbsp;&nbsp;want&nbsp;to&nbsp;show&nbsp;that&nbsp;multiplying&nbsp;the&nbsp;message&nbsp;with&nbsp;a&nbsp;random&nbsp;group&nbsp;element&nbsp;really<br/>
&nbsp;&nbsp;&nbsp;looks&nbsp;random,&nbsp;i.e.&nbsp;that&nbsp;msg⋅C&nbsp;=&nbsp;msg⋅g^c&nbsp;looks&nbsp;random,&nbsp;just&nbsp;like&nbsp;X&nbsp;=&nbsp;g^x.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;We&nbsp;prove&nbsp;this&nbsp;by&nbsp;showing&nbsp;that&nbsp;multiplying&nbsp;by&nbsp;msg&nbsp;induces&nbsp;a&nbsp;bijection&nbsp;f&nbsp;on&nbsp;the<br/>
&nbsp;&nbsp;&nbsp;set&nbsp;fin&nbsp;(S&nbsp;n)&nbsp;we&nbsp;sampled&nbsp;x&nbsp;from:&nbsp;Since&nbsp;msg&nbsp;=&nbsp;g^k&nbsp;for&nbsp;some&nbsp;unique&nbsp;k,&nbsp;msg&nbsp;has<br/>
&nbsp;&nbsp;&nbsp;inverse&nbsp;g^(-k),&nbsp;i.e.&nbsp;we&nbsp;define&nbsp;f(c)&nbsp;:=&nbsp;k+c&nbsp;(the&nbsp;inverse&nbsp;is&nbsp;obviously&nbsp;given<br/>
&nbsp;&nbsp;&nbsp;by&nbsp;(λ&nbsp;c,&nbsp;c-k)).&nbsp;Let&nbsp;msg⋅g^c&nbsp;=&nbsp;g^k⋅g^c&nbsp;=&nbsp;g^(k+c).&nbsp;Let&nbsp;x&nbsp;=&nbsp;f(c)&nbsp;be&nbsp;sampled&nbsp;along<br/>
&nbsp;&nbsp;&nbsp;the&nbsp;bijection&nbsp;f.&nbsp;Then&nbsp;g^x&nbsp;=&nbsp;g^f(c)&nbsp;=&nbsp;g^(c+k),&nbsp;as&nbsp;required.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;Since&nbsp;we&nbsp;need&nbsp;to&nbsp;know&nbsp;the&nbsp;value&nbsp;of&nbsp;msg,&nbsp;we&nbsp;cannot&nbsp;combine&nbsp;this&nbsp;game-hop&nbsp;with<br/>
&nbsp;&nbsp;&nbsp;the&nbsp;previous&nbsp;one:&nbsp;in&nbsp;C_DH_rand,&nbsp;c&nbsp;is&nbsp;sampled&nbsp;before&nbsp;msg&nbsp;is&nbsp;known.&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="pkN" class="idref" href="#pkN"><span class="id" title="definition">pkN</span></a> := <span class="id" title="definition">nroot</span><span class="id" title="notation">.@</span>"pks".<br/>

<br/>
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Tactic</span> <span class="id" title="keyword">Notation</span> "inv_prove" :=<br/>
&nbsp;&nbsp;<span class="id" title="var">iSplitL</span> ; [ <span class="id" title="tactic">by</span> (<span class="id" title="tactic">repeat</span> (<span class="id" title="var">iExists</span> <span class="id" title="var">_</span>) ; (<span class="id" title="tactic">by</span> <span class="id" title="var">iFrame</span>) || (<span class="id" title="var">iLeft</span> ; <span class="id" title="tactic">by</span> <span class="id" title="var">iFrame</span>) || (<span class="id" title="var">iRight</span> ; <span class="id" title="tactic">by</span> <span class="id" title="var">iFrame</span>)) |].<br/>

<br/>
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Tactic</span> <span class="id" title="keyword">Notation</span> "inv_mk" <span class="id" title="keyword">constr</span>(<span class="id" title="var">Pinv</span>) <span class="id" title="keyword">constr</span>(<span class="id" title="var">h</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">iApply</span> (<a class="idref" href="clutch.rel_logic.model.html#refines_na_alloc"><span class="id" title="lemma">refines_na_alloc</span></a> <span class="id" title="var">Pinv</span> <a class="idref" href="clutch.examples.crypto.ElGamal.html#pkN"><span class="id" title="definition">pkN</span></a>) ; <span class="id" title="var">inv_prove</span> ; <span class="id" title="var">iIntros</span> <span class="id" title="var">h</span>.<br/>

<br/>
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Tactic</span> <span class="id" title="keyword">Notation</span> "inv_cl" <span class="id" title="keyword">constr</span>(<span class="id" title="var">h</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.model.html#refines_na_close"><span class="id" title="lemma">refines_na_close</span></a> <span class="id" title="notation">with</span> <span class="id" title="var">h</span><span class="id" title="notation">)</span> ; <span class="id" title="var">inv_prove</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="real_real_tape" class="idref" href="#real_real_tape"><span class="id" title="lemma">real_real_tape</span></a> : <span class="id" title="notation">⊢</span> <a class="idref" href="clutch.rel_logic.model.html#refines"><span class="id" title="definition">refines</span></a> <span class="id" title="definition">top</span> <a class="idref" href="clutch.examples.crypto.ElGamal.html#pk_real"><span class="id" title="definition">pk_real</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#pk_real_tape"><span class="id" title="definition">pk_real_tape</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#T_EG"><span class="id" title="definition">T_EG</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">with</span> <span class="id" title="var">rel_red</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rel_red</span>. <span class="id" title="var">rel_couple_UU</span>...<br/>
&nbsp;&nbsp;<span class="id" title="var">inv_mk</span> (<span class="id" title="var">β</span>ₛ <a class="idref" href="clutch.rel_logic.spec_ra.html#537f9bfe1a4246c42baec6fa8e98c8aa"><span class="id" title="notation">↪ₛ</span></a> <a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.examples.crypto.ElGamal.html#n"><span class="id" title="abbreviation">n</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">;</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">)</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="var">count</span> <a class="idref" href="clutch.rel_logic.primitive_laws.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>0 <span class="id" title="notation">∗</span> <span class="id" title="var">count</span>ₛ <a class="idref" href="clutch.rel_logic.spec_ra.html#0326014f985dcbdf069e6962e826748b"><span class="id" title="notation">↦ₛ</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>0<span class="id" title="notation">)</span> <span class="id" title="notation">∨</span> <span class="id" title="notation">(</span><span class="id" title="var">count</span> <a class="idref" href="clutch.rel_logic.primitive_laws.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>1 <span class="id" title="notation">∗</span> <span class="id" title="var">count</span>ₛ <a class="idref" href="clutch.rel_logic.spec_ra.html#0326014f985dcbdf069e6962e826748b"><span class="id" title="notation">↦ₛ</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>1<span class="id" title="notation">)</span> )%<span class="id" title="var">I</span> "#Hinv"...<br/>
&nbsp;&nbsp;<span class="id" title="var">rel_vals</span> ; <span class="id" title="var">iIntros</span> "!&gt;" (??) "[%v[-&gt;-&gt;]]"...<br/>
&nbsp;&nbsp;<span class="id" title="var">rel_bind_l</span> (<a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int"><span class="id" title="method">vg_of_int</span></a> <span class="id" title="var">_</span>) ; <span class="id" title="var">rel_bind_r</span> (<a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int"><span class="id" title="method">vg_of_int</span></a> <span class="id" title="var">_</span>) ; <span class="id" title="var">rel_apply</span> <a class="idref" href="clutch.rel_logic.model.html#refines_bind"><span class="id" title="lemma">refines_bind</span></a>.<br/>
&nbsp;&nbsp;1: <span class="id" title="var">iApply</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int_lrel_G"><span class="id" title="method">vg_of_int_lrel_G</span></a> ; <span class="id" title="var">iExists</span> <span class="id" title="var">_</span> ; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (??) "#(%_&amp;%_'&amp;[(-&gt;&amp;-&gt;&amp;-&gt;&amp;-&gt;)|(-&gt;&amp;-&gt;&amp;%vmsg&amp;-&gt;&amp;-&gt;)])"... 1: <span class="id" title="var">rel_vals</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.model.html#refines_na_inv"><span class="id" title="lemma">refines_na_inv</span></a> <span class="id" title="notation">with</span> "[-$Hinv]"<span class="id" title="notation">)</span>; [<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "[&gt;[(β&amp;c&amp;c')|(c&amp;c')] Hclose]"...<br/>
&nbsp;&nbsp;2: <span class="id" title="var">inv_cl</span> "[- $Hclose]" ; <span class="id" title="var">rel_vals</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rel_couple_UT</span> "β"...<br/>
&nbsp;&nbsp;<span class="id" title="var">inv_cl</span> "[- $Hclose]"... <span class="id" title="var">rel_vals</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="real_tape_real" class="idref" href="#real_tape_real"><span class="id" title="lemma">real_tape_real</span></a> : <span class="id" title="notation">⊢</span> <a class="idref" href="clutch.rel_logic.model.html#refines"><span class="id" title="definition">refines</span></a> <span class="id" title="definition">top</span> <a class="idref" href="clutch.examples.crypto.ElGamal.html#pk_real_tape"><span class="id" title="definition">pk_real_tape</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#pk_real"><span class="id" title="definition">pk_real</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#T_EG"><span class="id" title="definition">T_EG</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">with</span> <span class="id" title="var">rel_red</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rel_red</span>. <span class="id" title="var">rel_couple_UU</span>...<br/>
&nbsp;&nbsp;<span class="id" title="var">inv_mk</span> (<span class="id" title="var">β</span> <a class="idref" href="clutch.rel_logic.primitive_laws.html#52c0998123349fcc3e1f8d05ae50419f"><span class="id" title="notation">↪</span></a> <a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.examples.crypto.ElGamal.html#n"><span class="id" title="abbreviation">n</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">;</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">)</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="var">count</span> <a class="idref" href="clutch.rel_logic.primitive_laws.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>0 <span class="id" title="notation">∗</span> <span class="id" title="var">count</span>ₛ <a class="idref" href="clutch.rel_logic.spec_ra.html#0326014f985dcbdf069e6962e826748b"><span class="id" title="notation">↦ₛ</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>0<span class="id" title="notation">)</span> <span class="id" title="notation">∨</span> <span class="id" title="notation">(</span><span class="id" title="var">count</span> <a class="idref" href="clutch.rel_logic.primitive_laws.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>1 <span class="id" title="notation">∗</span> <span class="id" title="var">count</span>ₛ <a class="idref" href="clutch.rel_logic.spec_ra.html#0326014f985dcbdf069e6962e826748b"><span class="id" title="notation">↦ₛ</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>1<span class="id" title="notation">)</span> )%<span class="id" title="var">I</span> "#Hinv"...<br/>
&nbsp;&nbsp;<span class="id" title="var">rel_vals</span> ; <span class="id" title="var">iIntros</span> "!&gt;" (??) "[%v[-&gt;-&gt;]]"...<br/>
&nbsp;&nbsp;<span class="id" title="var">rel_bind_l</span> (<a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int"><span class="id" title="method">vg_of_int</span></a> <span class="id" title="var">_</span>) ; <span class="id" title="var">rel_bind_r</span> (<a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int"><span class="id" title="method">vg_of_int</span></a> <span class="id" title="var">_</span>) ; <span class="id" title="var">rel_apply</span> <a class="idref" href="clutch.rel_logic.model.html#refines_bind"><span class="id" title="lemma">refines_bind</span></a>.<br/>
&nbsp;&nbsp;1: <span class="id" title="var">iApply</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int_lrel_G"><span class="id" title="method">vg_of_int_lrel_G</span></a> ; <span class="id" title="var">iExists</span> <span class="id" title="var">_</span> ; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (??) "#(%_&amp;%_'&amp;[(-&gt;&amp;-&gt;&amp;-&gt;&amp;-&gt;)|(-&gt;&amp;-&gt;&amp;%vmsg&amp;-&gt;&amp;-&gt;)])"... 1: <span class="id" title="var">rel_vals</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.model.html#refines_na_inv"><span class="id" title="lemma">refines_na_inv</span></a> <span class="id" title="notation">with</span> "[-$Hinv]"<span class="id" title="notation">)</span>; [<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "[&gt;[(β&amp;c&amp;c')|(c&amp;c')] Hclose]"...<br/>
&nbsp;&nbsp;2: <span class="id" title="var">inv_cl</span> "[- $Hclose]" ; <span class="id" title="var">rel_vals</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rel_couple_TU</span> "β"...<br/>
&nbsp;&nbsp;<span class="id" title="var">inv_cl</span> "[- $Hclose]" ; <span class="id" title="var">rel_vals</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="real_tape_C_DH_real" class="idref" href="#real_tape_C_DH_real"><span class="id" title="lemma">real_tape_C_DH_real</span></a> : <span class="id" title="notation">⊢</span> <a class="idref" href="clutch.rel_logic.model.html#refines"><span class="id" title="definition">refines</span></a> <span class="id" title="definition">top</span> <a class="idref" href="clutch.examples.crypto.ElGamal.html#pk_real_tape"><span class="id" title="definition">pk_real_tape</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#C_DH_real"><span class="id" title="definition">C_DH_real</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#T_EG"><span class="id" title="definition">T_EG</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">with</span> <span class="id" title="var">rel_red</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.examples.crypto.ElGamal.html#C_DH_real"><span class="id" title="definition">C_DH_real</span></a> /=. <span class="id" title="var">rel_red</span>. <span class="id" title="var">rel_couple_UU</span>. <span class="id" title="var">ireds</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rel_couple_TU</span> "β"...<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.Znat.html#Nat2Z.inj_mul"><span class="id" title="lemma">Nat2Z.inj_mul</span></a>...<br/>
&nbsp;&nbsp;<span class="id" title="var">inv_mk</span> (<span class="id" title="notation">(</span><span class="id" title="var">β</span> <a class="idref" href="clutch.rel_logic.primitive_laws.html#52c0998123349fcc3e1f8d05ae50419f"><span class="id" title="notation">↪</span></a> <a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.examples.crypto.ElGamal.html#n"><span class="id" title="abbreviation">n</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">;</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">)</span></a> <span class="id" title="notation">∗</span> <span class="id" title="var">count</span> <a class="idref" href="clutch.rel_logic.primitive_laws.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>0 <span class="id" title="notation">∗</span> <span class="id" title="var">count</span>ₛ <a class="idref" href="clutch.rel_logic.spec_ra.html#0326014f985dcbdf069e6962e826748b"><span class="id" title="notation">↦ₛ</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>0<span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∨</span> <span class="id" title="notation">(</span><span class="id" title="var">count</span> <a class="idref" href="clutch.rel_logic.primitive_laws.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>1 <span class="id" title="notation">∗</span> <span class="id" title="var">count</span>ₛ <a class="idref" href="clutch.rel_logic.spec_ra.html#0326014f985dcbdf069e6962e826748b"><span class="id" title="notation">↦ₛ</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>1<span class="id" title="notation">)</span>)%<span class="id" title="var">I</span> "#Hinv".<br/>
&nbsp;&nbsp;<span class="id" title="var">rel_vals</span> ; <span class="id" title="var">iIntros</span> "!&gt;" (??) "#(%msg&amp;-&gt;&amp;-&gt;)"...<br/>
&nbsp;&nbsp;<span class="id" title="var">rel_bind_l</span> (<a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int"><span class="id" title="method">vg_of_int</span></a> <span class="id" title="var">_</span>) ; <span class="id" title="var">rel_bind_r</span> (<a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int"><span class="id" title="method">vg_of_int</span></a> <span class="id" title="var">_</span>) ; <span class="id" title="var">rel_apply</span> <a class="idref" href="clutch.rel_logic.model.html#refines_bind"><span class="id" title="lemma">refines_bind</span></a>.<br/>
&nbsp;&nbsp;1: <span class="id" title="var">iApply</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int_lrel_G"><span class="id" title="method">vg_of_int_lrel_G</span></a> ; <span class="id" title="var">iExists</span> <span class="id" title="var">_</span> ; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (??) "#(%_1&amp;%_2&amp;[(-&gt;&amp;-&gt;&amp;-&gt;&amp;-&gt;)|(-&gt;&amp;-&gt;&amp;%vmsg&amp;-&gt;&amp;-&gt;)])"... 1: <span class="id" title="var">rel_vals</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.model.html#refines_na_inv"><span class="id" title="lemma">refines_na_inv</span></a> <span class="id" title="notation">with</span> "[$Hinv]"<span class="id" title="notation">)</span>; [<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "[&gt;[(β&amp;cnt&amp;cnt')|(c&amp;c')] Hclose]"...<br/>
&nbsp;&nbsp;2: <span class="id" title="tactic">by</span> (<span class="id" title="var">inv_cl</span> "[- $Hclose]" ; <span class="id" title="var">rel_vals</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">inv_cl</span> "[- $Hclose]"...<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="lemma">expgM</span> -<span class="id" title="lemma">ssrnat.multE</span>. <span class="id" title="var">rel_vals</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="C_DH_real_real_tape" class="idref" href="#C_DH_real_real_tape"><span class="id" title="lemma">C_DH_real_real_tape</span></a> : <span class="id" title="notation">⊢</span> <a class="idref" href="clutch.rel_logic.model.html#refines"><span class="id" title="definition">refines</span></a> <span class="id" title="definition">top</span> <a class="idref" href="clutch.examples.crypto.ElGamal.html#C_DH_real"><span class="id" title="definition">C_DH_real</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#pk_real_tape"><span class="id" title="definition">pk_real_tape</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#T_EG"><span class="id" title="definition">T_EG</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">with</span> <span class="id" title="var">rel_red</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.examples.crypto.ElGamal.html#C_DH_real"><span class="id" title="definition">C_DH_real</span></a> /=. <span class="id" title="var">rel_red</span>. <span class="id" title="var">rel_couple_UU</span>. <span class="id" title="var">ireds</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rel_couple_UT</span> "βₛ"...<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.Znat.html#Nat2Z.inj_mul"><span class="id" title="lemma">Nat2Z.inj_mul</span></a>...<br/>
&nbsp;&nbsp;<span class="id" title="var">inv_mk</span> (<span class="id" title="notation">(</span><span class="id" title="var">β</span>ₛ <a class="idref" href="clutch.rel_logic.spec_ra.html#537f9bfe1a4246c42baec6fa8e98c8aa"><span class="id" title="notation">↪ₛ</span></a> <a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.examples.crypto.ElGamal.html#n"><span class="id" title="abbreviation">n</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">;</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">)</span></a> <span class="id" title="notation">∗</span> <span class="id" title="var">count</span> <a class="idref" href="clutch.rel_logic.primitive_laws.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>0 <span class="id" title="notation">∗</span> <span class="id" title="var">count</span>ₛ <a class="idref" href="clutch.rel_logic.spec_ra.html#0326014f985dcbdf069e6962e826748b"><span class="id" title="notation">↦ₛ</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>0<span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∨</span> <span class="id" title="notation">(</span><span class="id" title="var">count</span> <a class="idref" href="clutch.rel_logic.primitive_laws.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>1 <span class="id" title="notation">∗</span> <span class="id" title="var">count</span>ₛ <a class="idref" href="clutch.rel_logic.spec_ra.html#0326014f985dcbdf069e6962e826748b"><span class="id" title="notation">↦ₛ</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>1<span class="id" title="notation">)</span>)%<span class="id" title="var">I</span> "#Hinv".<br/>
&nbsp;&nbsp;<span class="id" title="var">rel_vals</span> ; <span class="id" title="var">iIntros</span> "!&gt;" (??) "#(%msg&amp;-&gt;&amp;-&gt;)"...<br/>
&nbsp;&nbsp;<span class="id" title="var">rel_bind_l</span> (<a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int"><span class="id" title="method">vg_of_int</span></a> <span class="id" title="var">_</span>) ; <span class="id" title="var">rel_bind_r</span> (<a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int"><span class="id" title="method">vg_of_int</span></a> <span class="id" title="var">_</span>) ; <span class="id" title="var">rel_apply</span> <a class="idref" href="clutch.rel_logic.model.html#refines_bind"><span class="id" title="lemma">refines_bind</span></a>.<br/>
&nbsp;&nbsp;1: <span class="id" title="var">iApply</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int_lrel_G"><span class="id" title="method">vg_of_int_lrel_G</span></a> ; <span class="id" title="var">iExists</span> <span class="id" title="var">_</span> ; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (??) "#(%_1&amp;%_2&amp;[(-&gt;&amp;-&gt;&amp;-&gt;&amp;-&gt;)|(-&gt;&amp;-&gt;&amp;%vmsg&amp;-&gt;&amp;-&gt;)])"... 1: <span class="id" title="var">rel_vals</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.model.html#refines_na_inv"><span class="id" title="lemma">refines_na_inv</span></a> <span class="id" title="notation">with</span> "[$Hinv]"<span class="id" title="notation">)</span>; [<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "[&gt;[(β&amp;cnt&amp;cnt')|(c&amp;c')] Hclose]"...<br/>
&nbsp;&nbsp;2: <span class="id" title="tactic">by</span> (<span class="id" title="var">inv_cl</span> "[- $Hclose]" ; <span class="id" title="var">rel_vals</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">inv_cl</span> "[- $Hclose]"...<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="lemma">expgM</span> -<span class="id" title="lemma">ssrnat.multE</span>. <span class="id" title="var">rel_vals</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;This&nbsp;assumption&nbsp;is&nbsp;too&nbsp;strong&nbsp;in&nbsp;this&nbsp;generality,&nbsp;since&nbsp;it&nbsp;does&nbsp;not&nbsp;mention<br/>
&nbsp;&nbsp;&nbsp;PPT&nbsp;indistinguishability&nbsp;and&nbsp;assumes&nbsp;a&nbsp;logical&nbsp;instead&nbsp;of&nbsp;contextual<br/>
&nbsp;&nbsp;&nbsp;refinement.&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <a id="DDH_ref" class="idref" href="#DDH_ref"><span class="id" title="definition">DDH_ref</span></a> := <span class="id" title="notation">⊢</span> <a class="idref" href="clutch.rel_logic.model.html#refines"><span class="id" title="definition">refines</span></a> <span class="id" title="definition">top</span> <a class="idref" href="clutch.examples.crypto.ElGamal.html#DH_real"><span class="id" title="definition">DH_real</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#DH_rand"><span class="id" title="definition">DH_rand</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#T_DH"><span class="id" title="definition">T_DH</span></a>.<br/>
<span class="comment">(*&nbsp;If&nbsp;we&nbsp;do&nbsp;make&nbsp;this&nbsp;assumption&nbsp;though,&nbsp;we&nbsp;may&nbsp;prove&nbsp;the&nbsp;following&nbsp;refinement.&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <a id="DDH_C_DH_real_C_DH_rand" class="idref" href="#DDH_C_DH_real_C_DH_rand"><span class="id" title="lemma">DDH_C_DH_real_C_DH_rand</span></a> (<a id="DDH:9" class="idref" href="#DDH:9"><span class="id" title="binder">DDH</span></a> : <a class="idref" href="clutch.examples.crypto.ElGamal.html#DDH_ref"><span class="id" title="definition">DDH_ref</span></a>) : <span class="id" title="notation">⊢</span> <a class="idref" href="clutch.rel_logic.model.html#refines"><span class="id" title="definition">refines</span></a> <span class="id" title="definition">top</span> <a class="idref" href="clutch.examples.crypto.ElGamal.html#C_DH_real"><span class="id" title="definition">C_DH_real</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#C_DH_rand"><span class="id" title="definition">C_DH_rand</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#T_EG"><span class="id" title="definition">T_EG</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">with</span> <span class="id" title="var">rel_red</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.examples.crypto.ElGamal.html#C_DH_real"><span class="id" title="definition">C_DH_real</span></a> /<a class="idref" href="clutch.examples.crypto.ElGamal.html#C_DH_rand"><span class="id" title="definition">C_DH_rand</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rel_bind_l</span> <a class="idref" href="clutch.examples.crypto.ElGamal.html#DH_real"><span class="id" title="definition">DH_real</span></a>. <span class="id" title="var">rel_bind_r</span> <a class="idref" href="clutch.examples.crypto.ElGamal.html#DH_rand"><span class="id" title="definition">DH_rand</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rel_apply</span> <a class="idref" href="clutch.rel_logic.compatibility.html#refines_app"><span class="id" title="lemma">refines_app</span></a>. 2: <span class="id" title="var">iApply</span> <span class="id" title="var">DDH</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="clutch.examples.crypto.ElGamal.html#T_DH"><span class="id" title="definition">T_DH</span></a> <a class="idref" href="clutch.rel_logic.model.html#198b3df6111d1e335bfbd02615def5fc"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#T_EG"><span class="id" title="definition">T_EG</span></a>)%<span class="id" title="var">lrel</span> <span class="id" title="keyword">with</span> (<a class="idref" href="clutch.typing.interp.html#interp"><span class="id" title="definition">interp</span></a> (<a class="idref" href="clutch.examples.crypto.ElGamal.html#208159eccf7e85aae5d432b571819b63"><span class="id" title="definition">τ</span></a><a class="idref" href="clutch.examples.crypto.ElGamal.html#208159eccf7e85aae5d432b571819b63"><span class="id" title="definition">_DH</span></a> <a class="idref" href="clutch.typing.types.html#cf2aa254e4c9f9cb95db860c4555acd5"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#9fc5d2f065cb312100547e5efeaaf47d"><span class="id" title="definition">τ</span></a><a class="idref" href="clutch.examples.crypto.ElGamal.html#9fc5d2f065cb312100547e5efeaaf47d"><span class="id" title="definition">_EG</span></a>)%<span class="id" title="var">ty</span> <a class="idref" href="clutch.examples.crypto.ElGamal.html#c60cf82b94a1f8e1c92704bf6cc308f9"><span class="id" title="variable">Δ</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="clutch.typing.fundamental.html#refines_typed"><span class="id" title="lemma">refines_typed</span></a>. <span class="id" title="tactic">unfold</span> <a class="idref" href="clutch.examples.crypto.ElGamal.html#eC"><span class="id" title="definition">eC</span></a>. <span class="id" title="var">tychk</span> =&gt; //.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="C_DH_rand_rand_tape" class="idref" href="#C_DH_rand_rand_tape"><span class="id" title="lemma">C_DH_rand_rand_tape</span></a> : <span class="id" title="notation">⊢</span> <a class="idref" href="clutch.rel_logic.model.html#refines"><span class="id" title="definition">refines</span></a> <span class="id" title="definition">top</span> <a class="idref" href="clutch.examples.crypto.ElGamal.html#C_DH_rand"><span class="id" title="definition">C_DH_rand</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#pk_rand_tape"><span class="id" title="definition">pk_rand_tape</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#T_EG"><span class="id" title="definition">T_EG</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">with</span> <span class="id" title="var">rel_red</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.examples.crypto.ElGamal.html#C_DH_rand"><span class="id" title="definition">C_DH_rand</span></a> /=. <span class="id" title="var">rel_red</span>. <span class="id" title="var">rel_couple_UU</span>...<br/>
&nbsp;&nbsp;<span class="id" title="var">rel_couple_UT</span> "βₛ"...<br/>
&nbsp;&nbsp;<span class="id" title="var">rel_couple_UT</span> "γₛ"...<br/>
&nbsp;&nbsp;<span class="id" title="var">inv_mk</span> (<span class="id" title="notation">(</span><span class="id" title="var">β</span>ₛ <a class="idref" href="clutch.rel_logic.spec_ra.html#537f9bfe1a4246c42baec6fa8e98c8aa"><span class="id" title="notation">↪ₛ</span></a> <a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.examples.crypto.ElGamal.html#n"><span class="id" title="abbreviation">n</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">;</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">)</span></a> <span class="id" title="notation">∗</span> <span class="id" title="var">γ</span>ₛ <a class="idref" href="clutch.rel_logic.spec_ra.html#537f9bfe1a4246c42baec6fa8e98c8aa"><span class="id" title="notation">↪ₛ</span></a> <a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.examples.crypto.ElGamal.html#n"><span class="id" title="abbreviation">n</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">;</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><span class="id" title="var">c</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">)</span></a> <span class="id" title="notation">∗</span> <span class="id" title="var">count</span> <a class="idref" href="clutch.rel_logic.primitive_laws.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>0 <span class="id" title="notation">∗</span> <span class="id" title="var">count</span>ₛ <a class="idref" href="clutch.rel_logic.spec_ra.html#0326014f985dcbdf069e6962e826748b"><span class="id" title="notation">↦ₛ</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>0<span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∨</span> <span class="id" title="notation">(</span><span class="id" title="var">count</span> <a class="idref" href="clutch.rel_logic.primitive_laws.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>1 <span class="id" title="notation">∗</span> <span class="id" title="var">count</span>ₛ <a class="idref" href="clutch.rel_logic.spec_ra.html#0326014f985dcbdf069e6962e826748b"><span class="id" title="notation">↦ₛ</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>1<span class="id" title="notation">)</span>)%<span class="id" title="var">I</span> "#Hinv".<br/>
&nbsp;&nbsp;<span class="id" title="var">rel_vals</span> ; <span class="id" title="var">iIntros</span> "!&gt;" (??) "#(%msg&amp;-&gt;&amp;-&gt;)"...<br/>
&nbsp;&nbsp;<span class="id" title="var">rel_bind_l</span> (<a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int"><span class="id" title="method">vg_of_int</span></a> <span class="id" title="var">_</span>) ; <span class="id" title="var">rel_bind_r</span> (<a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int"><span class="id" title="method">vg_of_int</span></a> <span class="id" title="var">_</span>) ; <span class="id" title="var">rel_apply</span> <a class="idref" href="clutch.rel_logic.model.html#refines_bind"><span class="id" title="lemma">refines_bind</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">iApply</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int_lrel_G"><span class="id" title="method">vg_of_int_lrel_G</span></a> ; <span class="id" title="var">iExists</span> <span class="id" title="var">_</span> ; <span class="id" title="tactic">eauto</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (??) "#(%_1&amp;%_2&amp;[(-&gt;&amp;-&gt;&amp;-&gt;&amp;-&gt;)|(-&gt;&amp;-&gt;&amp;%vmsg&amp;-&gt;&amp;-&gt;)])"... 1: <span class="id" title="var">rel_vals</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.model.html#refines_na_inv"><span class="id" title="lemma">refines_na_inv</span></a> <span class="id" title="notation">with</span> "[$Hinv]"<span class="id" title="notation">)</span> =&gt; //.<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "[&gt;[(β'&amp;γ'&amp;cnt&amp;cnt')|(cnt&amp;cnt')] Hclose]"...<br/>
&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="var">inv_cl</span> "[- $Hclose]" ; <span class="id" title="var">rel_vals</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="rand_tape_C_DH_rand" class="idref" href="#rand_tape_C_DH_rand"><span class="id" title="lemma">rand_tape_C_DH_rand</span></a> : <span class="id" title="notation">⊢</span> <a class="idref" href="clutch.rel_logic.model.html#refines"><span class="id" title="definition">refines</span></a> <span class="id" title="definition">top</span> <a class="idref" href="clutch.examples.crypto.ElGamal.html#pk_rand_tape"><span class="id" title="definition">pk_rand_tape</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#C_DH_rand"><span class="id" title="definition">C_DH_rand</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#T_EG"><span class="id" title="definition">T_EG</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">with</span> <span class="id" title="var">rel_red</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.examples.crypto.ElGamal.html#C_DH_rand"><span class="id" title="definition">C_DH_rand</span></a> /=. <span class="id" title="var">rel_red</span>. <span class="id" title="var">rel_couple_UU</span>. <span class="id" title="var">iredrs</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rel_couple_TU</span> "β". <span class="id" title="var">iredrs</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rel_couple_TU</span> "γ"...<br/>
&nbsp;&nbsp;<span class="id" title="var">inv_mk</span> (<span class="id" title="notation">(</span><span class="id" title="var">β</span> <a class="idref" href="clutch.rel_logic.primitive_laws.html#52c0998123349fcc3e1f8d05ae50419f"><span class="id" title="notation">↪</span></a> <a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.examples.crypto.ElGamal.html#n"><span class="id" title="abbreviation">n</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">;</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">)</span></a> <span class="id" title="notation">∗</span> <span class="id" title="var">γ</span> <a class="idref" href="clutch.rel_logic.primitive_laws.html#52c0998123349fcc3e1f8d05ae50419f"><span class="id" title="notation">↪</span></a> <a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.examples.crypto.ElGamal.html#n"><span class="id" title="abbreviation">n</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">;</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><span class="id" title="var">c</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">)</span></a> <span class="id" title="notation">∗</span> <span class="id" title="var">count</span> <a class="idref" href="clutch.rel_logic.primitive_laws.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>0 <span class="id" title="notation">∗</span> <span class="id" title="var">count</span>ₛ <a class="idref" href="clutch.rel_logic.spec_ra.html#0326014f985dcbdf069e6962e826748b"><span class="id" title="notation">↦ₛ</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>0<span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∨</span> <span class="id" title="notation">(</span><span class="id" title="var">count</span> <a class="idref" href="clutch.rel_logic.primitive_laws.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>1 <span class="id" title="notation">∗</span> <span class="id" title="var">count</span>ₛ <a class="idref" href="clutch.rel_logic.spec_ra.html#0326014f985dcbdf069e6962e826748b"><span class="id" title="notation">↦ₛ</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>1<span class="id" title="notation">)</span>)%<span class="id" title="var">I</span> "#Hinv".<br/>
&nbsp;&nbsp;<span class="id" title="var">rel_vals</span> ; <span class="id" title="var">iIntros</span> "!&gt;" (??) "#(%msg&amp;-&gt;&amp;-&gt;)"...<br/>
&nbsp;&nbsp;<span class="id" title="var">rel_bind_l</span> (<a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int"><span class="id" title="method">vg_of_int</span></a> <span class="id" title="var">_</span>) ; <span class="id" title="var">rel_bind_r</span> (<a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int"><span class="id" title="method">vg_of_int</span></a> <span class="id" title="var">_</span>) ; <span class="id" title="var">rel_apply</span> <a class="idref" href="clutch.rel_logic.model.html#refines_bind"><span class="id" title="lemma">refines_bind</span></a><br/>
&nbsp;&nbsp;; [<span class="id" title="var">iApply</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int_lrel_G"><span class="id" title="method">vg_of_int_lrel_G</span></a> ; <span class="id" title="var">iExists</span> <span class="id" title="var">_</span> ; <span class="id" title="tactic">eauto</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (??) "#(%_1&amp;%_2&amp;[(-&gt;&amp;-&gt;&amp;-&gt;&amp;-&gt;)|(-&gt;&amp;-&gt;&amp;%vmsg&amp;-&gt;&amp;-&gt;)])"... 1: <span class="id" title="var">rel_vals</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.model.html#refines_na_inv"><span class="id" title="lemma">refines_na_inv</span></a> <span class="id" title="notation">with</span> "[$Hinv]"<span class="id" title="notation">)</span> =&gt; //.<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "[&gt;[(β'&amp;γ'&amp;cnt&amp;cnt')|(cnt&amp;cnt')] Hclose]"...<br/>
&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="var">inv_cl</span> "[- $Hclose]" ; <span class="id" title="var">rel_vals</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="rand_tape_rand" class="idref" href="#rand_tape_rand"><span class="id" title="lemma">rand_tape_rand</span></a> : <span class="id" title="notation">⊢</span> <a class="idref" href="clutch.rel_logic.model.html#refines"><span class="id" title="definition">refines</span></a> <span class="id" title="definition">top</span> <a class="idref" href="clutch.examples.crypto.ElGamal.html#pk_rand_tape"><span class="id" title="definition">pk_rand_tape</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#pk_rand"><span class="id" title="definition">pk_rand</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#T_EG"><span class="id" title="definition">T_EG</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">with</span> <span class="id" title="var">rel_red</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rel_red</span>. <span class="id" title="var">rel_couple_UU</span>...<br/>
&nbsp;&nbsp;<span class="id" title="var">inv_mk</span> (<span class="id" title="notation">(</span><span class="id" title="var">β</span> <a class="idref" href="clutch.rel_logic.primitive_laws.html#52c0998123349fcc3e1f8d05ae50419f"><span class="id" title="notation">↪</span></a> <a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.examples.crypto.ElGamal.html#n"><span class="id" title="abbreviation">n</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">;</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">)</span></a> <span class="id" title="notation">∗</span> <span class="id" title="var">γ</span> <a class="idref" href="clutch.rel_logic.primitive_laws.html#52c0998123349fcc3e1f8d05ae50419f"><span class="id" title="notation">↪</span></a> <a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.examples.crypto.ElGamal.html#n"><span class="id" title="abbreviation">n</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">;</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">)</span></a> <span class="id" title="notation">∗</span> <span class="id" title="var">count</span> <a class="idref" href="clutch.rel_logic.primitive_laws.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>0 <span class="id" title="notation">∗</span> <span class="id" title="var">count</span>ₛ <a class="idref" href="clutch.rel_logic.spec_ra.html#0326014f985dcbdf069e6962e826748b"><span class="id" title="notation">↦ₛ</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>0<span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∨</span> <span class="id" title="notation">(</span><span class="id" title="var">count</span> <a class="idref" href="clutch.rel_logic.primitive_laws.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>1 <span class="id" title="notation">∗</span> <span class="id" title="var">count</span>ₛ <a class="idref" href="clutch.rel_logic.spec_ra.html#0326014f985dcbdf069e6962e826748b"><span class="id" title="notation">↦ₛ</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>1<span class="id" title="notation">)</span>)%<span class="id" title="var">I</span> "#Hinv".<br/>
&nbsp;&nbsp;<span class="id" title="var">rel_vals</span> ; <span class="id" title="var">iIntros</span> "!&gt;" (??) "#(%msg&amp;-&gt;&amp;-&gt;)"...<br/>
&nbsp;&nbsp;<span class="id" title="var">rel_bind_l</span> (<a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int"><span class="id" title="method">vg_of_int</span></a> <span class="id" title="var">_</span>) ; <span class="id" title="var">rel_bind_r</span> (<a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int"><span class="id" title="method">vg_of_int</span></a> <span class="id" title="var">_</span>) ; <span class="id" title="var">rel_apply</span> <a class="idref" href="clutch.rel_logic.model.html#refines_bind"><span class="id" title="lemma">refines_bind</span></a><br/>
&nbsp;&nbsp;; [<span class="id" title="var">iApply</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int_lrel_G"><span class="id" title="method">vg_of_int_lrel_G</span></a> ; <span class="id" title="var">iExists</span> <span class="id" title="var">_</span> ; <span class="id" title="tactic">eauto</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (??) "#(%_1&amp;%_2&amp;[(-&gt;&amp;-&gt;&amp;-&gt;&amp;-&gt;)|(-&gt;&amp;-&gt;&amp;%vmsg&amp;-&gt;&amp;-&gt;)])"... 1: <span class="id" title="var">rel_vals</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.model.html#refines_na_inv"><span class="id" title="lemma">refines_na_inv</span></a> <span class="id" title="notation">with</span> "[-$Hinv]"<span class="id" title="notation">)</span> =&gt; //.<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "[&gt;[(β&amp;γ&amp;cnt&amp;cnt')|(cnt&amp;cnt')] Hclose]"...<br/>
&nbsp;&nbsp;2: <span class="id" title="tactic">by</span> (<span class="id" title="var">inv_cl</span> "[-$Hclose]" ; <span class="id" title="var">rel_vals</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">rel_couple_TU</span> "β"...<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Rewrite&nbsp;msg&nbsp;into&nbsp;g^k_msg&nbsp;for&nbsp;some&nbsp;k_msg.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="clutch.examples.crypto.valgroup.html#log_g"><span class="id" title="lemma">log_g</span></a> <span class="id" title="var">vmsg</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">k_msg</span> -&gt;].<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Sample&nbsp;c&nbsp;on&nbsp;the&nbsp;left,&nbsp;and&nbsp;((k_msg&nbsp;+&nbsp;c)&nbsp;mod&nbsp;(S&nbsp;n))&nbsp;on&nbsp;the&nbsp;right.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">k_msg_plus</span> := <a class="idref" href="clutch.examples.crypto.ElGamal_bijection.html#f"><span class="id" title="definition">ElGamal_bijection.f</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#n''"><span class="id" title="method">n''</span></a> <span class="id" title="var">k_msg</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="var">rel_couple_TU</span> "γ" <span class="id" title="var">k_msg_plus</span>...<br/>
&nbsp;&nbsp;<span class="id" title="var">inv_cl</span> "[- $Hclose]"...<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="lemma">expgD</span> -<span class="id" title="lemma">ssrnat.plusE</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#g"><span class="id" title="method">g</span></a> <span class="id" title="notation">^+</span> <span class="id" title="notation">(</span><span class="id" title="var">k_msg</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">x</span><span class="id" title="notation">)</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#g"><span class="id" title="method">g</span></a> <span class="id" title="notation">^+</span> <span class="id" title="var">k_msg_plus</span> <span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>)%<span class="id" title="var">g</span> <span class="id" title="keyword">as</span> <span class="id" title="var">heq</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">clear</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">fin_to_nat_to_fin</span> /= -<span class="id" title="lemma">ssrnat.plusE</span> /<span class="id" title="definition">Zp_trunc</span> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">e</span> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#eq_sym"><span class="id" title="lemma">eq_sym</span></a> (<span class="id" title="lemma">expg_mod_order</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#g"><span class="id" title="method">g</span></a> (<span class="id" title="var">k_msg</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a><span class="id" title="var">x</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#g_nontriv"><span class="id" title="method">g_nontriv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">heq</span>. <span class="id" title="var">rel_vals</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="rand_rand_tape" class="idref" href="#rand_rand_tape"><span class="id" title="lemma">rand_rand_tape</span></a> : <span class="id" title="notation">⊢</span> <a class="idref" href="clutch.rel_logic.model.html#refines"><span class="id" title="definition">refines</span></a> <span class="id" title="definition">top</span> <a class="idref" href="clutch.examples.crypto.ElGamal.html#pk_rand"><span class="id" title="definition">pk_rand</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#pk_rand_tape"><span class="id" title="definition">pk_rand_tape</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#T_EG"><span class="id" title="definition">T_EG</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">with</span> <span class="id" title="var">rel_red</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rel_red</span>. <span class="id" title="var">rel_couple_UU</span>...<br/>
&nbsp;&nbsp;<span class="id" title="var">inv_mk</span> (<span class="id" title="notation">(</span><span class="id" title="var">β</span>ₛ <a class="idref" href="clutch.rel_logic.spec_ra.html#537f9bfe1a4246c42baec6fa8e98c8aa"><span class="id" title="notation">↪ₛ</span></a> <a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.examples.crypto.ElGamal.html#n"><span class="id" title="abbreviation">n</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">;</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">)</span></a> <span class="id" title="notation">∗</span> <span class="id" title="var">γ</span>ₛ <a class="idref" href="clutch.rel_logic.spec_ra.html#537f9bfe1a4246c42baec6fa8e98c8aa"><span class="id" title="notation">↪ₛ</span></a> <a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.examples.crypto.ElGamal.html#n"><span class="id" title="abbreviation">n</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">;</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">)</span></a> <span class="id" title="notation">∗</span> <span class="id" title="var">count</span> <a class="idref" href="clutch.rel_logic.primitive_laws.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>0 <span class="id" title="notation">∗</span> <span class="id" title="var">count</span>ₛ <a class="idref" href="clutch.rel_logic.spec_ra.html#0326014f985dcbdf069e6962e826748b"><span class="id" title="notation">↦ₛ</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>0<span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∨</span> <span class="id" title="notation">(</span><span class="id" title="var">count</span> <a class="idref" href="clutch.rel_logic.primitive_laws.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>1 <span class="id" title="notation">∗</span> <span class="id" title="var">count</span>ₛ <a class="idref" href="clutch.rel_logic.spec_ra.html#0326014f985dcbdf069e6962e826748b"><span class="id" title="notation">↦ₛ</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>1<span class="id" title="notation">)</span>)%<span class="id" title="var">I</span> "#Hinv"...<br/>
&nbsp;&nbsp;<span class="id" title="var">rel_vals</span> ; <span class="id" title="var">iIntros</span> "!&gt;" (??) "#(%msg&amp;-&gt;&amp;-&gt;)"...<br/>
&nbsp;&nbsp;<span class="id" title="var">rel_bind_l</span> (<a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int"><span class="id" title="method">vg_of_int</span></a> <span class="id" title="var">_</span>) ; <span class="id" title="var">rel_bind_r</span> (<a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int"><span class="id" title="method">vg_of_int</span></a> <span class="id" title="var">_</span>) ; <span class="id" title="var">rel_apply</span> <a class="idref" href="clutch.rel_logic.model.html#refines_bind"><span class="id" title="lemma">refines_bind</span></a><br/>
&nbsp;&nbsp;; [<span class="id" title="var">iApply</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int_lrel_G"><span class="id" title="method">vg_of_int_lrel_G</span></a> ; <span class="id" title="var">iExists</span> <span class="id" title="var">_</span> ; <span class="id" title="tactic">eauto</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (??) "#(%_1&amp;%_2&amp;[(-&gt;&amp;-&gt;&amp;-&gt;&amp;-&gt;)|(-&gt;&amp;-&gt;&amp;%vmsg&amp;-&gt;&amp;-&gt;)])"... 1: <span class="id" title="var">rel_vals</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.model.html#refines_na_inv"><span class="id" title="lemma">refines_na_inv</span></a> <span class="id" title="notation">with</span> "[-$Hinv]"<span class="id" title="notation">)</span> =&gt; //.<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "[&gt;[(βₛ&amp;γₛ&amp;count&amp;countₛ)|(count&amp;countₛ)] Hclose]"...<br/>
&nbsp;&nbsp;2: <span class="id" title="tactic">by</span> (<span class="id" title="var">inv_cl</span> "[-$Hclose]" ; <span class="id" title="var">rel_vals</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">rel_couple_UT</span> "βₛ"...<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Rewrite&nbsp;msg&nbsp;into&nbsp;g^k_msg&nbsp;for&nbsp;some&nbsp;k_msg.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="clutch.examples.crypto.valgroup.html#log_g"><span class="id" title="lemma">log_g</span></a> <span class="id" title="var">vmsg</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">k_msg</span> -&gt;].<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Sample&nbsp;x&nbsp;on&nbsp;the&nbsp;left,&nbsp;and&nbsp;((-x&nbsp;+&nbsp;k_msg)&nbsp;mod&nbsp;(S&nbsp;n))&nbsp;on&nbsp;the&nbsp;right.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">minus_k_msg_plus</span> := <a class="idref" href="clutch.examples.crypto.ElGamal_bijection.html#g"><span class="id" title="definition">ElGamal_bijection.g</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#n''"><span class="id" title="method">n''</span></a> <span class="id" title="var">k_msg</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="var">rel_couple_UT</span> "γₛ" <span class="id" title="var">minus_k_msg_plus</span>...<br/>
&nbsp;&nbsp;<span class="id" title="var">inv_cl</span> "[- $Hclose]"...<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="lemma">expgD</span> -<span class="id" title="lemma">ssrnat.plusE</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#g"><span class="id" title="method">g</span></a> <span class="id" title="notation">^+</span> <span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#g"><span class="id" title="method">g</span></a> <span class="id" title="notation">^+</span> <span class="id" title="notation">(</span><span class="id" title="var">k_msg</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">minus_k_msg_plus</span> <span class="id" title="var">x</span><span class="id" title="notation">)</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>)%<span class="id" title="var">g</span> <span class="id" title="keyword">as</span> <span class="id" title="var">heq</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">clear</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">fin_to_nat_to_fin</span> /= /<span class="id" title="definition">Zp_trunc</span> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">epose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">e</span> := (<span class="id" title="lemma">expg_mod_order</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#g"><span class="id" title="method">g</span></a>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#g_nontriv"><span class="id" title="method">g_nontriv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -[<span class="id" title="tactic">in</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS"><span class="id" title="abbreviation">LHS</span></a>]<span class="id" title="var">e</span> -{}[<span class="id" title="tactic">in</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS"><span class="id" title="abbreviation">RHS</span></a>]<span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">div.modnDmr</span> <span class="id" title="lemma">ssrnat.addnC</span> -<span class="id" title="lemma">ssrnat.addnA</span> <span class="id" title="lemma">div.modnDml</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> [<span class="id" title="definition">ssrnat.addn</span> <span class="id" title="var">x</span> <span class="id" title="var">_</span>]<span class="id" title="lemma">ssrnat.addnC</span> <span class="id" title="lemma">ssrnat.addnA</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">ssrnat.subnK</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">div.modnDl</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> /<span class="id" title="lemma">ssrnat.leP</span>. <span class="id" title="tactic">move</span> : (<span class="id" title="lemma">fin_to_nat_lt</span> <span class="id" title="var">k_msg</span>). <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">heq</span>. <span class="id" title="var">rel_vals</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Decryption&nbsp;is&nbsp;left&nbsp;inverse&nbsp;to&nbsp;encryption.&nbsp;We&nbsp;only&nbsp;consider&nbsp;valid&nbsp;messages,<br/>
&nbsp;&nbsp;&nbsp;i.e.&nbsp;integers&nbsp;that&nbsp;decode&nbsp;to&nbsp;a&nbsp;group&nbsp;element&nbsp;(in&nbsp;practice,&nbsp;this&nbsp;means&nbsp;that<br/>
&nbsp;&nbsp;&nbsp;the&nbsp;integer&nbsp;has&nbsp;to&nbsp;be&nbsp;smaller&nbsp;than&nbsp;the&nbsp;group&nbsp;order).&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <a id="ElGamal_correct" class="idref" href="#ElGamal_correct"><span class="id" title="lemma">ElGamal_correct</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="clutch.rel_logic.model.html#refines"><span class="id" title="definition">refines</span></a> <span class="id" title="definition">top</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">(</span></a>"sk"<a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">,</span></a> "pk"<a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#keygen"><span class="id" title="definition">keygen</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.prob_lang.notation.html#3127c6bc552ca21a494fc6e3474a507d"><span class="id" title="notation">()</span></a> <a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#d2c3354f6c46df814e66d4c5c9b9c738"><span class="id" title="notation">λ</span></a><a class="idref" href="clutch.prob_lang.notation.html#d2c3354f6c46df814e66d4c5c9b9c738"><span class="id" title="notation">:</span></a>"msg"<a class="idref" href="clutch.prob_lang.notation.html#d2c3354f6c46df814e66d4c5c9b9c738"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#17c2ca1c8de3c2d1c3310c8aa5669890"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#17c2ca1c8de3c2d1c3310c8aa5669890"><span class="id" title="notation">:</span></a><a class="idref" href="clutch.prob_lang.notation.html#17c2ca1c8de3c2d1c3310c8aa5669890"><span class="id" title="notation">m</span></a> "msg" <a class="idref" href="clutch.prob_lang.notation.html#17c2ca1c8de3c2d1c3310c8aa5669890"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int"><span class="id" title="method">vg_of_int</span></a> "msg" <a class="idref" href="clutch.prob_lang.notation.html#17c2ca1c8de3c2d1c3310c8aa5669890"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "c" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#enc"><span class="id" title="definition">enc</span></a> "pk" "msg" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "vmsg" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#dec"><span class="id" title="definition">dec</span></a> "sk" "c" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#SOME"><span class="id" title="abbreviation">SOME</span></a> ("vmsg"))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="clutch.prob_lang.notation.html#d2c3354f6c46df814e66d4c5c9b9c738"><span class="id" title="notation">λ</span></a><a class="idref" href="clutch.prob_lang.notation.html#d2c3354f6c46df814e66d4c5c9b9c738"><span class="id" title="notation">:</span></a>"msg"<a class="idref" href="clutch.prob_lang.notation.html#d2c3354f6c46df814e66d4c5c9b9c738"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#17c2ca1c8de3c2d1c3310c8aa5669890"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#17c2ca1c8de3c2d1c3310c8aa5669890"><span class="id" title="notation">:</span></a><a class="idref" href="clutch.prob_lang.notation.html#17c2ca1c8de3c2d1c3310c8aa5669890"><span class="id" title="notation">m</span></a> "vmsg" <a class="idref" href="clutch.prob_lang.notation.html#17c2ca1c8de3c2d1c3310c8aa5669890"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int"><span class="id" title="method">vg_of_int</span></a> "msg" <a class="idref" href="clutch.prob_lang.notation.html#17c2ca1c8de3c2d1c3310c8aa5669890"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#SOME"><span class="id" title="abbreviation">SOME</span></a> ("vmsg"))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="clutch.rel_logic.model.html#lrel_int"><span class="id" title="definition">lrel_int</span></a> <a class="idref" href="clutch.rel_logic.model.html#198b3df6111d1e335bfbd02615def5fc"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.rel_logic.model.html#0926557fff3a7c5de6f38fcac599a96f"><span class="id" title="notation">()</span></a> <a class="idref" href="clutch.rel_logic.model.html#952b32b7bba24b7eee4a974ec810fdbc"><span class="id" title="notation">+</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#lrel_G"><span class="id" title="definition">lrel_G</span></a>).<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">with</span> <span class="id" title="var">rel_red</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rel_red</span>. <span class="id" title="var">rel_randU_l</span>...<br/>
&nbsp;&nbsp;<span class="id" title="var">rel_arrow_val</span> ; <span class="id" title="var">iIntros</span> (??) "#(%msg&amp;-&gt;&amp;-&gt;)"...<br/>
&nbsp;&nbsp;<span class="id" title="var">rel_bind_l</span> (<a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int"><span class="id" title="method">vg_of_int</span></a> <span class="id" title="var">_</span>) ; <span class="id" title="var">rel_bind_r</span> (<a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int"><span class="id" title="method">vg_of_int</span></a> <span class="id" title="var">_</span>) ; <span class="id" title="var">rel_apply</span> <a class="idref" href="clutch.rel_logic.model.html#refines_bind"><span class="id" title="lemma">refines_bind</span></a>.<br/>
&nbsp;&nbsp;1: <span class="id" title="var">iApply</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int_lrel_G"><span class="id" title="method">vg_of_int_lrel_G</span></a> ; <span class="id" title="var">iExists</span> <span class="id" title="var">_</span> ; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (??) "#(%_1&amp;%_2&amp;[(-&gt;&amp;-&gt;&amp;-&gt;&amp;-&gt;)|(-&gt;&amp;-&gt;&amp;%vmsg&amp;-&gt;&amp;-&gt;)])"... 1: <span class="id" title="var">rel_vals</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rel_randU_l</span>...<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -?<span class="id" title="lemma">expgM</span> -<span class="id" title="lemma">ssrnat.multE</span> -<span class="id" title="lemma">mulgA</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Numbers.Natural.Peano.NPeano.html#Nat.mul_comm"><span class="id" title="lemma">Nat.mul_comm</span></a> <span class="id" title="lemma">mulgV</span> <span class="id" title="lemma">mulg1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rel_vals</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="clutch.examples.crypto.ElGamal.html#ElGamal"><span class="id" title="section">ElGamal</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="Ctx" class="idref" href="#Ctx"><span class="id" title="section">Ctx</span></a>.<br/>

<br/>
<span class="id" title="keyword">Context</span> {<a id="vg:10" class="idref" href="#vg:10"><span class="id" title="binder">vg</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#val_group"><span class="id" title="class">val_group</span></a>}.<br/>
<span class="id" title="keyword">Context</span> {<a id="cg:11" class="idref" href="#cg:11"><span class="id" title="binder">cg</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#clutch_group_struct"><span class="id" title="class">clutch_group_struct</span></a>}.<br/>
<span class="id" title="keyword">Context</span> {<a id="G:14" class="idref" href="#G:14"><span class="id" title="binder">G</span></a> : <span class="id" title="notation">forall</span> <span class="id" title="notation">`{</span><a id="clutchRGS0:13" class="idref" href="#clutchRGS0:13"><span class="id" title="binder">!</span></a><a id="clutchRGS0:13" class="idref" href="#clutchRGS0:13"><span class="id" title="binder">clutchRGS</span></a> <a id="clutchRGS0:13" class="idref" href="#clutchRGS0:13"><span class="id" title="binder">Σ</span></a><span class="id" title="notation">},</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#clutch_group"><span class="id" title="class">clutch_group</span></a> (<span class="id" title="var">vg</span>:=<a class="idref" href="clutch.examples.crypto.ElGamal.html#Ctx.vg"><span class="id" title="variable">vg</span></a>) (<span class="id" title="var">cg</span>:=<a class="idref" href="clutch.examples.crypto.ElGamal.html#Ctx.cg"><span class="id" title="variable">cg</span></a>)}.<br/>
<span class="id" title="keyword">Context</span> {<a id="cgg:15" class="idref" href="#cgg:15"><span class="id" title="binder">cgg</span></a> : @<a class="idref" href="clutch.examples.crypto.valgroup.html#clutch_group_generator"><span class="id" title="class">clutch_group_generator</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#Ctx.vg"><span class="id" title="variable">vg</span></a>}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="ctx_real_real_tape" class="idref" href="#ctx_real_real_tape"><span class="id" title="lemma">ctx_real_real_tape</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="notation">∅</span> <a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">⊨</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#pk_real"><span class="id" title="definition">pk_real</span></a> <a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">=</span></a><a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">ctx</span></a><a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#pk_real_tape"><span class="id" title="definition">pk_real_tape</span></a> <a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">:</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#9fc5d2f065cb312100547e5efeaaf47d"><span class="id" title="definition">τ</span></a><a class="idref" href="clutch.examples.crypto.ElGamal.html#9fc5d2f065cb312100547e5efeaaf47d"><span class="id" title="definition">_EG</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> ; <span class="id" title="tactic">apply</span> (<a class="idref" href="clutch.typing.soundness.html#refines_sound"><span class="id" title="lemma">refines_sound</span></a> <a class="idref" href="clutch.rel_logic.adequacy_rel.html#6eff3dc174695f5fd55570d85c334262"><span class="id" title="definition">clutchRΣ</span></a>) ; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span>: <a class="idref" href="clutch.examples.crypto.ElGamal.html#real_real_tape"><span class="id" title="lemma">real_real_tape</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span>: <a class="idref" href="clutch.examples.crypto.ElGamal.html#real_tape_real"><span class="id" title="lemma">real_tape_real</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="ctx_real_tape_C_DH_real" class="idref" href="#ctx_real_tape_C_DH_real"><span class="id" title="lemma">ctx_real_tape_C_DH_real</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="notation">∅</span> <a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">⊨</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#pk_real_tape"><span class="id" title="definition">pk_real_tape</span></a> <a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">=</span></a><a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">ctx</span></a><a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#C"><span class="id" title="definition">C</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#DH_real"><span class="id" title="definition">DH_real</span></a><a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">:</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#9fc5d2f065cb312100547e5efeaaf47d"><span class="id" title="definition">τ</span></a><a class="idref" href="clutch.examples.crypto.ElGamal.html#9fc5d2f065cb312100547e5efeaaf47d"><span class="id" title="definition">_EG</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> ; <span class="id" title="tactic">apply</span> (<a class="idref" href="clutch.typing.soundness.html#refines_sound"><span class="id" title="lemma">refines_sound</span></a> <a class="idref" href="clutch.rel_logic.adequacy_rel.html#6eff3dc174695f5fd55570d85c334262"><span class="id" title="definition">clutchRΣ</span></a>) ; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span>: <a class="idref" href="clutch.examples.crypto.ElGamal.html#real_tape_C_DH_real"><span class="id" title="lemma">real_tape_C_DH_real</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span>: <a class="idref" href="clutch.examples.crypto.ElGamal.html#C_DH_real_real_tape"><span class="id" title="lemma">C_DH_real_real_tape</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="ctx_C_DH_rand_rand_tape" class="idref" href="#ctx_C_DH_rand_rand_tape"><span class="id" title="lemma">ctx_C_DH_rand_rand_tape</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="notation">∅</span> <a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">⊨</span></a> <a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#C"><span class="id" title="definition">C</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#DH_rand"><span class="id" title="definition">DH_rand</span></a><a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">=</span></a><a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">ctx</span></a><a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#pk_rand_tape"><span class="id" title="definition">pk_rand_tape</span></a> <a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">:</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#9fc5d2f065cb312100547e5efeaaf47d"><span class="id" title="definition">τ</span></a><a class="idref" href="clutch.examples.crypto.ElGamal.html#9fc5d2f065cb312100547e5efeaaf47d"><span class="id" title="definition">_EG</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> ; <span class="id" title="tactic">apply</span> (<a class="idref" href="clutch.typing.soundness.html#refines_sound"><span class="id" title="lemma">refines_sound</span></a> <a class="idref" href="clutch.rel_logic.adequacy_rel.html#6eff3dc174695f5fd55570d85c334262"><span class="id" title="definition">clutchRΣ</span></a>) ; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span>: <a class="idref" href="clutch.examples.crypto.ElGamal.html#C_DH_rand_rand_tape"><span class="id" title="lemma">C_DH_rand_rand_tape</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span>: <a class="idref" href="clutch.examples.crypto.ElGamal.html#rand_tape_C_DH_rand"><span class="id" title="lemma">rand_tape_C_DH_rand</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="ctx_rand_tape_rand" class="idref" href="#ctx_rand_tape_rand"><span class="id" title="lemma">ctx_rand_tape_rand</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="notation">∅</span> <a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">⊨</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#pk_rand_tape"><span class="id" title="definition">pk_rand_tape</span></a> <a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">=</span></a><a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">ctx</span></a><a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#pk_rand"><span class="id" title="definition">pk_rand</span></a> <a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">:</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#9fc5d2f065cb312100547e5efeaaf47d"><span class="id" title="definition">τ</span></a><a class="idref" href="clutch.examples.crypto.ElGamal.html#9fc5d2f065cb312100547e5efeaaf47d"><span class="id" title="definition">_EG</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> ; <span class="id" title="tactic">apply</span> (<a class="idref" href="clutch.typing.soundness.html#refines_sound"><span class="id" title="lemma">refines_sound</span></a> <a class="idref" href="clutch.rel_logic.adequacy_rel.html#6eff3dc174695f5fd55570d85c334262"><span class="id" title="definition">clutchRΣ</span></a>) ; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span>: <a class="idref" href="clutch.examples.crypto.ElGamal.html#rand_tape_rand"><span class="id" title="lemma">rand_tape_rand</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span>: <a class="idref" href="clutch.examples.crypto.ElGamal.html#rand_rand_tape"><span class="id" title="lemma">rand_rand_tape</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="ctx_real_C_DH_real" class="idref" href="#ctx_real_C_DH_real"><span class="id" title="lemma">ctx_real_C_DH_real</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="notation">∅</span> <a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">⊨</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#pk_real"><span class="id" title="definition">pk_real</span></a> <a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">=</span></a><a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">ctx</span></a><a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#C"><span class="id" title="definition">C</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#DH_real"><span class="id" title="definition">DH_real</span></a><a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">:</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#9fc5d2f065cb312100547e5efeaaf47d"><span class="id" title="definition">τ</span></a><a class="idref" href="clutch.examples.crypto.ElGamal.html#9fc5d2f065cb312100547e5efeaaf47d"><span class="id" title="definition">_EG</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="clutch.typing.contextual_refinement.html#ctx_equiv_transitive"><span class="id" title="instance">ctx_equiv_transitive</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span>: <a class="idref" href="clutch.examples.crypto.ElGamal.html#ctx_real_real_tape"><span class="id" title="lemma">ctx_real_real_tape</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span>: <a class="idref" href="clutch.examples.crypto.ElGamal.html#ctx_real_tape_C_DH_real"><span class="id" title="lemma">ctx_real_tape_C_DH_real</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="ctx_C_DH_rand_rand" class="idref" href="#ctx_C_DH_rand_rand"><span class="id" title="lemma">ctx_C_DH_rand_rand</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="notation">∅</span> <a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">⊨</span></a> <a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#C"><span class="id" title="definition">C</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#DH_rand"><span class="id" title="definition">DH_rand</span></a><a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">=</span></a><a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">ctx</span></a><a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#pk_rand"><span class="id" title="definition">pk_rand</span></a> <a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">:</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#9fc5d2f065cb312100547e5efeaaf47d"><span class="id" title="definition">τ</span></a><a class="idref" href="clutch.examples.crypto.ElGamal.html#9fc5d2f065cb312100547e5efeaaf47d"><span class="id" title="definition">_EG</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="clutch.typing.contextual_refinement.html#ctx_equiv_transitive"><span class="id" title="instance">ctx_equiv_transitive</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span>: <a class="idref" href="clutch.examples.crypto.ElGamal.html#ctx_C_DH_rand_rand_tape"><span class="id" title="lemma">ctx_C_DH_rand_rand_tape</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span>: <a class="idref" href="clutch.examples.crypto.ElGamal.html#ctx_rand_tape_rand"><span class="id" title="lemma">ctx_rand_tape_rand</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;The&nbsp;following&nbsp;lemmas&nbsp;make&nbsp;the&nbsp;unreasonably&nbsp;strong&nbsp;assumption&nbsp;that<br/>
&nbsp;&nbsp;&nbsp;DH_real/rand&nbsp;are&nbsp;contextually&nbsp;equivalent&nbsp;when&nbsp;they&nbsp;really&nbsp;should&nbsp;only&nbsp;be<br/>
&nbsp;&nbsp;&nbsp;assumed&nbsp;to&nbsp;be&nbsp;computationally&nbsp;indistinguishable,&nbsp;but&nbsp;they&nbsp;illustrate&nbsp;how&nbsp;one<br/>
&nbsp;&nbsp;&nbsp;would&nbsp;combine&nbsp;the&nbsp;results&nbsp;in&nbsp;a&nbsp;logic&nbsp;with&nbsp;support&nbsp;for&nbsp;reasoning&nbsp;about<br/>
&nbsp;&nbsp;&nbsp;computational&nbsp;indistinguishability.&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <a id="ctx_C_DH_real_C_DH_rand" class="idref" href="#ctx_C_DH_real_C_DH_rand"><span class="id" title="lemma">ctx_C_DH_real_C_DH_rand</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><span class="id" title="notation">∅</span> <a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">⊨</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#DH_real"><span class="id" title="definition">DH_real</span></a> <a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">=</span></a><a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">ctx</span></a><a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#DH_rand"><span class="id" title="definition">DH_rand</span></a> <a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">:</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#208159eccf7e85aae5d432b571819b63"><span class="id" title="definition">τ</span></a><a class="idref" href="clutch.examples.crypto.ElGamal.html#208159eccf7e85aae5d432b571819b63"><span class="id" title="definition">_DH</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><span class="id" title="notation">∅</span> <a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">⊨</span></a> <a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#C"><span class="id" title="definition">C</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#DH_real"><span class="id" title="definition">DH_real</span></a><a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">=</span></a><a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">ctx</span></a><a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#C"><span class="id" title="definition">C</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#DH_rand"><span class="id" title="definition">DH_rand</span></a><a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">:</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#9fc5d2f065cb312100547e5efeaaf47d"><span class="id" title="definition">τ</span></a><a class="idref" href="clutch.examples.crypto.ElGamal.html#9fc5d2f065cb312100547e5efeaaf47d"><span class="id" title="definition">_EG</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#C"><span class="id" title="definition">C</span></a> <span class="id" title="var">_</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="clutch.typing.contextual_refinement.html#fill_ctx"><span class="id" title="definition">fill_ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="clutch.typing.contextual_refinement.html#CTX_AppR"><span class="id" title="constructor">CTX_AppR</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#eC"><span class="id" title="definition">eC</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#DH_real"><span class="id" title="definition">DH_real</span></a>) ; <span class="id" title="tactic">auto</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#C"><span class="id" title="definition">C</span></a> <span class="id" title="var">_</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="clutch.typing.contextual_refinement.html#fill_ctx"><span class="id" title="definition">fill_ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="clutch.typing.contextual_refinement.html#CTX_AppR"><span class="id" title="constructor">CTX_AppR</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#eC"><span class="id" title="definition">eC</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#DH_rand"><span class="id" title="definition">DH_rand</span></a>) =&gt; //.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">DDH</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="clutch.typing.contextual_refinement.html#ctx_refines_congruence"><span class="id" title="lemma">ctx_refines_congruence</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">apply</span> <span class="id" title="var">DDH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="clutch.examples.crypto.ElGamal.html#eC"><span class="id" title="definition">eC</span></a>. <span class="id" title="var">tychk</span> =&gt; //.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="clutch.typing.contextual_refinement.html#ctx_refines_congruence"><span class="id" title="lemma">ctx_refines_congruence</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">apply</span> <span class="id" title="var">DDH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="clutch.examples.crypto.ElGamal.html#eC"><span class="id" title="definition">eC</span></a>. <span class="id" title="var">tychk</span> =&gt; //.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="pk_ots_rnd_ddh" class="idref" href="#pk_ots_rnd_ddh"><span class="id" title="lemma">pk_ots_rnd_ddh</span></a> (<a id="DDH:16" class="idref" href="#DDH:16"><span class="id" title="binder">DDH</span></a> : <span class="id" title="notation">∅</span> <a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">⊨</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#DH_real"><span class="id" title="definition">DH_real</span></a> <a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">=</span></a><a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">ctx</span></a><a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#DH_rand"><span class="id" title="definition">DH_rand</span></a> <a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">:</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#208159eccf7e85aae5d432b571819b63"><span class="id" title="definition">τ</span></a><a class="idref" href="clutch.examples.crypto.ElGamal.html#208159eccf7e85aae5d432b571819b63"><span class="id" title="definition">_DH</span></a>) :<br/>
&nbsp;&nbsp;(<span class="id" title="notation">∅</span> <a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">⊨</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#pk_real"><span class="id" title="definition">pk_real</span></a> <a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">=</span></a><a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">ctx</span></a><a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#pk_rand"><span class="id" title="definition">pk_rand</span></a> <a class="idref" href="clutch.typing.contextual_refinement.html#7c3947114bad70993f565dfb1ce7829f"><span class="id" title="notation">:</span></a> <a class="idref" href="clutch.examples.crypto.ElGamal.html#9fc5d2f065cb312100547e5efeaaf47d"><span class="id" title="definition">τ</span></a><a class="idref" href="clutch.examples.crypto.ElGamal.html#9fc5d2f065cb312100547e5efeaaf47d"><span class="id" title="definition">_EG</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="clutch.typing.contextual_refinement.html#ctx_equiv_transitive"><span class="id" title="instance">ctx_equiv_transitive</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span>: <a class="idref" href="clutch.examples.crypto.ElGamal.html#ctx_real_C_DH_real"><span class="id" title="lemma">ctx_real_C_DH_real</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="clutch.typing.contextual_refinement.html#ctx_equiv_transitive"><span class="id" title="instance">ctx_equiv_transitive</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span>: <a class="idref" href="clutch.examples.crypto.ElGamal.html#ctx_C_DH_real_C_DH_rand"><span class="id" title="lemma">ctx_C_DH_real_C_DH_rand</span></a> =&gt; //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span>: <a class="idref" href="clutch.examples.crypto.ElGamal.html#ctx_C_DH_rand_rand"><span class="id" title="lemma">ctx_C_DH_rand_rand</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="clutch.examples.crypto.ElGamal.html#Ctx"><span class="id" title="section">Ctx</span></a>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/coq-community/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
