<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="resources/coqdoc.css" rel="stylesheet" type="text/css" />
<link href="resources/coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resources/config.js"></script>
<script type="text/javascript" src="resources/coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="../">Project Page</a>
      <a href="./indexpage.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">clutch.examples.von_neumann_coin</h1>

<div class="code">
<span class="comment">(*&nbsp;A&nbsp;zoo&nbsp;of&nbsp;variants&nbsp;of&nbsp;Von&nbsp;Neumann's&nbsp;construction&nbsp;of&nbsp;a&nbsp;fair&nbsp;coin&nbsp;from&nbsp;a&nbsp;biased&nbsp;coin.&nbsp;*)</span><br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">clutch</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="clutch.clutch.html#"><span class="id" title="library">clutch</span></a> <a class="idref" href="clutch.lib.flip.html#"><span class="id" title="library">lib.flip</span></a>.<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="var">Default</span> <span class="id" title="keyword">Proof</span> <span class="id" title="var">Using</span> "Type*".<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="proofs" class="idref" href="#proofs"><span class="id" title="section">proofs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="clutchRGS0:2" class="idref" href="#clutchRGS0:2"><span class="id" title="binder">!</span></a><a id="clutchRGS0:2" class="idref" href="#clutchRGS0:2"><span class="id" title="binder">clutchRGS</span></a> <a id="clutchRGS0:2" class="idref" href="#clutchRGS0:2"><span class="id" title="binder">Σ</span></a>}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="coinN" class="idref" href="#coinN"><span class="id" title="definition">coinN</span></a> := <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.namespaces.html#nroot"><span class="id" title="definition">nroot</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.namespaces.html#e79e436c08f66d063bd17fb4bcd1cac6"><span class="id" title="notation">.@</span></a>"coin".<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Biased&nbsp;coin&nbsp;toss:&nbsp;t4&nbsp;=&nbsp;{&nbsp;true&nbsp;⟼&nbsp;1/4,&nbsp;false&nbsp;⟼&nbsp;3/4&nbsp;}&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="t4" class="idref" href="#t4"><span class="id" title="definition">t4</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="clutch.prob_lang.notation.html#704630d98f03f1fa6c74ab29b9831803"><span class="id" title="notation">λ</span></a><a class="idref" href="clutch.prob_lang.notation.html#704630d98f03f1fa6c74ab29b9831803"><span class="id" title="notation">:</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.binders.html#::binder_scope:'&lt;&gt;'"><span class="id" title="notation">&lt;&gt;</span></a><a class="idref" href="clutch.prob_lang.notation.html#704630d98f03f1fa6c74ab29b9831803"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "b0" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.lib.flip.html#flip"><span class="id" title="definition">flip</span></a> <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "b1" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.lib.flip.html#flip"><span class="id" title="definition">flip</span></a> <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a><a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">:</span></a> "b1" <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> "b0" <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>)%<span class="id" title="var">V</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Von&nbsp;Neumann&nbsp;coin.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="vnc" class="idref" href="#vnc"><span class="id" title="definition">vnc</span></a> (<a id="t:3" class="idref" href="#t:3"><span class="id" title="binder">t</span></a> : <a class="idref" href="clutch.prob_lang.lang.html#prob_lang.expr"><span class="id" title="inductive">expr</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="clutch.prob_lang.notation.html#3b4611ead68c65413f980c1d4a390696"><span class="id" title="notation">rec</span></a><a class="idref" href="clutch.prob_lang.notation.html#3b4611ead68c65413f980c1d4a390696"><span class="id" title="notation">:</span></a> "f" <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.binders.html#::binder_scope:'&lt;&gt;'"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="clutch.prob_lang.notation.html#3b4611ead68c65413f980c1d4a390696"><span class="id" title="notation">:=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "x" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.examples.von_neumann_coin.html#t:3"><span class="id" title="variable">t</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.prob_lang.notation.html#3127c6bc552ca21a494fc6e3474a507d"><span class="id" title="notation">()</span></a> <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "y" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.examples.von_neumann_coin.html#t:3"><span class="id" title="variable">t</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.prob_lang.notation.html#3127c6bc552ca21a494fc6e3474a507d"><span class="id" title="notation">()</span></a> <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a><a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">:</span></a> "x" <a class="idref" href="clutch.prob_lang.notation.html#268bceb185e8402e5a254d7b9bacc674"><span class="id" title="notation">=</span></a> "y" <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> "f" <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.prob_lang.notation.html#3127c6bc552ca21a494fc6e3474a507d"><span class="id" title="notation">()</span></a> <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> "x")%<span class="id" title="var">V</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;A&nbsp;variant&nbsp;that&nbsp;diverges&nbsp;instead&nbsp;of&nbsp;recursing.&nbsp;Can&nbsp;be&nbsp;used&nbsp;in&nbsp;simple<br/>
&nbsp;&nbsp;situations&nbsp;to&nbsp;prove&nbsp;a&nbsp;left-refinement&nbsp;because&nbsp;our&nbsp;judgement&nbsp;allows&nbsp;discarding<br/>
&nbsp;&nbsp;mass&nbsp;on&nbsp;the&nbsp;left.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="vnc_div" class="idref" href="#vnc_div"><span class="id" title="definition">vnc_div</span></a> (<a id="t:4" class="idref" href="#t:4"><span class="id" title="binder">t</span></a> : <a class="idref" href="clutch.prob_lang.lang.html#prob_lang.expr"><span class="id" title="inductive">expr</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="clutch.prob_lang.notation.html#704630d98f03f1fa6c74ab29b9831803"><span class="id" title="notation">λ</span></a><a class="idref" href="clutch.prob_lang.notation.html#704630d98f03f1fa6c74ab29b9831803"><span class="id" title="notation">:</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.binders.html#::binder_scope:'&lt;&gt;'"><span class="id" title="notation">&lt;&gt;</span></a><a class="idref" href="clutch.prob_lang.notation.html#704630d98f03f1fa6c74ab29b9831803"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "x" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.examples.von_neumann_coin.html#t:4"><span class="id" title="variable">t</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.prob_lang.notation.html#3127c6bc552ca21a494fc6e3474a507d"><span class="id" title="notation">()</span></a> <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "y" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.examples.von_neumann_coin.html#t:4"><span class="id" title="variable">t</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.prob_lang.notation.html#3127c6bc552ca21a494fc6e3474a507d"><span class="id" title="notation">()</span></a> <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a><a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">:</span></a> "x" <a class="idref" href="clutch.prob_lang.notation.html#268bceb185e8402e5a254d7b9bacc674"><span class="id" title="notation">=</span></a> "y" <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="clutch.prob_lang.notation.html#906ea9e6f897046b3c4410ec24b8ddef"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.prob_lang.notation.html#906ea9e6f897046b3c4410ec24b8ddef"><span class="id" title="notation">rec</span></a><a class="idref" href="clutch.prob_lang.notation.html#906ea9e6f897046b3c4410ec24b8ddef"><span class="id" title="notation">:</span></a> "f" <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.binders.html#::binder_scope:'&lt;&gt;'"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="clutch.prob_lang.notation.html#906ea9e6f897046b3c4410ec24b8ddef"><span class="id" title="notation">:=</span></a> "f" <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.prob_lang.notation.html#3127c6bc552ca21a494fc6e3474a507d"><span class="id" title="notation">()</span></a><a class="idref" href="clutch.prob_lang.notation.html#906ea9e6f897046b3c4410ec24b8ddef"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.prob_lang.notation.html#906ea9e6f897046b3c4410ec24b8ddef"><span class="id" title="notation">#()</span></a> <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> "x")%<span class="id" title="var">V</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;We&nbsp;can't&nbsp;show&nbsp;this&nbsp;refinement&nbsp;since&nbsp;the&nbsp;lhs&nbsp;needs&nbsp;to&nbsp;couple&nbsp;a&nbsp;combination<br/>
&nbsp;&nbsp;of&nbsp;flips&nbsp;with&nbsp;a&nbsp;single&nbsp;flip&nbsp;on&nbsp;the&nbsp;rhs&nbsp;and&nbsp;since&nbsp;we&nbsp;may&nbsp;need&nbsp;to&nbsp;recurse&nbsp;an<br/>
&nbsp;&nbsp;unbounded&nbsp;number&nbsp;of&nbsp;times.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Goal</span> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">⊢</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">REL</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">(</span></a><a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">vnc</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">t4</span></a><a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">)</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">≾</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">(</span></a><a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">λ</span></a><a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">:&lt;&gt;,</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">flip</span></a><a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">)</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">:</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">lrel_unit</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">→</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">lrel_bool</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.examples.von_neumann_coin.html#vnc"><span class="id" title="definition">vnc</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rel_pures_r</span>. <span class="id" title="var">rel_pures_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="clutch.rel_logic.rel_rules.html#refines_arrow_val"><span class="id" title="lemma">refines_arrow_val</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "!#" (??) "#[-&gt; -&gt;]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rel_pures_r</span>. <span class="id" title="var">rel_pures_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">vnc4</span> := <a class="idref" href="clutch.examples.von_neumann_coin.html#vnc"><span class="id" title="definition">vnc</span></a> <a class="idref" href="clutch.examples.von_neumann_coin.html#t4"><span class="id" title="definition">t4</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="clutch.examples.von_neumann_coin.html#vnc"><span class="id" title="definition">vnc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">vnc4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">fold</span> <span class="id" title="var">vnc4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="clutch.examples.von_neumann_coin.html#t4"><span class="id" title="definition">t4</span></a>. <span class="id" title="var">rel_pures_l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Abort</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;A&nbsp;simpler&nbsp;coin&nbsp;toss:&nbsp;t2&nbsp;=&nbsp;{&nbsp;true&nbsp;⟼&nbsp;1/2,&nbsp;false&nbsp;⟼&nbsp;1/2&nbsp;}&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="t2" class="idref" href="#t2"><span class="id" title="definition">t2</span></a> := (<a class="idref" href="clutch.prob_lang.notation.html#704630d98f03f1fa6c74ab29b9831803"><span class="id" title="notation">λ</span></a><a class="idref" href="clutch.prob_lang.notation.html#704630d98f03f1fa6c74ab29b9831803"><span class="id" title="notation">:</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.binders.html#::binder_scope:'&lt;&gt;'"><span class="id" title="notation">&lt;&gt;</span></a><a class="idref" href="clutch.prob_lang.notation.html#704630d98f03f1fa6c74ab29b9831803"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.lib.flip.html#flip"><span class="id" title="definition">flip</span></a>)%<span class="id" title="var">V</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Still&nbsp;can't&nbsp;prove&nbsp;the&nbsp;refinement&nbsp;since&nbsp;we&nbsp;don't&nbsp;know&nbsp;how&nbsp;to&nbsp;recurse.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Goal</span> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">⊢</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">REL</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">(</span></a><a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">vnc</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">t2</span></a><a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">)</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">≾</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">(</span></a><a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">λ</span></a><a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">:&lt;&gt;,</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">flip</span></a><a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">)</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">:</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">lrel_unit</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">→</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">lrel_bool</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iLöb</span> <span class="id" title="keyword">as</span> "HH".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.examples.von_neumann_coin.html#vnc"><span class="id" title="definition">vnc</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rel_pures_r</span>. <span class="id" title="var">rel_pures_l</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="clutch.rel_logic.rel_rules.html#refines_arrow_val"><span class="id" title="lemma">refines_arrow_val</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "!#" (??) "#[-&gt; -&gt;]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rel_rec_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rel_pures_r</span>. <span class="id" title="var">rel_pures_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">vnc2</span> := <a class="idref" href="clutch.examples.von_neumann_coin.html#vnc"><span class="id" title="definition">vnc</span></a> <a class="idref" href="clutch.examples.von_neumann_coin.html#t2"><span class="id" title="definition">t2</span></a>) ; <span class="id" title="tactic">unfold</span> <a class="idref" href="clutch.examples.von_neumann_coin.html#vnc"><span class="id" title="definition">vnc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">vnc2</span> ; <span class="id" title="tactic">fold</span> <span class="id" title="var">vnc2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="clutch.examples.von_neumann_coin.html#t2"><span class="id" title="definition">t2</span></a>. <span class="id" title="var">rel_pures_l</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rel_apply</span> <a class="idref" href="clutch.lib.flip.html#refines_couple_flip_flip"><span class="id" title="lemma">refines_couple_flip_flip</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">b</span>) "!&gt;".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rel_pures_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rel_apply</span> <a class="idref" href="clutch.lib.flip.html#refines_flip_l"><span class="id" title="lemma">refines_flip_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "!&gt;" (<span class="id" title="var">b'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rel_pures_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_bool_decide</span> ; <span class="id" title="var">rel_pures_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">admit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">rel_values</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Abort</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;We&nbsp;can&nbsp;prove&nbsp;the&nbsp;refinement&nbsp;in&nbsp;case&nbsp;we&nbsp;diverge&nbsp;instead.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Goal</span> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">⊢</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">REL</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">(</span></a><a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">vnc_div</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">t2</span></a><a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">)</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">≾</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">(</span></a><a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">λ</span></a><a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">:&lt;&gt;,</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">flip</span></a><a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">)</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">:</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">lrel_unit</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">→</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">lrel_bool</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.examples.von_neumann_coin.html#vnc_div"><span class="id" title="definition">vnc_div</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rel_pures_r</span>. <span class="id" title="var">rel_pures_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="clutch.rel_logic.rel_rules.html#refines_arrow_val"><span class="id" title="lemma">refines_arrow_val</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "!#" (??) "#[-&gt; -&gt;]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rel_rec_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rel_pures_r</span>. <span class="id" title="var">rel_pures_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">vnc2</span> := <a class="idref" href="clutch.examples.von_neumann_coin.html#vnc_div"><span class="id" title="definition">vnc_div</span></a> <a class="idref" href="clutch.examples.von_neumann_coin.html#t2"><span class="id" title="definition">t2</span></a>) ; <span class="id" title="tactic">unfold</span> <a class="idref" href="clutch.examples.von_neumann_coin.html#vnc_div"><span class="id" title="definition">vnc_div</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">vnc2</span> ; <span class="id" title="tactic">fold</span> <span class="id" title="var">vnc2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="clutch.examples.von_neumann_coin.html#t2"><span class="id" title="definition">t2</span></a>. <span class="id" title="var">rel_pures_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rel_apply</span> <a class="idref" href="clutch.lib.flip.html#refines_couple_flip_flip"><span class="id" title="lemma">refines_couple_flip_flip</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">b</span>) "!&gt;".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rel_pures_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rel_apply</span> <a class="idref" href="clutch.lib.flip.html#refines_flip_l"><span class="id" title="lemma">refines_flip_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "!&gt;" (<span class="id" title="var">b'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rel_pures_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_bool_decide</span> ; <span class="id" title="var">rel_pures_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iLöb</span> <span class="id" title="keyword">as</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rel_rec_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExact</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">rel_values</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;We&nbsp;can&nbsp;construct&nbsp;a&nbsp;refinement&nbsp;coupling&nbsp;of&nbsp;vnc_div&nbsp;t4&nbsp;and&nbsp;flip&nbsp;by<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;discarding&nbsp;weight&nbsp;of&nbsp;the&nbsp;recursive&nbsp;calls.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;biased&nbsp;coin&nbsp;t4&nbsp;is&nbsp;represented&nbsp;by&nbsp;the&nbsp;following&nbsp;tree,&nbsp;where&nbsp;left<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub-branches&nbsp;correspond&nbsp;to&nbsp;the&nbsp;label&nbsp;evaluating&nbsp;to&nbsp;true&nbsp;(1)&nbsp;and&nbsp;right<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;branches&nbsp;correspond&nbsp;to&nbsp;false&nbsp;(0).&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;b0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;\<br/>
&nbsp;&nbsp;&nbsp;b1&nbsp;&nbsp;b1<br/>
&nbsp;&nbsp;/&nbsp;\&nbsp;/&nbsp;\<br/>
&nbsp;1&nbsp;&nbsp;0&nbsp;0&nbsp;0&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;The&nbsp;vnc_div&nbsp;t4&nbsp;program&nbsp;executes&nbsp;this&nbsp;tree&nbsp;twice&nbsp;and&nbsp;returns&nbsp;1&nbsp;if&nbsp;the&nbsp;two<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;results&nbsp;differ,&nbsp;and&nbsp;diverges&nbsp;otherwise.&nbsp;*)</span><br/>

<br/>
<span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/----------&nbsp;b0&nbsp;----------\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;___/&nbsp;&nbsp;\___&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;___/&nbsp;&nbsp;\___<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<br/>
x&nbsp;=&nbsp;1st&nbsp;run&nbsp;of&nbsp;t4:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b2<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b3&nbsp;&nbsp;&nbsp;b3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b3&nbsp;&nbsp;&nbsp;b3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b3&nbsp;&nbsp;&nbsp;b3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b3&nbsp;&nbsp;&nbsp;b3<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;\&nbsp;&nbsp;&nbsp;/&nbsp;\&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;\&nbsp;&nbsp;&nbsp;/&nbsp;\&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;\&nbsp;&nbsp;&nbsp;/&nbsp;\&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;\&nbsp;&nbsp;&nbsp;/&nbsp;\<br/>
y&nbsp;=&nbsp;2nd&nbsp;run&nbsp;of&nbsp;t4:&nbsp;&nbsp;1&nbsp;&nbsp;0&nbsp;&nbsp;0&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;0&nbsp;&nbsp;0&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;0&nbsp;&nbsp;0&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;0&nbsp;&nbsp;0&nbsp;&nbsp;0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;|&nbsp;&nbsp;|&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;|&nbsp;&nbsp;|&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;|&nbsp;&nbsp;|&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;|&nbsp;&nbsp;|&nbsp;&nbsp;|<br/>
x&nbsp;=&nbsp;y&nbsp;?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;&nbsp;n&nbsp;&nbsp;n&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;y&nbsp;&nbsp;y&nbsp;&nbsp;y&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;y&nbsp;&nbsp;y&nbsp;&nbsp;y&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;y&nbsp;&nbsp;y&nbsp;&nbsp;y<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;|&nbsp;&nbsp;|&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;|&nbsp;&nbsp;|&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;|&nbsp;&nbsp;|&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;|&nbsp;&nbsp;|&nbsp;&nbsp;|<br/>
vnc_div&nbsp;t4:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;⊥&nbsp;&nbsp;1&nbsp;&nbsp;1&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;⊥&nbsp;&nbsp;⊥&nbsp;&nbsp;⊥&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;⊥&nbsp;&nbsp;⊥&nbsp;&nbsp;⊥&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;⊥&nbsp;&nbsp;⊥&nbsp;&nbsp;⊥<br/>
<br/>
&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Goal</span> <a id="Unnamed_thm0" class="idref" href="#Unnamed_thm0"><span class="id" title="definition">⊢</span></a> <a id="Unnamed_thm0" class="idref" href="#Unnamed_thm0"><span class="id" title="definition">REL</span></a> <a id="Unnamed_thm0" class="idref" href="#Unnamed_thm0"><span class="id" title="definition">(</span></a><a id="Unnamed_thm0" class="idref" href="#Unnamed_thm0"><span class="id" title="definition">vnc_div</span></a> <a id="Unnamed_thm0" class="idref" href="#Unnamed_thm0"><span class="id" title="definition">t4</span></a><a id="Unnamed_thm0" class="idref" href="#Unnamed_thm0"><span class="id" title="definition">)</span></a> <a id="Unnamed_thm0" class="idref" href="#Unnamed_thm0"><span class="id" title="definition">≾</span></a> <a id="Unnamed_thm0" class="idref" href="#Unnamed_thm0"><span class="id" title="definition">(</span></a><a id="Unnamed_thm0" class="idref" href="#Unnamed_thm0"><span class="id" title="definition">λ</span></a><a id="Unnamed_thm0" class="idref" href="#Unnamed_thm0"><span class="id" title="definition">:&lt;&gt;,</span></a> <a id="Unnamed_thm0" class="idref" href="#Unnamed_thm0"><span class="id" title="definition">flip</span></a><a id="Unnamed_thm0" class="idref" href="#Unnamed_thm0"><span class="id" title="definition">)</span></a> <a id="Unnamed_thm0" class="idref" href="#Unnamed_thm0"><span class="id" title="definition">:</span></a> <a id="Unnamed_thm0" class="idref" href="#Unnamed_thm0"><span class="id" title="definition">lrel_unit</span></a> <a id="Unnamed_thm0" class="idref" href="#Unnamed_thm0"><span class="id" title="definition">→</span></a> <a id="Unnamed_thm0" class="idref" href="#Unnamed_thm0"><span class="id" title="definition">lrel_bool</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">with</span> <span class="id" title="tactic">try</span> <span class="id" title="var">rel_pures_r</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">rel_pures_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.examples.von_neumann_coin.html#vnc_div"><span class="id" title="definition">vnc_div</span></a>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="clutch.rel_logic.rel_rules.html#refines_arrow_val"><span class="id" title="lemma">refines_arrow_val</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "!#" (??) "#[-&gt; -&gt;]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rel_pure_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">Ω</span> := (<a class="idref" href="clutch.prob_lang.notation.html#906ea9e6f897046b3c4410ec24b8ddef"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.prob_lang.notation.html#906ea9e6f897046b3c4410ec24b8ddef"><span class="id" title="notation">rec</span></a><a class="idref" href="clutch.prob_lang.notation.html#906ea9e6f897046b3c4410ec24b8ddef"><span class="id" title="notation">:</span></a> "f" <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.binders.html#::binder_scope:'&lt;&gt;'"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="clutch.prob_lang.notation.html#906ea9e6f897046b3c4410ec24b8ddef"><span class="id" title="notation">:=</span></a> "f" <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.prob_lang.notation.html#3127c6bc552ca21a494fc6e3474a507d"><span class="id" title="notation">()</span></a><a class="idref" href="clutch.prob_lang.notation.html#906ea9e6f897046b3c4410ec24b8ddef"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.prob_lang.notation.html#906ea9e6f897046b3c4410ec24b8ddef"><span class="id" title="notation">#()</span></a>)%<span class="id" title="var">E</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="clutch.examples.von_neumann_coin.html#t4"><span class="id" title="definition">t4</span></a>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Case&nbsp;on&nbsp;the&nbsp;first&nbsp;lhs&nbsp;flip,&nbsp;don't&nbsp;couple&nbsp;anything.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rel_apply_l</span> <a class="idref" href="clutch.lib.flip.html#refines_flip_l"><span class="id" title="lemma">refines_flip_l</span></a> ; <span class="id" title="var">iIntros</span> "!&gt;" (<span class="id" title="var">b0</span>) ; <span class="id" title="tactic">destruct</span> <span class="id" title="var">b0</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">hb0</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">rel_apply</span> (<a class="idref" href="clutch.lib.flip.html#refines_couple_flip_flip"><span class="id" title="lemma">refines_couple_flip_flip</span></a>) ; <span class="id" title="var">iIntros</span> "!&gt;" (<span class="id" title="var">b1</span>) ; <span class="id" title="tactic">destruct</span> <span class="id" title="var">b1</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">hb1</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">rel_apply_l</span> <a class="idref" href="clutch.lib.flip.html#refines_flip_l"><span class="id" title="lemma">refines_flip_l</span></a> ; <span class="id" title="var">iIntros</span> "!&gt;" (<span class="id" title="var">b2</span>) ; <span class="id" title="tactic">destruct</span> <span class="id" title="var">b2</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">hb2</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">rel_apply_l</span> <a class="idref" href="clutch.lib.flip.html#refines_flip_l"><span class="id" title="lemma">refines_flip_l</span></a> ; <span class="id" title="var">iIntros</span> "!&gt;" (<span class="id" title="var">b3</span>) ; <span class="id" title="tactic">destruct</span> <span class="id" title="var">b3</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">hb3</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="var">iLöb</span> <span class="id" title="keyword">as</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rel_rec_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExact</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="var">rel_values</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">rel_apply_l</span> <a class="idref" href="clutch.lib.flip.html#refines_flip_l"><span class="id" title="lemma">refines_flip_l</span></a> ; <span class="id" title="var">iIntros</span> "!&gt;" (<span class="id" title="var">b3</span>) ; <span class="id" title="tactic">destruct</span> <span class="id" title="var">b3</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">hb3</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="var">rel_values</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">rel_apply_l</span> <a class="idref" href="clutch.lib.flip.html#refines_flip_l"><span class="id" title="lemma">refines_flip_l</span></a> ; <span class="id" title="var">iIntros</span> "!&gt;" (<span class="id" title="var">b2</span>) ; <span class="id" title="tactic">destruct</span> <span class="id" title="var">b2</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">hb2</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">rel_apply_l</span> <a class="idref" href="clutch.lib.flip.html#refines_flip_l"><span class="id" title="lemma">refines_flip_l</span></a> ; <span class="id" title="var">iIntros</span> "!&gt;" (<span class="id" title="var">b3</span>) ; <span class="id" title="tactic">destruct</span> <span class="id" title="var">b3</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">hb3</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="var">rel_values</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="var">iLöb</span> <span class="id" title="keyword">as</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rel_rec_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExact</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">rel_apply_l</span> <a class="idref" href="clutch.lib.flip.html#refines_flip_l"><span class="id" title="lemma">refines_flip_l</span></a> ; <span class="id" title="var">iIntros</span> "!&gt;" (<span class="id" title="var">b3</span>) ; <span class="id" title="tactic">destruct</span> <span class="id" title="var">b3</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">hb3</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="var">iLöb</span> <span class="id" title="keyword">as</span> "H" ; <span class="id" title="var">rel_rec_l</span> ; <span class="id" title="var">iExact</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">rel_apply_l</span> <a class="idref" href="clutch.lib.flip.html#refines_flip_l"><span class="id" title="lemma">refines_flip_l</span></a> ; <span class="id" title="var">iIntros</span> "!&gt;" (<span class="id" title="var">b1</span>) ; <span class="id" title="tactic">destruct</span> <span class="id" title="var">b1</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">hb1</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="var">rel_apply_l</span> <a class="idref" href="clutch.lib.flip.html#refines_flip_l"><span class="id" title="lemma">refines_flip_l</span></a> ; <span class="id" title="var">iIntros</span> "!&gt;" (<span class="id" title="var">b2</span>) ; <span class="id" title="tactic">destruct</span> <span class="id" title="var">b2</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">hb2</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="var">rel_apply</span> (<a class="idref" href="clutch.lib.flip.html#refines_couple_flip_flip"><span class="id" title="lemma">refines_couple_flip_flip</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#negb"><span class="id" title="definition">negb</span></a>) ; <span class="id" title="var">iIntros</span> "!&gt;" (<span class="id" title="var">b3</span>) ; <span class="id" title="tactic">destruct</span> <span class="id" title="var">b3</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">hb3</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,5: <span class="id" title="var">rel_values</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="var">iLöb</span> <span class="id" title="keyword">as</span> "H" ; <span class="id" title="var">rel_rec_l</span> ; <span class="id" title="var">iExact</span> "H".<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;A&nbsp;similar&nbsp;problem:&nbsp;no&nbsp;single&nbsp;flip&nbsp;on&nbsp;the&nbsp;left&nbsp;behaves&nbsp;like&nbsp;the&nbsp;rhs.&nbsp;But&nbsp;we<br/>
&nbsp;&nbsp;can&nbsp;pick&nbsp;our&nbsp;coupling&nbsp;after&nbsp;evaluating&nbsp;the&nbsp;first&nbsp;flip!&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Goal</span> <a id="Unnamed_thm1" class="idref" href="#Unnamed_thm1"><span class="id" title="definition">⊢</span></a> <a id="Unnamed_thm1" class="idref" href="#Unnamed_thm1"><span class="id" title="definition">REL</span></a> <a id="Unnamed_thm1" class="idref" href="#Unnamed_thm1"><span class="id" title="definition">flip</span></a> <a id="Unnamed_thm1" class="idref" href="#Unnamed_thm1"><span class="id" title="definition">=</span></a> <a id="Unnamed_thm1" class="idref" href="#Unnamed_thm1"><span class="id" title="definition">flip</span></a> <a id="Unnamed_thm1" class="idref" href="#Unnamed_thm1"><span class="id" title="definition">≾</span></a> <a id="Unnamed_thm1" class="idref" href="#Unnamed_thm1"><span class="id" title="definition">flip</span></a> <a id="Unnamed_thm1" class="idref" href="#Unnamed_thm1"><span class="id" title="definition">:</span></a> <a id="Unnamed_thm1" class="idref" href="#Unnamed_thm1"><span class="id" title="definition">lrel_bool</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rel_apply</span> <a class="idref" href="clutch.lib.flip.html#refines_flip_l"><span class="id" title="lemma">refines_flip_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "!&gt;" (<span class="id" title="var">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rel_apply</span> (<a class="idref" href="clutch.lib.flip.html#refines_couple_flip_flip"><span class="id" title="lemma">refines_couple_flip_flip</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <span class="id" title="var">b</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#id"><span class="id" title="definition">Datatypes.id</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#negb"><span class="id" title="definition">negb</span></a>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "!&gt;" (<span class="id" title="var">b'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span>, <span class="id" title="var">b'</span> =&gt; /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="var">rel_pures_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="var">rel_values</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span> ; <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;We&nbsp;can&nbsp;also&nbsp;show&nbsp;this&nbsp;refinement&nbsp;where&nbsp;the&nbsp;result&nbsp;on&nbsp;the&nbsp;left&nbsp;only<br/>
&nbsp;&nbsp;depends&nbsp;on&nbsp;the&nbsp;outcome&nbsp;of&nbsp;one&nbsp;flip.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Goal</span> <a id="Unnamed_thm2" class="idref" href="#Unnamed_thm2"><span class="id" title="definition">⊢</span></a> <a id="Unnamed_thm2" class="idref" href="#Unnamed_thm2"><span class="id" title="definition">REL</span></a> <a id="Unnamed_thm2" class="idref" href="#Unnamed_thm2"><span class="id" title="definition">(</span></a><a id="Unnamed_thm2" class="idref" href="#Unnamed_thm2"><span class="id" title="definition">let</span></a><a id="Unnamed_thm2" class="idref" href="#Unnamed_thm2"><span class="id" title="definition">:</span></a> "b" <a id="Unnamed_thm2" class="idref" href="#Unnamed_thm2"><span class="id" title="definition">:=</span></a> <a id="Unnamed_thm2" class="idref" href="#Unnamed_thm2"><span class="id" title="definition">flip</span></a> <a id="Unnamed_thm2" class="idref" href="#Unnamed_thm2"><span class="id" title="definition">in</span></a> <a id="Unnamed_thm2" class="idref" href="#Unnamed_thm2"><span class="id" title="definition">if</span></a><a id="Unnamed_thm2" class="idref" href="#Unnamed_thm2"><span class="id" title="definition">:</span></a> "b" <a id="Unnamed_thm2" class="idref" href="#Unnamed_thm2"><span class="id" title="definition">=</span></a> <a id="Unnamed_thm2" class="idref" href="#Unnamed_thm2"><span class="id" title="definition">flip</span></a> <a id="Unnamed_thm2" class="idref" href="#Unnamed_thm2"><span class="id" title="definition">then</span></a> "b" <a id="Unnamed_thm2" class="idref" href="#Unnamed_thm2"><span class="id" title="definition">else</span></a> "b"<a id="Unnamed_thm2" class="idref" href="#Unnamed_thm2"><span class="id" title="definition">)</span></a> <a id="Unnamed_thm2" class="idref" href="#Unnamed_thm2"><span class="id" title="definition">≾</span></a> <a id="Unnamed_thm2" class="idref" href="#Unnamed_thm2"><span class="id" title="definition">flip</span></a> <a id="Unnamed_thm2" class="idref" href="#Unnamed_thm2"><span class="id" title="definition">:</span></a> <a id="Unnamed_thm2" class="idref" href="#Unnamed_thm2"><span class="id" title="definition">lrel_bool</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rel_apply</span> <a class="idref" href="clutch.lib.flip.html#refines_couple_flip_flip"><span class="id" title="lemma">refines_couple_flip_flip</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "!&gt;" (<span class="id" title="var">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rel_pures_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rel_apply_l</span> <a class="idref" href="clutch.lib.flip.html#refines_flip_l"><span class="id" title="lemma">refines_flip_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "!&gt;" (<span class="id" title="var">b'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rel_pures_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_bool_decide</span> ; <span class="id" title="var">rel_pures_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="var">rel_values</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;We&nbsp;can&nbsp;even&nbsp;flip&nbsp;separately&nbsp;in&nbsp;each&nbsp;branch.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Goal</span> <a id="Unnamed_thm3" class="idref" href="#Unnamed_thm3"><span class="id" title="definition">⊢</span></a> <a id="Unnamed_thm3" class="idref" href="#Unnamed_thm3"><span class="id" title="definition">REL</span></a> <a id="Unnamed_thm3" class="idref" href="#Unnamed_thm3"><span class="id" title="definition">(</span></a><a id="Unnamed_thm3" class="idref" href="#Unnamed_thm3"><span class="id" title="definition">if</span></a><a id="Unnamed_thm3" class="idref" href="#Unnamed_thm3"><span class="id" title="definition">:</span></a> <a id="Unnamed_thm3" class="idref" href="#Unnamed_thm3"><span class="id" title="definition">flip</span></a> <a id="Unnamed_thm3" class="idref" href="#Unnamed_thm3"><span class="id" title="definition">then</span></a> <a id="Unnamed_thm3" class="idref" href="#Unnamed_thm3"><span class="id" title="definition">flip</span></a> <a id="Unnamed_thm3" class="idref" href="#Unnamed_thm3"><span class="id" title="definition">else</span></a> <a id="Unnamed_thm3" class="idref" href="#Unnamed_thm3"><span class="id" title="definition">flip</span></a><a id="Unnamed_thm3" class="idref" href="#Unnamed_thm3"><span class="id" title="definition">)</span></a> <a id="Unnamed_thm3" class="idref" href="#Unnamed_thm3"><span class="id" title="definition">≾</span></a> <a id="Unnamed_thm3" class="idref" href="#Unnamed_thm3"><span class="id" title="definition">flip</span></a> <a id="Unnamed_thm3" class="idref" href="#Unnamed_thm3"><span class="id" title="definition">:</span></a> <a id="Unnamed_thm3" class="idref" href="#Unnamed_thm3"><span class="id" title="definition">lrel_bool</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rel_apply_l</span> <a class="idref" href="clutch.lib.flip.html#refines_flip_l"><span class="id" title="lemma">refines_flip_l</span></a> ; <span class="id" title="var">iIntros</span> "!&gt;" (<span class="id" title="var">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span> ; <span class="id" title="var">rel_pures_l</span>; <span class="id" title="var">rel_apply</span> <a class="idref" href="clutch.lib.flip.html#refines_couple_flip_flip"><span class="id" title="lemma">refines_couple_flip_flip</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (?); <span class="id" title="var">rel_values</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;A&nbsp;form&nbsp;of&nbsp;extensionality.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Goal</span> <a id="Unnamed_thm4" class="idref" href="#Unnamed_thm4"><span class="id" title="definition">forall</span></a> <a id="e:5" class="idref" href="#e:5"><span class="id" title="binder">e</span></a> <a id="3e04709bb11b5bba5059773458c0fe1c" class="idref" href="#3e04709bb11b5bba5059773458c0fe1c"><span class="id" title="binder">τ</span></a> <a id="de9bdb4e9c2be34cf9b5e2f20d66b06e" class="idref" href="#de9bdb4e9c2be34cf9b5e2f20d66b06e"><span class="id" title="binder">Γ</span></a><a id="Unnamed_thm4" class="idref" href="#Unnamed_thm4"><span class="id" title="definition">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="Unnamed_thm4" class="idref" href="#Unnamed_thm4"><span class="id" title="definition">∅</span></a> <a id="Unnamed_thm4" class="idref" href="#Unnamed_thm4"><span class="id" title="definition">⊢ₜ</span></a> <a id="Unnamed_thm4" class="idref" href="#Unnamed_thm4"><span class="id" title="definition">e</span></a> <a id="Unnamed_thm4" class="idref" href="#Unnamed_thm4"><span class="id" title="definition">:</span></a> <a id="Unnamed_thm4" class="idref" href="#Unnamed_thm4"><span class="id" title="definition">τ</span></a> <a id="Unnamed_thm4" class="idref" href="#Unnamed_thm4"><span class="id" title="definition">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="Unnamed_thm4" class="idref" href="#Unnamed_thm4"><span class="id" title="definition">⊢</span></a> <a id="Unnamed_thm4" class="idref" href="#Unnamed_thm4"><span class="id" title="definition">REL</span></a> <a id="Unnamed_thm4" class="idref" href="#Unnamed_thm4"><span class="id" title="definition">(</span></a><a id="Unnamed_thm4" class="idref" href="#Unnamed_thm4"><span class="id" title="definition">if</span></a><a id="Unnamed_thm4" class="idref" href="#Unnamed_thm4"><span class="id" title="definition">:</span></a> <a id="Unnamed_thm4" class="idref" href="#Unnamed_thm4"><span class="id" title="definition">flip</span></a> <a id="Unnamed_thm4" class="idref" href="#Unnamed_thm4"><span class="id" title="definition">then</span></a> <a id="Unnamed_thm4" class="idref" href="#Unnamed_thm4"><span class="id" title="definition">e</span></a> <a id="Unnamed_thm4" class="idref" href="#Unnamed_thm4"><span class="id" title="definition">else</span></a> <a id="Unnamed_thm4" class="idref" href="#Unnamed_thm4"><span class="id" title="definition">e</span></a><a id="Unnamed_thm4" class="idref" href="#Unnamed_thm4"><span class="id" title="definition">)</span></a> <a id="Unnamed_thm4" class="idref" href="#Unnamed_thm4"><span class="id" title="definition">≾</span></a> <a id="Unnamed_thm4" class="idref" href="#Unnamed_thm4"><span class="id" title="definition">e</span></a> <a id="Unnamed_thm4" class="idref" href="#Unnamed_thm4"><span class="id" title="definition">:</span></a> <a id="Unnamed_thm4" class="idref" href="#Unnamed_thm4"><span class="id" title="definition">interp</span></a> <a id="Unnamed_thm4" class="idref" href="#Unnamed_thm4"><span class="id" title="definition">τ</span></a> <a id="Unnamed_thm4" class="idref" href="#Unnamed_thm4"><span class="id" title="definition">Γ</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rel_apply_l</span> <a class="idref" href="clutch.lib.flip.html#refines_flip_l"><span class="id" title="lemma">refines_flip_l</span></a> ; <span class="id" title="var">iIntros</span> (<span class="id" title="var">b'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">b'</span> ; <span class="id" title="var">iModIntro</span> ; <span class="id" title="var">rel_pures_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="var">rel_apply_l</span> <a class="idref" href="clutch.typing.fundamental.html#refines_typed"><span class="id" title="lemma">refines_typed</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="clutch.examples.von_neumann_coin.html#proofs"><span class="id" title="section">proofs</span></a>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/coq-community/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
