<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="resources/coqdoc.css" rel="stylesheet" type="text/css" />
<link href="resources/coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resources/config.js"></script>
<script type="text/javascript" src="resources/coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="../">Project Page</a>
      <a href="./indexpage.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">clutch.prob.couplings</h1>

<div class="code">
</div>

<div class="doc">
Exact couplings  
</div>
<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Reals.html#"><span class="id" title="library">Reals</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.micromega.Psatz.html#"><span class="id" title="library">Psatz</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coquelicot</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coquelicot.saclay.inria.fr/html//Coquelicot.Rcomplements.html#"><span class="id" title="library">Rcomplements</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">stdpp</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.countable.html#"><span class="id" title="library">countable</span></a>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">clutch.prelude</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="clutch.prelude.base.html#"><span class="id" title="library">base</span></a> <a class="idref" href="clutch.prelude.Coquelicot_ext.html#"><span class="id" title="library">Coquelicot_ext</span></a> <a class="idref" href="clutch.prelude.Reals_ext.html#"><span class="id" title="library">Reals_ext</span></a> <a class="idref" href="clutch.prelude.stdpp_ext.html#"><span class="id" title="library">stdpp_ext</span></a> <a class="idref" href="clutch.prelude.classical.html#"><span class="id" title="library">classical</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">clutch.prob</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="clutch.prob.countable_sum.html#"><span class="id" title="library">countable_sum</span></a> <a class="idref" href="clutch.prob.distribution.html#"><span class="id" title="library">distribution</span></a>.<br/>

<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">R</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="coupl" class="idref" href="#coupl"><span class="id" title="section">coupl</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H:3" class="idref" href="#H:3"><span class="id" title="binder">Countable</span></a> <a id="H:3" class="idref" href="#H:3"><span class="id" title="binder">A</span></a>, <a id="H0:6" class="idref" href="#H0:6"><span class="id" title="binder">Countable</span></a> <a id="H0:6" class="idref" href="#H0:6"><span class="id" title="binder">B</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<a id="c7d02b4cbd5705ab39b01e419f22278c" class="idref" href="#c7d02b4cbd5705ab39b01e419f22278c"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#coupl.A"><span class="id" title="variable">A</span></a>) (<a id="6d0cd020d6912053146d47eec2f17381" class="idref" href="#6d0cd020d6912053146d47eec2f17381"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#coupl.B"><span class="id" title="variable">B</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="is_coupl" class="idref" href="#is_coupl"><span class="id" title="definition">is_coupl</span></a> (<a id="90df8bdb236fa6d748593874a043010b" class="idref" href="#90df8bdb236fa6d748593874a043010b"><span class="id" title="binder">μ</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> (<a class="idref" href="clutch.prob.couplings.html#coupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="clutch.prob.couplings.html#coupl.B"><span class="id" title="variable">B</span></a>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.distribution.html#lmarg"><span class="id" title="definition">lmarg</span></a> <a class="idref" href="clutch.prob.couplings.html#90df8bdb236fa6d748593874a043010b"><span class="id" title="variable">μ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.prob.couplings.html#b639a6dced6d5967fda6389458cfa48f"><span class="id" title="variable">μ1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="clutch.prob.distribution.html#rmarg"><span class="id" title="definition">rmarg</span></a> <a class="idref" href="clutch.prob.couplings.html#90df8bdb236fa6d748593874a043010b"><span class="id" title="variable">μ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.prob.couplings.html#8b7307aed0404907a25d41b5577b9ebe"><span class="id" title="variable">μ2</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="ex_coupl" class="idref" href="#ex_coupl"><span class="id" title="definition">ex_coupl</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">(</span></a><a id="5587be393abab7d9461a4b3f4fb7e097" class="idref" href="#5587be393abab7d9461a4b3f4fb7e097"><span class="id" title="binder">μ</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> (<a class="idref" href="clutch.prob.couplings.html#coupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="clutch.prob.couplings.html#coupl.B"><span class="id" title="variable">B</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">),</span></a> <a class="idref" href="clutch.prob.couplings.html#is_coupl"><span class="id" title="definition">is_coupl</span></a> <a class="idref" href="clutch.prob.couplings.html#5587be393abab7d9461a4b3f4fb7e097"><span class="id" title="variable">μ</span></a>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="clutch.prob.couplings.html#coupl"><span class="id" title="section">coupl</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="Rcoupl" class="idref" href="#Rcoupl"><span class="id" title="section">Rcoupl</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H:13" class="idref" href="#H:13"><span class="id" title="binder">Countable</span></a> <a id="H:13" class="idref" href="#H:13"><span class="id" title="binder">A</span></a>, <a id="H0:16" class="idref" href="#H0:16"><span class="id" title="binder">Countable</span></a> <a id="H0:16" class="idref" href="#H0:16"><span class="id" title="binder">B</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<a id="8de2c9f99e4699c737f06fc043b0e5b0" class="idref" href="#8de2c9f99e4699c737f06fc043b0e5b0"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="00b55cd51f04e66754ff7c8def3f4867" class="idref" href="#00b55cd51f04e66754ff7c8def3f4867"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a>) (<a id="R:19" class="idref" href="#R:19"><span class="id" title="binder">R</span></a> : <a class="idref" href="clutch.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="is_Rcoupl" class="idref" href="#is_Rcoupl"><span class="id" title="definition">is_Rcoupl</span></a> (<a id="9a5f82bf14e2d9fa7ef57f7e19185de2" class="idref" href="#9a5f82bf14e2d9fa7ef57f7e19185de2"><span class="id" title="binder">μ</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> (<a class="idref" href="clutch.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#is_coupl"><span class="id" title="definition">is_coupl</span></a> <a class="idref" href="clutch.prob.couplings.html#bd25e74ef525ff42f542f01b0192b88d"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#765e22366dda88add855e9651a99f536"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.couplings.html#9a5f82bf14e2d9fa7ef57f7e19185de2"><span class="id" title="variable">μ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="p:21" class="idref" href="#p:21"><span class="id" title="binder">p</span></a> : <a class="idref" href="clutch.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a> <a class="idref" href="clutch.prob.couplings.html#9a5f82bf14e2d9fa7ef57f7e19185de2"><span class="id" title="variable">μ</span></a> <a class="idref" href="clutch.prob.couplings.html#p:21"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl.R"><span class="id" title="variable">R</span></a> <a class="idref" href="clutch.prob.couplings.html#p:21"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="clutch.prob.couplings.html#p:21"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.2'"><span class="id" title="notation">.2</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="Rcoupl" class="idref" href="#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">(</span></a><a id="cc1e75c6f0d857f62fd72a8bc1c0288a" class="idref" href="#cc1e75c6f0d857f62fd72a8bc1c0288a"><span class="id" title="binder">μ</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> (<a class="idref" href="clutch.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">),</span></a> <a class="idref" href="clutch.prob.couplings.html#is_Rcoupl"><span class="id" title="definition">is_Rcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#cc1e75c6f0d857f62fd72a8bc1c0288a"><span class="id" title="variable">μ</span></a>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="section">Rcoupl</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="is_coupl" class="idref" href="#is_coupl"><span class="id" title="section">is_coupl</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H:25" class="idref" href="#H:25"><span class="id" title="binder">Countable</span></a> <a id="H:25" class="idref" href="#H:25"><span class="id" title="binder">A</span></a>, <a id="H0:28" class="idref" href="#H0:28"><span class="id" title="binder">Countable</span></a> <a id="H0:28" class="idref" href="#H0:28"><span class="id" title="binder">B</span></a>}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="is_Rcoupl_is_coupl" class="idref" href="#is_Rcoupl_is_coupl"><span class="id" title="lemma">is_Rcoupl_is_coupl</span></a> (<a id="b7837e3c47a8d3db8af13411031509c4" class="idref" href="#b7837e3c47a8d3db8af13411031509c4"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#is_coupl.A"><span class="id" title="variable">A</span></a>) (<a id="aa1ba50ee401cc59a220c42bc5c20a7b" class="idref" href="#aa1ba50ee401cc59a220c42bc5c20a7b"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#is_coupl.B"><span class="id" title="variable">B</span></a>) <a id="R:31" class="idref" href="#R:31"><span class="id" title="binder">R</span></a> <a id="ef4ae7934778aeed4bf39382b8b5f724" class="idref" href="#ef4ae7934778aeed4bf39382b8b5f724"><span class="id" title="binder">μ</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#is_Rcoupl"><span class="id" title="definition">is_Rcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#b7837e3c47a8d3db8af13411031509c4"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#aa1ba50ee401cc59a220c42bc5c20a7b"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.couplings.html#R:31"><span class="id" title="variable">R</span></a> <a class="idref" href="clutch.prob.couplings.html#ef4ae7934778aeed4bf39382b8b5f724"><span class="id" title="variable">μ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#is_coupl"><span class="id" title="definition">is_coupl</span></a> <a class="idref" href="clutch.prob.couplings.html#b7837e3c47a8d3db8af13411031509c4"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#aa1ba50ee401cc59a220c42bc5c20a7b"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.couplings.html#ef4ae7934778aeed4bf39382b8b5f724"><span class="id" title="variable">μ</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">intros</span> []. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="is_coupl_mass_l" class="idref" href="#is_coupl_mass_l"><span class="id" title="lemma">is_coupl_mass_l</span></a> (<a id="3609dc48822ad1a169ab1a50dd8550d3" class="idref" href="#3609dc48822ad1a169ab1a50dd8550d3"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#is_coupl.A"><span class="id" title="variable">A</span></a>) (<a id="fdf9a2b004896723c8fa6b01d8168657" class="idref" href="#fdf9a2b004896723c8fa6b01d8168657"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#is_coupl.B"><span class="id" title="variable">B</span></a>) <a id="add8f206bcb2c07fac09debe3d4baf04" class="idref" href="#add8f206bcb2c07fac09debe3d4baf04"><span class="id" title="binder">μ</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#is_coupl"><span class="id" title="definition">is_coupl</span></a> <a class="idref" href="clutch.prob.couplings.html#3609dc48822ad1a169ab1a50dd8550d3"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#fdf9a2b004896723c8fa6b01d8168657"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.couplings.html#add8f206bcb2c07fac09debe3d4baf04"><span class="id" title="variable">μ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="clutch.prob.couplings.html#add8f206bcb2c07fac09debe3d4baf04"><span class="id" title="variable">μ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="clutch.prob.couplings.html#3609dc48822ad1a169ab1a50dd8550d3"><span class="id" title="variable">μ1</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> (&lt;- &amp; <span class="id" title="var">_</span>). <span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.distribution.html#dmap_mass"><span class="id" title="lemma">dmap_mass</span></a> //. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="is_coupl_mass_r" class="idref" href="#is_coupl_mass_r"><span class="id" title="lemma">is_coupl_mass_r</span></a> (<a id="3fb10c98aef75f3ba3877c74ba013cb4" class="idref" href="#3fb10c98aef75f3ba3877c74ba013cb4"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#is_coupl.A"><span class="id" title="variable">A</span></a>) (<a id="89d753c7bc7a3bb38e250fa3a237b7d7" class="idref" href="#89d753c7bc7a3bb38e250fa3a237b7d7"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#is_coupl.B"><span class="id" title="variable">B</span></a>) <a id="857527bcfb5911404b587ad2f1e079e7" class="idref" href="#857527bcfb5911404b587ad2f1e079e7"><span class="id" title="binder">μ</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#is_coupl"><span class="id" title="definition">is_coupl</span></a> <a class="idref" href="clutch.prob.couplings.html#3fb10c98aef75f3ba3877c74ba013cb4"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#89d753c7bc7a3bb38e250fa3a237b7d7"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.couplings.html#857527bcfb5911404b587ad2f1e079e7"><span class="id" title="variable">μ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="clutch.prob.couplings.html#857527bcfb5911404b587ad2f1e079e7"><span class="id" title="variable">μ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="clutch.prob.couplings.html#89d753c7bc7a3bb38e250fa3a237b7d7"><span class="id" title="variable">μ2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> (<span class="id" title="var">_</span> &amp; &lt;-). <span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.distribution.html#dmap_mass"><span class="id" title="lemma">dmap_mass</span></a> //. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="is_coupl_mass_eq" class="idref" href="#is_coupl_mass_eq"><span class="id" title="lemma">is_coupl_mass_eq</span></a> (<a id="58e65fe083273fba688b5d007611cbee" class="idref" href="#58e65fe083273fba688b5d007611cbee"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#is_coupl.A"><span class="id" title="variable">A</span></a>) (<a id="55b15e11b0185948f4960e67714128b4" class="idref" href="#55b15e11b0185948f4960e67714128b4"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#is_coupl.B"><span class="id" title="variable">B</span></a>) <a id="097b8060c48d1509e2273bce6bb2e7d6" class="idref" href="#097b8060c48d1509e2273bce6bb2e7d6"><span class="id" title="binder">μ</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#is_coupl"><span class="id" title="definition">is_coupl</span></a> <a class="idref" href="clutch.prob.couplings.html#58e65fe083273fba688b5d007611cbee"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#55b15e11b0185948f4960e67714128b4"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.couplings.html#097b8060c48d1509e2273bce6bb2e7d6"><span class="id" title="variable">μ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="clutch.prob.couplings.html#58e65fe083273fba688b5d007611cbee"><span class="id" title="variable">μ1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="clutch.prob.couplings.html#55b15e11b0185948f4960e67714128b4"><span class="id" title="variable">μ2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> -(<a class="idref" href="clutch.prob.couplings.html#is_coupl_mass_l"><span class="id" title="lemma">is_coupl_mass_l</span></a> <span class="id" title="var">_</span> <span class="id" title="var">μ2</span> <span class="id" title="var">μ</span>) // -(<a class="idref" href="clutch.prob.couplings.html#is_coupl_mass_r"><span class="id" title="lemma">is_coupl_mass_r</span></a> <span class="id" title="var">μ1</span> <span class="id" title="var">_</span> <span class="id" title="var">μ</span>) //.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="is_coupl_dret" class="idref" href="#is_coupl_dret"><span class="id" title="lemma">is_coupl_dret</span></a> (<a id="a:42" class="idref" href="#a:42"><span class="id" title="binder">a</span></a> : <a class="idref" href="clutch.prob.couplings.html#is_coupl.A"><span class="id" title="variable">A</span></a>) (<a id="b:43" class="idref" href="#b:43"><span class="id" title="binder">b</span></a> : <a class="idref" href="clutch.prob.couplings.html#is_coupl.B"><span class="id" title="variable">B</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#is_coupl"><span class="id" title="definition">is_coupl</span></a> (<a class="idref" href="clutch.prob.distribution.html#dret"><span class="id" title="definition">dret</span></a> <a class="idref" href="clutch.prob.couplings.html#a:42"><span class="id" title="variable">a</span></a>) (<a class="idref" href="clutch.prob.distribution.html#dret"><span class="id" title="definition">dret</span></a> <a class="idref" href="clutch.prob.couplings.html#b:43"><span class="id" title="variable">b</span></a>) (<a class="idref" href="clutch.prob.distribution.html#dret"><span class="id" title="definition">dret</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.prob.couplings.html#a:42"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.couplings.html#b:43"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.prob.couplings.html#is_coupl"><span class="id" title="definition">is_coupl</span></a> /<a class="idref" href="clutch.prob.distribution.html#lmarg"><span class="id" title="definition">lmarg</span></a> /<a class="idref" href="clutch.prob.distribution.html#rmarg"><span class="id" title="definition">rmarg</span></a> !<a class="idref" href="clutch.prob.distribution.html#dmap_dret"><span class="id" title="lemma">dmap_dret</span></a> //. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="clutch.prob.couplings.html#is_coupl"><span class="id" title="section">is_coupl</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="ex_coupl" class="idref" href="#ex_coupl"><span class="id" title="section">ex_coupl</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H:46" class="idref" href="#H:46"><span class="id" title="binder">Countable</span></a> <a id="H:46" class="idref" href="#H:46"><span class="id" title="binder">A</span></a>, <a id="H0:49" class="idref" href="#H0:49"><span class="id" title="binder">Countable</span></a> <a id="H0:49" class="idref" href="#H0:49"><span class="id" title="binder">B</span></a>}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="coupl_dret" class="idref" href="#coupl_dret"><span class="id" title="lemma">coupl_dret</span></a> (<a id="a:50" class="idref" href="#a:50"><span class="id" title="binder">a</span></a> : <a class="idref" href="clutch.prob.couplings.html#ex_coupl.A"><span class="id" title="variable">A</span></a>) (<a id="b:51" class="idref" href="#b:51"><span class="id" title="binder">b</span></a> : <a class="idref" href="clutch.prob.couplings.html#ex_coupl.B"><span class="id" title="variable">B</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#ex_coupl"><span class="id" title="definition">ex_coupl</span></a> (<a class="idref" href="clutch.prob.distribution.html#dret"><span class="id" title="definition">dret</span></a> <a class="idref" href="clutch.prob.couplings.html#a:50"><span class="id" title="variable">a</span></a>) (<a class="idref" href="clutch.prob.distribution.html#dret"><span class="id" title="definition">dret</span></a> <a class="idref" href="clutch.prob.couplings.html#b:51"><span class="id" title="variable">b</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.couplings.html#is_coupl_dret"><span class="id" title="lemma">is_coupl_dret</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="ex_coupl_sym" class="idref" href="#ex_coupl_sym"><span class="id" title="lemma">ex_coupl_sym</span></a> (<a id="491fa43f670ee6e97bbb5a689641c329" class="idref" href="#491fa43f670ee6e97bbb5a689641c329"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#ex_coupl.A"><span class="id" title="variable">A</span></a>) (<a id="b6baa9361ef06621dcb5424cbe7dc258" class="idref" href="#b6baa9361ef06621dcb5424cbe7dc258"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#ex_coupl.B"><span class="id" title="variable">B</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#ex_coupl"><span class="id" title="definition">ex_coupl</span></a> <a class="idref" href="clutch.prob.couplings.html#491fa43f670ee6e97bbb5a689641c329"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#b6baa9361ef06621dcb5424cbe7dc258"><span class="id" title="variable">μ2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#ex_coupl"><span class="id" title="definition">ex_coupl</span></a> <a class="idref" href="clutch.prob.couplings.html#b6baa9361ef06621dcb5424cbe7dc258"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.couplings.html#491fa43f670ee6e97bbb5a689641c329"><span class="id" title="variable">μ1</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> (<span class="id" title="var">μ</span> &amp; <span class="id" title="var">HμL</span> &amp; <span class="id" title="var">HμR</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<a class="idref" href="clutch.prob.distribution.html#dmap"><span class="id" title="definition">dmap</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">'</span></a><a id="pat:59" class="idref" href="#pat:59"><span class="id" title="binder">(</span></a><a id="pat:59" class="idref" href="#pat:59"><span class="id" title="binder">a</span></a><a id="pat:59" class="idref" href="#pat:59"><span class="id" title="binder">,</span></a> <a id="pat:59" class="idref" href="#pat:59"><span class="id" title="binder">b</span></a><a id="pat:59" class="idref" href="#pat:59"><span class="id" title="binder">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.prob.couplings.html#b:54"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.couplings.html#a:55"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <span class="id" title="var">μ</span>); <span class="id" title="tactic">split</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.distribution.html#distr_ext"><span class="id" title="lemma">distr_ext</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intro</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">HμR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.distribution.html#lmarg_pmf"><span class="id" title="lemma">lmarg_pmf</span></a> <a class="idref" href="clutch.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a>; <span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> {1}/<a class="idref" href="clutch.prob.distribution.html#pmf"><span class="id" title="projection">pmf</span></a> /= /<a class="idref" href="clutch.prob.distribution.html#dbind_pmf"><span class="id" title="definition">dbind_pmf</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> {2}/<a class="idref" href="clutch.prob.distribution.html#pmf"><span class="id" title="projection">pmf</span></a> /= /<a class="idref" href="clutch.prob.distribution.html#dret_pmf"><span class="id" title="definition">dret_pmf</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="a0:62" class="idref" href="#a0:62"><span class="id" title="binder">a0</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <span class="id" title="var">μ</span> <a class="idref" href="clutch.prob.couplings.html#a0:60"><span class="id" title="variable">a0</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.decidable.html#bool_decide"><span class="id" title="definition">bool_decide</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="keyword">let</span> '<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b0</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> := <a class="idref" href="clutch.prob.couplings.html#a0:60"><span class="id" title="variable">a0</span></a> <span class="id" title="tactic">in</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">b0</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">a1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> 1 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> 0<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.decidable.html#bool_decide"><span class="id" title="definition">bool_decide</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.prob.couplings.html#a0:60"><span class="id" title="variable">a0</span></a> ) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> 0) <span class="id" title="keyword">as</span> <span class="id" title="var">Heq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> (<span class="id" title="var">a'</span> &amp; <span class="id" title="var">b'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_bool_decide</span>; <span class="id" title="var">case_bool_decide</span>; <span class="id" title="var">simplify_eq</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="clutch.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Heq1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC_singleton'"><span class="id" title="lemma">SeriesC_singleton'</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">HμL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.distribution.html#lmarg_pmf"><span class="id" title="lemma">lmarg_pmf</span></a> <a class="idref" href="clutch.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a>; <span class="id" title="tactic">intro</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> {1}/<a class="idref" href="clutch.prob.distribution.html#pmf"><span class="id" title="projection">pmf</span></a> /= /<a class="idref" href="clutch.prob.distribution.html#dbind_pmf"><span class="id" title="definition">dbind_pmf</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> {2}/<a class="idref" href="clutch.prob.distribution.html#pmf"><span class="id" title="projection">pmf</span></a> /= /<a class="idref" href="clutch.prob.distribution.html#dret_pmf"><span class="id" title="definition">dret_pmf</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="a0:66" class="idref" href="#a0:66"><span class="id" title="binder">a0</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <span class="id" title="var">μ</span> <a class="idref" href="clutch.prob.couplings.html#a0:64"><span class="id" title="variable">a0</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.decidable.html#bool_decide"><span class="id" title="definition">bool_decide</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="keyword">let</span> '<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b0</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> := <a class="idref" href="clutch.prob.couplings.html#a0:64"><span class="id" title="variable">a0</span></a> <span class="id" title="tactic">in</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">b0</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">a1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> 1 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> 0<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.decidable.html#bool_decide"><span class="id" title="definition">bool_decide</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.prob.couplings.html#a0:64"><span class="id" title="variable">a0</span></a> ) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> 0) <span class="id" title="keyword">as</span> <span class="id" title="var">Heq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> (<span class="id" title="var">a'</span> &amp; <span class="id" title="var">b'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_bool_decide</span>; <span class="id" title="var">case_bool_decide</span>; <span class="id" title="var">simplify_eq</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">lra</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="clutch.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Heq1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC_singleton'"><span class="id" title="lemma">SeriesC_singleton'</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="ex_coupl_dbind" class="idref" href="#ex_coupl_dbind"><span class="id" title="lemma">ex_coupl_dbind</span></a> `{<a id="H1:70" class="idref" href="#H1:70"><span class="id" title="binder">Countable</span></a> <a id="H1:70" class="idref" href="#H1:70"><span class="id" title="binder">A'</span></a>, <a id="H2:73" class="idref" href="#H2:73"><span class="id" title="binder">Countable</span></a> <a id="H2:73" class="idref" href="#H2:73"><span class="id" title="binder">B'</span></a>} (<a id="f:74" class="idref" href="#f:74"><span class="id" title="binder">f</span></a> : <a class="idref" href="clutch.prob.couplings.html#ex_coupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#A':68"><span class="id" title="variable">A'</span></a>) (<a id="g:75" class="idref" href="#g:75"><span class="id" title="binder">g</span></a> : <a class="idref" href="clutch.prob.couplings.html#ex_coupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#B':71"><span class="id" title="variable">B'</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="fb92f4bea75b26cab8575bfa3fb70990" class="idref" href="#fb92f4bea75b26cab8575bfa3fb70990"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#ex_coupl.A"><span class="id" title="variable">A</span></a>) (<a id="2be0c2cb0d4e0b5f36f857a3bd81ad7a" class="idref" href="#2be0c2cb0d4e0b5f36f857a3bd81ad7a"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#ex_coupl.B"><span class="id" title="variable">B</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="a:78" class="idref" href="#a:78"><span class="id" title="binder">a</span></a> <a id="b:79" class="idref" href="#b:79"><span class="id" title="binder">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.couplings.html#ex_coupl"><span class="id" title="definition">ex_coupl</span></a> (<a class="idref" href="clutch.prob.couplings.html#f:74"><span class="id" title="variable">f</span></a> <a class="idref" href="clutch.prob.couplings.html#a:78"><span class="id" title="variable">a</span></a>) (<a class="idref" href="clutch.prob.couplings.html#g:75"><span class="id" title="variable">g</span></a> <a class="idref" href="clutch.prob.couplings.html#b:79"><span class="id" title="variable">b</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#ex_coupl"><span class="id" title="definition">ex_coupl</span></a> <a class="idref" href="clutch.prob.couplings.html#fb92f4bea75b26cab8575bfa3fb70990"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#2be0c2cb0d4e0b5f36f857a3bd81ad7a"><span class="id" title="variable">μ2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#ex_coupl"><span class="id" title="definition">ex_coupl</span></a> (<a class="idref" href="clutch.prob.couplings.html#fb92f4bea75b26cab8575bfa3fb70990"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.distribution.html#1ec27ecb4da8da3d3cbd85a2394dc835"><span class="id" title="notation">≫=</span></a> <a class="idref" href="clutch.prob.couplings.html#f:74"><span class="id" title="variable">f</span></a>) (<a class="idref" href="clutch.prob.couplings.html#2be0c2cb0d4e0b5f36f857a3bd81ad7a"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.distribution.html#1ec27ecb4da8da3d3cbd85a2394dc835"><span class="id" title="notation">≫=</span></a> <a class="idref" href="clutch.prob.couplings.html#g:75"><span class="id" title="variable">g</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hfg</span> (<span class="id" title="var">μ</span> &amp; <span class="id" title="var">Hμ</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.prob.couplings.html#ex_coupl"><span class="id" title="definition">ex_coupl</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hfg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="p:82" class="idref" href="#p:82"><span class="id" title="binder">p</span></a> : <a class="idref" href="clutch.prob.couplings.html#ex_coupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="clutch.prob.couplings.html#ex_coupl.B"><span class="id" title="variable">B</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a id="f8d4daaf2dac3fd13f88d07f68b86358" class="idref" href="#f8d4daaf2dac3fd13f88d07f68b86358"><span class="id" title="binder">μ</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> (<span class="id" title="var">A'</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <span class="id" title="var">B'</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.couplings.html#is_coupl"><span class="id" title="definition">is_coupl</span></a> (<span class="id" title="var">f</span> <a class="idref" href="clutch.prob.couplings.html#p:80"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.1'"><span class="id" title="notation">.1</span></a>) (<span class="id" title="var">g</span> <a class="idref" href="clutch.prob.couplings.html#p:80"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.2'"><span class="id" title="notation">.2</span></a>) <a class="idref" href="clutch.prob.couplings.html#a294bf0eb6e29ae69ec5768672c9a484"><span class="id" title="variable">μ</span></a>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hfg'</span>; [<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Logic.ClassicalEpsilon.html#choice"><span class="id" title="lemma">ClassicalEpsilon.choice</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hfg'</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">Ch</span> &amp; <span class="id" title="var">HCh</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.prob.couplings.html#ex_coupl"><span class="id" title="definition">ex_coupl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<a class="idref" href="clutch.prob.distribution.html#dbind"><span class="id" title="definition">dbind</span></a> <span class="id" title="var">Ch</span> <span class="id" title="var">μ</span>); <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.distribution.html#distr_ext"><span class="id" title="lemma">distr_ext</span></a>; <span class="id" title="tactic">intro</span> <span class="id" title="var">a'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.distribution.html#lmarg_pmf"><span class="id" title="lemma">lmarg_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> {1 2}/<a class="idref" href="clutch.prob.distribution.html#pmf"><span class="id" title="projection">pmf</span></a>/=/<a class="idref" href="clutch.prob.distribution.html#dbind_pmf"><span class="id" title="definition">dbind_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="clutch.prob.distribution.html#distr_double_swap_lmarg"><span class="id" title="lemma">distr_double_swap_lmarg</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">setoid_rewrite</span> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC_scal_l"><span class="id" title="lemma">SeriesC_scal_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="p:86" class="idref" href="#p:86"><span class="id" title="binder">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <span class="id" title="var">μ</span> <a class="idref" href="clutch.prob.couplings.html#p:84"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="b':87" class="idref" href="#b':87"><span class="id" title="binder">b'</span></a> : <span class="id" title="var">B'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="var">Ch</span> <a class="idref" href="clutch.prob.couplings.html#p:84"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.couplings.html#b':85"><span class="id" title="variable">b'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">μ</span> <a class="idref" href="clutch.prob.couplings.html#p:84"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <span class="id" title="var">f</span> <a class="idref" href="clutch.prob.couplings.html#p:84"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.1'"><span class="id" title="notation">.1</span></a> <span class="id" title="var">a'</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Heq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> (<span class="id" title="var">a</span> &amp; <span class="id" title="var">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">HCh</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <span class="id" title="keyword">as</span> (<span class="id" title="var">HChL</span> &amp; <span class="id" title="var">HChR</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">HChL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.distribution.html#lmarg_pmf"><span class="id" title="lemma">lmarg_pmf</span></a> //. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="clutch.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Heq2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.countable_sum.html#fubini_pos_seriesC_prod_lr"><span class="id" title="lemma">fubini_pos_seriesC_prod_lr</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: { <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_pos"><span class="id" title="lemma">Rmult_le_pos</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: { <span class="id" title="tactic">apply</span> (<a class="idref" href="clutch.prob.countable_sum.html#ex_seriesC_le"><span class="id" title="lemma">ex_seriesC_le</span></a> <span class="id" title="var">_</span> <span class="id" title="var">μ</span>); [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">split</span>; [<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_pos"><span class="id" title="lemma">Rmult_le_pos</span></a>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -{2}(<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rmult_1_r"><span class="id" title="lemma">Rmult_1_r</span></a> (<span class="id" title="var">μ</span> <span class="id" title="var">n</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_compat"><span class="id" title="lemma">Rmult_le_compat</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="a:91" class="idref" href="#a:91"><span class="id" title="binder">a</span></a> : <a class="idref" href="clutch.prob.couplings.html#ex_coupl.A"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="b:92" class="idref" href="#b:92"><span class="id" title="binder">b</span></a> : <a class="idref" href="clutch.prob.couplings.html#ex_coupl.B"><span class="id" title="variable">B</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.prob.couplings.html#a:88"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.couplings.html#b:89"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <span class="id" title="var">f</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.prob.couplings.html#a:88"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.couplings.html#b:89"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.1'"><span class="id" title="notation">.1</span></a> <span class="id" title="var">a'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="b:93" class="idref" href="#b:93"><span class="id" title="binder">b</span></a> : <a class="idref" href="clutch.prob.couplings.html#ex_coupl.B"><span class="id" title="variable">B</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.prob.couplings.html#a:88"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.couplings.html#b:90"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> ) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <span class="id" title="var">f</span> <a class="idref" href="clutch.prob.couplings.html#a:88"><span class="id" title="variable">a</span></a> <span class="id" title="var">a'</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Heq3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC_scal_r"><span class="id" title="lemma">SeriesC_scal_r</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="clutch.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Heq3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="a:96" class="idref" href="#a:96"><span class="id" title="binder">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="b:97" class="idref" href="#b:97"><span class="id" title="binder">b</span></a> : <a class="idref" href="clutch.prob.couplings.html#ex_coupl.B"><span class="id" title="variable">B</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.prob.couplings.html#a:94"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.couplings.html#b:95"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">μ1</span> <a class="idref" href="clutch.prob.couplings.html#a:94"><span class="id" title="variable">a</span></a>) <span class="id" title="keyword">as</span> <span class="id" title="var">Heq4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hμ</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">Hμ1</span> &amp; <span class="id" title="var">Hμ2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Hμ1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.distribution.html#lmarg_pmf"><span class="id" title="lemma">lmarg_pmf</span></a> //. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heq4</span> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;The&nbsp;second&nbsp;half&nbsp;is&nbsp;esentially&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;first,&nbsp;can&nbsp;it&nbsp;be&nbsp;proven&nbsp;somehow&nbsp;by&nbsp;symmetry?&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.distribution.html#distr_ext"><span class="id" title="lemma">distr_ext</span></a>; <span class="id" title="tactic">intro</span> <span class="id" title="var">b'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> {1 2}/<a class="idref" href="clutch.prob.distribution.html#pmf"><span class="id" title="projection">pmf</span></a>/=/<a class="idref" href="clutch.prob.distribution.html#dbind_pmf"><span class="id" title="definition">dbind_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="clutch.prob.distribution.html#distr_double_swap_rmarg"><span class="id" title="lemma">distr_double_swap_rmarg</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">setoid_rewrite</span> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC_scal_l"><span class="id" title="lemma">SeriesC_scal_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="p:100" class="idref" href="#p:100"><span class="id" title="binder">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <span class="id" title="var">μ</span> <a class="idref" href="clutch.prob.couplings.html#p:98"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a':101" class="idref" href="#a':101"><span class="id" title="binder">a'</span></a> : <span class="id" title="var">A'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="var">Ch</span> <a class="idref" href="clutch.prob.couplings.html#p:98"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.prob.couplings.html#a':99"><span class="id" title="variable">a'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">μ</span> <a class="idref" href="clutch.prob.couplings.html#p:98"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <span class="id" title="var">g</span> <a class="idref" href="clutch.prob.couplings.html#p:98"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.2'"><span class="id" title="notation">.2</span></a> <span class="id" title="var">b'</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Heq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> (<span class="id" title="var">a</span> &amp; <span class="id" title="var">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">HCh</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <span class="id" title="keyword">as</span> (<span class="id" title="var">HChL</span> &amp; <span class="id" title="var">HChR</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">HChR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a> //. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="clutch.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Heq2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.countable_sum.html#fubini_pos_seriesC_prod_rl"><span class="id" title="lemma">fubini_pos_seriesC_prod_rl</span></a> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_pos"><span class="id" title="lemma">Rmult_le_pos</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id" title="tactic">apply</span> (<a class="idref" href="clutch.prob.countable_sum.html#ex_seriesC_le"><span class="id" title="lemma">ex_seriesC_le</span></a> <span class="id" title="var">_</span> <span class="id" title="var">μ</span>); [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">split</span>; [<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_pos"><span class="id" title="lemma">Rmult_le_pos</span></a>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -{2}(<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rmult_1_r"><span class="id" title="lemma">Rmult_1_r</span></a> (<span class="id" title="var">μ</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_compat"><span class="id" title="lemma">Rmult_le_compat</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="b:105" class="idref" href="#b:105"><span class="id" title="binder">b</span></a> : <a class="idref" href="clutch.prob.couplings.html#ex_coupl.B"><span class="id" title="variable">B</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a:106" class="idref" href="#a:106"><span class="id" title="binder">a</span></a> : <a class="idref" href="clutch.prob.couplings.html#ex_coupl.A"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.prob.couplings.html#a:103"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.couplings.html#b:102"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <span class="id" title="var">g</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.prob.couplings.html#a:103"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.couplings.html#b:102"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.2'"><span class="id" title="notation">.2</span></a> <span class="id" title="var">b'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a:107" class="idref" href="#a:107"><span class="id" title="binder">a</span></a> : <a class="idref" href="clutch.prob.couplings.html#ex_coupl.A"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.prob.couplings.html#a:104"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.couplings.html#b:102"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> ) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <span class="id" title="var">g</span> <a class="idref" href="clutch.prob.couplings.html#b:102"><span class="id" title="variable">b</span></a> <span class="id" title="var">b'</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Heq3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span> <span class="id" title="var">b</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC_scal_r"><span class="id" title="lemma">SeriesC_scal_r</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="clutch.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Heq3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="b:110" class="idref" href="#b:110"><span class="id" title="binder">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a:111" class="idref" href="#a:111"><span class="id" title="binder">a</span></a> : <a class="idref" href="clutch.prob.couplings.html#ex_coupl.A"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.prob.couplings.html#a:109"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.couplings.html#b:108"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">μ2</span> <a class="idref" href="clutch.prob.couplings.html#b:108"><span class="id" title="variable">b</span></a>) <span class="id" title="keyword">as</span> <span class="id" title="var">Heq4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hμ</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">Hμ1</span> &amp; <span class="id" title="var">Hμ2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">Hμ2</span> <a class="idref" href="clutch.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a> //. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">b</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heq4</span> //.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="clutch.prob.couplings.html#ex_coupl"><span class="id" title="section">ex_coupl</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="is_Rcoupl" class="idref" href="#is_Rcoupl"><span class="id" title="section">is_Rcoupl</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H:114" class="idref" href="#H:114"><span class="id" title="binder">Countable</span></a> <a id="H:114" class="idref" href="#H:114"><span class="id" title="binder">A</span></a>, <a id="H0:117" class="idref" href="#H0:117"><span class="id" title="binder">Countable</span></a> <a id="H0:117" class="idref" href="#H0:117"><span class="id" title="binder">B</span></a>}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="is_Rcoupl_dret" class="idref" href="#is_Rcoupl_dret"><span class="id" title="lemma">is_Rcoupl_dret</span></a> (<a id="a:118" class="idref" href="#a:118"><span class="id" title="binder">a</span></a> : <a class="idref" href="clutch.prob.couplings.html#is_Rcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="b:119" class="idref" href="#b:119"><span class="id" title="binder">b</span></a> : <a class="idref" href="clutch.prob.couplings.html#is_Rcoupl.B"><span class="id" title="variable">B</span></a>) (<a id="R:120" class="idref" href="#R:120"><span class="id" title="binder">R</span></a> : <a class="idref" href="clutch.prob.couplings.html#is_Rcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#is_Rcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#R:120"><span class="id" title="variable">R</span></a> <a class="idref" href="clutch.prob.couplings.html#a:118"><span class="id" title="variable">a</span></a> <a class="idref" href="clutch.prob.couplings.html#b:119"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#is_Rcoupl"><span class="id" title="definition">is_Rcoupl</span></a> (<a class="idref" href="clutch.prob.distribution.html#dret"><span class="id" title="definition">dret</span></a> <a class="idref" href="clutch.prob.couplings.html#a:118"><span class="id" title="variable">a</span></a>) (<a class="idref" href="clutch.prob.distribution.html#dret"><span class="id" title="definition">dret</span></a> <a class="idref" href="clutch.prob.couplings.html#b:119"><span class="id" title="variable">b</span></a>) <a class="idref" href="clutch.prob.couplings.html#R:120"><span class="id" title="variable">R</span></a> (<a class="idref" href="clutch.prob.distribution.html#dret"><span class="id" title="definition">dret</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.prob.couplings.html#a:118"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.couplings.html#b:119"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.couplings.html#is_coupl_dret"><span class="id" title="lemma">is_coupl_dret</span></a>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">intros</span> [? ?] [=-&gt; -&gt;]%<a class="idref" href="clutch.prob.distribution.html#dret_pos"><span class="id" title="lemma">dret_pos</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="clutch.prob.couplings.html#is_Rcoupl"><span class="id" title="section">is_Rcoupl</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="Rcoupl" class="idref" href="#Rcoupl"><span class="id" title="section">Rcoupl</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H:123" class="idref" href="#H:123"><span class="id" title="binder">Countable</span></a> <a id="H:123" class="idref" href="#H:123"><span class="id" title="binder">A</span></a>, <a id="H0:126" class="idref" href="#H0:126"><span class="id" title="binder">Countable</span></a> <a id="H0:126" class="idref" href="#H0:126"><span class="id" title="binder">B</span></a>}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_dret" class="idref" href="#Rcoupl_dret"><span class="id" title="lemma">Rcoupl_dret</span></a> (<a id="a:127" class="idref" href="#a:127"><span class="id" title="binder">a</span></a> : <a class="idref" href="clutch.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="b:128" class="idref" href="#b:128"><span class="id" title="binder">b</span></a> : <a class="idref" href="clutch.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a>) (<a id="R:129" class="idref" href="#R:129"><span class="id" title="binder">R</span></a> : <a class="idref" href="clutch.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#R:129"><span class="id" title="variable">R</span></a> <a class="idref" href="clutch.prob.couplings.html#a:127"><span class="id" title="variable">a</span></a> <a class="idref" href="clutch.prob.couplings.html#b:128"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> (<a class="idref" href="clutch.prob.distribution.html#dret"><span class="id" title="definition">dret</span></a> <a class="idref" href="clutch.prob.couplings.html#a:127"><span class="id" title="variable">a</span></a>) (<a class="idref" href="clutch.prob.distribution.html#dret"><span class="id" title="definition">dret</span></a> <a class="idref" href="clutch.prob.couplings.html#b:128"><span class="id" title="variable">b</span></a>) <a class="idref" href="clutch.prob.couplings.html#R:129"><span class="id" title="variable">R</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.couplings.html#is_Rcoupl_dret"><span class="id" title="lemma">is_Rcoupl_dret</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_mass_eq" class="idref" href="#Rcoupl_mass_eq"><span class="id" title="lemma">Rcoupl_mass_eq</span></a> (<a id="b8bf3baa97fa7f3f8fe6fc4584fa84fd" class="idref" href="#b8bf3baa97fa7f3f8fe6fc4584fa84fd"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="d3960bb7e0e9a9643c4a5bbd75f670c4" class="idref" href="#d3960bb7e0e9a9643c4a5bbd75f670c4"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a>) (<a id="R:132" class="idref" href="#R:132"><span class="id" title="binder">R</span></a> : <a class="idref" href="clutch.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#b8bf3baa97fa7f3f8fe6fc4584fa84fd"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#d3960bb7e0e9a9643c4a5bbd75f670c4"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.couplings.html#R:132"><span class="id" title="variable">R</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="clutch.prob.couplings.html#b8bf3baa97fa7f3f8fe6fc4584fa84fd"><span class="id" title="variable">μ1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="clutch.prob.couplings.html#d3960bb7e0e9a9643c4a5bbd75f670c4"><span class="id" title="variable">μ2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> (?&amp;?&amp;?). <span class="id" title="tactic">by</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="clutch.prob.couplings.html#is_coupl_mass_eq"><span class="id" title="lemma">is_coupl_mass_eq</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_eq" class="idref" href="#Rcoupl_eq"><span class="id" title="lemma">Rcoupl_eq</span></a> (<a id="c418be2bb336445c839cc5afe0dda269" class="idref" href="#c418be2bb336445c839cc5afe0dda269"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a>) : <a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#c418be2bb336445c839cc5afe0dda269"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#c418be2bb336445c839cc5afe0dda269"><span class="id" title="variable">μ1</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#924fd3758233021bbb7af913c6a625ce"><span class="id" title="notation">(=)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<a class="idref" href="clutch.prob.distribution.html#ddiag"><span class="id" title="definition">ddiag</span></a> <span class="id" title="var">μ1</span>); <span class="id" title="tactic">repeat</span> <span class="id" title="var">split_and</span>!.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.distribution.html#distr_ext"><span class="id" title="lemma">distr_ext</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.distribution.html#lmarg_pmf"><span class="id" title="lemma">lmarg_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> {1}/<a class="idref" href="clutch.prob.distribution.html#pmf"><span class="id" title="projection">pmf</span></a>/=/<a class="idref" href="clutch.prob.distribution.html#dbind_pmf"><span class="id" title="definition">dbind_pmf</span></a>/=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC_singleton'"><span class="id" title="lemma">SeriesC_singleton'</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.distribution.html#distr_ext"><span class="id" title="lemma">distr_ext</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> {1}/<a class="idref" href="clutch.prob.distribution.html#pmf"><span class="id" title="projection">pmf</span></a>/=/<a class="idref" href="clutch.prob.distribution.html#dbind_pmf"><span class="id" title="definition">dbind_pmf</span></a>/=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="clutch.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a0:136" class="idref" href="#a0:136"><span class="id" title="binder">a0</span></a> : <a class="idref" href="clutch.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.decidable.html#bool_decide"><span class="id" title="definition">bool_decide</span></a> (<a class="idref" href="clutch.prob.couplings.html#a0:134"><span class="id" title="variable">a0</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">a</span>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <span class="id" title="var">μ1</span> <span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> 0));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC_singleton"><span class="id" title="lemma">SeriesC_singleton</span></a> //| ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">a'</span>; <span class="id" title="var">case_bool_decide</span>; <span class="id" title="tactic">by</span> <span class="id" title="var">simplify_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> (<span class="id" title="var">a1</span> &amp; <span class="id" title="var">a2</span>) <span class="id" title="var">Hpos</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.prob.distribution.html#pmf"><span class="id" title="projection">pmf</span></a>/= <span class="id" title="tactic">in</span> <span class="id" title="var">Hpos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_bool_decide</span>; <span class="id" title="var">simplify_eq</span>=&gt;//. <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_dbind" class="idref" href="#Rcoupl_dbind"><span class="id" title="lemma">Rcoupl_dbind</span></a> `{<a id="H1:139" class="idref" href="#H1:139"><span class="id" title="binder">Countable</span></a> <a id="H1:139" class="idref" href="#H1:139"><span class="id" title="binder">A'</span></a>, <a id="H2:142" class="idref" href="#H2:142"><span class="id" title="binder">Countable</span></a> <a id="H2:142" class="idref" href="#H2:142"><span class="id" title="binder">B'</span></a>} (<a id="f:143" class="idref" href="#f:143"><span class="id" title="binder">f</span></a> : <a class="idref" href="clutch.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#A':137"><span class="id" title="variable">A'</span></a>) (<a id="g:144" class="idref" href="#g:144"><span class="id" title="binder">g</span></a> : <a class="idref" href="clutch.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#B':140"><span class="id" title="variable">B'</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="2a307783bc552bc3bf524a3c95b5ffd1" class="idref" href="#2a307783bc552bc3bf524a3c95b5ffd1"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="a3fe3de4fa103db9b0aac25d072853fc" class="idref" href="#a3fe3de4fa103db9b0aac25d072853fc"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a>) (<a id="R:147" class="idref" href="#R:147"><span class="id" title="binder">R</span></a> : <a class="idref" href="clutch.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) (<a id="S:148" class="idref" href="#S:148"><span class="id" title="binder">S</span></a> : <a class="idref" href="clutch.prob.couplings.html#A':137"><span class="id" title="variable">A'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#B':140"><span class="id" title="variable">B'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="a:149" class="idref" href="#a:149"><span class="id" title="binder">a</span></a> <a id="b:150" class="idref" href="#b:150"><span class="id" title="binder">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.couplings.html#R:147"><span class="id" title="variable">R</span></a> <a class="idref" href="clutch.prob.couplings.html#a:149"><span class="id" title="variable">a</span></a> <a class="idref" href="clutch.prob.couplings.html#b:150"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> (<a class="idref" href="clutch.prob.couplings.html#f:143"><span class="id" title="variable">f</span></a> <a class="idref" href="clutch.prob.couplings.html#a:149"><span class="id" title="variable">a</span></a>) (<a class="idref" href="clutch.prob.couplings.html#g:144"><span class="id" title="variable">g</span></a> <a class="idref" href="clutch.prob.couplings.html#b:150"><span class="id" title="variable">b</span></a>) <a class="idref" href="clutch.prob.couplings.html#S:148"><span class="id" title="variable">S</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#2a307783bc552bc3bf524a3c95b5ffd1"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#a3fe3de4fa103db9b0aac25d072853fc"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.couplings.html#R:147"><span class="id" title="variable">R</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> (<a class="idref" href="clutch.prob.couplings.html#2a307783bc552bc3bf524a3c95b5ffd1"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.distribution.html#1ec27ecb4da8da3d3cbd85a2394dc835"><span class="id" title="notation">≫=</span></a> <a class="idref" href="clutch.prob.couplings.html#f:143"><span class="id" title="variable">f</span></a>) (<a class="idref" href="clutch.prob.couplings.html#a3fe3de4fa103db9b0aac25d072853fc"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.distribution.html#1ec27ecb4da8da3d3cbd85a2394dc835"><span class="id" title="notation">≫=</span></a> <a class="idref" href="clutch.prob.couplings.html#g:144"><span class="id" title="variable">g</span></a>) <a class="idref" href="clutch.prob.couplings.html#S:148"><span class="id" title="variable">S</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hfg</span> (<span class="id" title="var">μ</span> &amp; <span class="id" title="var">HμC</span> &amp; <span class="id" title="var">HμS</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> /<a class="idref" href="clutch.prob.couplings.html#is_Rcoupl"><span class="id" title="definition">is_Rcoupl</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hfg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;First&nbsp;we&nbsp;rewrite&nbsp;Hfg&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;use&nbsp;Choice&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="p:154" class="idref" href="#p:154"><span class="id" title="binder">p</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a id="8f456d39e888555d4388cc1ddd01e42e" class="idref" href="#8f456d39e888555d4388cc1ddd01e42e"><span class="id" title="binder">μ'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a> <span class="id" title="var">R</span> <a class="idref" href="clutch.prob.couplings.html#p:151"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="clutch.prob.couplings.html#p:151"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.2'"><span class="id" title="notation">.2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.prob.couplings.html#is_coupl"><span class="id" title="definition">is_coupl</span></a> (<span class="id" title="var">f</span> <a class="idref" href="clutch.prob.couplings.html#p:151"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.1'"><span class="id" title="notation">.1</span></a>) (<span class="id" title="var">g</span> <a class="idref" href="clutch.prob.couplings.html#p:151"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.2'"><span class="id" title="notation">.2</span></a>) <a class="idref" href="clutch.prob.couplings.html#2ccab5d508b226c2c6cc0a530d7df160"><span class="id" title="variable">μ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="q:156" class="idref" href="#q:156"><span class="id" title="binder">q</span></a> : <span class="id" title="var">A'</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <span class="id" title="var">B'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.couplings.html#2ccab5d508b226c2c6cc0a530d7df160"><span class="id" title="variable">μ'</span></a> <a class="idref" href="clutch.prob.couplings.html#q:153"><span class="id" title="variable">q</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="var">S</span> <a class="idref" href="clutch.prob.couplings.html#q:153"><span class="id" title="variable">q</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="clutch.prob.couplings.html#q:153"><span class="id" title="variable">q</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.2'"><span class="id" title="notation">.2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> <span class="id" title="var">Hfg'</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">HμS</span> <span class="id" title="var">p</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hfg</span> <span class="id" title="var">p</span><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.1'"><span class="id" title="notation">.1</span></a> <span class="id" title="var">p</span><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.2'"><span class="id" title="notation">.2</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="clutch.prelude.classical.html#ExcludedMiddle"><span class="id" title="lemma">ExcludedMiddle</span></a> (<span class="id" title="var">R</span> <span class="id" title="var">p</span><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.1'"><span class="id" title="notation">.1</span></a> <span class="id" title="var">p</span><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.2'"><span class="id" title="notation">.2</span></a>)) <span class="id" title="keyword">as</span> <span class="id" title="var">H3</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">HR</span> | <span class="id" title="var">HnR</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hfg</span> <span class="id" title="var">HR</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hfg</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">μ'</span> &amp; <span class="id" title="var">Hμ'1</span> &amp; <span class="id" title="var">Hμ'2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">μ'</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exists</span> <a class="idref" href="clutch.prob.distribution.html#dzero"><span class="id" title="definition">dzero</span></a>; <span class="id" title="tactic">intro</span> ; <span class="id" title="var">done</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Logic.ClassicalEpsilon.html#choice"><span class="id" title="lemma">ClassicalEpsilon.choice</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hfg'</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">Ch</span> &amp; <span class="id" title="var">Hch</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> /<a class="idref" href="clutch.prob.couplings.html#is_Rcoupl"><span class="id" title="definition">is_Rcoupl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<a class="idref" href="clutch.prob.distribution.html#dbind"><span class="id" title="definition">dbind</span></a> <span class="id" title="var">Ch</span> <span class="id" title="var">μ</span>); <span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;To&nbsp;prove&nbsp;that&nbsp;the&nbsp;marginal&nbsp;coincides&nbsp;is&nbsp;a&nbsp;matter&nbsp;of&nbsp;rearranging&nbsp;the&nbsp;sums&nbsp;and&nbsp;using&nbsp;the<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fact&nbsp;that&nbsp;μ&nbsp;and&nbsp;(Ch&nbsp;p)&nbsp;are&nbsp;couplings&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.distribution.html#distr_ext"><span class="id" title="lemma">distr_ext</span></a>; <span class="id" title="tactic">intro</span> <span class="id" title="var">a'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.distribution.html#lmarg_pmf"><span class="id" title="lemma">lmarg_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> {1 2}/<a class="idref" href="clutch.prob.distribution.html#pmf"><span class="id" title="projection">pmf</span></a>/=/<a class="idref" href="clutch.prob.distribution.html#dbind_pmf"><span class="id" title="definition">dbind_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="clutch.prob.distribution.html#distr_double_swap_lmarg"><span class="id" title="lemma">distr_double_swap_lmarg</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">setoid_rewrite</span> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC_scal_l"><span class="id" title="lemma">SeriesC_scal_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> (<a class="idref" href="clutch.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="p:160" class="idref" href="#p:160"><span class="id" title="binder">p</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="var">μ</span> <a class="idref" href="clutch.prob.couplings.html#p:157"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <span class="id" title="var">f</span> <a class="idref" href="clutch.prob.couplings.html#p:157"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.1'"><span class="id" title="notation">.1</span></a> <span class="id" title="var">a'</span>)); <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> (<span class="id" title="var">a</span> &amp; <span class="id" title="var">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rtotal_order"><span class="id" title="lemma">Rtotal_order</span></a> (<span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) 0) <span class="id" title="keyword">as</span> [<span class="id" title="var">Hlt</span> | [<span class="id" title="var">Heqz</span> | <span class="id" title="var">Hgt</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="clutch.prob.distribution.html#pmf_pos"><span class="id" title="projection">pmf_pos</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>); <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heqz</span>; <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hch</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> (<span class="id" title="var">HμS</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="var">Hgt</span> )) <span class="id" title="keyword">as</span> ((<span class="id" title="var">HChL</span> &amp; <span class="id" title="var">HChR</span>) &amp; <span class="id" title="var">HChS</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">HChL</span> <a class="idref" href="clutch.prob.distribution.html#lmarg_pmf"><span class="id" title="lemma">lmarg_pmf</span></a> //=. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.countable_sum.html#fubini_pos_seriesC_prod_lr"><span class="id" title="lemma">fubini_pos_seriesC_prod_lr</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: { <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_pos"><span class="id" title="lemma">Rmult_le_pos</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: { <span class="id" title="tactic">apply</span> (<a class="idref" href="clutch.prob.countable_sum.html#ex_seriesC_le"><span class="id" title="lemma">ex_seriesC_le</span></a> <span class="id" title="var">_</span> <span class="id" title="var">μ</span>); [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">split</span>; [<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_pos"><span class="id" title="lemma">Rmult_le_pos</span></a>| ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rmult_1_r"><span class="id" title="lemma">Rmult_1_r</span></a>; <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_compat"><span class="id" title="lemma">Rmult_le_compat</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> (<a class="idref" href="clutch.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a:167" class="idref" href="#a:167"><span class="id" title="binder">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="b:168" class="idref" href="#b:168"><span class="id" title="binder">b</span></a> : <a class="idref" href="clutch.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.prob.couplings.html#a:161"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.couplings.html#b:162"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> ) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <span class="id" title="var">f</span> <a class="idref" href="clutch.prob.couplings.html#a:161"><span class="id" title="variable">a</span></a> <span class="id" title="var">a'</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[| <span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC_scal_r"><span class="id" title="lemma">SeriesC_scal_r</span></a> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> (<a class="idref" href="clutch.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a:172" class="idref" href="#a:172"><span class="id" title="binder">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">(</span></a><span class="id" title="var">μ1</span> <a class="idref" href="clutch.prob.couplings.html#a:169"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <span class="id" title="var">f</span> <a class="idref" href="clutch.prob.couplings.html#a:169"><span class="id" title="variable">a</span></a> <span class="id" title="var">a'</span>)); [<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">HμC</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">Hμ1</span> &amp; <span class="id" title="var">Hμ2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">Hμ1</span> <a class="idref" href="clutch.prob.distribution.html#lmarg_pmf"><span class="id" title="lemma">lmarg_pmf</span></a> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.distribution.html#distr_ext"><span class="id" title="lemma">distr_ext</span></a>; <span class="id" title="tactic">intro</span> <span class="id" title="var">b'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> {1 2}/<a class="idref" href="clutch.prob.distribution.html#pmf"><span class="id" title="projection">pmf</span></a>/=/<a class="idref" href="clutch.prob.distribution.html#dbind_pmf"><span class="id" title="definition">dbind_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="clutch.prob.distribution.html#distr_double_swap_rmarg"><span class="id" title="lemma">distr_double_swap_rmarg</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">setoid_rewrite</span> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC_scal_l"><span class="id" title="lemma">SeriesC_scal_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> (<a class="idref" href="clutch.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="p:176" class="idref" href="#p:176"><span class="id" title="binder">p</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="var">μ</span> <a class="idref" href="clutch.prob.couplings.html#p:173"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <span class="id" title="var">g</span> <a class="idref" href="clutch.prob.couplings.html#p:173"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.2'"><span class="id" title="notation">.2</span></a> <span class="id" title="var">b'</span>)); <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> (<span class="id" title="var">a</span> &amp; <span class="id" title="var">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rtotal_order"><span class="id" title="lemma">Rtotal_order</span></a> (<span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) 0) <span class="id" title="keyword">as</span> [<span class="id" title="var">Hlt</span> | [<span class="id" title="var">Heqz</span> | <span class="id" title="var">Hgt</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="clutch.prob.distribution.html#pmf_pos"><span class="id" title="projection">pmf_pos</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>); <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heqz</span>. <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hch</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> (<span class="id" title="var">HμS</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="var">Hgt</span>)) <span class="id" title="keyword">as</span> ((<span class="id" title="var">HChL</span> &amp; <span class="id" title="var">HChR</span>) &amp; <span class="id" title="var">HChS</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">HChR</span> <a class="idref" href="clutch.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a> //=. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.countable_sum.html#fubini_pos_seriesC_prod_rl"><span class="id" title="lemma">fubini_pos_seriesC_prod_rl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: { <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_pos"><span class="id" title="lemma">Rmult_le_pos</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: { <span class="id" title="tactic">apply</span> (<a class="idref" href="clutch.prob.countable_sum.html#ex_seriesC_le"><span class="id" title="lemma">ex_seriesC_le</span></a> <span class="id" title="var">_</span> <span class="id" title="var">μ</span>); [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">split</span>; [<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_pos"><span class="id" title="lemma">Rmult_le_pos</span></a>| ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rmult_1_r"><span class="id" title="lemma">Rmult_1_r</span></a>; <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_compat"><span class="id" title="lemma">Rmult_le_compat</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> (<a class="idref" href="clutch.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="b:183" class="idref" href="#b:183"><span class="id" title="binder">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a:184" class="idref" href="#a:184"><span class="id" title="binder">a</span></a> : <a class="idref" href="clutch.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.prob.couplings.html#a:178"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.couplings.html#b:177"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> ) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <span class="id" title="var">g</span> <a class="idref" href="clutch.prob.couplings.html#b:177"><span class="id" title="variable">b</span></a> <span class="id" title="var">b'</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ | <span class="id" title="tactic">intro</span> <span class="id" title="var">b</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC_scal_r"><span class="id" title="lemma">SeriesC_scal_r</span></a>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> (<a class="idref" href="clutch.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="b:188" class="idref" href="#b:188"><span class="id" title="binder">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">(</span></a><span class="id" title="var">μ2</span> <a class="idref" href="clutch.prob.couplings.html#b:185"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <span class="id" title="var">g</span> <a class="idref" href="clutch.prob.couplings.html#b:185"><span class="id" title="variable">b</span></a> <span class="id" title="var">b'</span>)); [<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">HμC</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">Hμ1</span> &amp; <span class="id" title="var">Hμ2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">Hμ2</span> <a class="idref" href="clutch.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> (<span class="id" title="var">a'</span> &amp; <span class="id" title="var">b'</span>) <span class="id" title="var">H3</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="clutch.prob.distribution.html#dbind_pos"><span class="id" title="lemma">dbind_pos</span></a> <span class="id" title="var">Ch</span> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <span class="id" title="keyword">as</span> (<span class="id" title="var">H4</span> &amp; <span class="id" title="var">H5</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">H4</span> <span class="id" title="var">H3</span>) <span class="id" title="keyword">as</span> ((<span class="id" title="var">a0</span>, <span class="id" title="var">b0</span>) &amp; <span class="id" title="var">H7</span> &amp; <span class="id" title="var">H8</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hch</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a0</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b0</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> (<span class="id" title="var">HμS</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a0</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b0</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="var">H8</span>)) <span class="id" title="keyword">as</span> (<span class="id" title="var">HCh1</span> &amp; <span class="id" title="var">HCh2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">HCh2</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="var">H7</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_eq_elim" class="idref" href="#Rcoupl_eq_elim"><span class="id" title="lemma">Rcoupl_eq_elim</span></a> (<a id="66461ca543875df23de53cd36279bab8" class="idref" href="#66461ca543875df23de53cd36279bab8"><span class="id" title="binder">μ1</span></a> <a id="4c25204a8af0e352e9430e8c6811f4a4" class="idref" href="#4c25204a8af0e352e9430e8c6811f4a4"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#66461ca543875df23de53cd36279bab8"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#4c25204a8af0e352e9430e8c6811f4a4"><span class="id" title="variable">μ2</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#924fd3758233021bbb7af913c6a625ce"><span class="id" title="notation">(=)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#66461ca543875df23de53cd36279bab8"><span class="id" title="variable">μ1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.prob.couplings.html#4c25204a8af0e352e9430e8c6811f4a4"><span class="id" title="variable">μ2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> (<span class="id" title="var">μ</span> &amp; (<span class="id" title="var">HμL</span> &amp; <span class="id" title="var">HμR</span>) &amp; <span class="id" title="var">HμS</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">HμL</span>, &lt;- <span class="id" title="var">HμR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.distribution.html#distr_ext"><span class="id" title="lemma">distr_ext</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">a1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.distribution.html#lmarg_pmf"><span class="id" title="lemma">lmarg_pmf</span></a> <a class="idref" href="clutch.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">a2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">HμS</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">a2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <span class="id" title="keyword">as</span> <span class="id" title="var">HμS12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">HμS</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">a1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <span class="id" title="keyword">as</span> <span class="id" title="var">HμS21</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HμS12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HμS21</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rtotal_order"><span class="id" title="lemma">Rtotal_order</span></a> (<span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">a2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) (<span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">a1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>)) <span class="id" title="keyword">as</span> [<span class="id" title="var">Hlt</span> | [<span class="id" title="var">Heq</span> | <span class="id" title="var">Hgt</span>]]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="clutch.prob.distribution.html#pmf_pos"><span class="id" title="projection">pmf_pos</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">a2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">a1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> 0) <span class="id" title="keyword">as</span> <span class="id" title="var">H'</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">HμS21</span> <span class="id" title="var">H'</span>); <span class="id" title="tactic">destruct</span> <span class="id" title="var">HμS21</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="clutch.prob.distribution.html#pmf_pos"><span class="id" title="projection">pmf_pos</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">a1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">a2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> 0) <span class="id" title="keyword">as</span> <span class="id" title="var">H'</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">HμS12</span> <span class="id" title="var">H'</span>); <span class="id" title="tactic">destruct</span> <span class="id" title="var">HμS12</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_eq_sym" class="idref" href="#Rcoupl_eq_sym"><span class="id" title="lemma">Rcoupl_eq_sym</span></a> (<a id="96b8be24b26f80e6b33d2c47bf6177a9" class="idref" href="#96b8be24b26f80e6b33d2c47bf6177a9"><span class="id" title="binder">μ1</span></a> <a id="9766a17a7b4ce16be928ed8a2c739898" class="idref" href="#9766a17a7b4ce16be928ed8a2c739898"><span class="id" title="binder">μ2</span></a>: <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#96b8be24b26f80e6b33d2c47bf6177a9"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#9766a17a7b4ce16be928ed8a2c739898"><span class="id" title="variable">μ2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#9766a17a7b4ce16be928ed8a2c739898"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.couplings.html#96b8be24b26f80e6b33d2c47bf6177a9"><span class="id" title="variable">μ1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.couplings.html#Rcoupl_eq_elim"><span class="id" title="lemma">Rcoupl_eq_elim</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hc</span> <span class="id" title="keyword">as</span> -&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.couplings.html#Rcoupl_eq"><span class="id" title="lemma">Rcoupl_eq</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_eq_trans" class="idref" href="#Rcoupl_eq_trans"><span class="id" title="lemma">Rcoupl_eq_trans</span></a> (<a id="b7c9010185607449d8ee92fb0f5572b2" class="idref" href="#b7c9010185607449d8ee92fb0f5572b2"><span class="id" title="binder">μ1</span></a> <a id="1a4ba3d7b1bece9c927f57d4379e3b06" class="idref" href="#1a4ba3d7b1bece9c927f57d4379e3b06"><span class="id" title="binder">μ2</span></a> <a id="88c4b5eb11a5bf0e22af0f5232b19401" class="idref" href="#88c4b5eb11a5bf0e22af0f5232b19401"><span class="id" title="binder">μ3</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#b7c9010185607449d8ee92fb0f5572b2"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#1a4ba3d7b1bece9c927f57d4379e3b06"><span class="id" title="variable">μ2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#1a4ba3d7b1bece9c927f57d4379e3b06"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.couplings.html#88c4b5eb11a5bf0e22af0f5232b19401"><span class="id" title="variable">μ3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#b7c9010185607449d8ee92fb0f5572b2"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#88c4b5eb11a5bf0e22af0f5232b19401"><span class="id" title="variable">μ3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">intros</span> -&gt;%<a class="idref" href="clutch.prob.couplings.html#Rcoupl_eq_elim"><span class="id" title="lemma">Rcoupl_eq_elim</span></a> ?. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_mono" class="idref" href="#Rcoupl_mono"><span class="id" title="lemma">Rcoupl_mono</span></a> (<a id="8736699ef8ba2f96d003fc4c30a45131" class="idref" href="#8736699ef8ba2f96d003fc4c30a45131"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="7aaaba77fb57c76a1597b19a072bafc2" class="idref" href="#7aaaba77fb57c76a1597b19a072bafc2"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a>) (<a id="R:198" class="idref" href="#R:198"><span class="id" title="binder">R</span></a> : <a class="idref" href="clutch.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) (<a id="S:199" class="idref" href="#S:199"><span class="id" title="binder">S</span></a> : <a class="idref" href="clutch.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#8736699ef8ba2f96d003fc4c30a45131"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#7aaaba77fb57c76a1597b19a072bafc2"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.couplings.html#R:198"><span class="id" title="variable">R</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="a:200" class="idref" href="#a:200"><span class="id" title="binder">a</span></a> <a id="b:201" class="idref" href="#b:201"><span class="id" title="binder">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.couplings.html#R:198"><span class="id" title="variable">R</span></a> <a class="idref" href="clutch.prob.couplings.html#a:200"><span class="id" title="variable">a</span></a> <a class="idref" href="clutch.prob.couplings.html#b:201"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#S:199"><span class="id" title="variable">S</span></a> <a class="idref" href="clutch.prob.couplings.html#a:200"><span class="id" title="variable">a</span></a> <a class="idref" href="clutch.prob.couplings.html#b:201"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#8736699ef8ba2f96d003fc4c30a45131"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#7aaaba77fb57c76a1597b19a072bafc2"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.couplings.html#S:199"><span class="id" title="variable">S</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">μ</span> [[<span class="id" title="var">HμL</span> <span class="id" title="var">HμR</span>] <span class="id" title="var">HμSupp</span>]] <span class="id" title="var">Hwk</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">μ</span>; <span class="id" title="tactic">split</span>; [<span class="id" title="tactic">split</span>| ]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_inhabited_l" class="idref" href="#Rcoupl_inhabited_l"><span class="id" title="lemma">Rcoupl_inhabited_l</span></a> (<a id="68ebaa1c457f3016f01aba4bdd9ea4b1" class="idref" href="#68ebaa1c457f3016f01aba4bdd9ea4b1"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="1a01a769fe0a72126562b20f533d1044" class="idref" href="#1a01a769fe0a72126562b20f533d1044"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a>) <a id="R:204" class="idref" href="#R:204"><span class="id" title="binder">R</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#68ebaa1c457f3016f01aba4bdd9ea4b1"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#1a01a769fe0a72126562b20f533d1044"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.couplings.html#R:204"><span class="id" title="variable">R</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="clutch.prob.couplings.html#68ebaa1c457f3016f01aba4bdd9ea4b1"><span class="id" title="variable">μ1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a id="a:205" class="idref" href="#a:205"><span class="id" title="binder">a</span></a> <a id="b:206" class="idref" href="#b:206"><span class="id" title="binder">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.couplings.html#R:204"><span class="id" title="variable">R</span></a> <a class="idref" href="clutch.prob.couplings.html#a:205"><span class="id" title="variable">a</span></a> <a class="idref" href="clutch.prob.couplings.html#b:206"><span class="id" title="variable">b</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">μ</span> [<span class="id" title="var">Hcpl</span> <span class="id" title="var">HR</span>]] <span class="id" title="var">Hz</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> 0) <span class="id" title="keyword">as</span> <span class="id" title="var">Hsup</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">by</span> <span class="id" title="var">erewrite</span> <a class="idref" href="clutch.prob.couplings.html#is_coupl_mass_l"><span class="id" title="lemma">is_coupl_mass_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC_gtz_ex"><span class="id" title="lemma">SeriesC_gtz_ex</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hsup</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">a</span> <span class="id" title="var">b</span>] <span class="id" title="var">Hμ</span>]; [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_inhabited_r" class="idref" href="#Rcoupl_inhabited_r"><span class="id" title="lemma">Rcoupl_inhabited_r</span></a> (<a id="f90d02d89ec6df98a3ee3b7f0ecf9226" class="idref" href="#f90d02d89ec6df98a3ee3b7f0ecf9226"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="0c44533006fa420d7557c35892791d6e" class="idref" href="#0c44533006fa420d7557c35892791d6e"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a>) <a id="R:209" class="idref" href="#R:209"><span class="id" title="binder">R</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#f90d02d89ec6df98a3ee3b7f0ecf9226"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#0c44533006fa420d7557c35892791d6e"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.couplings.html#R:209"><span class="id" title="variable">R</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="clutch.prob.couplings.html#0c44533006fa420d7557c35892791d6e"><span class="id" title="variable">μ2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a id="a:210" class="idref" href="#a:210"><span class="id" title="binder">a</span></a> <a id="b:211" class="idref" href="#b:211"><span class="id" title="binder">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.couplings.html#R:209"><span class="id" title="variable">R</span></a> <a class="idref" href="clutch.prob.couplings.html#a:210"><span class="id" title="variable">a</span></a> <a class="idref" href="clutch.prob.couplings.html#b:211"><span class="id" title="variable">b</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">μ</span> [<span class="id" title="var">Hcpl</span> <span class="id" title="var">HR</span>]] <span class="id" title="var">Hz</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> 0) <span class="id" title="keyword">as</span> <span class="id" title="var">Hsup</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">by</span> <span class="id" title="var">erewrite</span> <a class="idref" href="clutch.prob.couplings.html#is_coupl_mass_r"><span class="id" title="lemma">is_coupl_mass_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC_gtz_ex"><span class="id" title="lemma">SeriesC_gtz_ex</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hsup</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">a</span> <span class="id" title="var">b</span>] <span class="id" title="var">Hμ</span>]; [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_trivial" class="idref" href="#Rcoupl_trivial"><span class="id" title="lemma">Rcoupl_trivial</span></a> (<a id="f9b4e3f67f17996f6c0da7914bea1f46" class="idref" href="#f9b4e3f67f17996f6c0da7914bea1f46"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="c991600ac9d28ceb81985dfc2eaf5900" class="idref" href="#c991600ac9d28ceb81985dfc2eaf5900"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a>)    :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="clutch.prob.couplings.html#f9b4e3f67f17996f6c0da7914bea1f46"><span class="id" title="variable">μ1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 1 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="clutch.prob.couplings.html#c991600ac9d28ceb81985dfc2eaf5900"><span class="id" title="variable">μ2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 1 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#f9b4e3f67f17996f6c0da7914bea1f46"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#c991600ac9d28ceb81985dfc2eaf5900"><span class="id" title="variable">μ2</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#::type_scope:'True'"><span class="id" title="notation">True</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hμ1</span> <span class="id" title="var">Hμ2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<a class="idref" href="clutch.prob.distribution.html#dprod"><span class="id" title="definition">dprod</span></a> <span class="id" title="var">μ1</span> <span class="id" title="var">μ2</span>). <span class="id" title="tactic">split</span>; [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.distribution.html#lmarg_dprod"><span class="id" title="lemma">lmarg_dprod</span></a>|<span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.distribution.html#rmarg_dprod"><span class="id" title="lemma">rmarg_dprod</span></a>]; <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_pos_R" class="idref" href="#Rcoupl_pos_R"><span class="id" title="lemma">Rcoupl_pos_R</span></a> (<a id="98bee98729acf3e8fd7146f1b7d39f54" class="idref" href="#98bee98729acf3e8fd7146f1b7d39f54"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="c8a4b632a5a943577e50d5f9c630eaba" class="idref" href="#c8a4b632a5a943577e50d5f9c630eaba"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a>) <a id="R:216" class="idref" href="#R:216"><span class="id" title="binder">R</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#98bee98729acf3e8fd7146f1b7d39f54"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#c8a4b632a5a943577e50d5f9c630eaba"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.couplings.html#R:216"><span class="id" title="variable">R</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#98bee98729acf3e8fd7146f1b7d39f54"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#c8a4b632a5a943577e50d5f9c630eaba"><span class="id" title="variable">μ2</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a:217" class="idref" href="#a:217"><span class="id" title="binder">a</span></a> <a id="b:218" class="idref" href="#b:218"><span class="id" title="binder">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.couplings.html#R:216"><span class="id" title="variable">R</span></a> <a class="idref" href="clutch.prob.couplings.html#a:217"><span class="id" title="variable">a</span></a> <a class="idref" href="clutch.prob.couplings.html#b:218"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="clutch.prob.couplings.html#98bee98729acf3e8fd7146f1b7d39f54"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#a:217"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="clutch.prob.couplings.html#c8a4b632a5a943577e50d5f9c630eaba"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.couplings.html#b:218"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> 0).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">μ</span> [[<span class="id" title="var">Hμ1</span> <span class="id" title="var">Hμ2</span>] <span class="id" title="var">HR</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">μ</span>. <span class="id" title="tactic">split</span>; [<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">a</span> <span class="id" title="var">b</span>] <span class="id" title="var">H</span>ρ. <span class="id" title="tactic">split</span>; [<span class="id" title="tactic">auto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">Hμ1</span> -<span class="id" title="var">Hμ2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2!<a class="idref" href="clutch.prob.distribution.html#dmap_pos"><span class="id" title="lemma">dmap_pos</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_dzero_dzero" class="idref" href="#Rcoupl_dzero_dzero"><span class="id" title="lemma">Rcoupl_dzero_dzero</span></a> (<a id="R:219" class="idref" href="#R:219"><span class="id" title="binder">R</span></a> : <a class="idref" href="clutch.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="clutch.prob.distribution.html#dzero"><span class="id" title="definition">dzero</span></a> <a class="idref" href="clutch.prob.distribution.html#dzero"><span class="id" title="definition">dzero</span></a> <a class="idref" href="clutch.prob.couplings.html#R:219"><span class="id" title="variable">R</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <a class="idref" href="clutch.prob.distribution.html#dzero"><span class="id" title="definition">dzero</span></a>. <span class="id" title="tactic">split</span>; [|<span class="id" title="tactic">intros</span>; <span class="id" title="var">inv_distr</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.distribution.html#lmarg_dzero"><span class="id" title="lemma">lmarg_dzero</span></a>|<span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.distribution.html#rmarg_dzero"><span class="id" title="lemma">rmarg_dzero</span></a>].<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_dzero_r_inv" class="idref" href="#Rcoupl_dzero_r_inv"><span class="id" title="lemma">Rcoupl_dzero_r_inv</span></a> <a id="464fff996cdb350f65d997a3c258ce0a" class="idref" href="#464fff996cdb350f65d997a3c258ce0a"><span class="id" title="binder">μ1</span></a> (<a id="R:221" class="idref" href="#R:221"><span class="id" title="binder">R</span></a> : <a class="idref" href="clutch.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#464fff996cdb350f65d997a3c258ce0a"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.distribution.html#dzero"><span class="id" title="definition">dzero</span></a> <a class="idref" href="clutch.prob.couplings.html#R:221"><span class="id" title="variable">R</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#464fff996cdb350f65d997a3c258ce0a"><span class="id" title="variable">μ1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.prob.distribution.html#dzero"><span class="id" title="definition">dzero</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hz</span>%<a class="idref" href="clutch.prob.couplings.html#Rcoupl_mass_eq"><span class="id" title="lemma">Rcoupl_mass_eq</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.distribution.html#SeriesC_zero_dzero"><span class="id" title="lemma">SeriesC_zero_dzero</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hz</span> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC_0"><span class="id" title="lemma">SeriesC_0</span></a> //.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_dzero_l_inv" class="idref" href="#Rcoupl_dzero_l_inv"><span class="id" title="lemma">Rcoupl_dzero_l_inv</span></a> <a id="0df71311ad82b5370c7d2e45a58e5f08" class="idref" href="#0df71311ad82b5370c7d2e45a58e5f08"><span class="id" title="binder">μ2</span></a> (<a id="R:223" class="idref" href="#R:223"><span class="id" title="binder">R</span></a> : <a class="idref" href="clutch.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="clutch.prob.distribution.html#dzero"><span class="id" title="definition">dzero</span></a> <a class="idref" href="clutch.prob.couplings.html#0df71311ad82b5370c7d2e45a58e5f08"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.couplings.html#R:223"><span class="id" title="variable">R</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#0df71311ad82b5370c7d2e45a58e5f08"><span class="id" title="variable">μ2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.prob.distribution.html#dzero"><span class="id" title="definition">dzero</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hz</span>%<a class="idref" href="clutch.prob.couplings.html#Rcoupl_mass_eq"><span class="id" title="lemma">Rcoupl_mass_eq</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.distribution.html#SeriesC_zero_dzero"><span class="id" title="lemma">SeriesC_zero_dzero</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">Hz</span> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC_0"><span class="id" title="lemma">SeriesC_0</span></a> //.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="section">Rcoupl</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_dmap" class="idref" href="#Rcoupl_dmap"><span class="id" title="lemma">Rcoupl_dmap</span></a> `{<a id="H:226" class="idref" href="#H:226"><span class="id" title="binder">Countable</span></a> <a id="H:226" class="idref" href="#H:226"><span class="id" title="binder">A</span></a>, <a id="H0:229" class="idref" href="#H0:229"><span class="id" title="binder">Countable</span></a> <a id="H0:229" class="idref" href="#H0:229"><span class="id" title="binder">B</span></a>, <a id="H1:232" class="idref" href="#H1:232"><span class="id" title="binder">Countable</span></a> <a id="H1:232" class="idref" href="#H1:232"><span class="id" title="binder">A'</span></a>, <a id="H2:235" class="idref" href="#H2:235"><span class="id" title="binder">Countable</span></a> <a id="H2:235" class="idref" href="#H2:235"><span class="id" title="binder">B'</span></a>}<br/>
&nbsp;&nbsp;(<a id="f:236" class="idref" href="#f:236"><span class="id" title="binder">f</span></a> : <a class="idref" href="clutch.prob.couplings.html#A:224"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#A':230"><span class="id" title="variable">A'</span></a>) (<a id="g:237" class="idref" href="#g:237"><span class="id" title="binder">g</span></a> : <a class="idref" href="clutch.prob.couplings.html#B:227"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#B':233"><span class="id" title="variable">B'</span></a>) (<a id="34fc3ddbbc83e8bc36e9842381b981b4" class="idref" href="#34fc3ddbbc83e8bc36e9842381b981b4"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#A:224"><span class="id" title="variable">A</span></a>) (<a id="eb641882772b9aae0ad0c4bbce6dce3c" class="idref" href="#eb641882772b9aae0ad0c4bbce6dce3c"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#B:227"><span class="id" title="variable">B</span></a>) (<a id="R:240" class="idref" href="#R:240"><span class="id" title="binder">R</span></a> : <a class="idref" href="clutch.prob.couplings.html#A':230"><span class="id" title="variable">A'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#B':233"><span class="id" title="variable">B'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) :<br/>
&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#34fc3ddbbc83e8bc36e9842381b981b4"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#eb641882772b9aae0ad0c4bbce6dce3c"><span class="id" title="variable">μ2</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a:241" class="idref" href="#a:241"><span class="id" title="binder">a</span></a> <a id="a':242" class="idref" href="#a':242"><span class="id" title="binder">a'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.couplings.html#R:240"><span class="id" title="variable">R</span></a> (<a class="idref" href="clutch.prob.couplings.html#f:236"><span class="id" title="variable">f</span></a> <a class="idref" href="clutch.prob.couplings.html#a:241"><span class="id" title="variable">a</span></a>) (<a class="idref" href="clutch.prob.couplings.html#g:237"><span class="id" title="variable">g</span></a> <a class="idref" href="clutch.prob.couplings.html#a':242"><span class="id" title="variable">a'</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> (<a class="idref" href="clutch.prob.distribution.html#dmap"><span class="id" title="definition">dmap</span></a> <a class="idref" href="clutch.prob.couplings.html#f:236"><span class="id" title="variable">f</span></a> <a class="idref" href="clutch.prob.couplings.html#34fc3ddbbc83e8bc36e9842381b981b4"><span class="id" title="variable">μ1</span></a>) (<a class="idref" href="clutch.prob.distribution.html#dmap"><span class="id" title="definition">dmap</span></a> <a class="idref" href="clutch.prob.couplings.html#g:237"><span class="id" title="variable">g</span></a> <a class="idref" href="clutch.prob.couplings.html#eb641882772b9aae0ad0c4bbce6dce3c"><span class="id" title="variable">μ2</span></a>) <a class="idref" href="clutch.prob.couplings.html#R:240"><span class="id" title="variable">R</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hcoupl</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.prob.distribution.html#dmap"><span class="id" title="definition">dmap</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="clutch.prob.couplings.html#Rcoupl_dbind"><span class="id" title="lemma">Rcoupl_dbind</span></a>; [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="clutch.prob.couplings.html#Rcoupl_dret"><span class="id" title="lemma">Rcoupl_dret</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_dunif" class="idref" href="#Rcoupl_dunif"><span class="id" title="lemma">Rcoupl_dunif</span></a> (<a id="N:243" class="idref" href="#N:243"><span class="id" title="binder">N</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) <a id="f:244" class="idref" href="#f:244"><span class="id" title="binder">f</span></a> `{<a id="H:245" class="idref" href="#H:245"><span class="id" title="binder">Bij</span></a> <a id="H:245" class="idref" href="#H:245"><span class="id" title="binder">(</span></a><a id="H:245" class="idref" href="#H:245"><span class="id" title="binder">fin</span></a> <a id="H:245" class="idref" href="#H:245"><span class="id" title="binder">N</span></a><a id="H:245" class="idref" href="#H:245"><span class="id" title="binder">)</span></a> <a id="H:245" class="idref" href="#H:245"><span class="id" title="binder">(</span></a><a id="H:245" class="idref" href="#H:245"><span class="id" title="binder">fin</span></a> <a id="H:245" class="idref" href="#H:245"><span class="id" title="binder">N</span></a><a id="H:245" class="idref" href="#H:245"><span class="id" title="binder">)</span></a> <a id="H:245" class="idref" href="#H:245"><span class="id" title="binder">f</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> (<a class="idref" href="clutch.prob.distribution.html#dunif"><span class="id" title="definition">dunif</span></a> <a class="idref" href="clutch.prob.couplings.html#N:243"><span class="id" title="variable">N</span></a>) (<a class="idref" href="clutch.prob.distribution.html#dunif"><span class="id" title="definition">dunif</span></a> <a class="idref" href="clutch.prob.couplings.html#N:243"><span class="id" title="variable">N</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="n:246" class="idref" href="#n:246"><span class="id" title="binder">n</span></a> <a id="m:247" class="idref" href="#m:247"><span class="id" title="binder">m</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.couplings.html#m:247"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.prob.couplings.html#f:244"><span class="id" title="variable">f</span></a> <a class="idref" href="clutch.prob.couplings.html#n:246"><span class="id" title="variable">n</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<a class="idref" href="clutch.prob.distribution.html#dmap"><span class="id" title="definition">dmap</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="x:249" class="idref" href="#x:249"><span class="id" title="binder">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.prob.couplings.html#x:248"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">f</span> <a class="idref" href="clutch.prob.couplings.html#x:248"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) (<a class="idref" href="clutch.prob.distribution.html#dunif"><span class="id" title="definition">dunif</span></a> <span class="id" title="var">N</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="tactic">split</span>|].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="clutch.prob.distribution.html#distr_ext"><span class="id" title="lemma">distr_ext</span></a>=&gt; <span class="id" title="var">y1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.distribution.html#lmarg_pmf"><span class="id" title="lemma">lmarg_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> (<a class="idref" href="clutch.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="y2:253" class="idref" href="#y2:253"><span class="id" title="binder">y2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.decidable.html#bool_decide"><span class="id" title="definition">bool_decide</span></a> (<a class="idref" href="clutch.prob.couplings.html#y2:250"><span class="id" title="variable">y2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">f</span> <span class="id" title="var">y1</span>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#2299a6ef56270a66cc1b95489d0f6e3a"><span class="id" title="notation">/</span></a><span class="id" title="var">N</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> 0)); <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span>. <span class="id" title="var">case_bool_decide</span>; <span class="id" title="var">simplify_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="clutch.prob.distribution.html#dmap_unif_nonzero"><span class="id" title="lemma">dmap_unif_nonzero</span></a>; [|<span class="id" title="var">done</span>]. <span class="id" title="tactic">intros</span> ???; <span class="id" title="tactic">by</span> <span class="id" title="var">simplify_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.distribution.html#dmap_unif_zero"><span class="id" title="lemma">dmap_unif_zero</span></a>. <span class="id" title="tactic">intros</span> ? [=]; <span class="id" title="var">simplify_eq</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.distribution.html#dunif_pmf"><span class="id" title="lemma">dunif_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC_singleton"><span class="id" title="lemma">SeriesC_singleton</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="clutch.prob.distribution.html#distr_ext"><span class="id" title="lemma">distr_ext</span></a>=&gt; <span class="id" title="var">y2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> (<a class="idref" href="clutch.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="y1:257" class="idref" href="#y1:257"><span class="id" title="binder">y1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.decidable.html#bool_decide"><span class="id" title="definition">bool_decide</span></a> (<span class="id" title="var">f</span> <a class="idref" href="clutch.prob.couplings.html#y1:254"><span class="id" title="variable">y1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">y2</span>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#2299a6ef56270a66cc1b95489d0f6e3a"><span class="id" title="notation">/</span></a><span class="id" title="var">N</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> 0)); <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span>. <span class="id" title="var">case_bool_decide</span>; <span class="id" title="var">simplify_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="clutch.prob.distribution.html#dmap_unif_nonzero"><span class="id" title="lemma">dmap_unif_nonzero</span></a>; [|<span class="id" title="var">done</span>]. <span class="id" title="tactic">intros</span> ???; <span class="id" title="tactic">by</span> <span class="id" title="var">simplify_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.distribution.html#dmap_unif_zero"><span class="id" title="lemma">dmap_unif_zero</span></a>. <span class="id" title="tactic">intros</span> ? [=]; <span class="id" title="var">simplify_eq</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.distribution.html#dunif_pmf"><span class="id" title="lemma">dunif_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="clutch.prob.countable_sum.html#SeriesC_singleton_inj"><span class="id" title="lemma">SeriesC_singleton_inj</span></a> <span class="id" title="var">y2</span> <span class="id" title="var">f</span>); [<span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#surj"><span class="id" title="definition">surj</span></a> <span class="id" title="var">f</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> (<span class="id" title="var">m1</span> &amp; <span class="id" title="var">m2</span>) (<span class="id" title="var">n</span> &amp; [=] &amp; <span class="id" title="var">Hn</span>)%<a class="idref" href="clutch.prob.distribution.html#dmap_pos"><span class="id" title="lemma">dmap_pos</span></a> =&gt;/=. <span class="id" title="tactic">by</span> <span class="id" title="var">simplify_eq</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="Rcoupl_strength" class="idref" href="#Rcoupl_strength"><span class="id" title="section">Rcoupl_strength</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H:260" class="idref" href="#H:260"><span class="id" title="binder">Countable</span></a> <a id="H:260" class="idref" href="#H:260"><span class="id" title="binder">A</span></a>, <a id="H0:263" class="idref" href="#H0:263"><span class="id" title="binder">Countable</span></a> <a id="H0:263" class="idref" href="#H0:263"><span class="id" title="binder">B</span></a>, <a id="H1:266" class="idref" href="#H1:266"><span class="id" title="binder">Countable</span></a> <a id="H1:266" class="idref" href="#H1:266"><span class="id" title="binder">D</span></a>, <a id="H2:269" class="idref" href="#H2:269"><span class="id" title="binder">Countable</span></a> <a id="H2:269" class="idref" href="#H2:269"><span class="id" title="binder">E</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<a id="da458f66f393053bb61f37600215d068" class="idref" href="#da458f66f393053bb61f37600215d068"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl_strength.A"><span class="id" title="variable">A</span></a>) (<a id="5083996e7c709baf85381798638a2075" class="idref" href="#5083996e7c709baf85381798638a2075"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl_strength.B"><span class="id" title="variable">B</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_strength_l" class="idref" href="#Rcoupl_strength_l"><span class="id" title="lemma">Rcoupl_strength_l</span></a> (<a id="R:272" class="idref" href="#R:272"><span class="id" title="binder">R</span></a> : <a class="idref" href="clutch.prob.couplings.html#Rcoupl_strength.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl_strength.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) (<a id="d:273" class="idref" href="#d:273"><span class="id" title="binder">d</span></a> : <a class="idref" href="clutch.prob.couplings.html#Rcoupl_strength.D"><span class="id" title="variable">D</span></a>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#4610bf25777509125aadf87c886bf6bd"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#17621db61b04d0de722ee9be01719362"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.couplings.html#R:272"><span class="id" title="variable">R</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> (<a class="idref" href="clutch.prob.distribution.html#strength_l"><span class="id" title="definition">strength_l</span></a> <a class="idref" href="clutch.prob.couplings.html#d:273"><span class="id" title="variable">d</span></a> <a class="idref" href="clutch.prob.couplings.html#4610bf25777509125aadf87c886bf6bd"><span class="id" title="variable">μ1</span></a>) <a class="idref" href="clutch.prob.couplings.html#17621db61b04d0de722ee9be01719362"><span class="id" title="variable">μ2</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">'</span></a><a id="pat:276" class="idref" href="#pat:276"><span class="id" title="binder">(</span></a><a id="pat:276" class="idref" href="#pat:276"><span class="id" title="binder">d'</span></a><a id="pat:276" class="idref" href="#pat:276"><span class="id" title="binder">,</span></a> <a id="pat:276" class="idref" href="#pat:276"><span class="id" title="binder">a</span></a><a id="pat:276" class="idref" href="#pat:276"><span class="id" title="binder">)</span></a> <a id="b:277" class="idref" href="#b:277"><span class="id" title="binder">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.couplings.html#d':275"><span class="id" title="variable">d'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.prob.couplings.html#d:273"><span class="id" title="variable">d</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="clutch.prob.couplings.html#R:272"><span class="id" title="variable">R</span></a> <a class="idref" href="clutch.prob.couplings.html#a:274"><span class="id" title="variable">a</span></a> <a class="idref" href="clutch.prob.couplings.html#b:277"><span class="id" title="variable">b</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.prob.distribution.html#strength_l"><span class="id" title="definition">strength_l</span></a> /<a class="idref" href="clutch.prob.distribution.html#dmap"><span class="id" title="definition">dmap</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hcpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -(<a class="idref" href="clutch.prob.distribution.html#dret_id_right"><span class="id" title="lemma">dret_id_right</span></a> <a class="idref" href="clutch.prob.couplings.html#17621db61b04d0de722ee9be01719362"><span class="id" title="variable">μ2</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="clutch.prob.couplings.html#Rcoupl_dbind"><span class="id" title="lemma">Rcoupl_dbind</span></a>; [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.couplings.html#Rcoupl_dret"><span class="id" title="lemma">Rcoupl_dret</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_strength" class="idref" href="#Rcoupl_strength"><span class="id" title="lemma">Rcoupl_strength</span></a> (<a id="R:278" class="idref" href="#R:278"><span class="id" title="binder">R</span></a> : <a class="idref" href="clutch.prob.couplings.html#Rcoupl_strength.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl_strength.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) (<a id="d:279" class="idref" href="#d:279"><span class="id" title="binder">d</span></a> : <a class="idref" href="clutch.prob.couplings.html#Rcoupl_strength.D"><span class="id" title="variable">D</span></a>) (<a id="e:280" class="idref" href="#e:280"><span class="id" title="binder">e</span></a> : <a class="idref" href="clutch.prob.couplings.html#Rcoupl_strength.E"><span class="id" title="variable">E</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#4610bf25777509125aadf87c886bf6bd"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#17621db61b04d0de722ee9be01719362"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.couplings.html#R:278"><span class="id" title="variable">R</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> (<a class="idref" href="clutch.prob.distribution.html#strength_l"><span class="id" title="definition">strength_l</span></a> <a class="idref" href="clutch.prob.couplings.html#d:279"><span class="id" title="variable">d</span></a> <a class="idref" href="clutch.prob.couplings.html#4610bf25777509125aadf87c886bf6bd"><span class="id" title="variable">μ1</span></a>) (<a class="idref" href="clutch.prob.distribution.html#strength_l"><span class="id" title="definition">strength_l</span></a> <a class="idref" href="clutch.prob.couplings.html#e:280"><span class="id" title="variable">e</span></a> <a class="idref" href="clutch.prob.couplings.html#17621db61b04d0de722ee9be01719362"><span class="id" title="variable">μ2</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">'</span></a><a id="pat:283" class="idref" href="#pat:283"><span class="id" title="binder">(</span></a><a id="pat:283" class="idref" href="#pat:283"><span class="id" title="binder">d'</span></a><a id="pat:283" class="idref" href="#pat:283"><span class="id" title="binder">,</span></a> <a id="pat:283" class="idref" href="#pat:283"><span class="id" title="binder">a</span></a><a id="pat:283" class="idref" href="#pat:283"><span class="id" title="binder">)</span></a> '<a id="pat:286" class="idref" href="#pat:286"><span class="id" title="binder">(</span></a><a id="pat:286" class="idref" href="#pat:286"><span class="id" title="binder">e'</span></a><a id="pat:286" class="idref" href="#pat:286"><span class="id" title="binder">,</span></a> <a id="pat:286" class="idref" href="#pat:286"><span class="id" title="binder">b</span></a><a id="pat:286" class="idref" href="#pat:286"><span class="id" title="binder">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.couplings.html#d':282"><span class="id" title="variable">d'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.prob.couplings.html#d:279"><span class="id" title="variable">d</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="clutch.prob.couplings.html#e':285"><span class="id" title="variable">e'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.prob.couplings.html#e:280"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="clutch.prob.couplings.html#R:278"><span class="id" title="variable">R</span></a> <a class="idref" href="clutch.prob.couplings.html#a:281"><span class="id" title="variable">a</span></a> <a class="idref" href="clutch.prob.couplings.html#b:284"><span class="id" title="variable">b</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.prob.distribution.html#strength_l"><span class="id" title="definition">strength_l</span></a> /<a class="idref" href="clutch.prob.distribution.html#dmap"><span class="id" title="definition">dmap</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="clutch.prob.couplings.html#Rcoupl_dbind"><span class="id" title="lemma">Rcoupl_dbind</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.couplings.html#Rcoupl_dret"><span class="id" title="lemma">Rcoupl_dret</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="clutch.prob.couplings.html#Rcoupl_strength"><span class="id" title="section">Rcoupl_strength</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="refcoupl" class="idref" href="#refcoupl"><span class="id" title="section">refcoupl</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H:289" class="idref" href="#H:289"><span class="id" title="binder">Countable</span></a> <a id="H:289" class="idref" href="#H:289"><span class="id" title="binder">A</span></a>, <a id="H0:292" class="idref" href="#H0:292"><span class="id" title="binder">Countable</span></a> <a id="H0:292" class="idref" href="#H0:292"><span class="id" title="binder">B</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<a id="006d57969455c95eb36bbdf86bda64a5" class="idref" href="#006d57969455c95eb36bbdf86bda64a5"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#refcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="d907eea1ce5aa11e64f6d6c2675aaf6e" class="idref" href="#d907eea1ce5aa11e64f6d6c2675aaf6e"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#refcoupl.B"><span class="id" title="variable">B</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="is_refcoupl" class="idref" href="#is_refcoupl"><span class="id" title="definition">is_refcoupl</span></a> (<a id="eb3b290e023bf5faf0d0a7d83c1db8af" class="idref" href="#eb3b290e023bf5faf0d0a7d83c1db8af"><span class="id" title="binder">μ</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> (<a class="idref" href="clutch.prob.couplings.html#refcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="clutch.prob.couplings.html#refcoupl.B"><span class="id" title="variable">B</span></a>)) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.distribution.html#lmarg"><span class="id" title="definition">lmarg</span></a> <a class="idref" href="clutch.prob.couplings.html#eb3b290e023bf5faf0d0a7d83c1db8af"><span class="id" title="variable">μ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.prob.couplings.html#7a54db6f28655e067446ca617b849410"><span class="id" title="variable">μ1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="b:296" class="idref" href="#b:296"><span class="id" title="binder">b</span></a> : <a class="idref" href="clutch.prob.couplings.html#refcoupl.B"><span class="id" title="variable">B</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a> <a class="idref" href="clutch.prob.distribution.html#rmarg"><span class="id" title="definition">rmarg</span></a> <a class="idref" href="clutch.prob.couplings.html#eb3b290e023bf5faf0d0a7d83c1db8af"><span class="id" title="variable">μ</span></a> <a class="idref" href="clutch.prob.couplings.html#b:296"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="clutch.prob.couplings.html#70cfe85fac37a080fe61e7eeff50e91f"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.couplings.html#b:296"><span class="id" title="variable">b</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="ex_refcoupl" class="idref" href="#ex_refcoupl"><span class="id" title="definition">ex_refcoupl</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">(</span></a><a id="3b1b0ef270cf0b470ecf4a02cd914d6c" class="idref" href="#3b1b0ef270cf0b470ecf4a02cd914d6c"><span class="id" title="binder">μ</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> (<a class="idref" href="clutch.prob.couplings.html#refcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="clutch.prob.couplings.html#refcoupl.B"><span class="id" title="variable">B</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">),</span></a> <a class="idref" href="clutch.prob.couplings.html#is_refcoupl"><span class="id" title="definition">is_refcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#3b1b0ef270cf0b470ecf4a02cd914d6c"><span class="id" title="variable">μ</span></a>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="clutch.prob.couplings.html#refcoupl"><span class="id" title="section">refcoupl</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="refRcoupl" class="idref" href="#refRcoupl"><span class="id" title="section">refRcoupl</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H:300" class="idref" href="#H:300"><span class="id" title="binder">Countable</span></a> <a id="H:300" class="idref" href="#H:300"><span class="id" title="binder">A</span></a>, <a id="H0:303" class="idref" href="#H0:303"><span class="id" title="binder">Countable</span></a> <a id="H0:303" class="idref" href="#H0:303"><span class="id" title="binder">B</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<a id="6b1b23356ec9a74e23a6484446ce32f5" class="idref" href="#6b1b23356ec9a74e23a6484446ce32f5"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="bc9619044fa3c76b6217c298b2f3db19" class="idref" href="#bc9619044fa3c76b6217c298b2f3db19"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a>) (<a id="R:306" class="idref" href="#R:306"><span class="id" title="binder">R</span></a> : <a class="idref" href="clutch.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="is_refRcoupl" class="idref" href="#is_refRcoupl"><span class="id" title="definition">is_refRcoupl</span></a> (<a id="f4c0664895e326f92b046396fdef294f" class="idref" href="#f4c0664895e326f92b046396fdef294f"><span class="id" title="binder">μ</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> (<a class="idref" href="clutch.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a>)) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#is_refcoupl"><span class="id" title="definition">is_refcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#d1039bc2620b861e186a90ffa48201a9"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#cdb21d605c56261e9c952fe2092cbe76"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.couplings.html#f4c0664895e326f92b046396fdef294f"><span class="id" title="variable">μ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="p:308" class="idref" href="#p:308"><span class="id" title="binder">p</span></a> : <a class="idref" href="clutch.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a> <a class="idref" href="clutch.prob.couplings.html#f4c0664895e326f92b046396fdef294f"><span class="id" title="variable">μ</span></a> <a class="idref" href="clutch.prob.couplings.html#p:308"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl.R"><span class="id" title="variable">R</span></a> <a class="idref" href="clutch.prob.couplings.html#p:308"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="clutch.prob.couplings.html#p:308"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.2'"><span class="id" title="notation">.2</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="refRcoupl" class="idref" href="#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">(</span></a><a id="5bdfdbd55b66ccf5dbfa7bc59b726802" class="idref" href="#5bdfdbd55b66ccf5dbfa7bc59b726802"><span class="id" title="binder">μ</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> (<a class="idref" href="clutch.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">),</span></a> <a class="idref" href="clutch.prob.couplings.html#is_refRcoupl"><span class="id" title="definition">is_refRcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#5bdfdbd55b66ccf5dbfa7bc59b726802"><span class="id" title="variable">μ</span></a>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="clutch.prob.couplings.html#refRcoupl"><span class="id" title="section">refRcoupl</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="refcoupl" class="idref" href="#refcoupl"><span class="id" title="section">refcoupl</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H:312" class="idref" href="#H:312"><span class="id" title="binder">Countable</span></a> <a id="H:312" class="idref" href="#H:312"><span class="id" title="binder">A</span></a>, <a id="H0:315" class="idref" href="#H0:315"><span class="id" title="binder">Countable</span></a> <a id="H0:315" class="idref" href="#H0:315"><span class="id" title="binder">B</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<a id="edfc84a11c8d0f27f26e05c1afc1a1af" class="idref" href="#edfc84a11c8d0f27f26e05c1afc1a1af"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#refcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="f90bb8ffe4cee6efca312ee6fd2f158f" class="idref" href="#f90bb8ffe4cee6efca312ee6fd2f158f"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#refcoupl.B"><span class="id" title="variable">B</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="is_refcoupl_dret" class="idref" href="#is_refcoupl_dret"><span class="id" title="lemma">is_refcoupl_dret</span></a> (<a id="a:318" class="idref" href="#a:318"><span class="id" title="binder">a</span></a> : <a class="idref" href="clutch.prob.couplings.html#refcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="b:319" class="idref" href="#b:319"><span class="id" title="binder">b</span></a> : <a class="idref" href="clutch.prob.couplings.html#refcoupl.B"><span class="id" title="variable">B</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#is_refcoupl"><span class="id" title="definition">is_refcoupl</span></a> (<a class="idref" href="clutch.prob.distribution.html#dret"><span class="id" title="definition">dret</span></a> <a class="idref" href="clutch.prob.couplings.html#a:318"><span class="id" title="variable">a</span></a>) (<a class="idref" href="clutch.prob.distribution.html#dret"><span class="id" title="definition">dret</span></a> <a class="idref" href="clutch.prob.couplings.html#b:319"><span class="id" title="variable">b</span></a>) (<a class="idref" href="clutch.prob.distribution.html#dret"><span class="id" title="definition">dret</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.prob.couplings.html#a:318"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.couplings.html#b:319"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">split</span>; [<span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.prob.distribution.html#lmarg"><span class="id" title="definition">lmarg</span></a> <a class="idref" href="clutch.prob.distribution.html#dmap_dret"><span class="id" title="lemma">dmap_dret</span></a> // | <span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.prob.distribution.html#rmarg"><span class="id" title="definition">rmarg</span></a> <a class="idref" href="clutch.prob.distribution.html#dmap_dret"><span class="id" title="lemma">dmap_dret</span></a> //]. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="clutch.prob.couplings.html#refcoupl"><span class="id" title="section">refcoupl</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="is_refRcoupl" class="idref" href="#is_refRcoupl"><span class="id" title="section">is_refRcoupl</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H:322" class="idref" href="#H:322"><span class="id" title="binder">Countable</span></a> <a id="H:322" class="idref" href="#H:322"><span class="id" title="binder">A</span></a>, <a id="H0:325" class="idref" href="#H0:325"><span class="id" title="binder">Countable</span></a> <a id="H0:325" class="idref" href="#H0:325"><span class="id" title="binder">B</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<a id="0b411e33971aa5722299b0800a15ad82" class="idref" href="#0b411e33971aa5722299b0800a15ad82"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#is_refRcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="0c4fe8c0c061f8af87679576d3583bc8" class="idref" href="#0c4fe8c0c061f8af87679576d3583bc8"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#is_refRcoupl.B"><span class="id" title="variable">B</span></a>) (<a id="R:328" class="idref" href="#R:328"><span class="id" title="binder">R</span></a> : <a class="idref" href="clutch.prob.couplings.html#is_refRcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#is_refRcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) (<a id="8dcc03ea4c3a60e056676ea36fc2f8d5" class="idref" href="#8dcc03ea4c3a60e056676ea36fc2f8d5"><span class="id" title="binder">μ</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> (<a class="idref" href="clutch.prob.couplings.html#is_refRcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="clutch.prob.couplings.html#is_refRcoupl.B"><span class="id" title="variable">B</span></a>)).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="is_refRcoupl_mass_l" class="idref" href="#is_refRcoupl_mass_l"><span class="id" title="lemma">is_refRcoupl_mass_l</span></a> : <a class="idref" href="clutch.prob.couplings.html#is_refRcoupl"><span class="id" title="definition">is_refRcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#6f34c6ba51a1f72419aae715b0c91389"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#443a8cb3a4f3b1df92f6e7bc66f11ef7"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.couplings.html#is_refRcoupl.R"><span class="id" title="variable">R</span></a> <a class="idref" href="clutch.prob.couplings.html#bea3fc71ac219bdaabf47e6ffd2e59da"><span class="id" title="variable">μ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="clutch.prob.couplings.html#bea3fc71ac219bdaabf47e6ffd2e59da"><span class="id" title="variable">μ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="clutch.prob.couplings.html#6f34c6ba51a1f72419aae715b0c91389"><span class="id" title="variable">μ1</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> ([&lt;- <span class="id" title="var">Hr</span>] &amp; <span class="id" title="var">Hμ</span>). <span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.prob.distribution.html#lmarg"><span class="id" title="definition">lmarg</span></a> <a class="idref" href="clutch.prob.distribution.html#dmap_mass"><span class="id" title="lemma">dmap_mass</span></a> //. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="is_refRcoupl_mass_r" class="idref" href="#is_refRcoupl_mass_r"><span class="id" title="lemma">is_refRcoupl_mass_r</span></a> : <a class="idref" href="clutch.prob.couplings.html#is_refRcoupl"><span class="id" title="definition">is_refRcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#6f34c6ba51a1f72419aae715b0c91389"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#443a8cb3a4f3b1df92f6e7bc66f11ef7"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.couplings.html#is_refRcoupl.R"><span class="id" title="variable">R</span></a> <a class="idref" href="clutch.prob.couplings.html#bea3fc71ac219bdaabf47e6ffd2e59da"><span class="id" title="variable">μ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="clutch.prob.couplings.html#bea3fc71ac219bdaabf47e6ffd2e59da"><span class="id" title="variable">μ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="clutch.prob.couplings.html#443a8cb3a4f3b1df92f6e7bc66f11ef7"><span class="id" title="variable">μ2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ([<span class="id" title="var">Hl</span> <span class="id" title="var">Hr</span>] &amp; <span class="id" title="var">Hμ</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -(<a class="idref" href="clutch.prob.distribution.html#dmap_mass"><span class="id" title="lemma">dmap_mass</span></a> <a class="idref" href="clutch.prob.couplings.html#bea3fc71ac219bdaabf47e6ffd2e59da"><span class="id" title="variable">μ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC_le"><span class="id" title="lemma">SeriesC_le</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="is_refRcoupl_mass_eq" class="idref" href="#is_refRcoupl_mass_eq"><span class="id" title="lemma">is_refRcoupl_mass_eq</span></a> : <a class="idref" href="clutch.prob.couplings.html#is_refRcoupl"><span class="id" title="definition">is_refRcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#6f34c6ba51a1f72419aae715b0c91389"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#443a8cb3a4f3b1df92f6e7bc66f11ef7"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.couplings.html#is_refRcoupl.R"><span class="id" title="variable">R</span></a> <a class="idref" href="clutch.prob.couplings.html#bea3fc71ac219bdaabf47e6ffd2e59da"><span class="id" title="variable">μ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="clutch.prob.couplings.html#6f34c6ba51a1f72419aae715b0c91389"><span class="id" title="variable">μ1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="clutch.prob.couplings.html#443a8cb3a4f3b1df92f6e7bc66f11ef7"><span class="id" title="variable">μ2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">Hμ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="clutch.prob.couplings.html#is_refRcoupl_mass_l"><span class="id" title="lemma">is_refRcoupl_mass_l</span></a>; [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.couplings.html#is_refRcoupl_mass_r"><span class="id" title="lemma">is_refRcoupl_mass_r</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="clutch.prob.couplings.html#is_refRcoupl"><span class="id" title="section">is_refRcoupl</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="refRcoupl" class="idref" href="#refRcoupl"><span class="id" title="section">refRcoupl</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H:332" class="idref" href="#H:332"><span class="id" title="binder">Countable</span></a> <a id="H:332" class="idref" href="#H:332"><span class="id" title="binder">A</span></a>, <a id="H0:335" class="idref" href="#H0:335"><span class="id" title="binder">Countable</span></a> <a id="H0:335" class="idref" href="#H0:335"><span class="id" title="binder">B</span></a>}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="refRcoupl_mass_eq" class="idref" href="#refRcoupl_mass_eq"><span class="id" title="lemma">refRcoupl_mass_eq</span></a> (<a id="5e6a8ca5bb89c18b2624dcd750877048" class="idref" href="#5e6a8ca5bb89c18b2624dcd750877048"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="78622a6537c1bb60b8f0b9f77a9f0460" class="idref" href="#78622a6537c1bb60b8f0b9f77a9f0460"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a>) (<a id="R:338" class="idref" href="#R:338"><span class="id" title="binder">R</span></a> : <a class="idref" href="clutch.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#5e6a8ca5bb89c18b2624dcd750877048"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#78622a6537c1bb60b8f0b9f77a9f0460"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.couplings.html#R:338"><span class="id" title="variable">R</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="clutch.prob.couplings.html#5e6a8ca5bb89c18b2624dcd750877048"><span class="id" title="variable">μ1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="clutch.prob.couplings.html#78622a6537c1bb60b8f0b9f77a9f0460"><span class="id" title="variable">μ2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> (?&amp;?&amp;?). <span class="id" title="tactic">by</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="clutch.prob.couplings.html#is_refRcoupl_mass_eq"><span class="id" title="lemma">is_refRcoupl_mass_eq</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="refRcoupl_eq_elim" class="idref" href="#refRcoupl_eq_elim"><span class="id" title="lemma">refRcoupl_eq_elim</span></a> (<a id="38922bbd4f9c37819ed11a27a05b3632" class="idref" href="#38922bbd4f9c37819ed11a27a05b3632"><span class="id" title="binder">μ1</span></a> <a id="f79a50f9dc95b9c55b358dcdc3b670bb" class="idref" href="#f79a50f9dc95b9c55b358dcdc3b670bb"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#38922bbd4f9c37819ed11a27a05b3632"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#f79a50f9dc95b9c55b358dcdc3b670bb"><span class="id" title="variable">μ2</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#924fd3758233021bbb7af913c6a625ce"><span class="id" title="notation">(=)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="a:341" class="idref" href="#a:341"><span class="id" title="binder">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.couplings.html#38922bbd4f9c37819ed11a27a05b3632"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#a:341"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="clutch.prob.couplings.html#f79a50f9dc95b9c55b358dcdc3b670bb"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.couplings.html#a:341"><span class="id" title="variable">a</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> (<span class="id" title="var">μ</span> &amp; (<span class="id" title="var">HμL</span> &amp; <span class="id" title="var">HμR</span>) &amp; <span class="id" title="var">HμS</span>) <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="clutch.prelude.Reals_ext.html#Rle_Transitive"><span class="id" title="instance">Rle_Transitive</span></a> <span class="id" title="var">_</span> (<a class="idref" href="clutch.prob.distribution.html#rmarg"><span class="id" title="definition">rmarg</span></a> <span class="id" title="var">μ</span> <span class="id" title="var">a</span>) <span class="id" title="var">_</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">HμL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.distribution.html#lmarg_pmf"><span class="id" title="lemma">lmarg_pmf</span></a> <a class="idref" href="clutch.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC_le"><span class="id" title="lemma">SeriesC_le</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span> . <span class="id" title="tactic">specialize</span> (<span class="id" title="var">HμS</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>). <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HμS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rtotal_order"><span class="id" title="lemma">Rtotal_order</span></a> (<span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) 0) <span class="id" title="keyword">as</span> [? | [? | <span class="id" title="var">H3</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="clutch.prob.distribution.html#pmf_pos"><span class="id" title="projection">pmf_pos</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>); <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="clutch.prob.distribution.html#pmf_pos"><span class="id" title="projection">pmf_pos</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>); <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">HμS</span> <span class="id" title="var">H3</span>); <span class="id" title="var">simplify_eq</span>; <span class="id" title="var">lra</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.distribution.html#ex_distr_rmarg"><span class="id" title="lemma">ex_distr_rmarg</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="refRcoupl_from_leq" class="idref" href="#refRcoupl_from_leq"><span class="id" title="lemma">refRcoupl_from_leq</span></a> (<a id="42a0d7ec81cb53087846a52bc08c8220" class="idref" href="#42a0d7ec81cb53087846a52bc08c8220"><span class="id" title="binder">μ1</span></a> <a id="57e33198160941f94f2861d4428aa1e9" class="idref" href="#57e33198160941f94f2861d4428aa1e9"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="a:344" class="idref" href="#a:344"><span class="id" title="binder">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.couplings.html#42a0d7ec81cb53087846a52bc08c8220"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#a:344"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="clutch.prob.couplings.html#57e33198160941f94f2861d4428aa1e9"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.couplings.html#a:344"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#42a0d7ec81cb53087846a52bc08c8220"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#57e33198160941f94f2861d4428aa1e9"><span class="id" title="variable">μ2</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#924fd3758233021bbb7af913c6a625ce"><span class="id" title="notation">(=)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">Hleq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<a class="idref" href="clutch.prob.distribution.html#ddiag"><span class="id" title="definition">ddiag</span></a> <span class="id" title="var">μ1</span>). <span class="id" title="tactic">split</span>;[ <span class="id" title="tactic">split</span>  | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.distribution.html#distr_ext"><span class="id" title="lemma">distr_ext</span></a>; <span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.distribution.html#lmarg_pmf"><span class="id" title="lemma">lmarg_pmf</span></a> {2}/<a class="idref" href="clutch.prob.distribution.html#pmf"><span class="id" title="projection">pmf</span></a>/=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC_singleton'"><span class="id" title="lemma">SeriesC_singleton'</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.distribution.html#ddiag_rmarg"><span class="id" title="lemma">ddiag_rmarg</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">p</span> <span class="id" title="var">Hp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.distribution.html#ddiag_pmf"><span class="id" title="lemma">ddiag_pmf</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_bool_decide</span>; <span class="id" title="tactic">auto</span>; <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="refRcoupl_eq_refl" class="idref" href="#refRcoupl_eq_refl"><span class="id" title="lemma">refRcoupl_eq_refl</span></a> (<a id="a5304fe98e628c47979bf987831ce871" class="idref" href="#a5304fe98e628c47979bf987831ce871"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#a5304fe98e628c47979bf987831ce871"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#a5304fe98e628c47979bf987831ce871"><span class="id" title="variable">μ1</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#924fd3758233021bbb7af913c6a625ce"><span class="id" title="notation">(=)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.couplings.html#refRcoupl_from_leq"><span class="id" title="lemma">refRcoupl_from_leq</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="refRcoupl_eq_trans" class="idref" href="#refRcoupl_eq_trans"><span class="id" title="lemma">refRcoupl_eq_trans</span></a> (<a id="6fee170a73bf8a162bc3f7353709c3d6" class="idref" href="#6fee170a73bf8a162bc3f7353709c3d6"><span class="id" title="binder">μ1</span></a> <a id="afd75d7abfbb10d7431d6ad8eb4215e9" class="idref" href="#afd75d7abfbb10d7431d6ad8eb4215e9"><span class="id" title="binder">μ2</span></a> <a id="2bd4781edac2d00ca412bcfeb7feae6e" class="idref" href="#2bd4781edac2d00ca412bcfeb7feae6e"><span class="id" title="binder">μ3</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#6fee170a73bf8a162bc3f7353709c3d6"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#afd75d7abfbb10d7431d6ad8eb4215e9"><span class="id" title="variable">μ2</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#924fd3758233021bbb7af913c6a625ce"><span class="id" title="notation">(=)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#afd75d7abfbb10d7431d6ad8eb4215e9"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.couplings.html#2bd4781edac2d00ca412bcfeb7feae6e"><span class="id" title="variable">μ3</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#924fd3758233021bbb7af913c6a625ce"><span class="id" title="notation">(=)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#6fee170a73bf8a162bc3f7353709c3d6"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#2bd4781edac2d00ca412bcfeb7feae6e"><span class="id" title="variable">μ3</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#924fd3758233021bbb7af913c6a625ce"><span class="id" title="notation">(=)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H12</span> <span class="id" title="var">H23</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="clutch.prob.couplings.html#refRcoupl_eq_elim"><span class="id" title="lemma">refRcoupl_eq_elim</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H12</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H12'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="clutch.prob.couplings.html#refRcoupl_eq_elim"><span class="id" title="lemma">refRcoupl_eq_elim</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H23</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H23'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.couplings.html#refRcoupl_from_leq"><span class="id" title="lemma">refRcoupl_from_leq</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">eapply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rle_trans"><span class="id" title="lemma">Rle_trans</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="refRcoupl_eq_refRcoupl_unfoldl" class="idref" href="#refRcoupl_eq_refRcoupl_unfoldl"><span class="id" title="lemma">refRcoupl_eq_refRcoupl_unfoldl</span></a> (<a id="5bef28a4f1a0979320f1478a468ac22a" class="idref" href="#5bef28a4f1a0979320f1478a468ac22a"><span class="id" title="binder">μ1</span></a> <a id="2be05a8ff1db277222a9a9dffad15e6a" class="idref" href="#2be05a8ff1db277222a9a9dffad15e6a"><span class="id" title="binder">μ2</span></a> <a id="6920ed382017c9d33f832d23c081a923" class="idref" href="#6920ed382017c9d33f832d23c081a923"><span class="id" title="binder">μ3</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a>) <a id="R:352" class="idref" href="#R:352"><span class="id" title="binder">R</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#5bef28a4f1a0979320f1478a468ac22a"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#2be05a8ff1db277222a9a9dffad15e6a"><span class="id" title="variable">μ2</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#924fd3758233021bbb7af913c6a625ce"><span class="id" title="notation">(=)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#2be05a8ff1db277222a9a9dffad15e6a"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.couplings.html#6920ed382017c9d33f832d23c081a923"><span class="id" title="variable">μ3</span></a> <a class="idref" href="clutch.prob.couplings.html#R:352"><span class="id" title="variable">R</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#5bef28a4f1a0979320f1478a468ac22a"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#6920ed382017c9d33f832d23c081a923"><span class="id" title="variable">μ3</span></a> <a class="idref" href="clutch.prob.couplings.html#R:352"><span class="id" title="variable">R</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">intros</span> -&gt;%<a class="idref" href="clutch.prob.couplings.html#Rcoupl_eq_elim"><span class="id" title="lemma">Rcoupl_eq_elim</span></a> ?. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="refRcoupl_eq_refRcoupl_unfoldr" class="idref" href="#refRcoupl_eq_refRcoupl_unfoldr"><span class="id" title="lemma">refRcoupl_eq_refRcoupl_unfoldr</span></a> (<a id="83d5daebc1e3c300dcae808a2c26cca9" class="idref" href="#83d5daebc1e3c300dcae808a2c26cca9"><span class="id" title="binder">μ1</span></a> <a id="11aab1d32209ba7f49372ab9a77ed37e" class="idref" href="#11aab1d32209ba7f49372ab9a77ed37e"><span class="id" title="binder">μ2</span></a> <a id="a0fe60ba96751e7e7bb52df9502e84e1" class="idref" href="#a0fe60ba96751e7e7bb52df9502e84e1"><span class="id" title="binder">μ3</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a>) <a id="R:356" class="idref" href="#R:356"><span class="id" title="binder">R</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#83d5daebc1e3c300dcae808a2c26cca9"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#11aab1d32209ba7f49372ab9a77ed37e"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.couplings.html#R:356"><span class="id" title="variable">R</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#11aab1d32209ba7f49372ab9a77ed37e"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.couplings.html#a0fe60ba96751e7e7bb52df9502e84e1"><span class="id" title="variable">μ3</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#924fd3758233021bbb7af913c6a625ce"><span class="id" title="notation">(=)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#83d5daebc1e3c300dcae808a2c26cca9"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#a0fe60ba96751e7e7bb52df9502e84e1"><span class="id" title="variable">μ3</span></a> <a class="idref" href="clutch.prob.couplings.html#R:356"><span class="id" title="variable">R</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">intros</span> ? &lt;-%<a class="idref" href="clutch.prob.couplings.html#Rcoupl_eq_elim"><span class="id" title="lemma">Rcoupl_eq_elim</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_refRcoupl" class="idref" href="#Rcoupl_refRcoupl"><span class="id" title="lemma">Rcoupl_refRcoupl</span></a> (<a id="c14e19250364906e4039d5c304e9c6b8" class="idref" href="#c14e19250364906e4039d5c304e9c6b8"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="7438903130e9776dd2939c6904e46e7b" class="idref" href="#7438903130e9776dd2939c6904e46e7b"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a>) (<a id="R:359" class="idref" href="#R:359"><span class="id" title="binder">R</span></a> : <a class="idref" href="clutch.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#c14e19250364906e4039d5c304e9c6b8"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#7438903130e9776dd2939c6904e46e7b"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.couplings.html#R:359"><span class="id" title="variable">R</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#c14e19250364906e4039d5c304e9c6b8"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#7438903130e9776dd2939c6904e46e7b"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.couplings.html#R:359"><span class="id" title="variable">R</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> /<a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> (<span class="id" title="var">μ</span> &amp; ((<span class="id" title="var">HμL</span> &amp; <span class="id" title="var">HμR</span>) &amp; <span class="id" title="var">HμSupp</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">μ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">HμR</span>; <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="refRcoupl_dret" class="idref" href="#refRcoupl_dret"><span class="id" title="lemma">refRcoupl_dret</span></a> <a id="a:360" class="idref" href="#a:360"><span class="id" title="binder">a</span></a> <a id="b:361" class="idref" href="#b:361"><span class="id" title="binder">b</span></a> (<a id="R:362" class="idref" href="#R:362"><span class="id" title="binder">R</span></a> : <a class="idref" href="clutch.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#R:362"><span class="id" title="variable">R</span></a> <a class="idref" href="clutch.prob.couplings.html#a:360"><span class="id" title="variable">a</span></a> <a class="idref" href="clutch.prob.couplings.html#b:361"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> (<a class="idref" href="clutch.prob.distribution.html#dret"><span class="id" title="definition">dret</span></a> <a class="idref" href="clutch.prob.couplings.html#a:360"><span class="id" title="variable">a</span></a>) (<a class="idref" href="clutch.prob.distribution.html#dret"><span class="id" title="definition">dret</span></a> <a class="idref" href="clutch.prob.couplings.html#b:361"><span class="id" title="variable">b</span></a>) <a class="idref" href="clutch.prob.couplings.html#R:362"><span class="id" title="variable">R</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">HR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">split</span>; [<span class="id" title="tactic">eapply</span> <a class="idref" href="clutch.prob.couplings.html#is_refcoupl_dret"><span class="id" title="lemma">is_refcoupl_dret</span></a>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [] [=&lt;- &lt;-]%<a class="idref" href="clutch.prob.distribution.html#dret_pos"><span class="id" title="lemma">dret_pos</span></a>. <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="refRcoupl_dbind" class="idref" href="#refRcoupl_dbind"><span class="id" title="lemma">refRcoupl_dbind</span></a>  `{<a id="H1:365" class="idref" href="#H1:365"><span class="id" title="binder">Countable</span></a> <a id="H1:365" class="idref" href="#H1:365"><span class="id" title="binder">A'</span></a>, <a id="H2:368" class="idref" href="#H2:368"><span class="id" title="binder">Countable</span></a> <a id="H2:368" class="idref" href="#H2:368"><span class="id" title="binder">B'</span></a>} (<a id="f:369" class="idref" href="#f:369"><span class="id" title="binder">f</span></a> : <a class="idref" href="clutch.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#A':363"><span class="id" title="variable">A'</span></a>) (<a id="g:370" class="idref" href="#g:370"><span class="id" title="binder">g</span></a> : <a class="idref" href="clutch.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#B':366"><span class="id" title="variable">B'</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="c4afadb30b53667f4fb56d6935ec60b5" class="idref" href="#c4afadb30b53667f4fb56d6935ec60b5"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="3cff4f7c75a8ace204689cca77c90827" class="idref" href="#3cff4f7c75a8ace204689cca77c90827"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a>) (<a id="R:373" class="idref" href="#R:373"><span class="id" title="binder">R</span></a> : <a class="idref" href="clutch.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) (<a id="S:374" class="idref" href="#S:374"><span class="id" title="binder">S</span></a> : <a class="idref" href="clutch.prob.couplings.html#A':363"><span class="id" title="variable">A'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#B':366"><span class="id" title="variable">B'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="a:375" class="idref" href="#a:375"><span class="id" title="binder">a</span></a> <a id="b:376" class="idref" href="#b:376"><span class="id" title="binder">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.couplings.html#R:373"><span class="id" title="variable">R</span></a> <a class="idref" href="clutch.prob.couplings.html#a:375"><span class="id" title="variable">a</span></a> <a class="idref" href="clutch.prob.couplings.html#b:376"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> (<a class="idref" href="clutch.prob.couplings.html#f:369"><span class="id" title="variable">f</span></a> <a class="idref" href="clutch.prob.couplings.html#a:375"><span class="id" title="variable">a</span></a>) (<a class="idref" href="clutch.prob.couplings.html#g:370"><span class="id" title="variable">g</span></a> <a class="idref" href="clutch.prob.couplings.html#b:376"><span class="id" title="variable">b</span></a>) <a class="idref" href="clutch.prob.couplings.html#S:374"><span class="id" title="variable">S</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#c4afadb30b53667f4fb56d6935ec60b5"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#3cff4f7c75a8ace204689cca77c90827"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.couplings.html#R:373"><span class="id" title="variable">R</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> (<a class="idref" href="clutch.prob.couplings.html#c4afadb30b53667f4fb56d6935ec60b5"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.distribution.html#1ec27ecb4da8da3d3cbd85a2394dc835"><span class="id" title="notation">≫=</span></a> <a class="idref" href="clutch.prob.couplings.html#f:369"><span class="id" title="variable">f</span></a>) (<a class="idref" href="clutch.prob.couplings.html#3cff4f7c75a8ace204689cca77c90827"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.distribution.html#1ec27ecb4da8da3d3cbd85a2394dc835"><span class="id" title="notation">≫=</span></a> <a class="idref" href="clutch.prob.couplings.html#g:370"><span class="id" title="variable">g</span></a>) <a class="idref" href="clutch.prob.couplings.html#S:374"><span class="id" title="variable">S</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hfg</span> (<span class="id" title="var">μ</span> &amp; <span class="id" title="var">HμC</span> &amp; <span class="id" title="var">HμS</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> /<a class="idref" href="clutch.prob.couplings.html#is_Rcoupl"><span class="id" title="definition">is_Rcoupl</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hfg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;First&nbsp;we&nbsp;rewrite&nbsp;Hfg&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;use&nbsp;Choice&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="p:380" class="idref" href="#p:380"><span class="id" title="binder">p</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a id="2c2829acaa9f092458a43671e9677f11" class="idref" href="#2c2829acaa9f092458a43671e9677f11"><span class="id" title="binder">μ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a> <span class="id" title="var">R</span> <a class="idref" href="clutch.prob.couplings.html#p:377"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="clutch.prob.couplings.html#p:377"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.2'"><span class="id" title="notation">.2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.prob.couplings.html#is_refcoupl"><span class="id" title="definition">is_refcoupl</span></a> (<span class="id" title="var">f</span> <a class="idref" href="clutch.prob.couplings.html#p:377"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.1'"><span class="id" title="notation">.1</span></a>) (<span class="id" title="var">g</span> <a class="idref" href="clutch.prob.couplings.html#p:377"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.2'"><span class="id" title="notation">.2</span></a>) <a class="idref" href="clutch.prob.couplings.html#26e19c76411898a8bcd696a606ad49fc"><span class="id" title="variable">μ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="q:382" class="idref" href="#q:382"><span class="id" title="binder">q</span></a> : <span class="id" title="var">A'</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <span class="id" title="var">B'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.couplings.html#26e19c76411898a8bcd696a606ad49fc"><span class="id" title="variable">μ'</span></a> <a class="idref" href="clutch.prob.couplings.html#q:379"><span class="id" title="variable">q</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="var">S</span> <a class="idref" href="clutch.prob.couplings.html#q:379"><span class="id" title="variable">q</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="clutch.prob.couplings.html#q:379"><span class="id" title="variable">q</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.2'"><span class="id" title="notation">.2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hfg'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">HμS</span> <span class="id" title="var">p</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hfg</span> <span class="id" title="var">p</span><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.1'"><span class="id" title="notation">.1</span></a> <span class="id" title="var">p</span><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.2'"><span class="id" title="notation">.2</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="clutch.prelude.classical.html#ExcludedMiddle"><span class="id" title="lemma">ExcludedMiddle</span></a> (<span class="id" title="var">R</span> <span class="id" title="var">p</span><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.1'"><span class="id" title="notation">.1</span></a> <span class="id" title="var">p</span><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.2'"><span class="id" title="notation">.2</span></a>)) <span class="id" title="keyword">as</span> <span class="id" title="var">H3</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">HR</span> | <span class="id" title="var">HnR</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hfg</span> <span class="id" title="var">HR</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hfg</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">μ'</span> &amp; <span class="id" title="var">Hμ'1</span> &amp; <span class="id" title="var">Hμ'2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">μ'</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exists</span> <a class="idref" href="clutch.prob.distribution.html#dzero"><span class="id" title="definition">dzero</span></a>; <span class="id" title="tactic">intro</span> ; <span class="id" title="var">done</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Logic.ClassicalEpsilon.html#choice"><span class="id" title="lemma">ClassicalEpsilon.choice</span></a>  <span class="id" title="tactic">in</span> <span class="id" title="var">Hfg'</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">Ch</span> &amp; <span class="id" title="var">HCh</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> /<a class="idref" href="clutch.prob.couplings.html#is_Rcoupl"><span class="id" title="definition">is_Rcoupl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<a class="idref" href="clutch.prob.distribution.html#dbind"><span class="id" title="definition">dbind</span></a> <span class="id" title="var">Ch</span> <span class="id" title="var">μ</span>); <span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;To&nbsp;prove&nbsp;that&nbsp;the&nbsp;first&nbsp;marginal&nbsp;coincides&nbsp;is&nbsp;a&nbsp;matter&nbsp;of&nbsp;rearranging&nbsp;the&nbsp;sums&nbsp;and&nbsp;using&nbsp;the<br/>
&nbsp;&nbsp;&nbsp;&nbsp;fact&nbsp;that&nbsp;μ&nbsp;and&nbsp;(Ch&nbsp;p)&nbsp;are&nbsp;couplings&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.distribution.html#distr_ext"><span class="id" title="lemma">distr_ext</span></a>; <span class="id" title="tactic">intro</span> <span class="id" title="var">a'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.distribution.html#lmarg_pmf"><span class="id" title="lemma">lmarg_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.prob.distribution.html#pmf"><span class="id" title="projection">pmf</span></a> /= /<a class="idref" href="clutch.prob.distribution.html#dbind_pmf"><span class="id" title="definition">dbind_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="clutch.prob.distribution.html#distr_double_swap_lmarg"><span class="id" title="lemma">distr_double_swap_lmarg</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">setoid_rewrite</span> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC_scal_l"><span class="id" title="lemma">SeriesC_scal_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> (<a class="idref" href="clutch.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="p:386" class="idref" href="#p:386"><span class="id" title="binder">p</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="var">μ</span> <a class="idref" href="clutch.prob.couplings.html#p:383"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <span class="id" title="var">f</span> <a class="idref" href="clutch.prob.couplings.html#p:383"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.1'"><span class="id" title="notation">.1</span></a> <span class="id" title="var">a'</span>)); <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> (<span class="id" title="var">a</span> &amp; <span class="id" title="var">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rtotal_order"><span class="id" title="lemma">Rtotal_order</span></a> (<span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) 0) <span class="id" title="keyword">as</span> [<span class="id" title="var">Hlt</span> | [<span class="id" title="var">Heqz</span> | <span class="id" title="var">Hgt</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="clutch.prob.distribution.html#pmf_pos"><span class="id" title="projection">pmf_pos</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>); <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heqz</span>; <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">specialize</span> (<span class="id" title="var">HCh</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> (<span class="id" title="var">HμS</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="var">Hgt</span> )) <span class="id" title="keyword">as</span> ((<span class="id" title="var">HChL</span> &amp; <span class="id" title="var">HChR</span>) &amp; <span class="id" title="var">HChS</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">HChL</span> <a class="idref" href="clutch.prob.distribution.html#lmarg_pmf"><span class="id" title="lemma">lmarg_pmf</span></a> //=. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.countable_sum.html#fubini_pos_seriesC_prod_lr"><span class="id" title="lemma">fubini_pos_seriesC_prod_lr</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: { <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_pos"><span class="id" title="lemma">Rmult_le_pos</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: { <span class="id" title="tactic">apply</span> (<a class="idref" href="clutch.prob.countable_sum.html#ex_seriesC_le"><span class="id" title="lemma">ex_seriesC_le</span></a> <span class="id" title="var">_</span> <span class="id" title="var">μ</span>); [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">split</span>; [<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_pos"><span class="id" title="lemma">Rmult_le_pos</span></a>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rmult_1_r"><span class="id" title="lemma">Rmult_1_r</span></a>; <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_compat"><span class="id" title="lemma">Rmult_le_compat</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> (<a class="idref" href="clutch.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a:393" class="idref" href="#a:393"><span class="id" title="binder">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="b:394" class="idref" href="#b:394"><span class="id" title="binder">b</span></a> : <a class="idref" href="clutch.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.prob.couplings.html#a:387"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.couplings.html#b:388"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> ) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <span class="id" title="var">f</span> <a class="idref" href="clutch.prob.couplings.html#a:387"><span class="id" title="variable">a</span></a> <span class="id" title="var">a'</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ | <span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC_scal_r"><span class="id" title="lemma">SeriesC_scal_r</span></a> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> (<a class="idref" href="clutch.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a:398" class="idref" href="#a:398"><span class="id" title="binder">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">(</span></a><span class="id" title="var">μ1</span> <a class="idref" href="clutch.prob.couplings.html#a:395"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <span class="id" title="var">f</span> <a class="idref" href="clutch.prob.couplings.html#a:395"><span class="id" title="variable">a</span></a> <span class="id" title="var">a'</span>)); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">HμC</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">Hμ1</span> &amp; <span class="id" title="var">Hμ2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">Hμ1</span> <a class="idref" href="clutch.prob.distribution.html#lmarg_pmf"><span class="id" title="lemma">lmarg_pmf</span></a> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intro</span> <span class="id" title="var">b'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.prob.distribution.html#pmf"><span class="id" title="projection">pmf</span></a>/=/<a class="idref" href="clutch.prob.distribution.html#dbind_pmf"><span class="id" title="definition">dbind_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="clutch.prob.distribution.html#distr_double_swap_rmarg"><span class="id" title="lemma">distr_double_swap_rmarg</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> (<a class="idref" href="clutch.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="b:405" class="idref" href="#b:405"><span class="id" title="binder">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="var">μ</span> <a class="idref" href="clutch.prob.couplings.html#b:399"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a:406" class="idref" href="#a:406"><span class="id" title="binder">a</span></a> : <span class="id" title="var">A'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="var">Ch</span> <a class="idref" href="clutch.prob.couplings.html#b:399"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.prob.couplings.html#a:400"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>)) );<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ | <span class="id" title="tactic">intro</span> <span class="id" title="var">p</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC_scal_l"><span class="id" title="lemma">SeriesC_scal_l</span></a>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rle_trans"><span class="id" title="lemma">Rle_trans</span></a> <span class="id" title="var">_</span> (<a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="p:408" class="idref" href="#p:408"><span class="id" title="binder">p</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="var">μ</span> <a class="idref" href="clutch.prob.couplings.html#p:407"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <span class="id" title="var">g</span> <a class="idref" href="clutch.prob.couplings.html#p:407"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.2'"><span class="id" title="notation">.2</span></a> <span class="id" title="var">b'</span>)) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC_le"><span class="id" title="lemma">SeriesC_le</span></a>; [ | ]; <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> (<a class="idref" href="clutch.prob.countable_sum.html#ex_seriesC_le"><span class="id" title="lemma">ex_seriesC_le</span></a> <span class="id" title="var">_</span> <span class="id" title="var">μ</span>); [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_pos"><span class="id" title="lemma">Rmult_le_pos</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> -{2}(<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rmult_1_r"><span class="id" title="lemma">Rmult_1_r</span></a> (<span class="id" title="var">μ</span> <span class="id" title="var">_</span>)). <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_compat_l"><span class="id" title="lemma">Rmult_le_compat_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> (<span class="id" title="var">a</span> &amp; <span class="id" title="var">b</span>); <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_pos"><span class="id" title="lemma">Rmult_le_pos</span></a>; [<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a0:410" class="idref" href="#a0:410"><span class="id" title="binder">a0</span></a> : <span class="id" title="var">A'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="var">Ch</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.prob.couplings.html#a0:409"><span class="id" title="variable">a0</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.prob.distribution.html#rmarg"><span class="id" title="definition">rmarg</span></a> (<span class="id" title="var">Ch</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <span class="id" title="var">b'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> -&gt;; [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rtotal_order"><span class="id" title="lemma">Rtotal_order</span></a> (<span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) 0) <span class="id" title="keyword">as</span> [<span class="id" title="var">Hlt</span> | [<span class="id" title="var">Heqz</span> | <span class="id" title="var">Hgt</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="clutch.prob.distribution.html#pmf_pos"><span class="id" title="projection">pmf_pos</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>); <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heqz</span>; <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">specialize</span> (<span class="id" title="var">HCh</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> (<span class="id" title="var">HμS</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="var">Hgt</span> )) <span class="id" title="keyword">as</span> ((<span class="id" title="var">HChL</span> &amp; <span class="id" title="var">HChR</span>) &amp; <span class="id" title="var">HChS</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">HChR</span> <span class="id" title="var">b'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="clutch.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a> (<span class="id" title="var">Ch</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>)) <span class="id" title="tactic">in</span> <span class="id" title="var">HChR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_compat_l"><span class="id" title="lemma">Rmult_le_compat_l</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.countable_sum.html#fubini_pos_seriesC_prod_rl"><span class="id" title="lemma">fubini_pos_seriesC_prod_rl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: { <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_pos"><span class="id" title="lemma">Rmult_le_pos</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: { <span class="id" title="tactic">apply</span> (<a class="idref" href="clutch.prob.countable_sum.html#ex_seriesC_le"><span class="id" title="lemma">ex_seriesC_le</span></a> <span class="id" title="var">_</span> <span class="id" title="var">μ</span>); [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">split</span>; [<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_pos"><span class="id" title="lemma">Rmult_le_pos</span></a>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rmult_1_r"><span class="id" title="lemma">Rmult_1_r</span></a>; <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_compat"><span class="id" title="lemma">Rmult_le_compat</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC_le"><span class="id" title="lemma">SeriesC_le</span></a>; <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> (<a class="idref" href="clutch.prob.countable_sum.html#ex_seriesC_le"><span class="id" title="lemma">ex_seriesC_le</span></a> <span class="id" title="var">_</span> <span class="id" title="var">μ2</span>); [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_pos"><span class="id" title="lemma">Rmult_le_pos</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rmult_1_r"><span class="id" title="lemma">Rmult_1_r</span></a>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_compat_l"><span class="id" title="lemma">Rmult_le_compat_l</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">b</span>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC_scal_r"><span class="id" title="lemma">SeriesC_scal_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_pos"><span class="id" title="lemma">Rmult_le_pos</span></a>; [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="clutch.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">destruct</span> <span class="id" title="var">HμC</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">HμCL</span> <span class="id" title="var">HμCR</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC_scal_r"><span class="id" title="lemma">SeriesC_scal_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_compat_r"><span class="id" title="lemma">Rmult_le_compat_r</span></a>; [<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">HμCR</span> <span class="id" title="var">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">HμCR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> (<span class="id" title="var">a'</span> &amp; <span class="id" title="var">b'</span>) <span class="id" title="var">H3</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="clutch.prob.distribution.html#dbind_pos"><span class="id" title="lemma">dbind_pos</span></a> <span class="id" title="var">Ch</span> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <span class="id" title="keyword">as</span> (<span class="id" title="var">H4</span> &amp; <span class="id" title="var">H5</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">H4</span> <span class="id" title="var">H3</span>) <span class="id" title="keyword">as</span> ((<span class="id" title="var">a0</span>, <span class="id" title="var">b0</span>) &amp; <span class="id" title="var">H7</span> &amp; <span class="id" title="var">H8</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">HCh</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a0</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b0</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> (<span class="id" title="var">HμS</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a0</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b0</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="var">H8</span>)) <span class="id" title="keyword">as</span> (<span class="id" title="var">HCh1</span> &amp; <span class="id" title="var">HCh2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">HCh2</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="var">H7</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="refRcoupl_dzero" class="idref" href="#refRcoupl_dzero"><span class="id" title="lemma">refRcoupl_dzero</span></a> (<a id="f2f7061fed89cba6316bad97e4126439" class="idref" href="#f2f7061fed89cba6316bad97e4126439"><span class="id" title="binder">μ</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a>) (<a id="R:412" class="idref" href="#R:412"><span class="id" title="binder">R</span></a>: <a class="idref" href="clutch.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="clutch.prob.distribution.html#dzero"><span class="id" title="definition">dzero</span></a> <a class="idref" href="clutch.prob.couplings.html#f2f7061fed89cba6316bad97e4126439"><span class="id" title="variable">μ</span></a> <a class="idref" href="clutch.prob.couplings.html#R:412"><span class="id" title="variable">R</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <a class="idref" href="clutch.prob.distribution.html#dzero"><span class="id" title="definition">dzero</span></a>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.prob.distribution.html#lmarg"><span class="id" title="definition">lmarg</span></a> <a class="idref" href="clutch.prob.distribution.html#dmap_dzero"><span class="id" title="lemma">dmap_dzero</span></a>; <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a> {1}/<a class="idref" href="clutch.prob.distribution.html#pmf"><span class="id" title="projection">pmf</span></a>/=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC_0"><span class="id" title="lemma">SeriesC_0</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.prob.distribution.html#pmf"><span class="id" title="projection">pmf</span></a>/=; <span class="id" title="tactic">intros</span>; <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="refRcoupl_mono" class="idref" href="#refRcoupl_mono"><span class="id" title="lemma">refRcoupl_mono</span></a> (<a id="d6876054012fd323870403f623d8a2f0" class="idref" href="#d6876054012fd323870403f623d8a2f0"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="758081fb62afd3b19c322581654e4ec0" class="idref" href="#758081fb62afd3b19c322581654e4ec0"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a>) (<a id="R:415" class="idref" href="#R:415"><span class="id" title="binder">R</span></a> : <a class="idref" href="clutch.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) (<a id="S:416" class="idref" href="#S:416"><span class="id" title="binder">S</span></a> : <a class="idref" href="clutch.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="a:417" class="idref" href="#a:417"><span class="id" title="binder">a</span></a> <a id="b:418" class="idref" href="#b:418"><span class="id" title="binder">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob.couplings.html#R:415"><span class="id" title="variable">R</span></a> <a class="idref" href="clutch.prob.couplings.html#a:417"><span class="id" title="variable">a</span></a> <a class="idref" href="clutch.prob.couplings.html#b:418"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#S:416"><span class="id" title="variable">S</span></a> <a class="idref" href="clutch.prob.couplings.html#a:417"><span class="id" title="variable">a</span></a> <a class="idref" href="clutch.prob.couplings.html#b:418"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#d6876054012fd323870403f623d8a2f0"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#758081fb62afd3b19c322581654e4ec0"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.couplings.html#R:415"><span class="id" title="variable">R</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#d6876054012fd323870403f623d8a2f0"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#758081fb62afd3b19c322581654e4ec0"><span class="id" title="variable">μ2</span></a> <a class="idref" href="clutch.prob.couplings.html#S:416"><span class="id" title="variable">S</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hwk</span> [<span class="id" title="var">μ</span> [[<span class="id" title="var">HμL</span> <span class="id" title="var">HμR</span>] <span class="id" title="var">HμSupp</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">μ</span>; <span class="id" title="tactic">split</span>; [<span class="id" title="tactic">split</span>| ]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="refRcoupl_trivial" class="idref" href="#refRcoupl_trivial"><span class="id" title="lemma">refRcoupl_trivial</span></a> (<a id="978a54da06590edc6c04017b4e205c94" class="idref" href="#978a54da06590edc6c04017b4e205c94"><span class="id" title="binder">μ1</span></a> :<a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="e720ee33153840da3c543e2511440bb8" class="idref" href="#e720ee33153840da3c543e2511440bb8"><span class="id" title="binder">μ2</span></a> :<a class="idref" href="clutch.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="clutch.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="clutch.prob.couplings.html#978a54da06590edc6c04017b4e205c94"><span class="id" title="variable">μ1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="clutch.prob.couplings.html#e720ee33153840da3c543e2511440bb8"><span class="id" title="variable">μ2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="clutch.prob.couplings.html#978a54da06590edc6c04017b4e205c94"><span class="id" title="variable">μ1</span></a> <a class="idref" href="clutch.prob.couplings.html#e720ee33153840da3c543e2511440bb8"><span class="id" title="variable">μ2</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#::type_scope:'True'"><span class="id" title="notation">True</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hμ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="clutch.prob.distribution.html#pmf_SeriesC_ge_0"><span class="id" title="lemma">pmf_SeriesC_ge_0</span></a> <span class="id" title="var">μ1</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rlt_or_le"><span class="id" title="lemma">Rlt_or_le</span></a> 0 (<a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <span class="id" title="var">μ1</span>)); <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="clutch.prob.distribution.html#SeriesC_zero_dzero"><span class="id" title="lemma">SeriesC_zero_dzero</span></a> <span class="id" title="var">μ1</span>); [ | <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rle_antisym"><span class="id" title="lemma">Rle_antisym</span></a>; <span class="id" title="tactic">auto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.couplings.html#refRcoupl_dzero"><span class="id" title="lemma">refRcoupl_dzero</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">assert</span> (0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <span class="id" title="var">μ2</span>); [<span class="id" title="tactic">apply</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rlt_le_trans"><span class="id" title="lemma">Rlt_le_trans</span></a> <span class="id" title="var">_</span> (<a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <span class="id" title="var">μ1</span>))|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">done</span>|<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#2299a6ef56270a66cc1b95489d0f6e3a"><span class="id" title="notation">/</span></a> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <span class="id" title="var">μ2</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#2299a6ef56270a66cc1b95489d0f6e3a"><span class="id" title="notation">/</span></a> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <span class="id" title="var">μ2</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> (<a class="idref" href="clutch.prob.distribution.html#dprod"><span class="id" title="definition">dprod</span></a> <span class="id" title="var">μ1</span> <span class="id" title="var">μ2</span>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2"><span class="id" title="notation">&lt;=</span></a> 1) <span class="id" title="keyword">as</span> <span class="id" title="var">Hle1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">left</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rinv_0_lt_compat"><span class="id" title="lemma">Rinv_0_lt_compat</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.distribution.html#dprod_mass"><span class="id" title="lemma">dprod_mass</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Raxioms.html#Rmult_comm"><span class="id" title="lemma">Rmult_comm</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Raxioms.html#Rmult_assoc"><span class="id" title="lemma">Rmult_assoc</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rinv_r"><span class="id" title="lemma">Rinv_r</span></a>; [|<span class="id" title="var">lra</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rmult_1_r"><span class="id" title="lemma">Rmult_1_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">done</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span> (<a class="idref" href="clutch.prob.distribution.html#distr_scal"><span class="id" title="definition">distr_scal</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#2299a6ef56270a66cc1b95489d0f6e3a"><span class="id" title="notation">/(</span></a><a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <span class="id" title="var">μ2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Rdefinitions.html#2299a6ef56270a66cc1b95489d0f6e3a"><span class="id" title="notation">)</span></a>) (<a class="idref" href="clutch.prob.distribution.html#dprod"><span class="id" title="definition">dprod</span></a> <span class="id" title="var">μ1</span> <span class="id" title="var">μ2</span>) <span class="id" title="var">Hle1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [|<span class="id" title="var">done</span>]. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.distribution.html#distr_ext"><span class="id" title="lemma">distr_ext</span></a>. <span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.distribution.html#lmarg_pmf"><span class="id" title="lemma">lmarg_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC_scal_l"><span class="id" title="lemma">SeriesC_scal_l</span></a> -<a class="idref" href="clutch.prob.distribution.html#lmarg_pmf"><span class="id" title="lemma">lmarg_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.distribution.html#lmarg_dprod_pmf"><span class="id" title="lemma">lmarg_dprod_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Raxioms.html#Rmult_comm"><span class="id" title="lemma">Rmult_comm</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Raxioms.html#Rmult_assoc"><span class="id" title="lemma">Rmult_assoc</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rinv_r"><span class="id" title="lemma">Rinv_r</span></a>; <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intro</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a> <a class="idref" href="clutch.prob.countable_sum.html#SeriesC_scal_l"><span class="id" title="lemma">SeriesC_scal_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="clutch.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a> <a class="idref" href="clutch.prob.distribution.html#rmarg_dprod_pmf"><span class="id" title="lemma">rmarg_dprod_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Raxioms.html#Rmult_comm"><span class="id" title="lemma">Rmult_comm</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.Raxioms.html#Rmult_assoc"><span class="id" title="lemma">Rmult_assoc</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -{2}(<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rmult_1_r"><span class="id" title="lemma">Rmult_1_r</span></a> (<span class="id" title="var">μ2</span> <span class="id" title="var">b</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_compat_l"><span class="id" title="lemma">Rmult_le_compat_l</span></a>; [<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> (<a class="idref" href="http://coquelicot.saclay.inria.fr/html//Coquelicot.Rcomplements.html#Rdiv_le_1"><span class="id" title="lemma">Rdiv_le_1</span></a> (<a class="idref" href="clutch.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <span class="id" title="var">μ1</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="clutch.prob.couplings.html#refRcoupl"><span class="id" title="section">refRcoupl</span></a>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> <a id="6d1c2ec99ec962f82862cf2642d15ee2" class="idref" href="#6d1c2ec99ec962f82862cf2642d15ee2"><span class="id" title="notation">&quot;</span></a>μ1 '≾' μ2 ':' R" :=<br/>
&nbsp;&nbsp;(<a class="idref" href="clutch.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <span class="id" title="var">μ1</span> <span class="id" title="var">μ2</span> <span class="id" title="var">R</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 100, <span class="id" title="var">μ2</span> <span class="id" title="tactic">at</span> <span class="id" title="var">next</span> <span class="id" title="keyword">level</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">R</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 200,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">format</span> "'[hv' μ1  '/' '≾'  '/  ' μ2  :  R ']'").<br/>

<br/>
<span class="id" title="keyword">Notation</span> <a id="6ead78d36f492c9660fec45b78207c8c" class="idref" href="#6ead78d36f492c9660fec45b78207c8c"><span class="id" title="notation">&quot;</span></a>μ1 '≿' μ2 ':' R" :=<br/>
&nbsp;&nbsp;(<a class="idref" href="clutch.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <span class="id" title="var">μ2</span> <span class="id" title="var">μ1</span> <span class="id" title="var">R</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 100, <span class="id" title="var">μ2</span> <span class="id" title="tactic">at</span> <span class="id" title="var">next</span> <span class="id" title="keyword">level</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">R</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 200, <span class="id" title="var">only</span> <span class="id" title="var">parsing</span>).<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/coq-community/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
