<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="resources/coqdoc.css" rel="stylesheet" type="text/css" />
<link href="resources/coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resources/config.js"></script>
<script type="text/javascript" src="resources/coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="https://github.com/logsem/clutch">Project Page</a>
      <a href="./indexpage.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">clutch.eris.examples.miller_rabin</h1>

<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">clutch.eris</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="clutch.eris.eris.html#"><span class="id" title="library">eris</span></a>.<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="http://coquelicot.saclay.inria.fr/html//Coquelicot.Hierarchy.html#"><span class="id" title="module">Hierarchy</span></a>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">mathcomp</span> <span class="id" title="keyword">Require</span> <span class="id" title="library">ssrnat</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">mathcomp</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">div</span> <span class="id" title="library">prime</span> <span class="id" title="library">zmodp</span> <span class="id" title="library">finset</span> <span class="id" title="library">fintype</span> <span class="id" title="library">ssrbool</span> <span class="id" title="library">fingroup.fingroup</span> <span class="id" title="library">solvable.cyclic</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="miller_rabin_code" class="idref" href="#miller_rabin_code"><span class="id" title="section">miller_rabin_code</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="erisGS0:2" class="idref" href="#erisGS0:2"><span class="id" title="binder">!</span></a><a id="erisGS0:2" class="idref" href="#erisGS0:2"><span class="id" title="binder">erisGS</span></a> <a id="0101b9beac487b383a5ba2a8f6922788" class="idref" href="#0101b9beac487b383a5ba2a8f6922788"><span class="id" title="binder"><span id="erisGS0:2" class="id">Σ</span></span></a>}.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;Miller-Rabin&nbsp;test&nbsp;is&nbsp;a&nbsp;probabilistic&nbsp;test&nbsp;for&nbsp;primality,&nbsp;that<br/>
&nbsp;&nbsp;&nbsp;&nbsp;always&nbsp;returns&nbsp;true&nbsp;for&nbsp;prime&nbsp;numbers,&nbsp;and&nbsp;it&nbsp;returns&nbsp;false&nbsp;for<br/>
&nbsp;&nbsp;&nbsp;&nbsp;composite&nbsp;numbers&nbsp;with&nbsp;probability&nbsp;at&nbsp;least&nbsp;1/2.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;It&nbsp;relies&nbsp;on&nbsp;two&nbsp;properties:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;Fermat's&nbsp;little&nbsp;theorem:&nbsp;for&nbsp;every&nbsp;prime&nbsp;p,&nbsp;and&nbsp;every&nbsp;(0&nbsp;&lt;&nbsp;x&nbsp;&lt;&nbsp;p),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;^&nbsp;(p&nbsp;-&nbsp;1)&nbsp;=&nbsp;1&nbsp;mod&nbsp;p<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;For&nbsp;every&nbsp;prime&nbsp;p,&nbsp;the&nbsp;equation<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;^&nbsp;2&nbsp;=&nbsp;1&nbsp;mod&nbsp;p<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;only&nbsp;has&nbsp;solutions&nbsp;{1,&nbsp;p-1}&nbsp;in&nbsp;(0&nbsp;&lt;&nbsp;x&nbsp;&lt;&nbsp;p)<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;algorithm&nbsp;receives&nbsp;an&nbsp;input&nbsp;m&nbsp;to&nbsp;test&nbsp;for&nbsp;primality,&nbsp;we&nbsp;assume<br/>
&nbsp;&nbsp;&nbsp;&nbsp;w.l.o.g&nbsp;that&nbsp;m&nbsp;is&nbsp;odd.&nbsp;Therefore,&nbsp;m&nbsp;-&nbsp;1&nbsp;=&nbsp;2^t&nbsp;*&nbsp;u&nbsp;for&nbsp;some&nbsp;t,&nbsp;u<br/>
&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;u&nbsp;odd.&nbsp;Miller-Rabin's&nbsp;test&nbsp;samples&nbsp;x&nbsp;s.t.&nbsp;(0&nbsp;&lt;&nbsp;x&nbsp;&lt;&nbsp;p),&nbsp;and<br/>
&nbsp;&nbsp;&nbsp;&nbsp;computes&nbsp;the&nbsp;sequence&nbsp;(modulo&nbsp;m):<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;^&nbsp;u&nbsp;,&nbsp;x&nbsp;^&nbsp;(2&nbsp;*&nbsp;u),&nbsp;x&nbsp;^&nbsp;(2^2&nbsp;*&nbsp;u),&nbsp;...,&nbsp;x&nbsp;^&nbsp;(2^(t-1)&nbsp;*&nbsp;u)<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;checking&nbsp;if&nbsp;any&nbsp;of&nbsp;the&nbsp;two&nbsp;conditions&nbsp;above&nbsp;is&nbsp;violated.&nbsp;For&nbsp;this<br/>
&nbsp;&nbsp;&nbsp;&nbsp;it&nbsp;is&nbsp;enough&nbsp;to&nbsp;check&nbsp;that&nbsp;x&nbsp;^&nbsp;u&nbsp;≠&nbsp;1&nbsp;mod&nbsp;m,&nbsp;and&nbsp;that,&nbsp;for&nbsp;all&nbsp;0&nbsp;≤&nbsp;k&nbsp;&lt;&nbsp;t,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;^&nbsp;(2^k&nbsp;*&nbsp;u)&nbsp;≠&nbsp;m&nbsp;-&nbsp;1&nbsp;(mod&nbsp;m).&nbsp;In&nbsp;that&nbsp;case,&nbsp;we&nbsp;say&nbsp;x&nbsp;is&nbsp;a&nbsp;Miller-Rabin&nbsp;witness,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;m&nbsp;must&nbsp;be&nbsp;composite.&nbsp;Conversely,&nbsp;if&nbsp;m&nbsp;is&nbsp;prime,&nbsp;we&nbsp;know&nbsp;that<br/>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;^&nbsp;(2^t&nbsp;*&nbsp;u)&nbsp;=&nbsp;1&nbsp;mod&nbsp;m,&nbsp;so&nbsp;either&nbsp;the&nbsp;entire&nbsp;sequence&nbsp;is&nbsp;constantly&nbsp;1,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;including&nbsp;x&nbsp;^&nbsp;u,&nbsp;or&nbsp;one&nbsp;of&nbsp;the&nbsp;elemets&nbsp;is&nbsp;m&nbsp;-&nbsp;1.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;known&nbsp;result&nbsp;states&nbsp;that,&nbsp;for&nbsp;every&nbsp;composite&nbsp;m,&nbsp;at&nbsp;least&nbsp;half&nbsp;of<br/>
&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;elements&nbsp;in&nbsp;(0&nbsp;&lt;&nbsp;x&nbsp;&lt;&nbsp;m-1)&nbsp;are&nbsp;Miller-Rabin&nbsp;witnesses.&nbsp;This&nbsp;is&nbsp;due&nbsp;to<br/>
&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;fact&nbsp;that&nbsp;there&nbsp;is&nbsp;a&nbsp;proper&nbsp;subgroup&nbsp;G&nbsp;of&nbsp;the&nbsp;group&nbsp;of&nbsp;multiplicative<br/>
&nbsp;&nbsp;&nbsp;&nbsp;inverses&nbsp;(Z_m)^*&nbsp;containing&nbsp;all&nbsp;Miller-Rabin&nbsp;non-witnesses,&nbsp;so&nbsp;their<br/>
&nbsp;&nbsp;&nbsp;&nbsp;cardinality&nbsp;is&nbsp;at&nbsp;most&nbsp;|(Z_m)^*|/2.<br/>
<br/>
&nbsp;&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Notation</span> <a id="ce1fe98431dfb0cfd22d83ce3801a3d3" class="idref" href="#ce1fe98431dfb0cfd22d83ce3801a3d3"><span class="id" title="notation">&quot;</span></a>e1 || e2" := (<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.BinOp"><span class="id" title="constructor">BinOp</span></a> <a class="idref" href="clutch.prob_lang.lang.html#prob_lang.OrOp"><span class="id" title="constructor">OrOp</span></a> <span class="id" title="var">e1</span>%<span class="id" title="var">E</span> <span class="id" title="var">e2</span>%<span class="id" title="var">E</span>) : <span class="id" title="var">expr_scope</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Takes&nbsp;an&nbsp;integer&nbsp;n&nbsp;and&nbsp;returns&nbsp;a&nbsp;pair<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;u,&nbsp;t&nbsp;with&nbsp;n&nbsp;=&nbsp;(2^t)&nbsp;u,&nbsp;and&nbsp;u&nbsp;odd<br/>
&nbsp;&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="power_two_decomp" class="idref" href="#power_two_decomp"><span class="id" title="definition">power_two_decomp</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="clutch.prob_lang.notation.html#3b4611ead68c65413f980c1d4a390696"><span class="id" title="notation">rec</span></a><a class="idref" href="clutch.prob_lang.notation.html#3b4611ead68c65413f980c1d4a390696"><span class="id" title="notation">:</span></a> "g" "n" <a class="idref" href="clutch.prob_lang.notation.html#3b4611ead68c65413f980c1d4a390696"><span class="id" title="notation">:=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a><a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">:</span></a> "n" <a class="idref" href="clutch.prob_lang.notation.html#0cf252c323579dc4cc2094194e7b3a0a"><span class="id" title="notation">`</span></a><a class="idref" href="clutch.prob_lang.notation.html#0cf252c323579dc4cc2094194e7b3a0a"><span class="id" title="notation">rem</span></a><a class="idref" href="clutch.prob_lang.notation.html#0cf252c323579dc4cc2094194e7b3a0a"><span class="id" title="notation">`</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>2 <a class="idref" href="clutch.prob_lang.notation.html#268bceb185e8402e5a254d7b9bacc674"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>1 <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">(</span></a>"n"<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>0<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">(</span></a>"u"<a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">,</span></a> "t"<a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">:=</span></a> "g" ("n" <a class="idref" href="clutch.prob_lang.notation.html#08b4b583c1bf9e0e3dd4723c0b74bb2d"><span class="id" title="notation">`</span></a><a class="idref" href="clutch.prob_lang.notation.html#08b4b583c1bf9e0e3dd4723c0b74bb2d"><span class="id" title="notation">quot</span></a><a class="idref" href="clutch.prob_lang.notation.html#08b4b583c1bf9e0e3dd4723c0b74bb2d"><span class="id" title="notation">`</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>2) <a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">(</span></a>"u"<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">,</span></a> "t" <a class="idref" href="clutch.prob_lang.notation.html#a4d9e3466bf1928a450a1a8426a17af3"><span class="id" title="notation">+</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>1<a class="idref" href="clutch.prob_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">)</span></a>)%<span class="id" title="var">V</span>.<br/>

<br/>
&nbsp;<span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Computes&nbsp;b^e&nbsp;mod&nbsp;m&nbsp;using&nbsp;repeated&nbsp;squaring<br/>
&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="fast_mod_exp" class="idref" href="#fast_mod_exp"><span class="id" title="definition">fast_mod_exp</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="clutch.prob_lang.notation.html#b655cc6b0c09a3d45e15582d945b2696"><span class="id" title="notation">rec</span></a><a class="idref" href="clutch.prob_lang.notation.html#b655cc6b0c09a3d45e15582d945b2696"><span class="id" title="notation">:</span></a> "g" "b" "e" "m" <a class="idref" href="clutch.prob_lang.notation.html#b655cc6b0c09a3d45e15582d945b2696"><span class="id" title="notation">:=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a><a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">:</span></a> "e" <a class="idref" href="clutch.prob_lang.notation.html#268bceb185e8402e5a254d7b9bacc674"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>0 <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "r" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> "g" ( <a class="idref" href="clutch.prob_lang.notation.html#0cf252c323579dc4cc2094194e7b3a0a"><span class="id" title="notation">(</span></a>"b" <a class="idref" href="clutch.prob_lang.notation.html#da5221709ab13640970b110774ada169"><span class="id" title="notation">*</span></a> "b"<a class="idref" href="clutch.prob_lang.notation.html#0cf252c323579dc4cc2094194e7b3a0a"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.prob_lang.notation.html#0cf252c323579dc4cc2094194e7b3a0a"><span class="id" title="notation">`</span></a><a class="idref" href="clutch.prob_lang.notation.html#0cf252c323579dc4cc2094194e7b3a0a"><span class="id" title="notation">rem</span></a><a class="idref" href="clutch.prob_lang.notation.html#0cf252c323579dc4cc2094194e7b3a0a"><span class="id" title="notation">`</span></a> "m") ("e" <a class="idref" href="clutch.prob_lang.notation.html#08b4b583c1bf9e0e3dd4723c0b74bb2d"><span class="id" title="notation">`</span></a><a class="idref" href="clutch.prob_lang.notation.html#08b4b583c1bf9e0e3dd4723c0b74bb2d"><span class="id" title="notation">quot</span></a><a class="idref" href="clutch.prob_lang.notation.html#08b4b583c1bf9e0e3dd4723c0b74bb2d"><span class="id" title="notation">`</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>2) "m" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a><a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">:</span></a> "e" <a class="idref" href="clutch.prob_lang.notation.html#0cf252c323579dc4cc2094194e7b3a0a"><span class="id" title="notation">`</span></a><a class="idref" href="clutch.prob_lang.notation.html#0cf252c323579dc4cc2094194e7b3a0a"><span class="id" title="notation">rem</span></a><a class="idref" href="clutch.prob_lang.notation.html#0cf252c323579dc4cc2094194e7b3a0a"><span class="id" title="notation">`</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>2 <a class="idref" href="clutch.prob_lang.notation.html#268bceb185e8402e5a254d7b9bacc674"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> "r"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="clutch.prob_lang.notation.html#0cf252c323579dc4cc2094194e7b3a0a"><span class="id" title="notation">(</span></a>"b" <a class="idref" href="clutch.prob_lang.notation.html#da5221709ab13640970b110774ada169"><span class="id" title="notation">*</span></a> "r"<a class="idref" href="clutch.prob_lang.notation.html#0cf252c323579dc4cc2094194e7b3a0a"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.prob_lang.notation.html#0cf252c323579dc4cc2094194e7b3a0a"><span class="id" title="notation">`</span></a><a class="idref" href="clutch.prob_lang.notation.html#0cf252c323579dc4cc2094194e7b3a0a"><span class="id" title="notation">rem</span></a><a class="idref" href="clutch.prob_lang.notation.html#0cf252c323579dc4cc2094194e7b3a0a"><span class="id" title="notation">`</span></a> "m")%<span class="id" title="var">V</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Auxiliary&nbsp;function&nbsp;for&nbsp;a&nbsp;Miller-Rabin&nbsp;round.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Computes&nbsp;the&nbsp;sequence&nbsp;(modulo&nbsp;m):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;,&nbsp;y^2,&nbsp;...,&nbsp;y^(t-1)<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;returns&nbsp;true&nbsp;iff&nbsp;any&nbsp;element&nbsp;is&nbsp;m-1<br/>
&nbsp;&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="MR_round_aux" class="idref" href="#MR_round_aux"><span class="id" title="definition">MR_round_aux</span></a> : <a class="idref" href="clutch.prob_lang.lang.html#prob_lang.val"><span class="id" title="inductive">val</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="clutch.prob_lang.notation.html#b655cc6b0c09a3d45e15582d945b2696"><span class="id" title="notation">rec</span></a><a class="idref" href="clutch.prob_lang.notation.html#b655cc6b0c09a3d45e15582d945b2696"><span class="id" title="notation">:</span></a> "g" "y" "m" "t" <a class="idref" href="clutch.prob_lang.notation.html#b655cc6b0c09a3d45e15582d945b2696"><span class="id" title="notation">:=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a><a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">:</span></a> "t" <a class="idref" href="clutch.prob_lang.notation.html#268bceb185e8402e5a254d7b9bacc674"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>0 <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a><a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">:</span></a> "y" <a class="idref" href="clutch.prob_lang.notation.html#268bceb185e8402e5a254d7b9bacc674"><span class="id" title="notation">=</span></a> "m" <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>1 <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> "g" (<a class="idref" href="clutch.prob_lang.notation.html#0cf252c323579dc4cc2094194e7b3a0a"><span class="id" title="notation">(</span></a>"y" <a class="idref" href="clutch.prob_lang.notation.html#da5221709ab13640970b110774ada169"><span class="id" title="notation">*</span></a> "y"<a class="idref" href="clutch.prob_lang.notation.html#0cf252c323579dc4cc2094194e7b3a0a"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.prob_lang.notation.html#0cf252c323579dc4cc2094194e7b3a0a"><span class="id" title="notation">`</span></a><a class="idref" href="clutch.prob_lang.notation.html#0cf252c323579dc4cc2094194e7b3a0a"><span class="id" title="notation">rem</span></a><a class="idref" href="clutch.prob_lang.notation.html#0cf252c323579dc4cc2094194e7b3a0a"><span class="id" title="notation">`</span></a> "m") "m" ("t" <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>1))%<span class="id" title="var">V</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Testing&nbsp;a&nbsp;potential&nbsp;witness&nbsp;1&nbsp;&lt;&nbsp;x&nbsp;&lt;&nbsp;m<br/>
&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;m-1&nbsp;can&nbsp;be&nbsp;decomposed&nbsp;as&nbsp;2^t&nbsp;u<br/>
&nbsp;&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="MR_round" class="idref" href="#MR_round"><span class="id" title="definition">MR_round</span></a> : <a class="idref" href="clutch.prob_lang.lang.html#prob_lang.val"><span class="id" title="inductive">val</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="clutch.prob_lang.notation.html#e649b1753bdf9a3d478633a8c7e61dc9"><span class="id" title="notation">λ</span></a><a class="idref" href="clutch.prob_lang.notation.html#e649b1753bdf9a3d478633a8c7e61dc9"><span class="id" title="notation">:</span></a> "m" "t" "u"<a class="idref" href="clutch.prob_lang.notation.html#e649b1753bdf9a3d478633a8c7e61dc9"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "x" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>1 <a class="idref" href="clutch.prob_lang.notation.html#a4d9e3466bf1928a450a1a8426a17af3"><span class="id" title="notation">+</span></a> <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'rand'_x"><span class="id" title="notation">rand</span></a> <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'rand'_x"><span class="id" title="notation">(</span></a>"m" <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>2<a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'rand'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "y" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#fast_mod_exp"><span class="id" title="definition">fast_mod_exp</span></a> "x" "u" "m"<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a><a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">:</span></a> "y" <a class="idref" href="clutch.prob_lang.notation.html#268bceb185e8402e5a254d7b9bacc674"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>1 <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_round_aux"><span class="id" title="definition">MR_round_aux</span></a> "y" "m" "t")%<span class="id" title="var">V</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;main&nbsp;function&nbsp;for&nbsp;the&nbsp;Miller-Rabin<br/>
&nbsp;&nbsp;&nbsp;&nbsp;test&nbsp;where&nbsp;only&nbsp;1&nbsp;iteration&nbsp;is&nbsp;performed<br/>
&nbsp;&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="MR_main" class="idref" href="#MR_main"><span class="id" title="definition">MR_main</span></a> : <a class="idref" href="clutch.prob_lang.lang.html#prob_lang.val"><span class="id" title="inductive">val</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="clutch.prob_lang.notation.html#704630d98f03f1fa6c74ab29b9831803"><span class="id" title="notation">λ</span></a><a class="idref" href="clutch.prob_lang.notation.html#704630d98f03f1fa6c74ab29b9831803"><span class="id" title="notation">:</span></a> "m"<a class="idref" href="clutch.prob_lang.notation.html#704630d98f03f1fa6c74ab29b9831803"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a><a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">:</span></a> "m" <a class="idref" href="clutch.prob_lang.notation.html#959e055f1ab3ff54c36dde10824af025"><span class="id" title="notation">≤</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>1 <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">(</span></a>"u"<a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">,</span></a> "t"<a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#power_two_decomp"><span class="id" title="definition">power_two_decomp</span></a> ("m" <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>1) <a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_round"><span class="id" title="definition">MR_round</span></a> "m" "t" "u")%<span class="id" title="var">V</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="is_MR_nonwitness" class="idref" href="#is_MR_nonwitness"><span class="id" title="definition">is_MR_nonwitness</span></a> (<a id="t:3" class="idref" href="#t:3"><span class="id" title="binder">t</span></a> <a id="u:4" class="idref" href="#u:4"><span class="id" title="binder">u</span></a> <a id="x:5" class="idref" href="#x:5"><span class="id" title="binder">x</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <a class="idref" href="clutch.eris.examples.miller_rabin.html#x:5"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">^</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#u:4"><span class="id" title="variable">u</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">mod</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">(</span></a>2<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">^</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#t:3"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e"><span class="id" title="notation">*</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:4"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> 1<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#f10153ef1a81fe79ed16d848b456c79b"><span class="id" title="notation">=?</span></a> 1 <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">mod</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">(</span></a>2<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">^</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#t:3"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e"><span class="id" title="notation">*</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:4"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> 1<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">)</span></a>)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">||</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Lists.List.html#existsb"><span class="id" title="definition">List.existsb</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="i:6" class="idref" href="#i:6"><span class="id" title="binder">i</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="clutch.eris.examples.miller_rabin.html#x:5"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">^((</span></a>2<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">^</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#i:6"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e"><span class="id" title="notation">*</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:4"><span class="id" title="variable">u</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">))</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">mod</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">(</span></a>2<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">^</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#t:3"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e"><span class="id" title="notation">*</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:4"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> 1<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#f10153ef1a81fe79ed16d848b456c79b"><span class="id" title="notation">=?</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">(</span></a>2<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">^</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#t:3"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e"><span class="id" title="notation">*</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:4"><span class="id" title="variable">u</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">)</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">mod</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">(</span></a>2<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">^</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#t:3"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e"><span class="id" title="notation">*</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:4"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> 1<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">)</span></a>)%<span class="id" title="var">Z</span>) (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Lists.List.html#seq"><span class="id" title="definition">seq</span></a> 0 (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.to_nat"><span class="id" title="definition">Z.to_nat</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#t:3"><span class="id" title="variable">t</span></a>))<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">)</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="MR_nonwitness" class="idref" href="#MR_nonwitness"><span class="id" title="definition">MR_nonwitness</span></a> (<a id="m:7" class="idref" href="#m:7"><span class="id" title="binder">m</span></a> <a id="t:8" class="idref" href="#t:8"><span class="id" title="binder">t</span></a> <a id="u:9" class="idref" href="#u:9"><span class="id" title="binder">u</span></a> <a id="x:10" class="idref" href="#x:10"><span class="id" title="binder">x</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="clutch.eris.examples.miller_rabin.html#m:7"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 2<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">^</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#t:8"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e"><span class="id" title="notation">*</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:9"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.Odd"><span class="id" title="definition">Z.Odd</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:9"><span class="id" title="variable">u</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(1 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#x:10"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:7"><span class="id" title="variable">m</span></a> )%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <a class="idref" href="clutch.eris.examples.miller_rabin.html#x:10"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">^</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#u:9"><span class="id" title="variable">u</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">mod</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:7"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 1 <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">mod</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:7"><span class="id" title="variable">m</span></a>)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">\/</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">(</span></a><a id="i:11" class="idref" href="#i:11"><span class="id" title="binder">i</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">),</span></a> 0 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#i:11"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#t:8"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.eris.examples.miller_rabin.html#x:10"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">^(</span></a>2<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">^</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#i:11"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e"><span class="id" title="notation">*</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:9"><span class="id" title="variable">u</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">)</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">mod</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:7"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#m:7"><span class="id" title="variable">m</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">-</span></a>1<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">)</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">mod</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:7"><span class="id" title="variable">m</span></a> )%<span class="id" title="var">Z</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="MR_witness" class="idref" href="#MR_witness"><span class="id" title="definition">MR_witness</span></a> (<a id="m:12" class="idref" href="#m:12"><span class="id" title="binder">m</span></a> <a id="t:13" class="idref" href="#t:13"><span class="id" title="binder">t</span></a> <a id="u:14" class="idref" href="#u:14"><span class="id" title="binder">u</span></a> <a id="x:15" class="idref" href="#x:15"><span class="id" title="binder">x</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="clutch.eris.examples.miller_rabin.html#m:12"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 2<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">^</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#t:13"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e"><span class="id" title="notation">*</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:14"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.Odd"><span class="id" title="definition">Z.Odd</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:14"><span class="id" title="variable">u</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(1 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#x:15"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:12"><span class="id" title="variable">m</span></a> )%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <a class="idref" href="clutch.eris.examples.miller_rabin.html#x:15"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">^</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#u:14"><span class="id" title="variable">u</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">mod</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:12"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> 1 <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">mod</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:12"><span class="id" title="variable">m</span></a>)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#a46514f7419edb3d22453078cf7c9fb7"><span class="id" title="notation">forall</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#a46514f7419edb3d22453078cf7c9fb7"><span class="id" title="notation">(</span></a><a id="i:16" class="idref" href="#i:16"><span class="id" title="binder">i</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#a46514f7419edb3d22453078cf7c9fb7"><span class="id" title="notation">),</span></a> 0 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#i:16"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#t:13"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.eris.examples.miller_rabin.html#x:15"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">^(</span></a>2<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">^</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#i:16"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e"><span class="id" title="notation">*</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:14"><span class="id" title="variable">u</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">)</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">mod</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:12"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#m:12"><span class="id" title="variable">m</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">-</span></a>1<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">)</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">mod</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:12"><span class="id" title="variable">m</span></a> )%<span class="id" title="var">Z</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;These&nbsp;two&nbsp;lemmas&nbsp;need&nbsp;some&nbsp;group&nbsp;theory,&nbsp;but&nbsp;should<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;be&nbsp;available&nbsp;in&nbsp;standard&nbsp;textbooks,&nbsp;e.g&nbsp;Cormen&nbsp;et&nbsp;al&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a id="MR_witness_card" class="idref" href="#MR_witness_card"><span class="id" title="axiom">MR_witness_card</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="m:17" class="idref" href="#m:17"><span class="id" title="binder">m</span></a> <a id="t:18" class="idref" href="#t:18"><span class="id" title="binder">t</span></a> <a id="u:19" class="idref" href="#u:19"><span class="id" title="binder">u</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#b02645851bc60f28087c4c8d90376442"><span class="id" title="notation">¬</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.Znumtheory.html#prime"><span class="id" title="inductive">Znumtheory.prime</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:17"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="clutch.eris.examples.miller_rabin.html#m:17"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 2<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">^</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#t:18"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e"><span class="id" title="notation">*</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:19"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.Odd"><span class="id" title="definition">Z.Odd</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:19"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#length"><span class="id" title="abbreviation">length</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">List.filter</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="x:20" class="idref" href="#x:20"><span class="id" title="binder">x</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#is_MR_nonwitness"><span class="id" title="definition">is_MR_nonwitness</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#t:18"><span class="id" title="variable">t</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:19"><span class="id" title="variable">u</span></a> (1 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#x:20"><span class="id" title="variable">x</span></a>)) (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Lists.List.html#seq"><span class="id" title="definition">seq</span></a> 0 (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.to_nat"><span class="id" title="definition">Z.to_nat</span></a> (<a class="idref" href="clutch.eris.examples.miller_rabin.html#m:17"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">-</span></a> 1)))) <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#IZR"><span class="id" title="definition">IZR</span></a>(<a class="idref" href="clutch.eris.examples.miller_rabin.html#m:17"><span class="id" title="variable">m</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">-</span></a>1)<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b"><span class="id" title="notation">/</span></a> 2.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a id="fermat_little" class="idref" href="#fermat_little"><span class="id" title="axiom">fermat_little</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="p:22" class="idref" href="#p:22"><span class="id" title="binder">p</span></a> <a id="t:23" class="idref" href="#t:23"><span class="id" title="binder">t</span></a> <a id="u:24" class="idref" href="#u:24"><span class="id" title="binder">u</span></a> <a id="x:25" class="idref" href="#x:25"><span class="id" title="binder">x</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.Znumtheory.html#prime"><span class="id" title="inductive">Znumtheory.prime</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#p:22"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="clutch.eris.examples.miller_rabin.html#p:22"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 2<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">^</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#t:23"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e"><span class="id" title="notation">*</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:24"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.Odd"><span class="id" title="definition">Z.Odd</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:24"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(0 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#x:25"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#p:22"><span class="id" title="variable">p</span></a>)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_nonwitness"><span class="id" title="definition">MR_nonwitness</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#p:22"><span class="id" title="variable">p</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#t:23"><span class="id" title="variable">t</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:24"><span class="id" title="variable">u</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#x:25"><span class="id" title="variable">x</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="is_MR_nonwitness_false" class="idref" href="#is_MR_nonwitness_false"><span class="id" title="lemma">is_MR_nonwitness_false</span></a> (<a id="m:27" class="idref" href="#m:27"><span class="id" title="binder">m</span></a> <a id="t:28" class="idref" href="#t:28"><span class="id" title="binder">t</span></a> <a id="u:29" class="idref" href="#u:29"><span class="id" title="binder">u</span></a> <a id="x:30" class="idref" href="#x:30"><span class="id" title="binder">x</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(0 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#t:28"><span class="id" title="variable">t</span></a>)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(1 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:29"><span class="id" title="variable">u</span></a>)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="clutch.eris.examples.miller_rabin.html#m:27"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 2<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">^</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#t:28"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e"><span class="id" title="notation">*</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:29"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.Odd"><span class="id" title="definition">Z.Odd</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:29"><span class="id" title="variable">u</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(1 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#x:30"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:27"><span class="id" title="variable">m</span></a> )%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#is_MR_nonwitness"><span class="id" title="definition">is_MR_nonwitness</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#t:28"><span class="id" title="variable">t</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:29"><span class="id" title="variable">u</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#x:30"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_witness"><span class="id" title="definition">MR_witness</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:27"><span class="id" title="variable">m</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#t:28"><span class="id" title="variable">t</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:29"><span class="id" title="variable">u</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#x:30"><span class="id" title="variable">x</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.eris.examples.miller_rabin.html#is_MR_nonwitness"><span class="id" title="definition">is_MR_nonwitness</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Ht</span> <span class="id" title="var">Hu</span> <span class="id" title="var">Heq</span> <span class="id" title="var">Hodd</span> <span class="id" title="var">Hm</span> <span class="id" title="var">Hwit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Bool.Bool.html#orb_false_elim"><span class="id" title="lemma">orb_false_elim</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hwit</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hwit1</span> <span class="id" title="var">Hwit2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.eqb_neq"><span class="id" title="lemma">Z.eqb_neq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hwit1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_witness"><span class="id" title="definition">MR_witness</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heq</span> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">Hi1</span> <span class="id" title="var">Hi2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (@<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Lists.List.html#existsb_nth"><span class="id" title="lemma">existsb_nth</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.to_nat"><span class="id" title="definition">Z.to_nat</span></a> <span class="id" title="var">i</span>) 0%<span class="id" title="var">nat</span> ) <span class="id" title="tactic">in</span> <span class="id" title="var">Hwit2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.eqb_neq"><span class="id" title="lemma">Z.eqb_neq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hwit2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Hwit2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Lists.List.html#nth"><span class="id" title="definition">nth</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.to_nat"><span class="id" title="definition">Z.to_nat</span></a> <span class="id" title="var">i</span>) (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Lists.List.html#seq"><span class="id" title="definition">seq</span></a> 0 (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.to_nat"><span class="id" title="definition">Z.to_nat</span></a> <span class="id" title="var">t</span>)) 0%<span class="id" title="var">nat</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.to_nat"><span class="id" title="definition">Z.to_nat</span></a> <span class="id" title="var">i</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>) <span class="id" title="keyword">as</span> -&gt;; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Lists.List.html#seq_nth"><span class="id" title="lemma">seq_nth</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hi2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.Znat.html#Z2Nat.id"><span class="id" title="lemma">Z2Nat.id</span></a>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hi2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Lists.List.html#seq_length"><span class="id" title="lemma">seq_length</span></a>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="is_MR_nonwitness_true" class="idref" href="#is_MR_nonwitness_true"><span class="id" title="lemma">is_MR_nonwitness_true</span></a> (<a id="m:31" class="idref" href="#m:31"><span class="id" title="binder">m</span></a> <a id="t:32" class="idref" href="#t:32"><span class="id" title="binder">t</span></a> <a id="u:33" class="idref" href="#u:33"><span class="id" title="binder">u</span></a> <a id="x:34" class="idref" href="#x:34"><span class="id" title="binder">x</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(0 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#t:32"><span class="id" title="variable">t</span></a>)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(1 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:33"><span class="id" title="variable">u</span></a>)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="clutch.eris.examples.miller_rabin.html#m:31"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 2<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">^</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#t:32"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e"><span class="id" title="notation">*</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:33"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.Odd"><span class="id" title="definition">Z.Odd</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:33"><span class="id" title="variable">u</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(1 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#x:34"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:31"><span class="id" title="variable">m</span></a> )%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#is_MR_nonwitness"><span class="id" title="definition">is_MR_nonwitness</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#t:32"><span class="id" title="variable">t</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:33"><span class="id" title="variable">u</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#x:34"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_nonwitness"><span class="id" title="definition">MR_nonwitness</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:31"><span class="id" title="variable">m</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#t:32"><span class="id" title="variable">t</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:33"><span class="id" title="variable">u</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#x:34"><span class="id" title="variable">x</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.eris.examples.miller_rabin.html#is_MR_nonwitness"><span class="id" title="definition">is_MR_nonwitness</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_nonwitness"><span class="id" title="definition">MR_nonwitness</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Ht</span> <span class="id" title="var">Hu</span> <span class="id" title="var">Heq</span> <span class="id" title="var">Hodd</span> <span class="id" title="var">Hm</span> <span class="id" title="var">Hwit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Bool.Bool.html#orb_true_elim"><span class="id" title="lemma">orb_true_elim</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hwit</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hwit1</span> | <span class="id" title="var">Hwit2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.eqb_eq"><span class="id" title="lemma">Z.eqb_eq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hwit1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_witness"><span class="id" title="definition">MR_witness</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heq</span> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Lists.List.html#existsb_exists"><span class="id" title="lemma">existsb_exists</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hwit2</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">i</span> [<span class="id" title="var">Hi1</span> <span class="id" title="var">Hi2</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">i</span>; <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Lists.List.html#in_seq"><span class="id" title="lemma">in_seq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hi1</span>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.wp_tactics.html#wptac_mapsto"><span class="id" title="method">+</span></a> <a class="idref" href="clutch.prob_lang.wp_tactics.html#wptac_mapsto"><span class="id" title="method">rewrite</span></a> <span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.eqb_eq"><span class="id" title="lemma">Z.eqb_eq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hi2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hi2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="power_two_decomp_correct" class="idref" href="#power_two_decomp_correct"><span class="id" title="lemma">power_two_decomp_correct</span></a> (<a id="n:35" class="idref" href="#n:35"><span class="id" title="binder">n</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) <a id="E:36" class="idref" href="#E:36"><span class="id" title="binder">E</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">{{{</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌜</span></a> (0 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#n:35"><span class="id" title="variable">n</span></a>)%<span class="id" title="var">Z</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌝</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">}}}</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.eris.examples.miller_rabin.html#power_two_decomp"><span class="id" title="definition">power_two_decomp</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#n:35"><span class="id" title="variable">n</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">@</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#E:36"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">{{{</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">(</span></a><a id="u:37" class="idref" href="#u:37"><span class="id" title="binder">u</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) (<a id="t:38" class="idref" href="#t:38"><span class="id" title="binder">t</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a><a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">),</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">RET</span></a> <a class="idref" href="clutch.prob_lang.notation.html#cc14470b8443804ba405fa710525256d"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#u:37"><span class="id" title="variable">u</span></a><a class="idref" href="clutch.prob_lang.notation.html#cc14470b8443804ba405fa710525256d"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#t:38"><span class="id" title="variable">t</span></a><a class="idref" href="clutch.prob_lang.notation.html#cc14470b8443804ba405fa710525256d"><span class="id" title="notation">)</span></a>%<span class="id" title="var">V</span><a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌜</span></a> (<a class="idref" href="clutch.eris.examples.miller_rabin.html#n:35"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 2<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">^</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#t:38"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e"><span class="id" title="notation">*</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:37"><span class="id" title="variable">u</span></a>)%<span class="id" title="var">Z</span>  <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> (0 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#t:38"><span class="id" title="variable">t</span></a>)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.Odd"><span class="id" title="definition">Z.Odd</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:37"><span class="id" title="variable">u</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌝</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">}}}</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iLöb</span> <span class="id" title="keyword">as</span> "IH" <span class="id" title="keyword">forall</span> (<span class="id" title="var">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Φ</span> <span class="id" title="var">Hpos</span>) "HΦ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_rec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_bool_decide</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> "HΦ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.Odd"><span class="id" title="definition">Z.Odd</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.rem_mod_nonneg"><span class="id" title="lemma">Z.rem_mod_nonneg</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> {1}(<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.Zdiv.html#Z_div_mod_eq_full"><span class="id" title="lemma">Z_div_mod_eq_full</span></a> <span class="id" title="var">n</span> 2); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_bind</span> (<a class="idref" href="clutch.eris.examples.miller_rabin.html#power_two_decomp"><span class="id" title="definition">power_two_decomp</span></a> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#bc9fd2481486dc1ddc28ccbc3ddae226"><span class="id" title="notation">(</span></a>"IH" <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#bc9fd2481486dc1ddc28ccbc3ddae226"><span class="id" title="notation">$!</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#bc9fd2481486dc1ddc28ccbc3ddae226"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.quot_str_pos"><span class="id" title="lemma">Z.quot_str_pos</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">n</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> 1)%<span class="id" title="var">Z</span>; [| <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> -&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "!&gt;" (<span class="id" title="var">u</span> <span class="id" title="var">t'</span>) "[%Ht'1 [%Ht'2 %Ht'3]]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> "HΦ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [ | <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>; <span class="id" title="var">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.Zpower.html#Zpower_exp"><span class="id" title="lemma">Zpower_exp</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.mul_assoc"><span class="id" title="lemma">Z.mul_assoc</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.mul_comm"><span class="id" title="lemma">Z.mul_comm</span></a> <span class="id" title="var">_</span> <span class="id" title="var">u</span>) <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.mul_assoc"><span class="id" title="lemma">Z.mul_assoc</span></a> -<span class="id" title="var">Ht'1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.quot_div_nonneg"><span class="id" title="lemma">Z.quot_div_nonneg</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.pow_1_r"><span class="id" title="lemma">Z.pow_1_r</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.mul_comm"><span class="id" title="lemma">Z.mul_comm</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> {1}(<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.Zdiv.html#Z_div_mod_eq_full"><span class="id" title="lemma">Z_div_mod_eq_full</span></a> <span class="id" title="var">n</span> 2).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">n</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">mod</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a> 2 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 0)%<span class="id" title="var">Z</span>; [|<span class="id" title="var">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.rem_mod_nonneg"><span class="id" title="lemma">Z.rem_mod_nonneg</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">epose</span> <span class="id" title="var">proof</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.mod_pos_bound"><span class="id" title="lemma">Z.mod_pos_bound</span></a> <span class="id" title="var">n</span> 2) <span class="id" title="keyword">as</span> [? ?]; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ((<span class="id" title="var">n</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">mod</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a> 2)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> 1%<span class="id" title="var">Z</span>); <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="fast_mod_exp_correct" class="idref" href="#fast_mod_exp_correct"><span class="id" title="lemma">fast_mod_exp_correct</span></a> (<a id="b:39" class="idref" href="#b:39"><span class="id" title="binder">b</span></a> <a id="e:40" class="idref" href="#e:40"><span class="id" title="binder">e</span></a> <a id="m:41" class="idref" href="#m:41"><span class="id" title="binder">m</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) <a id="E:42" class="idref" href="#E:42"><span class="id" title="binder">E</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">{{{</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌜</span></a> (0 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#b:39"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> 0 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#e:40"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> 1 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:41"><span class="id" title="variable">m</span></a>)%<span class="id" title="var">Z</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌝</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">}}}</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.eris.examples.miller_rabin.html#fast_mod_exp"><span class="id" title="definition">fast_mod_exp</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#b:39"><span class="id" title="variable">b</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#e:40"><span class="id" title="variable">e</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#m:41"><span class="id" title="variable">m</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">@</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#E:42"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">{{{</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">(</span></a><a id="r:43" class="idref" href="#r:43"><span class="id" title="binder">r</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a><a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">RET</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#r:43"><span class="id" title="variable">r</span></a><a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌜</span></a>  (0 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#r:43"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:41"><span class="id" title="variable">m</span></a>)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> (<a class="idref" href="clutch.eris.examples.miller_rabin.html#b:39"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">^</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#e:40"><span class="id" title="variable">e</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">mod</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:41"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#r:43"><span class="id" title="variable">r</span></a>)%<span class="id" title="var">Z</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌝</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">}}}</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iLöb</span> <span class="id" title="keyword">as</span> "IH" <span class="id" title="keyword">forall</span> (<span class="id" title="var">b</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Φ</span> <span class="id" title="var">Hpos</span>) "HΦ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_rec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_bool_decide</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> "HΦ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> <span class="id" title="var">e</span> <span class="id" title="keyword">with</span> 0%<span class="id" title="var">Z</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">by</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.pow_0_r"><span class="id" title="lemma">Z.pow_0_r</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.mod_1_l"><span class="id" title="lemma">Z.mod_1_l</span></a>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_bind</span> (<a class="idref" href="clutch.eris.examples.miller_rabin.html#fast_mod_exp"><span class="id" title="definition">fast_mod_exp</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#bc9fd2481486dc1ddc28ccbc3ddae226"><span class="id" title="notation">(</span></a>"IH" <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#bc9fd2481486dc1ddc28ccbc3ddae226"><span class="id" title="notation">$!</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#bc9fd2481486dc1ddc28ccbc3ddae226"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.rem_nonneg"><span class="id" title="lemma">Z.rem_nonneg</span></a>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">split</span>; [|<span class="id" title="var">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.quot_pos"><span class="id" title="lemma">Z.quot_pos</span></a>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">iIntros</span> "!&gt;" (<span class="id" title="var">r</span>) "[%Hr1 %Hr2]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_bool_decide</span> <span class="id" title="keyword">as</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> "HΦ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Hr2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.quot_div_nonneg"><span class="id" title="lemma">Z.quot_div_nonneg</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.rem_mod_nonneg"><span class="id" title="lemma">Z.rem_mod_nonneg</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.Zpow_facts.html#Zpower_mod"><span class="id" title="lemma">Zpow_facts.Zpower_mod</span></a>; [ | <span class="id" title="var">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.pow_2_r"><span class="id" title="lemma">Z.pow_2_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.pow_mul_r"><span class="id" title="lemma">Z.pow_mul_r</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>; [ | <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.div_pos"><span class="id" title="lemma">Z.div_pos</span></a>; <span class="id" title="var">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (2 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e"><span class="id" title="notation">*</span></a> <span class="id" title="var">e</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#fcfee6d83fd9f57ee5dab2ec7173de08"><span class="id" title="notation">`</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#fcfee6d83fd9f57ee5dab2ec7173de08"><span class="id" title="notation">div</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#fcfee6d83fd9f57ee5dab2ec7173de08"><span class="id" title="notation">`</span></a> 2 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">e</span>)%<span class="id" title="var">Z</span> <span class="id" title="keyword">as</span> -&gt;; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> {2}(<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.Zdiv.html#Z_div_mod_eq_full"><span class="id" title="lemma">Z_div_mod_eq_full</span></a> <span class="id" title="var">e</span> 2).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.rem_mod_nonneg"><span class="id" title="lemma">Z.rem_mod_nonneg</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H0</span>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> "HΦ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.omega.PreOmega.html#Z.rem_bound_pos_pos"><span class="id" title="lemma">Z.rem_bound_pos_pos</span></a>; <span class="id" title="var">lia</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Hr2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.quot_div_nonneg"><span class="id" title="lemma">Z.quot_div_nonneg</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.rem_mod_nonneg"><span class="id" title="lemma">Z.rem_mod_nonneg</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.mul_nonneg_nonneg"><span class="id" title="lemma">Z.mul_nonneg_nonneg</span></a>; [<span class="id" title="var">lia</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.Zdiv.html#Z_mod_nonneg_nonneg"><span class="id" title="lemma">Z_mod_nonneg_nonneg</span></a>; [|<span class="id" title="var">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.pow_nonneg"><span class="id" title="lemma">Z.pow_nonneg</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.rem_nonneg"><span class="id" title="lemma">Z.rem_nonneg</span></a>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.rem_mod_nonneg"><span class="id" title="lemma">Z.rem_mod_nonneg</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.Zpow_facts.html#Zpower_mod"><span class="id" title="lemma">Zpow_facts.Zpower_mod</span></a>; [ | <span class="id" title="var">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.pow_2_r"><span class="id" title="lemma">Z.pow_2_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.pow_mul_r"><span class="id" title="lemma">Z.pow_mul_r</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>; [ | <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.div_pos"><span class="id" title="lemma">Z.div_pos</span></a>; <span class="id" title="var">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.Zdiv.html#Zmult_mod"><span class="id" title="lemma">Zmult_mod</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.Zdiv.html#Zmult_mod_idemp_r"><span class="id" title="lemma">Zmult_mod_idemp_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.Zdiv.html#Zmult_mod"><span class="id" title="lemma">Zmult_mod</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.pow_1_r"><span class="id" title="lemma">Z.pow_1_r</span></a> <span class="id" title="var">b</span>) <span class="id" title="tactic">at</span> 2.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.Zpower.html#Zpower_exp"><span class="id" title="lemma">Zpower_exp</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.add_comm"><span class="id" title="lemma">Z.add_comm</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> {1}(<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.Zdiv.html#Z_div_mod_eq_full"><span class="id" title="lemma">Z_div_mod_eq_full</span></a> <span class="id" title="var">e</span> 2).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 3 <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.rem_mod_nonneg"><span class="id" title="lemma">Z.rem_mod_nonneg</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">epose</span> <span class="id" title="var">proof</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.mod_pos_bound"><span class="id" title="lemma">Z.mod_pos_bound</span></a> <span class="id" title="var">e</span> 2) <span class="id" title="keyword">as</span> [? ?]; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ((<span class="id" title="var">e</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">mod</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a> 2)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> 0%<span class="id" title="var">Z</span>); <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">f_equal</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.le_ge"><span class="id" title="lemma">Z.le_ge</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.mul_nonneg_nonneg"><span class="id" title="lemma">Z.mul_nonneg_nonneg</span></a>; [<span class="id" title="var">lia</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.Zdiv.html#Z_div_pos"><span class="id" title="lemma">Z_div_pos</span></a>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="MR_round_aux_correct_aux" class="idref" href="#MR_round_aux_correct_aux"><span class="id" title="lemma">MR_round_aux_correct_aux</span></a> (<a id="y:44" class="idref" href="#y:44"><span class="id" title="binder">y</span></a> <a id="m:45" class="idref" href="#m:45"><span class="id" title="binder">m</span></a> <a id="t:46" class="idref" href="#t:46"><span class="id" title="binder">t</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) <a id="E:47" class="idref" href="#E:47"><span class="id" title="binder">E</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">{{{</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌜</span></a> (0 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#y:44"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:45"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> 1 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:45"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> 0 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#t:46"><span class="id" title="variable">t</span></a>)%<span class="id" title="var">Z</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌝</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">}}}</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_round_aux"><span class="id" title="definition">MR_round_aux</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#y:44"><span class="id" title="variable">y</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#m:45"><span class="id" title="variable">m</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#t:46"><span class="id" title="variable">t</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">@</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#E:47"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">{{{</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">(</span></a><a id="b:48" class="idref" href="#b:48"><span class="id" title="binder">b</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a><a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">RET</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#b:48"><span class="id" title="variable">b</span></a><a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌜</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#b:48"><span class="id" title="variable">b</span></a>  <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="i:49" class="idref" href="#i:49"><span class="id" title="binder">i</span></a>: <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> (0 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#i:49"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#t:46"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#y:44"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">^</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">(</span></a>2<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">^</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#i:49"><span class="id" title="variable">i</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">)</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">mod</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:45"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#m:45"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">-</span></a> 1<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">)</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">mod</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:45"><span class="id" title="variable">m</span></a>)%<span class="id" title="var">Z</span>  <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌝</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">}}}</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Φ</span> (<span class="id" title="var">Hym</span> &amp; <span class="id" title="var">Hm</span> &amp; <span class="id" title="var">Ht</span>)) "HΦ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -(<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.Znat.html#Z2Nat.id"><span class="id" title="lemma">Z2Nat.id</span></a> <span class="id" title="var">t</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iInduction</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.to_nat"><span class="id" title="definition">Z.to_nat</span></a> <span class="id" title="var">t</span>) <span class="id" title="keyword">as</span> [|<span class="id" title="var">t'</span>] "IH" <span class="id" title="keyword">forall</span> (<span class="id" title="var">y</span> <span class="id" title="var">m</span> <span class="id" title="var">Φ</span> <span class="id" title="var">Hym</span> <span class="id" title="var">Hm</span> <span class="id" title="var">Ht</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">wp_rec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> "HΦ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intro</span>. <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> (<span class="id" title="var">i</span> &amp; <span class="id" title="var">Hi</span>). <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">wp_rec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_bool_decide</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> "HΦ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> 0%<span class="id" title="var">nat</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">H2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#(</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">t'</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">-</span></a> 1<a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">)</span></a> <span class="id" title="keyword">with</span> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><span class="id" title="var">t'</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">f_equal</span>. <span class="id" title="var">lia</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#bc9fd2481486dc1ddc28ccbc3ddae226"><span class="id" title="notation">(</span></a>"IH" <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#bc9fd2481486dc1ddc28ccbc3ddae226"><span class="id" title="notation">$!</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#bc9fd2481486dc1ddc28ccbc3ddae226"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.rem_bound_pos"><span class="id" title="lemma">Z.rem_bound_pos</span></a>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">iPureIntro</span>. <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">iPureIntro</span>. <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">iIntros</span> "!&gt;" (<span class="id" title="var">b</span>) "%H1".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> "HΦ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">etransitivity</span>; [<span class="id" title="tactic">apply</span> <span class="id" title="var">H1</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">intros</span> (<span class="id" title="var">x</span> &amp; <span class="id" title="var">Hx1</span> &amp; <span class="id" title="var">Hx2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">exists</span> (<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">Z</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*** <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*** <span class="id" title="tactic">rewrite</span> -<span class="id" title="var">Hx2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.rem_mod_nonneg"><span class="id" title="lemma">Z.rem_mod_nonneg</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.Zpow_facts.html#Zpower_mod"><span class="id" title="lemma">Zpow_facts.Zpower_mod</span></a>; [ | <span class="id" title="var">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.pow_2_r"><span class="id" title="lemma">Z.pow_2_r</span></a> -<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.pow_mul_r"><span class="id" title="lemma">Z.pow_mul_r</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.pow_add_r"><span class="id" title="lemma">Z.pow_add_r</span></a>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> 0)%<span class="id" title="var">Z</span> <span class="id" title="keyword">as</span> <span class="id" title="var">Hx3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> -&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.pow_0_r"><span class="id" title="lemma">Z.pow_0_r</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.pow_1_r"><span class="id" title="lemma">Z.pow_1_r</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hx2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.mod_small"><span class="id" title="lemma">Z.mod_small</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hx2</span>; [ |<span class="id" title="var">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.mod_small"><span class="id" title="lemma">Z.mod_small</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hx2</span>; [ |<span class="id" title="var">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">simplify_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">-</span></a>1)%<span class="id" title="var">Z</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">lia</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">Hx2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.rem_mod_nonneg"><span class="id" title="lemma">Z.rem_mod_nonneg</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.Zpow_facts.html#Zpower_mod"><span class="id" title="lemma">Zpow_facts.Zpower_mod</span></a>; [ | <span class="id" title="var">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.pow_2_r"><span class="id" title="lemma">Z.pow_2_r</span></a> -<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.pow_mul_r"><span class="id" title="lemma">Z.pow_mul_r</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -{1}(<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.pow_1_r"><span class="id" title="lemma">Z.pow_1_r</span></a> 2).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.pow_add_r"><span class="id" title="lemma">Z.pow_add_r</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="MR_round_aux_correct_nonwit" class="idref" href="#MR_round_aux_correct_nonwit"><span class="id" title="lemma">MR_round_aux_correct_nonwit</span></a> (<a id="x:50" class="idref" href="#x:50"><span class="id" title="binder">x</span></a> <a id="m:51" class="idref" href="#m:51"><span class="id" title="binder">m</span></a> <a id="t:52" class="idref" href="#t:52"><span class="id" title="binder">t</span></a> <a id="u:53" class="idref" href="#u:53"><span class="id" title="binder">u</span></a>: <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) <a id="E:54" class="idref" href="#E:54"><span class="id" title="binder">E</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">{{{</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌜</span></a> (1 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:51"><span class="id" title="variable">m</span></a>)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> (0 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#t:52"><span class="id" title="variable">t</span></a>)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> (0 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:53"><span class="id" title="variable">u</span></a>)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> (<a class="idref" href="clutch.eris.examples.miller_rabin.html#x:50"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">^</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:53"><span class="id" title="variable">u</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">mod</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:51"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> 1)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_nonwitness"><span class="id" title="definition">MR_nonwitness</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:51"><span class="id" title="variable">m</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#t:52"><span class="id" title="variable">t</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:53"><span class="id" title="variable">u</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#x:50"><span class="id" title="variable">x</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌝</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">}}}</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_round_aux"><span class="id" title="definition">MR_round_aux</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#(</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#x:50"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">^</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:53"><span class="id" title="variable">u</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">mod</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:51"><span class="id" title="variable">m</span></a><a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#m:51"><span class="id" title="variable">m</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#t:52"><span class="id" title="variable">t</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">@</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#E:54"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">{{{</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">(</span></a><a id="b:55" class="idref" href="#b:55"><span class="id" title="binder">b</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a><a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">RET</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#b:55"><span class="id" title="variable">b</span></a><a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌜</span></a>  <a class="idref" href="clutch.eris.examples.miller_rabin.html#b:55"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>  <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌝</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">}}}</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_nonwitness"><span class="id" title="definition">MR_nonwitness</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Φ</span> (<span class="id" title="var">Hm</span> &amp; <span class="id" title="var">Ht</span> &amp; <span class="id" title="var">Hu</span> &amp; <span class="id" title="var">Hneq</span> &amp; <span class="id" title="var">H2</span>)) "HΦ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">H3</span> | [<span class="id" title="var">i</span> [<span class="id" title="var">Hi1</span> <span class="id" title="var">Hi2</span>]]] .<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">exfalso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Hneq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span> <span class="id" title="keyword">as</span> (?&amp;?&amp;?&amp;-&gt;).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.mod_1_l"><span class="id" title="lemma">Z.mod_1_l</span></a>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_apply</span> <a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_round_aux_correct_aux"><span class="id" title="lemma">MR_round_aux_correct_aux</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.mod_pos_bound"><span class="id" title="lemma">Z.mod_pos_bound</span></a>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">b</span>) "%Hb".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> "HΦ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#Is_true_true"><span class="id" title="lemma">Is_true_true</span></a>, <span class="id" title="var">Hb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">Hi2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.Zpow_facts.html#Zpower_mod"><span class="id" title="lemma">Zpow_facts.Zpower_mod</span></a>; [|<span class="id" title="var">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.pow_mul_r"><span class="id" title="lemma">Z.pow_mul_r</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="MR_round_aux_correct_wit" class="idref" href="#MR_round_aux_correct_wit"><span class="id" title="lemma">MR_round_aux_correct_wit</span></a> (<a id="x:56" class="idref" href="#x:56"><span class="id" title="binder">x</span></a> <a id="m:57" class="idref" href="#m:57"><span class="id" title="binder">m</span></a> <a id="t:58" class="idref" href="#t:58"><span class="id" title="binder">t</span></a> <a id="u:59" class="idref" href="#u:59"><span class="id" title="binder">u</span></a>: <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) <a id="E:60" class="idref" href="#E:60"><span class="id" title="binder">E</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">{{{</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌜</span></a> (1 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:57"><span class="id" title="variable">m</span></a>)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> (0 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#t:58"><span class="id" title="variable">t</span></a>)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> (0 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:59"><span class="id" title="variable">u</span></a>)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> (<a class="idref" href="clutch.eris.examples.miller_rabin.html#x:56"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">^</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:59"><span class="id" title="variable">u</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">mod</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:57"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> 1)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_witness"><span class="id" title="definition">MR_witness</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:57"><span class="id" title="variable">m</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#t:58"><span class="id" title="variable">t</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:59"><span class="id" title="variable">u</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#x:56"><span class="id" title="variable">x</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌝</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">}}}</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_round_aux"><span class="id" title="definition">MR_round_aux</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#(</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#x:56"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">^</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:59"><span class="id" title="variable">u</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">mod</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:57"><span class="id" title="variable">m</span></a><a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#m:57"><span class="id" title="variable">m</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#t:58"><span class="id" title="variable">t</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">@</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#E:60"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">{{{</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">(</span></a><a id="b:61" class="idref" href="#b:61"><span class="id" title="binder">b</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a><a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">RET</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#b:61"><span class="id" title="variable">b</span></a><a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌜</span></a>  <a class="idref" href="clutch.eris.examples.miller_rabin.html#b:61"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>  <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌝</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">}}}</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_witness"><span class="id" title="definition">MR_witness</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Φ</span> (<span class="id" title="var">Hm</span> &amp; <span class="id" title="var">Ht</span> &amp; <span class="id" title="var">Hu</span> &amp; <span class="id" title="var">Hneq</span> &amp; <span class="id" title="var">H2</span>)) "HΦ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_apply</span> <a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_round_aux_correct_aux"><span class="id" title="lemma">MR_round_aux_correct_aux</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.mod_pos_bound"><span class="id" title="lemma">Z.mod_pos_bound</span></a>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">b</span>) "%Hb".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> "HΦ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#Is_true_false"><span class="id" title="lemma">Is_true_false</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#neg_false"><span class="id" title="lemma">neg_false</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">etrans</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> (<span class="id" title="var">i</span> &amp; <span class="id" title="var">Hi1</span> &amp; <span class="id" title="var">Hi2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span> <span class="id" title="keyword">as</span> (?&amp;?&amp;?&amp;?&amp;<span class="id" title="var">Hi3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">Hi3</span> <span class="id" title="var">i</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">Hi2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.Zpow_facts.html#Zpower_mod"><span class="id" title="lemma">Zpow_facts.Zpower_mod</span></a>; [|<span class="id" title="var">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.pow_mul_r"><span class="id" title="lemma">Z.pow_mul_r</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="MR_round_correct_prime" class="idref" href="#MR_round_correct_prime"><span class="id" title="lemma">MR_round_correct_prime</span></a> (<a id="m:62" class="idref" href="#m:62"><span class="id" title="binder">m</span></a> <a id="t:63" class="idref" href="#t:63"><span class="id" title="binder">t</span></a> <a id="u:64" class="idref" href="#u:64"><span class="id" title="binder">u</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) <a id="E:65" class="idref" href="#E:65"><span class="id" title="binder">E</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">{{{</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌜</span></a>(1 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:62"><span class="id" title="variable">m</span></a>)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> (0 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#t:63"><span class="id" title="variable">t</span></a>)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="clutch.eris.examples.miller_rabin.html#m:62"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 2<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">^</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#t:63"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e"><span class="id" title="notation">*</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:64"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> 1 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> 0 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:64"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.Odd"><span class="id" title="definition">Z.Odd</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:64"><span class="id" title="variable">u</span></a> )%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.Znumtheory.html#prime"><span class="id" title="inductive">Znumtheory.prime</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:62"><span class="id" title="variable">m</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌝</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">}}}</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_round"><span class="id" title="definition">MR_round</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#m:62"><span class="id" title="variable">m</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#t:63"><span class="id" title="variable">t</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#u:64"><span class="id" title="variable">u</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">@</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#E:65"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">{{{</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">(</span></a><a id="b:66" class="idref" href="#b:66"><span class="id" title="binder">b</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a><a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">RET</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#b:66"><span class="id" title="variable">b</span></a><a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌜</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#b:66"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">)</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌝</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">}}}</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Φ</span> (<span class="id" title="var">Hm</span> &amp; <span class="id" title="var">Ht</span> &amp; (<span class="id" title="var">Heq</span> &amp; (<span class="id" title="var">Hpos</span> &amp; <span class="id" title="var">Hodd</span>)) &amp; <span class="id" title="var">Hprime</span>)) "HΦ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_rec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_bind</span> (<a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'rand'_x"><span class="id" title="notation">rand</span></a> <span class="id" title="var">_</span>)%<span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_apply</span> <a class="idref" href="clutch.eris.primitive_laws.html#wp_rand"><span class="id" title="lemma">wp_rand</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">x</span>) "?".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_bind</span> (<a class="idref" href="clutch.eris.examples.miller_rabin.html#fast_mod_exp"><span class="id" title="definition">fast_mod_exp</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_apply</span> (<a class="idref" href="clutch.eris.examples.miller_rabin.html#fast_mod_exp_correct"><span class="id" title="lemma">fast_mod_exp_correct</span></a>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">y</span>) "[% &lt;-]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_bool_decide</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> "HΦ". <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (0 <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#7425b9b794a139b7a7da28194f85b286"><span class="id" title="notation">≤</span></a> 1 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <span class="id" title="var">x</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#7425b9b794a139b7a7da28194f85b286"><span class="id" title="notation">&lt;</span></a> <span class="id" title="var">m</span>)%<span class="id" title="var">Z</span> <span class="id" title="keyword">as</span> <span class="id" title="var">Haux</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.fin.html#fin_to_nat_lt"><span class="id" title="lemma">fin_to_nat_lt</span></a> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_apply</span> <a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_round_aux_correct_nonwit"><span class="id" title="lemma">MR_round_aux_correct_nonwit</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">lia</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">lia</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">lia</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">f_equal</span>. <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.eris.examples.miller_rabin.html#fermat_little"><span class="id" title="axiom">fermat_little</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="MR_round_composite_error" class="idref" href="#MR_round_composite_error"><span class="id" title="lemma">MR_round_composite_error</span></a> (<a id="m:67" class="idref" href="#m:67"><span class="id" title="binder">m</span></a> <a id="t:68" class="idref" href="#t:68"><span class="id" title="binder">t</span></a> <a id="u:69" class="idref" href="#u:69"><span class="id" title="binder">u</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) <a id="E:70" class="idref" href="#E:70"><span class="id" title="binder">E</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">{{{</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌜</span></a>(1 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:67"><span class="id" title="variable">m</span></a>)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> (0 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#t:68"><span class="id" title="variable">t</span></a>)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="clutch.eris.examples.miller_rabin.html#m:67"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 2<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">^</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#t:68"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e"><span class="id" title="notation">*</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:69"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> 1 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> 0 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:69"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.Odd"><span class="id" title="definition">Z.Odd</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:69"><span class="id" title="variable">u</span></a> )%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#b02645851bc60f28087c4c8d90376442"><span class="id" title="notation">¬</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.Znumtheory.html#prime"><span class="id" title="inductive">Znumtheory.prime</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:67"><span class="id" title="variable">m</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌝</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#17a7b93bfefac02a752836d54e5bc9da"><span class="id" title="notation">∗</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.eris.error_credits.html#08e29de66e639a50320709004a6b0ae4"><span class="id" title="notation">↯</span></a> <a class="idref" href="clutch.eris.error_credits.html#08e29de66e639a50320709004a6b0ae4"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.prelude.NNRbar.html#nnreal_div"><span class="id" title="definition">nnreal_div</span></a> (<a class="idref" href="clutch.prelude.NNRbar.html#nnreal_nat"><span class="id" title="definition">nnreal_nat</span></a> 1) (<a class="idref" href="clutch.prelude.NNRbar.html#nnreal_nat"><span class="id" title="definition">nnreal_nat</span></a> 2)<a class="idref" href="clutch.eris.error_credits.html#08e29de66e639a50320709004a6b0ae4"><span class="id" title="notation">)</span></a><a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">}}}</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_round"><span class="id" title="definition">MR_round</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#m:67"><span class="id" title="variable">m</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#t:68"><span class="id" title="variable">t</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#u:69"><span class="id" title="variable">u</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">@</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#E:70"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">{{{</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">(</span></a><a id="b:71" class="idref" href="#b:71"><span class="id" title="binder">b</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a><a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">RET</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#b:71"><span class="id" title="variable">b</span></a><a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌜</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#b:71"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">)</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌝</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">}}}</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Φ</span>) "((%Hm &amp; %Ht &amp; (%Heq &amp; (%Hpos &amp; %Hodd)) &amp; %Hcomp )&amp; Herr) HΦ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_rec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_bind</span> (<a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'rand'_x"><span class="id" title="notation">rand</span></a> <span class="id" title="var">_</span>)%<span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_apply</span> (<a class="idref" href="clutch.eris.error_rules.html#wp_rand_err_filter"><span class="id" title="lemma">wp_rand_err_filter</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ((<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="x:72" class="idref" href="#x:72"><span class="id" title="binder"><span id="x:73" class="id">x</span></span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#is_MR_nonwitness"><span class="id" title="definition">is_MR_nonwitness</span></a> <span class="id" title="var">t</span> <span class="id" title="var">u</span> (1 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#x:72"><span class="id" title="variable">x</span></a>)))) ; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitL</span> "Herr".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="clutch.eris.error_credits.html#ec_weaken"><span class="id" title="lemma">ec_weaken</span></a>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.to_nat"><span class="id" title="definition">Z.to_nat</span></a> (<span class="id" title="var">m</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">-</span></a> 2))) <span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.to_nat"><span class="id" title="definition">Z.to_nat</span></a> (<span class="id" title="var">m</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">-</span></a>1)); <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.Znat.html#Z2Nat.inj_succ"><span class="id" title="lemma">Z2Nat.inj_succ</span></a>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="http://coquelicot.saclay.inria.fr/html//Coquelicot.Rcomplements.html#Rle_div_l"><span class="id" title="lemma">Rcomplements.Rle_div_l</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#plus_INR"><span class="id" title="lemma">plus_INR</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.Znat.html#Z2Nat.inj_sub"><span class="id" title="lemma">Z2Nat.inj_sub</span></a>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#minus_INR"><span class="id" title="lemma">minus_INR</span></a>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.to_nat"><span class="id" title="definition">Z.to_nat</span></a> <span class="id" title="var">m</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x"><span class="id" title="notation">(</span></a>1 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#3e57074ab0a6a36b253e873a1bdac6ad"><span class="id" title="notation">+</span></a> 1<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#3e57074ab0a6a36b253e873a1bdac6ad"><span class="id" title="notation">+</span></a> 1) <span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.to_nat"><span class="id" title="definition">Z.to_nat</span></a> <span class="id" title="var">m</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x"><span class="id" title="notation">-</span></a> 1) <span class="id" title="tactic">by</span> <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#INR_IZR_INZ"><span class="id" title="lemma">INR_IZR_INZ</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.Znat.html#Z2Nat.id"><span class="id" title="lemma">Z2Nat.id</span></a>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rlt_gt"><span class="id" title="lemma">Rlt_gt</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#IZR_lt"><span class="id" title="lemma">IZR_lt</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hm</span>. <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_witness_card"><span class="id" title="axiom">MR_witness_card</span></a> <span class="id" title="var">m</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Haux</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">etrans</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.Znat.html#Z2Nat.inj_sub"><span class="id" title="lemma">Z2Nat.inj_sub</span></a>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (1<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#3e57074ab0a6a36b253e873a1bdac6ad"><span class="id" title="notation">+</span></a>1) <span class="id" title="keyword">with</span> 2 <span class="id" title="tactic">by</span> <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Raxioms.html#Rmult_1_l"><span class="id" title="lemma">Rmult_1_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Raxioms.html#Rmult_comm"><span class="id" title="lemma">Rmult_comm</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rdiv_def"><span class="id" title="lemma">Rdiv_def</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_compat_r"><span class="id" title="lemma">Rmult_le_compat_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">left</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rinv_0_lt_compat"><span class="id" title="lemma">Rinv_0_lt_compat</span></a>; <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#plus_INR"><span class="id" title="lemma">plus_INR</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#minus_INR"><span class="id" title="lemma">minus_INR</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#minus_IZR"><span class="id" title="lemma">minus_IZR</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.to_nat"><span class="id" title="definition">Z.to_nat</span></a> <span class="id" title="var">m</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x"><span class="id" title="notation">(</span></a>1 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#3e57074ab0a6a36b253e873a1bdac6ad"><span class="id" title="notation">+</span></a> 1<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#3e57074ab0a6a36b253e873a1bdac6ad"><span class="id" title="notation">+</span></a> 1) <span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.to_nat"><span class="id" title="definition">Z.to_nat</span></a> <span class="id" title="var">m</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x"><span class="id" title="notation">-</span></a> 1) <span class="id" title="tactic">by</span> <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#INR_IZR_INZ"><span class="id" title="lemma">INR_IZR_INZ</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.Znat.html#Z2Nat.id"><span class="id" title="lemma">Z2Nat.id</span></a>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">x</span>) "%Hwit".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_bind</span> (<a class="idref" href="clutch.eris.examples.miller_rabin.html#fast_mod_exp"><span class="id" title="definition">fast_mod_exp</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_apply</span> (<a class="idref" href="clutch.eris.examples.miller_rabin.html#fast_mod_exp_correct"><span class="id" title="lemma">fast_mod_exp_correct</span></a>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">y</span>) "[% &lt;-]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="clutch.eris.examples.miller_rabin.html#is_MR_nonwitness_false"><span class="id" title="lemma">is_MR_nonwitness_false</span></a> <span class="id" title="var">m</span> <span class="id" title="var">t</span> <span class="id" title="var">u</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hwit</span>; <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2:{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.fin.html#fin_to_nat_lt"><span class="id" title="lemma">fin_to_nat_lt</span></a> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_bool_decide</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> "HΦ". <span class="id" title="var">exfalso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_witness"><span class="id" title="definition">MR_witness</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hwit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hwit</span> <span class="id" title="keyword">as</span> (?&amp;?&amp;?&amp;<span class="id" title="var">Hx1</span>&amp;<span class="id" title="var">Hx2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Hx1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">(</span></a>1 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">)^</span></a><span class="id" title="var">u</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">mod</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a> <span class="id" title="var">m</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 1)%<span class="id" title="var">Z</span> <span class="id" title="keyword">as</span> -&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H5</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.Zdiv.html#Zmod_1_l"><span class="id" title="lemma">Zmod_1_l</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_apply</span> <a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_round_aux_correct_wit"><span class="id" title="lemma">MR_round_aux_correct_wit</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">lia</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">lia</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">lia</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">f_equal</span>. <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="MR_round_composite_error_amplify" class="idref" href="#MR_round_composite_error_amplify"><span class="id" title="lemma">MR_round_composite_error_amplify</span></a> (<a id="m:74" class="idref" href="#m:74"><span class="id" title="binder">m</span></a> <a id="t:75" class="idref" href="#t:75"><span class="id" title="binder">t</span></a> <a id="u:76" class="idref" href="#u:76"><span class="id" title="binder">u</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) (<a id="ef293bb0e566acdc3520188eb436f019" class="idref" href="#ef293bb0e566acdc3520188eb436f019"><span class="id" title="binder">ε</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#nonnegreal"><span class="id" title="record">nonnegreal</span></a>) <a id="E:78" class="idref" href="#E:78"><span class="id" title="binder">E</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">{{{</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌜</span></a>(1 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:74"><span class="id" title="variable">m</span></a>)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> (0 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#t:75"><span class="id" title="variable">t</span></a>)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="clutch.eris.examples.miller_rabin.html#m:74"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 2<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">^</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#t:75"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e"><span class="id" title="notation">*</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:76"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> 1 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> 0 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:76"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.Odd"><span class="id" title="definition">Z.Odd</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#u:76"><span class="id" title="variable">u</span></a> )%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#b02645851bc60f28087c4c8d90376442"><span class="id" title="notation">¬</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.Znumtheory.html#prime"><span class="id" title="inductive">Znumtheory.prime</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:74"><span class="id" title="variable">m</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌝</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#17a7b93bfefac02a752836d54e5bc9da"><span class="id" title="notation">∗</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.eris.error_credits.html#08e29de66e639a50320709004a6b0ae4"><span class="id" title="notation">↯</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#ef293bb0e566acdc3520188eb436f019"><span class="id" title="variable">ε</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">}}}</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_round"><span class="id" title="definition">MR_round</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#m:74"><span class="id" title="variable">m</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#t:75"><span class="id" title="variable">t</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#u:76"><span class="id" title="variable">u</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">@</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#E:78"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">{{{</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">(</span></a><a id="b:79" class="idref" href="#b:79"><span class="id" title="binder">b</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a><a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">RET</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#b:79"><span class="id" title="variable">b</span></a><a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌜</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#b:79"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">)</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌝</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#df8727fb8673700193f111b03d29db4e"><span class="id" title="notation">∨</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#df8727fb8673700193f111b03d29db4e"><span class="id" title="notation">(</span></a> <a class="idref" href="clutch.eris.error_credits.html#08e29de66e639a50320709004a6b0ae4"><span class="id" title="notation">↯</span></a> <a class="idref" href="clutch.eris.error_credits.html#08e29de66e639a50320709004a6b0ae4"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.prelude.NNRbar.html#nnreal_mult"><span class="id" title="definition">nnreal_mult</span></a> (<a class="idref" href="clutch.prelude.NNRbar.html#nnreal_nat"><span class="id" title="definition">nnreal_nat</span></a> 2) <a class="idref" href="clutch.eris.examples.miller_rabin.html#ef293bb0e566acdc3520188eb436f019"><span class="id" title="variable">ε</span></a><a class="idref" href="clutch.eris.error_credits.html#08e29de66e639a50320709004a6b0ae4"><span class="id" title="notation">)</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#df8727fb8673700193f111b03d29db4e"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">}}}</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Φ</span>) "((%Hm &amp; %Ht &amp; (%Heq &amp; (%Hpos &amp; %Hodd)) &amp; %Hcomp )&amp; Herr) HΦ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_rec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_bind</span> (<a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'rand'_x"><span class="id" title="notation">rand</span></a> <span class="id" title="var">_</span>)%<span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_apply</span> (<a class="idref" href="clutch.eris.error_rules.html#wp_rand_err_filter_adv"><span class="id" title="lemma">wp_rand_err_filter_adv</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="x:80" class="idref" href="#x:80"><span class="id" title="binder"><span id="x:81" class="id">x</span></span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#is_MR_nonwitness"><span class="id" title="definition">is_MR_nonwitness</span></a> <span class="id" title="var">t</span> <span class="id" title="var">u</span> (1 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#x:80"><span class="id" title="variable">x</span></a>)) <span class="id" title="var">ε</span> (<a class="idref" href="clutch.prelude.NNRbar.html#nnreal_mult"><span class="id" title="definition">nnreal_mult</span></a> (<a class="idref" href="clutch.prelude.NNRbar.html#nnreal_nat"><span class="id" title="definition">nnreal_nat</span></a> 2) <span class="id" title="var">ε</span>)); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.to_nat"><span class="id" title="definition">Z.to_nat</span></a> (<span class="id" title="var">m</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">-</span></a> 2))) <span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.to_nat"><span class="id" title="definition">Z.to_nat</span></a> (<span class="id" title="var">m</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">-</span></a>1)); <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.Znat.html#Z2Nat.inj_succ"><span class="id" title="lemma">Z2Nat.inj_succ</span></a>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Raxioms.html#Rmult_assoc"><span class="id" title="lemma">Rmult_assoc</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Raxioms.html#Rmult_comm"><span class="id" title="lemma">Rmult_comm</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Raxioms.html#Rmult_assoc"><span class="id" title="lemma">Rmult_assoc</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_compat_l"><span class="id" title="lemma">Rmult_le_compat_l</span></a>; [<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#cond_nonneg"><span class="id" title="projection">cond_nonneg</span></a>| ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_witness_card"><span class="id" title="axiom">MR_witness_card</span></a> <span class="id" title="var">m</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Haux</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coquelicot.saclay.inria.fr/html//Coquelicot.Rcomplements.html#Rle_div_r"><span class="id" title="lemma">Rcomplements.Rle_div_r</span></a>; [<span class="id" title="var">lra</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">etrans</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.Znat.html#Z2Nat.inj_sub"><span class="id" title="lemma">Z2Nat.inj_sub</span></a>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (1<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#3e57074ab0a6a36b253e873a1bdac6ad"><span class="id" title="notation">+</span></a>1) <span class="id" title="keyword">with</span> 2 <span class="id" title="tactic">by</span> <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#Rdiv"><span class="id" title="definition">Rdiv</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_compat_r"><span class="id" title="lemma">Rmult_le_compat_r</span></a>; [<span class="id" title="var">lra</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> ((<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.to_nat"><span class="id" title="definition">Z.to_nat</span></a> <span class="id" title="var">m</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.to_nat"><span class="id" title="definition">Z.to_nat</span></a> 2)%<span class="id" title="var">nat</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#3e57074ab0a6a36b253e873a1bdac6ad"><span class="id" title="notation">+</span></a> 1) <span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#IZR"><span class="id" title="definition">IZR</span></a> <span class="id" title="var">m</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x"><span class="id" title="notation">-</span></a> 1); [<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#minus_IZR"><span class="id" title="lemma">minus_IZR</span></a>; <span class="id" title="var">lra</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#INR_IZR_INZ"><span class="id" title="lemma">INR_IZR_INZ</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#plus_IZR"><span class="id" title="lemma">plus_IZR</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#minus_IZR"><span class="id" title="lemma">minus_IZR</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">x</span>) "[%Hcont1 | Hcont2]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_bind</span> (<a class="idref" href="clutch.eris.examples.miller_rabin.html#fast_mod_exp"><span class="id" title="definition">fast_mod_exp</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_apply</span> (<a class="idref" href="clutch.eris.examples.miller_rabin.html#fast_mod_exp_correct"><span class="id" title="lemma">fast_mod_exp_correct</span></a>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">y</span>) "[% &lt;-]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="clutch.eris.examples.miller_rabin.html#is_MR_nonwitness_false"><span class="id" title="lemma">is_MR_nonwitness_false</span></a> <span class="id" title="var">m</span> <span class="id" title="var">t</span> <span class="id" title="var">u</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hcont1</span>; <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2:{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.fin.html#fin_to_nat_lt"><span class="id" title="lemma">fin_to_nat_lt</span></a> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_bool_decide</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> "HΦ". <span class="id" title="var">exfalso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_witness"><span class="id" title="definition">MR_witness</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcont1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hcont1</span> <span class="id" title="keyword">as</span> (?&amp;?&amp;?&amp;<span class="id" title="var">Hx1</span>&amp;<span class="id" title="var">Hx2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Hx1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">(</span></a>1 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#14ef112b66e341f773bd1e9d05816f43"><span class="id" title="notation">)^</span></a><span class="id" title="var">u</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">mod</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.numbers.html#856fa7d91d396119b0858e662f34d034"><span class="id" title="notation">`</span></a> <span class="id" title="var">m</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 1)%<span class="id" title="var">Z</span> <span class="id" title="keyword">as</span> -&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H5</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.Zdiv.html#Zmod_1_l"><span class="id" title="lemma">Zmod_1_l</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_apply</span> <a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_round_aux_correct_wit"><span class="id" title="lemma">MR_round_aux_correct_wit</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id" title="var">iIntros</span>. <span class="id" title="var">iApply</span> "HΦ". <span class="id" title="var">iLeft</span>. <span class="id" title="var">done</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">lia</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">lia</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">lia</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">f_equal</span>. <span class="id" title="var">done</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iAssert</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#3737660a6294eb9f7af6df17be5eb5a3"><span class="id" title="notation">∀</span></a> <a id="b:82" class="idref" href="#b:82"><span class="id" title="binder"><span id="b:83" class="id">b</span></span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#3737660a6294eb9f7af6df17be5eb5a3"><span class="id" title="notation">,</span></a> <span class="id" title="var">Φ</span> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#b:82"><span class="id" title="variable">b</span></a>)%<span class="id" title="var">I</span> <span class="id" title="keyword">with</span> "[HΦ Hcont2]" <span class="id" title="keyword">as</span> "HΦ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> "HΦ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iRight</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="clutch.eris.error_credits.html#ec_weaken"><span class="id" title="lemma">ec_weaken</span></a>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="var">iFrame</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.to_nat"><span class="id" title="definition">Z.to_nat</span></a> (<span class="id" title="var">m</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">-</span></a> 2))) <span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#Z.to_nat"><span class="id" title="definition">Z.to_nat</span></a> (<span class="id" title="var">m</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">-</span></a>1)); <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.Znat.html#Z2Nat.inj_succ"><span class="id" title="lemma">Z2Nat.inj_succ</span></a>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_bind</span> (<a class="idref" href="clutch.eris.examples.miller_rabin.html#fast_mod_exp"><span class="id" title="definition">fast_mod_exp</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_apply</span> (<a class="idref" href="clutch.eris.examples.miller_rabin.html#fast_mod_exp_correct"><span class="id" title="lemma">fast_mod_exp_correct</span></a>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">y</span>) "[% &lt;-]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_bool_decide</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">wp_pures</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="clutch.eris.examples.miller_rabin.html#is_MR_nonwitness"><span class="id" title="definition">is_MR_nonwitness</span></a> <span class="id" title="var">t</span> <span class="id" title="var">u</span> (1 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <span class="id" title="var">x</span>)) <span class="id" title="var">eqn</span>:<span class="id" title="var">Hwit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">wp_apply</span> <a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_round_aux_correct_nonwit"><span class="id" title="lemma">MR_round_aux_correct_nonwit</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">lia</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">lia</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">lia</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">intro</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">f_equal</span>. <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.eris.examples.miller_rabin.html#is_MR_nonwitness_true"><span class="id" title="lemma">is_MR_nonwitness_true</span></a>; <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.fin.html#fin_to_nat_lt"><span class="id" title="lemma">fin_to_nat_lt</span></a> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">wp_apply</span> <a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_round_aux_correct_wit"><span class="id" title="lemma">MR_round_aux_correct_wit</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">lia</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">lia</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">lia</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">intro</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">f_equal</span>. <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.eris.examples.miller_rabin.html#is_MR_nonwitness_false"><span class="id" title="lemma">is_MR_nonwitness_false</span></a>; <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.fin.html#fin_to_nat_lt"><span class="id" title="lemma">fin_to_nat_lt</span></a> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="MR_main_correct_prime" class="idref" href="#MR_main_correct_prime"><span class="id" title="lemma">MR_main_correct_prime</span></a> (<a id="m:84" class="idref" href="#m:84"><span class="id" title="binder">m</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) <a id="E:85" class="idref" href="#E:85"><span class="id" title="binder">E</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">{{{</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌜</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.Znumtheory.html#prime"><span class="id" title="inductive">Znumtheory.prime</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:84"><span class="id" title="variable">m</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌝</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">}}}</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_main"><span class="id" title="definition">MR_main</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#m:84"><span class="id" title="variable">m</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">@</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#E:85"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">{{{</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">(</span></a><a id="b:86" class="idref" href="#b:86"><span class="id" title="binder">b</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a><a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">RET</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#b:86"><span class="id" title="variable">b</span></a><a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌜</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#b:86"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">)</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌝</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">}}}</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Φ</span> <span class="id" title="var">Hprime</span>) "HΦ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (1 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <span class="id" title="var">m</span>)%<span class="id" title="var">Z</span> <span class="id" title="keyword">as</span> <span class="id" title="var">Hm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hprime</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_rec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_bool_decide</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_bind</span> (<a class="idref" href="clutch.eris.examples.miller_rabin.html#power_two_decomp"><span class="id" title="definition">power_two_decomp</span></a> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_apply</span> (<a class="idref" href="clutch.eris.examples.miller_rabin.html#power_two_decomp_correct"><span class="id" title="lemma">power_two_decomp_correct</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iPureIntro</span>; <span class="id" title="var">lia</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">u</span> <span class="id" title="var">t</span>) "(%Heq &amp; %Ht &amp; %Hodd)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_apply</span> <a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_round_correct_prime"><span class="id" title="lemma">MR_round_correct_prime</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="MR_main_composite_error" class="idref" href="#MR_main_composite_error"><span class="id" title="lemma">MR_main_composite_error</span></a> (<a id="m:87" class="idref" href="#m:87"><span class="id" title="binder">m</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) <a id="E:88" class="idref" href="#E:88"><span class="id" title="binder">E</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">{{{</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌜</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#b02645851bc60f28087c4c8d90376442"><span class="id" title="notation">¬</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.Znumtheory.html#prime"><span class="id" title="inductive">Znumtheory.prime</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:87"><span class="id" title="variable">m</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌝</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#17a7b93bfefac02a752836d54e5bc9da"><span class="id" title="notation">∗</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.eris.error_credits.html#08e29de66e639a50320709004a6b0ae4"><span class="id" title="notation">↯</span></a> <a class="idref" href="clutch.eris.error_credits.html#08e29de66e639a50320709004a6b0ae4"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.prelude.NNRbar.html#nnreal_div"><span class="id" title="definition">nnreal_div</span></a> (<a class="idref" href="clutch.prelude.NNRbar.html#nnreal_nat"><span class="id" title="definition">nnreal_nat</span></a> 1) (<a class="idref" href="clutch.prelude.NNRbar.html#nnreal_nat"><span class="id" title="definition">nnreal_nat</span></a> 2)<a class="idref" href="clutch.eris.error_credits.html#08e29de66e639a50320709004a6b0ae4"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">}}}</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_main"><span class="id" title="definition">MR_main</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#m:87"><span class="id" title="variable">m</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">@</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#E:88"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">{{{</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">(</span></a><a id="b:89" class="idref" href="#b:89"><span class="id" title="binder">b</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a><a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">RET</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#b:89"><span class="id" title="variable">b</span></a><a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌜</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#b:89"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">)</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌝</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">}}}</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Φ</span>) "[%Hcomp Herr] HΦ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_rec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_bool_decide</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "HΦ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_bind</span> (<a class="idref" href="clutch.eris.examples.miller_rabin.html#power_two_decomp"><span class="id" title="definition">power_two_decomp</span></a> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_apply</span> (<a class="idref" href="clutch.eris.examples.miller_rabin.html#power_two_decomp_correct"><span class="id" title="lemma">power_two_decomp_correct</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iPureIntro</span>; <span class="id" title="var">lia</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">u</span> <span class="id" title="var">t</span>) "(%Heq &amp; %Ht &amp; %Hodd)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_round_composite_error"><span class="id" title="lemma">MR_round_composite_error</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">with</span></a> "[$Herr]"<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">)</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Variable</span> (<a id="miller_rabin_code.num_iter" class="idref" href="#miller_rabin_code.num_iter"><span class="id" title="variable">num_iter</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;main&nbsp;function&nbsp;for&nbsp;the&nbsp;Miller-Rabin&nbsp;test,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;num_iter&nbsp;iterations&nbsp;are&nbsp;performed<br/>
&nbsp;&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="MR_main_looped" class="idref" href="#MR_main_looped"><span class="id" title="definition">MR_main_looped</span></a> : <a class="idref" href="clutch.prob_lang.lang.html#prob_lang.val"><span class="id" title="inductive">val</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="clutch.prob_lang.notation.html#704630d98f03f1fa6c74ab29b9831803"><span class="id" title="notation">λ</span></a><a class="idref" href="clutch.prob_lang.notation.html#704630d98f03f1fa6c74ab29b9831803"><span class="id" title="notation">:</span></a> "m"<a class="idref" href="clutch.prob_lang.notation.html#704630d98f03f1fa6c74ab29b9831803"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a><a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">:</span></a> "m" <a class="idref" href="clutch.prob_lang.notation.html#959e055f1ab3ff54c36dde10824af025"><span class="id" title="notation">≤</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>1 <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">(</span></a>"u"<a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">,</span></a> "t"<a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#power_two_decomp"><span class="id" title="definition">power_two_decomp</span></a> ("m" <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>1) <a class="idref" href="clutch.prob_lang.notation.html#6582bc55109100c0672072c9d8fbbf98"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#bc8473dd83165582f891bea81e4bbdd4"><span class="id" title="notation">letrec</span></a><a class="idref" href="clutch.prob_lang.notation.html#bc8473dd83165582f891bea81e4bbdd4"><span class="id" title="notation">:</span></a> "g" "k" <a class="idref" href="clutch.prob_lang.notation.html#bc8473dd83165582f891bea81e4bbdd4"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.prob_lang.notation.html#bc8473dd83165582f891bea81e4bbdd4"><span class="id" title="notation">(</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a><a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">:</span></a> "k" <a class="idref" href="clutch.prob_lang.notation.html#268bceb185e8402e5a254d7b9bacc674"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>0 <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "r" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_round"><span class="id" title="definition">MR_round</span></a> "m" "t" "u" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a><a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">:</span></a> "r" <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> "g" ("k" <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>1) <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="clutch.prob_lang.notation.html#bc8473dd83165582f891bea81e4bbdd4"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.prob_lang.notation.html#bc8473dd83165582f891bea81e4bbdd4"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"g" <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#miller_rabin_code.num_iter"><span class="id" title="variable">num_iter</span></a> )%<span class="id" title="var">V</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="MR_main_looped_correct_prime" class="idref" href="#MR_main_looped_correct_prime"><span class="id" title="lemma">MR_main_looped_correct_prime</span></a> (<a id="m:91" class="idref" href="#m:91"><span class="id" title="binder">m</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) <a id="E:92" class="idref" href="#E:92"><span class="id" title="binder">E</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">{{{</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌜</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.Znumtheory.html#prime"><span class="id" title="inductive">Znumtheory.prime</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:91"><span class="id" title="variable">m</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌝</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">}}}</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_main_looped"><span class="id" title="definition">MR_main_looped</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#m:91"><span class="id" title="variable">m</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">@</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#E:92"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">{{{</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">(</span></a><a id="b:93" class="idref" href="#b:93"><span class="id" title="binder">b</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a><a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">RET</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#b:93"><span class="id" title="variable">b</span></a><a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌜</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#b:93"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">)</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌝</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">}}}</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Φ</span> <span class="id" title="var">Hprime</span>) "HΦ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (1 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <span class="id" title="var">m</span>)%<span class="id" title="var">Z</span> <span class="id" title="keyword">as</span> <span class="id" title="var">Hm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hprime</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_rec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_bool_decide</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_bind</span> (<a class="idref" href="clutch.eris.examples.miller_rabin.html#power_two_decomp"><span class="id" title="definition">power_two_decomp</span></a> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_apply</span> (<a class="idref" href="clutch.eris.examples.miller_rabin.html#power_two_decomp_correct"><span class="id" title="lemma">power_two_decomp_correct</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iPureIntro</span>; <span class="id" title="var">lia</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">u</span> <span class="id" title="var">t</span>) "(%Heq &amp; %Ht &amp; %Hodd)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 11 <span class="id" title="var">wp_pure</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iInduction</span> <a class="idref" href="clutch.eris.examples.miller_rabin.html#miller_rabin_code.num_iter"><span class="id" title="variable">num_iter</span></a> <span class="id" title="keyword">as</span> [|<span class="id" title="var">k</span>] "IH".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> "HΦ"; <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_bind</span> (<a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_round"><span class="id" title="definition">MR_round</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_apply</span> <a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_round_correct_prime"><span class="id" title="lemma">MR_round_correct_prime</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">iIntros</span> (<span class="id" title="var">b</span>) "-&gt;".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 4 <span class="id" title="var">wp_pure</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#(</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">-</span></a> 1<a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">)</span></a> <span class="id" title="keyword">with</span> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><span class="id" title="var">k</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">f_equal</span>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "IH".<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="MR_main_looped_composite_error" class="idref" href="#MR_main_looped_composite_error"><span class="id" title="lemma">MR_main_looped_composite_error</span></a> (<a id="m:94" class="idref" href="#m:94"><span class="id" title="binder">m</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) <a id="E:95" class="idref" href="#E:95"><span class="id" title="binder">E</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">{{{</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌜</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#b02645851bc60f28087c4c8d90376442"><span class="id" title="notation">¬</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.Znumtheory.html#prime"><span class="id" title="inductive">Znumtheory.prime</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#m:94"><span class="id" title="variable">m</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌝</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#17a7b93bfefac02a752836d54e5bc9da"><span class="id" title="notation">∗</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.eris.error_credits.html#08e29de66e639a50320709004a6b0ae4"><span class="id" title="notation">↯</span></a> <a class="idref" href="clutch.eris.error_credits.html#08e29de66e639a50320709004a6b0ae4"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.prelude.NNRbar.html#nnreal_div"><span class="id" title="definition">nnreal_div</span></a> (<a class="idref" href="clutch.prelude.NNRbar.html#nnreal_nat"><span class="id" title="definition">nnreal_nat</span></a> 1) (<a class="idref" href="clutch.prelude.NNRbar.html#nnreal_nat"><span class="id" title="definition">nnreal_nat</span></a> (2<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Arith.PeanoNat.html#81fd94e251a61ee523cdd7855774ae7c"><span class="id" title="notation">^</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#miller_rabin_code.num_iter"><span class="id" title="variable">num_iter</span></a>))<a class="idref" href="clutch.eris.error_credits.html#08e29de66e639a50320709004a6b0ae4"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">}}}</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_main_looped"><span class="id" title="definition">MR_main_looped</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#m:94"><span class="id" title="variable">m</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">@</span></a> <a class="idref" href="clutch.eris.examples.miller_rabin.html#E:95"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">{{{</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">(</span></a><a id="b:96" class="idref" href="#b:96"><span class="id" title="binder">b</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a><a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">)</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">RET</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#b:96"><span class="id" title="variable">b</span></a><a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌜</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#b:96"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">)</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌝</span></a> <a class="idref" href="clutch.bi.weakestpre.html#dc7101858ef3a8f8398e14946db8cb25"><span class="id" title="notation">}}}</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Φ</span>) "[%Hcomp Herr] HΦ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_rec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_bool_decide</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "HΦ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_bind</span> (<a class="idref" href="clutch.eris.examples.miller_rabin.html#power_two_decomp"><span class="id" title="definition">power_two_decomp</span></a> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_apply</span> (<a class="idref" href="clutch.eris.examples.miller_rabin.html#power_two_decomp_correct"><span class="id" title="lemma">power_two_decomp_correct</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iPureIntro</span>; <span class="id" title="var">lia</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">u</span> <span class="id" title="var">t</span>) "(%Heq &amp; %Ht &amp; %Hodd)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 11 <span class="id" title="var">wp_pure</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iInduction</span> <a class="idref" href="clutch.eris.examples.miller_rabin.html#miller_rabin_code.num_iter"><span class="id" title="variable">num_iter</span></a> <span class="id" title="keyword">as</span> [|<span class="id" title="var">k</span>] "IH".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iExFalso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="clutch.eris.error_credits.html#ec_spend"><span class="id" title="lemma">ec_spend</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_bind</span> (<a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_round"><span class="id" title="definition">MR_round</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.eris.examples.miller_rabin.html#MR_round_composite_error_amplify"><span class="id" title="lemma">MR_round_composite_error_amplify</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">with</span></a> "[$Herr]"<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">)</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">iIntros</span> ([]) "Hpost".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">do</span> 4 <span class="id" title="var">wp_pure</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#(</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">-</span></a> 1<a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">)</span></a> <span class="id" title="keyword">with</span> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><span class="id" title="var">k</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">f_equal</span>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">(</span></a>"IH" <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">with</span></a> "[Hpost]"<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">)</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hpost" <span class="id" title="keyword">as</span> "[% |Herr]"; [<span class="id" title="var">done</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.eris.error_credits.html#ec_spend_irrel"><span class="id" title="lemma">ec_spend_irrel</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">with</span></a> "[$Herr]"<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Arith.PeanoNat.html#Nat.add_0_r"><span class="id" title="lemma">Nat.add_0_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (2 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Arith.PeanoNat.html#81fd94e251a61ee523cdd7855774ae7c"><span class="id" title="notation">^</span></a> <span class="id" title="var">k</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> 2 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Arith.PeanoNat.html#81fd94e251a61ee523cdd7855774ae7c"><span class="id" title="notation">^</span></a> <span class="id" title="var">k</span>)%<span class="id" title="var">nat</span> <span class="id" title="keyword">with</span> (2 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Peano.html#ea2ff3d561159081cea6fb2e8113cc54"><span class="id" title="notation">*</span></a> 2<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Arith.PeanoNat.html#81fd94e251a61ee523cdd7855774ae7c"><span class="id" title="notation">^</span></a><span class="id" title="var">k</span>)%<span class="id" title="var">nat</span> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Raxioms.html#Rmult_1_l"><span class="id" title="lemma">Rmult_1_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#mult_INR"><span class="id" title="lemma">mult_INR</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#pow_INR"><span class="id" title="lemma">pow_INR</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rinv_mult"><span class="id" title="lemma">Rinv_mult</span></a>. <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">wp_pures</span>. <span class="id" title="var">iApply</span> "HΦ"; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="clutch.eris.examples.miller_rabin.html#miller_rabin_code"><span class="id" title="section">miller_rabin_code</span></a>.<br/>

<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/coq-community/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
