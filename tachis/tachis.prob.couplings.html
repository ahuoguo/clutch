<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="resources/coqdoc.css" rel="stylesheet" type="text/css" />
<link href="resources/coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resources/config.js"></script>
<script type="text/javascript" src="resources/coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="https://github.com/logsem/clutch">Project Page</a>
      <a href="./indexpage.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">tachis.prob.couplings</h1>

<div class="code">
</div>

<div class="doc">
Exact couplings  
</div>
<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Reals.html#"><span class="id" title="library">Reals</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.micromega.Psatz.html#"><span class="id" title="library">Psatz</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coquelicot</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coquelicot.saclay.inria.fr/html//Coquelicot.Rcomplements.html#"><span class="id" title="library">Rcomplements</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">stdpp</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.countable.html#"><span class="id" title="library">countable</span></a>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">tachis.prelude</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="tachis.prelude.base.html#"><span class="id" title="library">base</span></a> <a class="idref" href="tachis.prelude.Coquelicot_ext.html#"><span class="id" title="library">Coquelicot_ext</span></a> <a class="idref" href="tachis.prelude.Reals_ext.html#"><span class="id" title="library">Reals_ext</span></a> <a class="idref" href="tachis.prelude.stdpp_ext.html#"><span class="id" title="library">stdpp_ext</span></a> <a class="idref" href="tachis.prelude.classical.html#"><span class="id" title="library">classical</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">tachis.prob</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="tachis.prob.countable_sum.html#"><span class="id" title="library">countable_sum</span></a> <a class="idref" href="tachis.prob.distribution.html#"><span class="id" title="library">distribution</span></a>.<br/>

<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">R</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="coupl" class="idref" href="#coupl"><span class="id" title="section">coupl</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H:3" class="idref" href="#H:3"><span class="id" title="binder">Countable</span></a> <a id="A:1" class="idref" href="#A:1"><span class="id" title="binder"><span id="H:3" class="id">A</span></span></a>, <a id="H0:6" class="idref" href="#H0:6"><span class="id" title="binder">Countable</span></a> <a id="B:4" class="idref" href="#B:4"><span class="id" title="binder"><span id="H0:6" class="id">B</span></span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<a id="c7d02b4cbd5705ab39b01e419f22278c" class="idref" href="#c7d02b4cbd5705ab39b01e419f22278c"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#coupl.A"><span class="id" title="variable">A</span></a>) (<a id="6d0cd020d6912053146d47eec2f17381" class="idref" href="#6d0cd020d6912053146d47eec2f17381"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#coupl.B"><span class="id" title="variable">B</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="is_coupl" class="idref" href="#is_coupl"><span class="id" title="definition">is_coupl</span></a> (<a id="90df8bdb236fa6d748593874a043010b" class="idref" href="#90df8bdb236fa6d748593874a043010b"><span class="id" title="binder">μ</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> (<a class="idref" href="tachis.prob.couplings.html#coupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="tachis.prob.couplings.html#coupl.B"><span class="id" title="variable">B</span></a>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.distribution.html#lmarg"><span class="id" title="definition">lmarg</span></a> <a class="idref" href="tachis.prob.couplings.html#90df8bdb236fa6d748593874a043010b"><span class="id" title="variable">μ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="tachis.prob.couplings.html#b639a6dced6d5967fda6389458cfa48f"><span class="id" title="variable">μ1</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="tachis.prob.distribution.html#rmarg"><span class="id" title="definition">rmarg</span></a> <a class="idref" href="tachis.prob.couplings.html#90df8bdb236fa6d748593874a043010b"><span class="id" title="variable">μ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="tachis.prob.couplings.html#8b7307aed0404907a25d41b5577b9ebe"><span class="id" title="variable">μ2</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="ex_coupl" class="idref" href="#ex_coupl"><span class="id" title="definition">ex_coupl</span></a> := <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">(</span></a><a id="5587be393abab7d9461a4b3f4fb7e097" class="idref" href="#5587be393abab7d9461a4b3f4fb7e097"><span class="id" title="binder">μ</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> (<a class="idref" href="tachis.prob.couplings.html#coupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="tachis.prob.couplings.html#coupl.B"><span class="id" title="variable">B</span></a>)<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">),</span></a> <a class="idref" href="tachis.prob.couplings.html#is_coupl"><span class="id" title="definition">is_coupl</span></a> <a class="idref" href="tachis.prob.couplings.html#5587be393abab7d9461a4b3f4fb7e097"><span class="id" title="variable">μ</span></a>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="tachis.prob.couplings.html#coupl"><span class="id" title="section">coupl</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="Rcoupl" class="idref" href="#Rcoupl"><span class="id" title="section">Rcoupl</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H:13" class="idref" href="#H:13"><span class="id" title="binder">Countable</span></a> <a id="A:11" class="idref" href="#A:11"><span class="id" title="binder"><span id="H:13" class="id">A</span></span></a>, <a id="H0:16" class="idref" href="#H0:16"><span class="id" title="binder">Countable</span></a> <a id="B:14" class="idref" href="#B:14"><span class="id" title="binder"><span id="H0:16" class="id">B</span></span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<a id="8de2c9f99e4699c737f06fc043b0e5b0" class="idref" href="#8de2c9f99e4699c737f06fc043b0e5b0"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="00b55cd51f04e66754ff7c8def3f4867" class="idref" href="#00b55cd51f04e66754ff7c8def3f4867"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a>) (<a id="R:19" class="idref" href="#R:19"><span class="id" title="binder">R</span></a> : <a class="idref" href="tachis.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="is_Rcoupl" class="idref" href="#is_Rcoupl"><span class="id" title="definition">is_Rcoupl</span></a> (<a id="9a5f82bf14e2d9fa7ef57f7e19185de2" class="idref" href="#9a5f82bf14e2d9fa7ef57f7e19185de2"><span class="id" title="binder">μ</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> (<a class="idref" href="tachis.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#is_coupl"><span class="id" title="definition">is_coupl</span></a> <a class="idref" href="tachis.prob.couplings.html#bd25e74ef525ff42f542f01b0192b88d"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#765e22366dda88add855e9651a99f536"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#9a5f82bf14e2d9fa7ef57f7e19185de2"><span class="id" title="variable">μ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="p:21" class="idref" href="#p:21"><span class="id" title="binder">p</span></a> : <a class="idref" href="tachis.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a> <a class="idref" href="tachis.prob.couplings.html#9a5f82bf14e2d9fa7ef57f7e19185de2"><span class="id" title="variable">μ</span></a> <a class="idref" href="tachis.prob.couplings.html#p:21"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> 0 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl.R"><span class="id" title="variable">R</span></a> <a class="idref" href="tachis.prob.couplings.html#p:21"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="tachis.prob.couplings.html#p:21"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.2'"><span class="id" title="notation">.2</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="Rcoupl" class="idref" href="#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> := <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">(</span></a><a id="cc1e75c6f0d857f62fd72a8bc1c0288a" class="idref" href="#cc1e75c6f0d857f62fd72a8bc1c0288a"><span class="id" title="binder">μ</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> (<a class="idref" href="tachis.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a>)<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">),</span></a> <a class="idref" href="tachis.prob.couplings.html#is_Rcoupl"><span class="id" title="definition">is_Rcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#cc1e75c6f0d857f62fd72a8bc1c0288a"><span class="id" title="variable">μ</span></a>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="section">Rcoupl</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="is_coupl" class="idref" href="#is_coupl"><span class="id" title="section">is_coupl</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H:25" class="idref" href="#H:25"><span class="id" title="binder">Countable</span></a> <a id="A:23" class="idref" href="#A:23"><span class="id" title="binder"><span id="H:25" class="id">A</span></span></a>, <a id="H0:28" class="idref" href="#H0:28"><span class="id" title="binder">Countable</span></a> <a id="B:26" class="idref" href="#B:26"><span class="id" title="binder"><span id="H0:28" class="id">B</span></span></a>}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="is_Rcoupl_is_coupl" class="idref" href="#is_Rcoupl_is_coupl"><span class="id" title="lemma">is_Rcoupl_is_coupl</span></a> (<a id="b7837e3c47a8d3db8af13411031509c4" class="idref" href="#b7837e3c47a8d3db8af13411031509c4"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#is_coupl.A"><span class="id" title="variable">A</span></a>) (<a id="aa1ba50ee401cc59a220c42bc5c20a7b" class="idref" href="#aa1ba50ee401cc59a220c42bc5c20a7b"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#is_coupl.B"><span class="id" title="variable">B</span></a>) <a id="R:31" class="idref" href="#R:31"><span class="id" title="binder">R</span></a> <a id="ef4ae7934778aeed4bf39382b8b5f724" class="idref" href="#ef4ae7934778aeed4bf39382b8b5f724"><span class="id" title="binder">μ</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#is_Rcoupl"><span class="id" title="definition">is_Rcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#b7837e3c47a8d3db8af13411031509c4"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#aa1ba50ee401cc59a220c42bc5c20a7b"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#R:31"><span class="id" title="variable">R</span></a> <a class="idref" href="tachis.prob.couplings.html#ef4ae7934778aeed4bf39382b8b5f724"><span class="id" title="variable">μ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#is_coupl"><span class="id" title="definition">is_coupl</span></a> <a class="idref" href="tachis.prob.couplings.html#b7837e3c47a8d3db8af13411031509c4"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#aa1ba50ee401cc59a220c42bc5c20a7b"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#ef4ae7934778aeed4bf39382b8b5f724"><span class="id" title="variable">μ</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">intros</span> []. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="is_coupl_mass_l" class="idref" href="#is_coupl_mass_l"><span class="id" title="lemma">is_coupl_mass_l</span></a> (<a id="3609dc48822ad1a169ab1a50dd8550d3" class="idref" href="#3609dc48822ad1a169ab1a50dd8550d3"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#is_coupl.A"><span class="id" title="variable">A</span></a>) (<a id="fdf9a2b004896723c8fa6b01d8168657" class="idref" href="#fdf9a2b004896723c8fa6b01d8168657"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#is_coupl.B"><span class="id" title="variable">B</span></a>) <a id="add8f206bcb2c07fac09debe3d4baf04" class="idref" href="#add8f206bcb2c07fac09debe3d4baf04"><span class="id" title="binder">μ</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#is_coupl"><span class="id" title="definition">is_coupl</span></a> <a class="idref" href="tachis.prob.couplings.html#3609dc48822ad1a169ab1a50dd8550d3"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#fdf9a2b004896723c8fa6b01d8168657"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#add8f206bcb2c07fac09debe3d4baf04"><span class="id" title="variable">μ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="tachis.prob.couplings.html#add8f206bcb2c07fac09debe3d4baf04"><span class="id" title="variable">μ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="tachis.prob.couplings.html#3609dc48822ad1a169ab1a50dd8550d3"><span class="id" title="variable">μ1</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> (&lt;- &amp; <span class="id" title="var">_</span>). <span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.distribution.html#dmap_mass"><span class="id" title="lemma">dmap_mass</span></a> //. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="is_coupl_mass_r" class="idref" href="#is_coupl_mass_r"><span class="id" title="lemma">is_coupl_mass_r</span></a> (<a id="3fb10c98aef75f3ba3877c74ba013cb4" class="idref" href="#3fb10c98aef75f3ba3877c74ba013cb4"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#is_coupl.A"><span class="id" title="variable">A</span></a>) (<a id="89d753c7bc7a3bb38e250fa3a237b7d7" class="idref" href="#89d753c7bc7a3bb38e250fa3a237b7d7"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#is_coupl.B"><span class="id" title="variable">B</span></a>) <a id="857527bcfb5911404b587ad2f1e079e7" class="idref" href="#857527bcfb5911404b587ad2f1e079e7"><span class="id" title="binder">μ</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#is_coupl"><span class="id" title="definition">is_coupl</span></a> <a class="idref" href="tachis.prob.couplings.html#3fb10c98aef75f3ba3877c74ba013cb4"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#89d753c7bc7a3bb38e250fa3a237b7d7"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#857527bcfb5911404b587ad2f1e079e7"><span class="id" title="variable">μ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="tachis.prob.couplings.html#857527bcfb5911404b587ad2f1e079e7"><span class="id" title="variable">μ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="tachis.prob.couplings.html#89d753c7bc7a3bb38e250fa3a237b7d7"><span class="id" title="variable">μ2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> (<span class="id" title="var">_</span> &amp; &lt;-). <span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.distribution.html#dmap_mass"><span class="id" title="lemma">dmap_mass</span></a> //. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="is_coupl_mass_eq" class="idref" href="#is_coupl_mass_eq"><span class="id" title="lemma">is_coupl_mass_eq</span></a> (<a id="58e65fe083273fba688b5d007611cbee" class="idref" href="#58e65fe083273fba688b5d007611cbee"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#is_coupl.A"><span class="id" title="variable">A</span></a>) (<a id="55b15e11b0185948f4960e67714128b4" class="idref" href="#55b15e11b0185948f4960e67714128b4"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#is_coupl.B"><span class="id" title="variable">B</span></a>) <a id="097b8060c48d1509e2273bce6bb2e7d6" class="idref" href="#097b8060c48d1509e2273bce6bb2e7d6"><span class="id" title="binder">μ</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#is_coupl"><span class="id" title="definition">is_coupl</span></a> <a class="idref" href="tachis.prob.couplings.html#58e65fe083273fba688b5d007611cbee"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#55b15e11b0185948f4960e67714128b4"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#097b8060c48d1509e2273bce6bb2e7d6"><span class="id" title="variable">μ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="tachis.prob.couplings.html#58e65fe083273fba688b5d007611cbee"><span class="id" title="variable">μ1</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="tachis.prob.couplings.html#55b15e11b0185948f4960e67714128b4"><span class="id" title="variable">μ2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> -(<a class="idref" href="tachis.prob.couplings.html#is_coupl_mass_l"><span class="id" title="lemma">is_coupl_mass_l</span></a> <span class="id" title="var">_</span> <span class="id" title="var">μ2</span> <span class="id" title="var">μ</span>) // -(<a class="idref" href="tachis.prob.couplings.html#is_coupl_mass_r"><span class="id" title="lemma">is_coupl_mass_r</span></a> <span class="id" title="var">μ1</span> <span class="id" title="var">_</span> <span class="id" title="var">μ</span>) //.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="is_coupl_dret" class="idref" href="#is_coupl_dret"><span class="id" title="lemma">is_coupl_dret</span></a> (<a id="a:42" class="idref" href="#a:42"><span class="id" title="binder">a</span></a> : <a class="idref" href="tachis.prob.couplings.html#is_coupl.A"><span class="id" title="variable">A</span></a>) (<a id="b:43" class="idref" href="#b:43"><span class="id" title="binder">b</span></a> : <a class="idref" href="tachis.prob.couplings.html#is_coupl.B"><span class="id" title="variable">B</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#is_coupl"><span class="id" title="definition">is_coupl</span></a> (<a class="idref" href="tachis.prob.distribution.html#dret"><span class="id" title="definition">dret</span></a> <a class="idref" href="tachis.prob.couplings.html#a:42"><span class="id" title="variable">a</span></a>) (<a class="idref" href="tachis.prob.distribution.html#dret"><span class="id" title="definition">dret</span></a> <a class="idref" href="tachis.prob.couplings.html#b:43"><span class="id" title="variable">b</span></a>) (<a class="idref" href="tachis.prob.distribution.html#dret"><span class="id" title="definition">dret</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="tachis.prob.couplings.html#a:42"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.couplings.html#b:43"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="tachis.prob.couplings.html#is_coupl"><span class="id" title="definition">is_coupl</span></a> /<a class="idref" href="tachis.prob.distribution.html#lmarg"><span class="id" title="definition">lmarg</span></a> /<a class="idref" href="tachis.prob.distribution.html#rmarg"><span class="id" title="definition">rmarg</span></a> !<a class="idref" href="tachis.prob.distribution.html#dmap_dret"><span class="id" title="lemma">dmap_dret</span></a> //. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="tachis.prob.couplings.html#is_coupl"><span class="id" title="section">is_coupl</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="ex_coupl" class="idref" href="#ex_coupl"><span class="id" title="section">ex_coupl</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H:46" class="idref" href="#H:46"><span class="id" title="binder">Countable</span></a> <a id="A:44" class="idref" href="#A:44"><span class="id" title="binder"><span id="H:46" class="id">A</span></span></a>, <a id="H0:49" class="idref" href="#H0:49"><span class="id" title="binder">Countable</span></a> <a id="B:47" class="idref" href="#B:47"><span class="id" title="binder"><span id="H0:49" class="id">B</span></span></a>}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="coupl_dret" class="idref" href="#coupl_dret"><span class="id" title="lemma">coupl_dret</span></a> (<a id="a:50" class="idref" href="#a:50"><span class="id" title="binder">a</span></a> : <a class="idref" href="tachis.prob.couplings.html#ex_coupl.A"><span class="id" title="variable">A</span></a>) (<a id="b:51" class="idref" href="#b:51"><span class="id" title="binder">b</span></a> : <a class="idref" href="tachis.prob.couplings.html#ex_coupl.B"><span class="id" title="variable">B</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#ex_coupl"><span class="id" title="definition">ex_coupl</span></a> (<a class="idref" href="tachis.prob.distribution.html#dret"><span class="id" title="definition">dret</span></a> <a class="idref" href="tachis.prob.couplings.html#a:50"><span class="id" title="variable">a</span></a>) (<a class="idref" href="tachis.prob.distribution.html#dret"><span class="id" title="definition">dret</span></a> <a class="idref" href="tachis.prob.couplings.html#b:51"><span class="id" title="variable">b</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.couplings.html#is_coupl_dret"><span class="id" title="lemma">is_coupl_dret</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="ex_coupl_sym" class="idref" href="#ex_coupl_sym"><span class="id" title="lemma">ex_coupl_sym</span></a> (<a id="491fa43f670ee6e97bbb5a689641c329" class="idref" href="#491fa43f670ee6e97bbb5a689641c329"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#ex_coupl.A"><span class="id" title="variable">A</span></a>) (<a id="b6baa9361ef06621dcb5424cbe7dc258" class="idref" href="#b6baa9361ef06621dcb5424cbe7dc258"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#ex_coupl.B"><span class="id" title="variable">B</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#ex_coupl"><span class="id" title="definition">ex_coupl</span></a> <a class="idref" href="tachis.prob.couplings.html#491fa43f670ee6e97bbb5a689641c329"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#b6baa9361ef06621dcb5424cbe7dc258"><span class="id" title="variable">μ2</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#ex_coupl"><span class="id" title="definition">ex_coupl</span></a> <a class="idref" href="tachis.prob.couplings.html#b6baa9361ef06621dcb5424cbe7dc258"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#491fa43f670ee6e97bbb5a689641c329"><span class="id" title="variable">μ1</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> (<span class="id" title="var">μ</span> &amp; <span class="id" title="var">HμL</span> &amp; <span class="id" title="var">HμR</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<a class="idref" href="tachis.prob.distribution.html#dmap"><span class="id" title="definition">dmap</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">'</span></a><a id="pat:56" class="idref" href="#pat:56"><span class="id" title="binder"><span id="pat:59" class="id">(</span></span></a><a id="a:55" class="idref" href="#a:55"><span class="id" title="binder"><span id="pat:56" class="id"><span id="a:58" class="id"><span id="pat:59" class="id">a</span></span></span></span></a><a id="pat:56" class="idref" href="#pat:56"><span class="id" title="binder"><span id="pat:59" class="id">,</span></span></a> <a id="b:54" class="idref" href="#b:54"><span class="id" title="binder"><span id="pat:56" class="id"><span id="b:57" class="id"><span id="pat:59" class="id">b</span></span></span></span></a><a id="pat:56" class="idref" href="#pat:56"><span class="id" title="binder"><span id="pat:59" class="id">)</span></span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="tachis.prob.couplings.html#b:54"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.couplings.html#a:55"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <span class="id" title="var">μ</span>); <span class="id" title="tactic">split</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.distribution.html#distr_ext"><span class="id" title="lemma">distr_ext</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intro</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">HμR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.distribution.html#lmarg_pmf"><span class="id" title="lemma">lmarg_pmf</span></a> <a class="idref" href="tachis.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a>; <span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> {1}/<a class="idref" href="tachis.prob.distribution.html#pmf"><span class="id" title="projection">pmf</span></a> /= /<a class="idref" href="tachis.prob.distribution.html#dbind_pmf"><span class="id" title="definition">dbind_pmf</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> {2}/<a class="idref" href="tachis.prob.distribution.html#pmf"><span class="id" title="projection">pmf</span></a> /= /<a class="idref" href="tachis.prob.distribution.html#dret_pmf"><span class="id" title="definition">dret_pmf</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="a0:60" class="idref" href="#a0:60"><span class="id" title="binder"><span id="a0:62" class="id">a0</span></span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <span class="id" title="var">μ</span> <a class="idref" href="tachis.prob.couplings.html#a0:60"><span class="id" title="variable">a0</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.decidable.html#bool_decide"><span class="id" title="definition">bool_decide</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="keyword">let</span> '<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a1</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b0</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> := <a class="idref" href="tachis.prob.couplings.html#a0:60"><span class="id" title="variable">a0</span></a> <span class="id" title="tactic">in</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">b0</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">a1</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> 1 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> 0<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.decidable.html#bool_decide"><span class="id" title="definition">bool_decide</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="tachis.prob.couplings.html#a0:60"><span class="id" title="variable">a0</span></a> ) <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> 0) <span class="id" title="keyword">as</span> <span class="id" title="var">Heq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> (<span class="id" title="var">a'</span> &amp; <span class="id" title="var">b'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_bool_decide</span>; <span class="id" title="var">case_bool_decide</span>; <span class="id" title="var">simplify_eq</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="tachis.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Heq1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC_singleton'"><span class="id" title="lemma">SeriesC_singleton'</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">HμL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.distribution.html#lmarg_pmf"><span class="id" title="lemma">lmarg_pmf</span></a> <a class="idref" href="tachis.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a>; <span class="id" title="tactic">intro</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> {1}/<a class="idref" href="tachis.prob.distribution.html#pmf"><span class="id" title="projection">pmf</span></a> /= /<a class="idref" href="tachis.prob.distribution.html#dbind_pmf"><span class="id" title="definition">dbind_pmf</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> {2}/<a class="idref" href="tachis.prob.distribution.html#pmf"><span class="id" title="projection">pmf</span></a> /= /<a class="idref" href="tachis.prob.distribution.html#dret_pmf"><span class="id" title="definition">dret_pmf</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="a0:64" class="idref" href="#a0:64"><span class="id" title="binder"><span id="a0:66" class="id">a0</span></span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <span class="id" title="var">μ</span> <a class="idref" href="tachis.prob.couplings.html#a0:64"><span class="id" title="variable">a0</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.decidable.html#bool_decide"><span class="id" title="definition">bool_decide</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="keyword">let</span> '<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a1</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b0</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> := <a class="idref" href="tachis.prob.couplings.html#a0:64"><span class="id" title="variable">a0</span></a> <span class="id" title="tactic">in</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">b0</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">a1</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> 1 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> 0<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.decidable.html#bool_decide"><span class="id" title="definition">bool_decide</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="tachis.prob.couplings.html#a0:64"><span class="id" title="variable">a0</span></a> ) <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> 0) <span class="id" title="keyword">as</span> <span class="id" title="var">Heq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> (<span class="id" title="var">a'</span> &amp; <span class="id" title="var">b'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_bool_decide</span>; <span class="id" title="var">case_bool_decide</span>; <span class="id" title="var">simplify_eq</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">lra</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="tachis.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Heq1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC_singleton'"><span class="id" title="lemma">SeriesC_singleton'</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="ex_coupl_dbind" class="idref" href="#ex_coupl_dbind"><span class="id" title="lemma">ex_coupl_dbind</span></a> `{<a id="H1:70" class="idref" href="#H1:70"><span class="id" title="binder">Countable</span></a> <a id="A':68" class="idref" href="#A':68"><span class="id" title="binder"><span id="H1:70" class="id">A'</span></span></a>, <a id="H2:73" class="idref" href="#H2:73"><span class="id" title="binder">Countable</span></a> <a id="B':71" class="idref" href="#B':71"><span class="id" title="binder"><span id="H2:73" class="id">B'</span></span></a>} (<a id="f:74" class="idref" href="#f:74"><span class="id" title="binder">f</span></a> : <a class="idref" href="tachis.prob.couplings.html#ex_coupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#A':68"><span class="id" title="variable">A'</span></a>) (<a id="g:75" class="idref" href="#g:75"><span class="id" title="binder">g</span></a> : <a class="idref" href="tachis.prob.couplings.html#ex_coupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#B':71"><span class="id" title="variable">B'</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="fb92f4bea75b26cab8575bfa3fb70990" class="idref" href="#fb92f4bea75b26cab8575bfa3fb70990"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#ex_coupl.A"><span class="id" title="variable">A</span></a>) (<a id="2be0c2cb0d4e0b5f36f857a3bd81ad7a" class="idref" href="#2be0c2cb0d4e0b5f36f857a3bd81ad7a"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#ex_coupl.B"><span class="id" title="variable">B</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="a:78" class="idref" href="#a:78"><span class="id" title="binder">a</span></a> <a id="b:79" class="idref" href="#b:79"><span class="id" title="binder">b</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.couplings.html#ex_coupl"><span class="id" title="definition">ex_coupl</span></a> (<a class="idref" href="tachis.prob.couplings.html#f:74"><span class="id" title="variable">f</span></a> <a class="idref" href="tachis.prob.couplings.html#a:78"><span class="id" title="variable">a</span></a>) (<a class="idref" href="tachis.prob.couplings.html#g:75"><span class="id" title="variable">g</span></a> <a class="idref" href="tachis.prob.couplings.html#b:79"><span class="id" title="variable">b</span></a>)<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#ex_coupl"><span class="id" title="definition">ex_coupl</span></a> <a class="idref" href="tachis.prob.couplings.html#fb92f4bea75b26cab8575bfa3fb70990"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#2be0c2cb0d4e0b5f36f857a3bd81ad7a"><span class="id" title="variable">μ2</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#ex_coupl"><span class="id" title="definition">ex_coupl</span></a> (<a class="idref" href="tachis.prob.couplings.html#fb92f4bea75b26cab8575bfa3fb70990"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.distribution.html#1ec27ecb4da8da3d3cbd85a2394dc835"><span class="id" title="notation">≫=</span></a> <a class="idref" href="tachis.prob.couplings.html#f:74"><span class="id" title="variable">f</span></a>) (<a class="idref" href="tachis.prob.couplings.html#2be0c2cb0d4e0b5f36f857a3bd81ad7a"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.distribution.html#1ec27ecb4da8da3d3cbd85a2394dc835"><span class="id" title="notation">≫=</span></a> <a class="idref" href="tachis.prob.couplings.html#g:75"><span class="id" title="variable">g</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hfg</span> (<span class="id" title="var">μ</span> &amp; <span class="id" title="var">Hμ</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="tachis.prob.couplings.html#ex_coupl"><span class="id" title="definition">ex_coupl</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hfg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="p:80" class="idref" href="#p:80"><span class="id" title="binder"><span id="p:82" class="id">p</span></span></a> : <a class="idref" href="tachis.prob.couplings.html#ex_coupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="tachis.prob.couplings.html#ex_coupl.B"><span class="id" title="variable">B</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a id="a294bf0eb6e29ae69ec5768672c9a484" class="idref" href="#a294bf0eb6e29ae69ec5768672c9a484"><span class="id" title="binder"><span id="f8d4daaf2dac3fd13f88d07f68b86358" class="id">μ</span></span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> (<span class="id" title="var">A'</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <span class="id" title="var">B'</span>)<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.couplings.html#is_coupl"><span class="id" title="definition">is_coupl</span></a> (<span class="id" title="var">f</span> <a class="idref" href="tachis.prob.couplings.html#p:80"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.1'"><span class="id" title="notation">.1</span></a>) (<span class="id" title="var">g</span> <a class="idref" href="tachis.prob.couplings.html#p:80"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.2'"><span class="id" title="notation">.2</span></a>) <a class="idref" href="tachis.prob.couplings.html#a294bf0eb6e29ae69ec5768672c9a484"><span class="id" title="variable">μ</span></a>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hfg'</span>; [<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Logic.ClassicalEpsilon.html#choice"><span class="id" title="lemma">ClassicalEpsilon.choice</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hfg'</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">Ch</span> &amp; <span class="id" title="var">HCh</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="tachis.prob.couplings.html#ex_coupl"><span class="id" title="definition">ex_coupl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<a class="idref" href="tachis.prob.distribution.html#dbind"><span class="id" title="definition">dbind</span></a> <span class="id" title="var">Ch</span> <span class="id" title="var">μ</span>); <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.distribution.html#distr_ext"><span class="id" title="lemma">distr_ext</span></a>; <span class="id" title="tactic">intro</span> <span class="id" title="var">a'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.distribution.html#lmarg_pmf"><span class="id" title="lemma">lmarg_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> {1 2}/<a class="idref" href="tachis.prob.distribution.html#pmf"><span class="id" title="projection">pmf</span></a>/=/<a class="idref" href="tachis.prob.distribution.html#dbind_pmf"><span class="id" title="definition">dbind_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="tachis.prob.distribution.html#distr_double_swap_lmarg"><span class="id" title="lemma">distr_double_swap_lmarg</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">setoid_rewrite</span> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC_scal_l"><span class="id" title="lemma">SeriesC_scal_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="p:84" class="idref" href="#p:84"><span class="id" title="binder"><span id="p:86" class="id">p</span></span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <span class="id" title="var">μ</span> <a class="idref" href="tachis.prob.couplings.html#p:84"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="b':85" class="idref" href="#b':85"><span class="id" title="binder"><span id="b':87" class="id">b'</span></span></a> : <span class="id" title="var">B'</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="var">Ch</span> <a class="idref" href="tachis.prob.couplings.html#p:84"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a'</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.couplings.html#b':85"><span class="id" title="variable">b'</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">μ</span> <a class="idref" href="tachis.prob.couplings.html#p:84"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <span class="id" title="var">f</span> <a class="idref" href="tachis.prob.couplings.html#p:84"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.1'"><span class="id" title="notation">.1</span></a> <span class="id" title="var">a'</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Heq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> (<span class="id" title="var">a</span> &amp; <span class="id" title="var">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">HCh</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <span class="id" title="keyword">as</span> (<span class="id" title="var">HChL</span> &amp; <span class="id" title="var">HChR</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">HChL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.distribution.html#lmarg_pmf"><span class="id" title="lemma">lmarg_pmf</span></a> //. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="tachis.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Heq2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.countable_sum.html#fubini_pos_seriesC_prod_lr"><span class="id" title="lemma">fubini_pos_seriesC_prod_lr</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: { <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_pos"><span class="id" title="lemma">Rmult_le_pos</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: { <span class="id" title="tactic">apply</span> (<a class="idref" href="tachis.prob.countable_sum.html#ex_seriesC_le"><span class="id" title="lemma">ex_seriesC_le</span></a> <span class="id" title="var">_</span> <span class="id" title="var">μ</span>); [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">split</span>; [<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_pos"><span class="id" title="lemma">Rmult_le_pos</span></a>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -{2}(<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_1_r"><span class="id" title="lemma">Rmult_1_r</span></a> (<span class="id" title="var">μ</span> <span class="id" title="var">n</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_compat"><span class="id" title="lemma">Rmult_le_compat</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="a:88" class="idref" href="#a:88"><span class="id" title="binder"><span id="a:91" class="id">a</span></span></a> : <a class="idref" href="tachis.prob.couplings.html#ex_coupl.A"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="b:89" class="idref" href="#b:89"><span class="id" title="binder"><span id="b:92" class="id">b</span></span></a> : <a class="idref" href="tachis.prob.couplings.html#ex_coupl.B"><span class="id" title="variable">B</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="tachis.prob.couplings.html#a:88"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.couplings.html#b:89"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <span class="id" title="var">f</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="tachis.prob.couplings.html#a:88"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.couplings.html#b:89"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.1'"><span class="id" title="notation">.1</span></a> <span class="id" title="var">a'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="b:90" class="idref" href="#b:90"><span class="id" title="binder"><span id="b:93" class="id">b</span></span></a> : <a class="idref" href="tachis.prob.couplings.html#ex_coupl.B"><span class="id" title="variable">B</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="tachis.prob.couplings.html#a:88"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.couplings.html#b:90"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> ) <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <span class="id" title="var">f</span> <a class="idref" href="tachis.prob.couplings.html#a:88"><span class="id" title="variable">a</span></a> <span class="id" title="var">a'</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Heq3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC_scal_r"><span class="id" title="lemma">SeriesC_scal_r</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="tachis.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Heq3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="a:94" class="idref" href="#a:94"><span class="id" title="binder"><span id="a:96" class="id">a</span></span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="b:95" class="idref" href="#b:95"><span class="id" title="binder"><span id="b:97" class="id">b</span></span></a> : <a class="idref" href="tachis.prob.couplings.html#ex_coupl.B"><span class="id" title="variable">B</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="tachis.prob.couplings.html#a:94"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.couplings.html#b:95"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">μ1</span> <a class="idref" href="tachis.prob.couplings.html#a:94"><span class="id" title="variable">a</span></a>) <span class="id" title="keyword">as</span> <span class="id" title="var">Heq4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hμ</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">Hμ1</span> &amp; <span class="id" title="var">Hμ2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Hμ1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.distribution.html#lmarg_pmf"><span class="id" title="lemma">lmarg_pmf</span></a> //. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heq4</span> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;The&nbsp;second&nbsp;half&nbsp;is&nbsp;esentially&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;first,&nbsp;can&nbsp;it&nbsp;be&nbsp;proven&nbsp;somehow&nbsp;by&nbsp;symmetry?&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.distribution.html#distr_ext"><span class="id" title="lemma">distr_ext</span></a>; <span class="id" title="tactic">intro</span> <span class="id" title="var">b'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> {1 2}/<a class="idref" href="tachis.prob.distribution.html#pmf"><span class="id" title="projection">pmf</span></a>/=/<a class="idref" href="tachis.prob.distribution.html#dbind_pmf"><span class="id" title="definition">dbind_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="tachis.prob.distribution.html#distr_double_swap_rmarg"><span class="id" title="lemma">distr_double_swap_rmarg</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">setoid_rewrite</span> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC_scal_l"><span class="id" title="lemma">SeriesC_scal_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="p:98" class="idref" href="#p:98"><span class="id" title="binder"><span id="p:100" class="id">p</span></span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <span class="id" title="var">μ</span> <a class="idref" href="tachis.prob.couplings.html#p:98"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a':99" class="idref" href="#a':99"><span class="id" title="binder"><span id="a':101" class="id">a'</span></span></a> : <span class="id" title="var">A'</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="var">Ch</span> <a class="idref" href="tachis.prob.couplings.html#p:98"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="tachis.prob.couplings.html#a':99"><span class="id" title="variable">a'</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b'</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">μ</span> <a class="idref" href="tachis.prob.couplings.html#p:98"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <span class="id" title="var">g</span> <a class="idref" href="tachis.prob.couplings.html#p:98"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.2'"><span class="id" title="notation">.2</span></a> <span class="id" title="var">b'</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Heq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> (<span class="id" title="var">a</span> &amp; <span class="id" title="var">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">HCh</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <span class="id" title="keyword">as</span> (<span class="id" title="var">HChL</span> &amp; <span class="id" title="var">HChR</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">HChR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a> //. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="tachis.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Heq2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.countable_sum.html#fubini_pos_seriesC_prod_rl"><span class="id" title="lemma">fubini_pos_seriesC_prod_rl</span></a> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_pos"><span class="id" title="lemma">Rmult_le_pos</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id" title="tactic">apply</span> (<a class="idref" href="tachis.prob.countable_sum.html#ex_seriesC_le"><span class="id" title="lemma">ex_seriesC_le</span></a> <span class="id" title="var">_</span> <span class="id" title="var">μ</span>); [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">split</span>; [<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_pos"><span class="id" title="lemma">Rmult_le_pos</span></a>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -{2}(<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_1_r"><span class="id" title="lemma">Rmult_1_r</span></a> (<span class="id" title="var">μ</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_compat"><span class="id" title="lemma">Rmult_le_compat</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="b:102" class="idref" href="#b:102"><span class="id" title="binder"><span id="b:105" class="id">b</span></span></a> : <a class="idref" href="tachis.prob.couplings.html#ex_coupl.B"><span class="id" title="variable">B</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a:103" class="idref" href="#a:103"><span class="id" title="binder"><span id="a:106" class="id">a</span></span></a> : <a class="idref" href="tachis.prob.couplings.html#ex_coupl.A"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="tachis.prob.couplings.html#a:103"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.couplings.html#b:102"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <span class="id" title="var">g</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="tachis.prob.couplings.html#a:103"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.couplings.html#b:102"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.2'"><span class="id" title="notation">.2</span></a> <span class="id" title="var">b'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a:104" class="idref" href="#a:104"><span class="id" title="binder"><span id="a:107" class="id">a</span></span></a> : <a class="idref" href="tachis.prob.couplings.html#ex_coupl.A"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="tachis.prob.couplings.html#a:104"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.couplings.html#b:102"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> ) <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <span class="id" title="var">g</span> <a class="idref" href="tachis.prob.couplings.html#b:102"><span class="id" title="variable">b</span></a> <span class="id" title="var">b'</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Heq3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span> <span class="id" title="var">b</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC_scal_r"><span class="id" title="lemma">SeriesC_scal_r</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="tachis.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Heq3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="b:108" class="idref" href="#b:108"><span class="id" title="binder"><span id="b:110" class="id">b</span></span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a:109" class="idref" href="#a:109"><span class="id" title="binder"><span id="a:111" class="id">a</span></span></a> : <a class="idref" href="tachis.prob.couplings.html#ex_coupl.A"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="tachis.prob.couplings.html#a:109"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.couplings.html#b:108"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">μ2</span> <a class="idref" href="tachis.prob.couplings.html#b:108"><span class="id" title="variable">b</span></a>) <span class="id" title="keyword">as</span> <span class="id" title="var">Heq4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hμ</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">Hμ1</span> &amp; <span class="id" title="var">Hμ2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">Hμ2</span> <a class="idref" href="tachis.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a> //. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">b</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heq4</span> //.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="tachis.prob.couplings.html#ex_coupl"><span class="id" title="section">ex_coupl</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="is_Rcoupl" class="idref" href="#is_Rcoupl"><span class="id" title="section">is_Rcoupl</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H:114" class="idref" href="#H:114"><span class="id" title="binder">Countable</span></a> <a id="A:112" class="idref" href="#A:112"><span class="id" title="binder"><span id="H:114" class="id">A</span></span></a>, <a id="H0:117" class="idref" href="#H0:117"><span class="id" title="binder">Countable</span></a> <a id="B:115" class="idref" href="#B:115"><span class="id" title="binder"><span id="H0:117" class="id">B</span></span></a>}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="is_Rcoupl_dret" class="idref" href="#is_Rcoupl_dret"><span class="id" title="lemma">is_Rcoupl_dret</span></a> (<a id="a:118" class="idref" href="#a:118"><span class="id" title="binder">a</span></a> : <a class="idref" href="tachis.prob.couplings.html#is_Rcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="b:119" class="idref" href="#b:119"><span class="id" title="binder">b</span></a> : <a class="idref" href="tachis.prob.couplings.html#is_Rcoupl.B"><span class="id" title="variable">B</span></a>) (<a id="R:120" class="idref" href="#R:120"><span class="id" title="binder">R</span></a> : <a class="idref" href="tachis.prob.couplings.html#is_Rcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#is_Rcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#R:120"><span class="id" title="variable">R</span></a> <a class="idref" href="tachis.prob.couplings.html#a:118"><span class="id" title="variable">a</span></a> <a class="idref" href="tachis.prob.couplings.html#b:119"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#is_Rcoupl"><span class="id" title="definition">is_Rcoupl</span></a> (<a class="idref" href="tachis.prob.distribution.html#dret"><span class="id" title="definition">dret</span></a> <a class="idref" href="tachis.prob.couplings.html#a:118"><span class="id" title="variable">a</span></a>) (<a class="idref" href="tachis.prob.distribution.html#dret"><span class="id" title="definition">dret</span></a> <a class="idref" href="tachis.prob.couplings.html#b:119"><span class="id" title="variable">b</span></a>) <a class="idref" href="tachis.prob.couplings.html#R:120"><span class="id" title="variable">R</span></a> (<a class="idref" href="tachis.prob.distribution.html#dret"><span class="id" title="definition">dret</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="tachis.prob.couplings.html#a:118"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.couplings.html#b:119"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.couplings.html#is_coupl_dret"><span class="id" title="lemma">is_coupl_dret</span></a>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">intros</span> [? ?] [=-&gt; -&gt;]%<a class="idref" href="tachis.prob.distribution.html#dret_pos"><span class="id" title="lemma">dret_pos</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="tachis.prob.couplings.html#is_Rcoupl"><span class="id" title="section">is_Rcoupl</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="Rcoupl" class="idref" href="#Rcoupl"><span class="id" title="section">Rcoupl</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H:123" class="idref" href="#H:123"><span class="id" title="binder">Countable</span></a> <a id="A:121" class="idref" href="#A:121"><span class="id" title="binder"><span id="H:123" class="id">A</span></span></a>, <a id="H0:126" class="idref" href="#H0:126"><span class="id" title="binder">Countable</span></a> <a id="B:124" class="idref" href="#B:124"><span class="id" title="binder"><span id="H0:126" class="id">B</span></span></a>}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_dret" class="idref" href="#Rcoupl_dret"><span class="id" title="lemma">Rcoupl_dret</span></a> (<a id="a:127" class="idref" href="#a:127"><span class="id" title="binder">a</span></a> : <a class="idref" href="tachis.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="b:128" class="idref" href="#b:128"><span class="id" title="binder">b</span></a> : <a class="idref" href="tachis.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a>) (<a id="R:129" class="idref" href="#R:129"><span class="id" title="binder">R</span></a> : <a class="idref" href="tachis.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#R:129"><span class="id" title="variable">R</span></a> <a class="idref" href="tachis.prob.couplings.html#a:127"><span class="id" title="variable">a</span></a> <a class="idref" href="tachis.prob.couplings.html#b:128"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> (<a class="idref" href="tachis.prob.distribution.html#dret"><span class="id" title="definition">dret</span></a> <a class="idref" href="tachis.prob.couplings.html#a:127"><span class="id" title="variable">a</span></a>) (<a class="idref" href="tachis.prob.distribution.html#dret"><span class="id" title="definition">dret</span></a> <a class="idref" href="tachis.prob.couplings.html#b:128"><span class="id" title="variable">b</span></a>) <a class="idref" href="tachis.prob.couplings.html#R:129"><span class="id" title="variable">R</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.couplings.html#is_Rcoupl_dret"><span class="id" title="lemma">is_Rcoupl_dret</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_mass_eq" class="idref" href="#Rcoupl_mass_eq"><span class="id" title="lemma">Rcoupl_mass_eq</span></a> (<a id="b8bf3baa97fa7f3f8fe6fc4584fa84fd" class="idref" href="#b8bf3baa97fa7f3f8fe6fc4584fa84fd"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="d3960bb7e0e9a9643c4a5bbd75f670c4" class="idref" href="#d3960bb7e0e9a9643c4a5bbd75f670c4"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a>) (<a id="R:132" class="idref" href="#R:132"><span class="id" title="binder">R</span></a> : <a class="idref" href="tachis.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#b8bf3baa97fa7f3f8fe6fc4584fa84fd"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#d3960bb7e0e9a9643c4a5bbd75f670c4"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#R:132"><span class="id" title="variable">R</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="tachis.prob.couplings.html#b8bf3baa97fa7f3f8fe6fc4584fa84fd"><span class="id" title="variable">μ1</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="tachis.prob.couplings.html#d3960bb7e0e9a9643c4a5bbd75f670c4"><span class="id" title="variable">μ2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> (?&amp;?&amp;?). <span class="id" title="tactic">by</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="tachis.prob.couplings.html#is_coupl_mass_eq"><span class="id" title="lemma">is_coupl_mass_eq</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_eq" class="idref" href="#Rcoupl_eq"><span class="id" title="lemma">Rcoupl_eq</span></a> (<a id="c418be2bb336445c839cc5afe0dda269" class="idref" href="#c418be2bb336445c839cc5afe0dda269"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a>) : <a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#c418be2bb336445c839cc5afe0dda269"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#c418be2bb336445c839cc5afe0dda269"><span class="id" title="variable">μ1</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#924fd3758233021bbb7af913c6a625ce"><span class="id" title="notation">(=)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<a class="idref" href="tachis.prob.distribution.html#ddiag"><span class="id" title="definition">ddiag</span></a> <span class="id" title="var">μ1</span>); <span class="id" title="tactic">repeat</span> <span class="id" title="var">split_and</span>!.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.distribution.html#distr_ext"><span class="id" title="lemma">distr_ext</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.distribution.html#lmarg_pmf"><span class="id" title="lemma">lmarg_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> {1}/<a class="idref" href="tachis.prob.distribution.html#pmf"><span class="id" title="projection">pmf</span></a>/=/<a class="idref" href="tachis.prob.distribution.html#dbind_pmf"><span class="id" title="definition">dbind_pmf</span></a>/=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC_singleton'"><span class="id" title="lemma">SeriesC_singleton'</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.distribution.html#distr_ext"><span class="id" title="lemma">distr_ext</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> {1}/<a class="idref" href="tachis.prob.distribution.html#pmf"><span class="id" title="projection">pmf</span></a>/=/<a class="idref" href="tachis.prob.distribution.html#dbind_pmf"><span class="id" title="definition">dbind_pmf</span></a>/=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="tachis.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a0:134" class="idref" href="#a0:134"><span class="id" title="binder"><span id="a0:135" class="id"><span id="a0:136" class="id">a0</span></span></span></a> : <a class="idref" href="tachis.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.decidable.html#bool_decide"><span class="id" title="definition">bool_decide</span></a> (<a class="idref" href="tachis.prob.couplings.html#a0:134"><span class="id" title="variable">a0</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">a</span>) <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <span class="id" title="var">μ1</span> <span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> 0));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC_singleton"><span class="id" title="lemma">SeriesC_singleton</span></a> //| ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">a'</span>; <span class="id" title="var">case_bool_decide</span>; <span class="id" title="tactic">by</span> <span class="id" title="var">simplify_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> (<span class="id" title="var">a1</span> &amp; <span class="id" title="var">a2</span>) <span class="id" title="var">Hpos</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="tachis.prob.distribution.html#pmf"><span class="id" title="projection">pmf</span></a>/= <span class="id" title="tactic">in</span> <span class="id" title="var">Hpos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_bool_decide</span>; <span class="id" title="var">simplify_eq</span>=&gt;//. <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_dbind" class="idref" href="#Rcoupl_dbind"><span class="id" title="lemma">Rcoupl_dbind</span></a> `{<a id="H1:139" class="idref" href="#H1:139"><span class="id" title="binder">Countable</span></a> <a id="A':137" class="idref" href="#A':137"><span class="id" title="binder"><span id="H1:139" class="id">A'</span></span></a>, <a id="H2:142" class="idref" href="#H2:142"><span class="id" title="binder">Countable</span></a> <a id="B':140" class="idref" href="#B':140"><span class="id" title="binder"><span id="H2:142" class="id">B'</span></span></a>} (<a id="f:143" class="idref" href="#f:143"><span class="id" title="binder">f</span></a> : <a class="idref" href="tachis.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#A':137"><span class="id" title="variable">A'</span></a>) (<a id="g:144" class="idref" href="#g:144"><span class="id" title="binder">g</span></a> : <a class="idref" href="tachis.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#B':140"><span class="id" title="variable">B'</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="2a307783bc552bc3bf524a3c95b5ffd1" class="idref" href="#2a307783bc552bc3bf524a3c95b5ffd1"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="a3fe3de4fa103db9b0aac25d072853fc" class="idref" href="#a3fe3de4fa103db9b0aac25d072853fc"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a>) (<a id="R:147" class="idref" href="#R:147"><span class="id" title="binder">R</span></a> : <a class="idref" href="tachis.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) (<a id="S:148" class="idref" href="#S:148"><span class="id" title="binder">S</span></a> : <a class="idref" href="tachis.prob.couplings.html#A':137"><span class="id" title="variable">A'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#B':140"><span class="id" title="variable">B'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="a:149" class="idref" href="#a:149"><span class="id" title="binder">a</span></a> <a id="b:150" class="idref" href="#b:150"><span class="id" title="binder">b</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.couplings.html#R:147"><span class="id" title="variable">R</span></a> <a class="idref" href="tachis.prob.couplings.html#a:149"><span class="id" title="variable">a</span></a> <a class="idref" href="tachis.prob.couplings.html#b:150"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> (<a class="idref" href="tachis.prob.couplings.html#f:143"><span class="id" title="variable">f</span></a> <a class="idref" href="tachis.prob.couplings.html#a:149"><span class="id" title="variable">a</span></a>) (<a class="idref" href="tachis.prob.couplings.html#g:144"><span class="id" title="variable">g</span></a> <a class="idref" href="tachis.prob.couplings.html#b:150"><span class="id" title="variable">b</span></a>) <a class="idref" href="tachis.prob.couplings.html#S:148"><span class="id" title="variable">S</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#2a307783bc552bc3bf524a3c95b5ffd1"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#a3fe3de4fa103db9b0aac25d072853fc"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#R:147"><span class="id" title="variable">R</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> (<a class="idref" href="tachis.prob.couplings.html#2a307783bc552bc3bf524a3c95b5ffd1"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.distribution.html#1ec27ecb4da8da3d3cbd85a2394dc835"><span class="id" title="notation">≫=</span></a> <a class="idref" href="tachis.prob.couplings.html#f:143"><span class="id" title="variable">f</span></a>) (<a class="idref" href="tachis.prob.couplings.html#a3fe3de4fa103db9b0aac25d072853fc"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.distribution.html#1ec27ecb4da8da3d3cbd85a2394dc835"><span class="id" title="notation">≫=</span></a> <a class="idref" href="tachis.prob.couplings.html#g:144"><span class="id" title="variable">g</span></a>) <a class="idref" href="tachis.prob.couplings.html#S:148"><span class="id" title="variable">S</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hfg</span> (<span class="id" title="var">μ</span> &amp; <span class="id" title="var">HμC</span> &amp; <span class="id" title="var">HμS</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> /<a class="idref" href="tachis.prob.couplings.html#is_Rcoupl"><span class="id" title="definition">is_Rcoupl</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hfg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;First&nbsp;we&nbsp;rewrite&nbsp;Hfg&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;use&nbsp;Choice&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="p:151" class="idref" href="#p:151"><span class="id" title="binder"><span id="p:154" class="id">p</span></span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a id="2ccab5d508b226c2c6cc0a530d7df160" class="idref" href="#2ccab5d508b226c2c6cc0a530d7df160"><span class="id" title="binder"><span id="8f456d39e888555d4388cc1ddd01e42e" class="id">μ'</span></span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a> <span class="id" title="var">R</span> <a class="idref" href="tachis.prob.couplings.html#p:151"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="tachis.prob.couplings.html#p:151"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.2'"><span class="id" title="notation">.2</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="tachis.prob.couplings.html#is_coupl"><span class="id" title="definition">is_coupl</span></a> (<span class="id" title="var">f</span> <a class="idref" href="tachis.prob.couplings.html#p:151"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.1'"><span class="id" title="notation">.1</span></a>) (<span class="id" title="var">g</span> <a class="idref" href="tachis.prob.couplings.html#p:151"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.2'"><span class="id" title="notation">.2</span></a>) <a class="idref" href="tachis.prob.couplings.html#2ccab5d508b226c2c6cc0a530d7df160"><span class="id" title="variable">μ'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="q:153" class="idref" href="#q:153"><span class="id" title="binder"><span id="q:156" class="id">q</span></span></a> : <span class="id" title="var">A'</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <span class="id" title="var">B'</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.couplings.html#2ccab5d508b226c2c6cc0a530d7df160"><span class="id" title="variable">μ'</span></a> <a class="idref" href="tachis.prob.couplings.html#q:153"><span class="id" title="variable">q</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> 0 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="var">S</span> <a class="idref" href="tachis.prob.couplings.html#q:153"><span class="id" title="variable">q</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="tachis.prob.couplings.html#q:153"><span class="id" title="variable">q</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.2'"><span class="id" title="notation">.2</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> <span class="id" title="var">Hfg'</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">HμS</span> <span class="id" title="var">p</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hfg</span> <span class="id" title="var">p</span><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.1'"><span class="id" title="notation">.1</span></a> <span class="id" title="var">p</span><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.2'"><span class="id" title="notation">.2</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="tachis.prelude.classical.html#ExcludedMiddle"><span class="id" title="lemma">ExcludedMiddle</span></a> (<span class="id" title="var">R</span> <span class="id" title="var">p</span><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.1'"><span class="id" title="notation">.1</span></a> <span class="id" title="var">p</span><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.2'"><span class="id" title="notation">.2</span></a>)) <span class="id" title="keyword">as</span> <span class="id" title="var">H3</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">HR</span> | <span class="id" title="var">HnR</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hfg</span> <span class="id" title="var">HR</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hfg</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">μ'</span> &amp; <span class="id" title="var">Hμ'1</span> &amp; <span class="id" title="var">Hμ'2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">μ'</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exists</span> <a class="idref" href="tachis.prob.distribution.html#dzero"><span class="id" title="definition">dzero</span></a>; <span class="id" title="tactic">intro</span> ; <span class="id" title="var">done</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Logic.ClassicalEpsilon.html#choice"><span class="id" title="lemma">ClassicalEpsilon.choice</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hfg'</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">Ch</span> &amp; <span class="id" title="var">Hch</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> /<a class="idref" href="tachis.prob.couplings.html#is_Rcoupl"><span class="id" title="definition">is_Rcoupl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<a class="idref" href="tachis.prob.distribution.html#dbind"><span class="id" title="definition">dbind</span></a> <span class="id" title="var">Ch</span> <span class="id" title="var">μ</span>); <span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;To&nbsp;prove&nbsp;that&nbsp;the&nbsp;marginal&nbsp;coincides&nbsp;is&nbsp;a&nbsp;matter&nbsp;of&nbsp;rearranging&nbsp;the&nbsp;sums&nbsp;and&nbsp;using&nbsp;the<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fact&nbsp;that&nbsp;μ&nbsp;and&nbsp;(Ch&nbsp;p)&nbsp;are&nbsp;couplings&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.distribution.html#distr_ext"><span class="id" title="lemma">distr_ext</span></a>; <span class="id" title="tactic">intro</span> <span class="id" title="var">a'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.distribution.html#lmarg_pmf"><span class="id" title="lemma">lmarg_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> {1 2}/<a class="idref" href="tachis.prob.distribution.html#pmf"><span class="id" title="projection">pmf</span></a>/=/<a class="idref" href="tachis.prob.distribution.html#dbind_pmf"><span class="id" title="definition">dbind_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="tachis.prob.distribution.html#distr_double_swap_lmarg"><span class="id" title="lemma">distr_double_swap_lmarg</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">setoid_rewrite</span> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC_scal_l"><span class="id" title="lemma">SeriesC_scal_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> (<a class="idref" href="tachis.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="p:157" class="idref" href="#p:157"><span class="id" title="binder"><span id="p:158" class="id"><span id="p:159" class="id"><span id="p:160" class="id">p</span></span></span></span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="var">μ</span> <a class="idref" href="tachis.prob.couplings.html#p:157"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <span class="id" title="var">f</span> <a class="idref" href="tachis.prob.couplings.html#p:157"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.1'"><span class="id" title="notation">.1</span></a> <span class="id" title="var">a'</span>)); <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> (<span class="id" title="var">a</span> &amp; <span class="id" title="var">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rtotal_order"><span class="id" title="lemma">Rtotal_order</span></a> (<span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) 0) <span class="id" title="keyword">as</span> [<span class="id" title="var">Hlt</span> | [<span class="id" title="var">Heqz</span> | <span class="id" title="var">Hgt</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="tachis.prob.distribution.html#pmf_pos"><span class="id" title="projection">pmf_pos</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>); <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heqz</span>; <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hch</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> (<span class="id" title="var">HμS</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="var">Hgt</span> )) <span class="id" title="keyword">as</span> ((<span class="id" title="var">HChL</span> &amp; <span class="id" title="var">HChR</span>) &amp; <span class="id" title="var">HChS</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">HChL</span> <a class="idref" href="tachis.prob.distribution.html#lmarg_pmf"><span class="id" title="lemma">lmarg_pmf</span></a> //=. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.countable_sum.html#fubini_pos_seriesC_prod_lr"><span class="id" title="lemma">fubini_pos_seriesC_prod_lr</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: { <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_pos"><span class="id" title="lemma">Rmult_le_pos</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: { <span class="id" title="tactic">apply</span> (<a class="idref" href="tachis.prob.countable_sum.html#ex_seriesC_le"><span class="id" title="lemma">ex_seriesC_le</span></a> <span class="id" title="var">_</span> <span class="id" title="var">μ</span>); [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">split</span>; [<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_pos"><span class="id" title="lemma">Rmult_le_pos</span></a>| ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_1_r"><span class="id" title="lemma">Rmult_1_r</span></a>; <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_compat"><span class="id" title="lemma">Rmult_le_compat</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> (<a class="idref" href="tachis.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a:161" class="idref" href="#a:161"><span class="id" title="binder"><span id="a:163" class="id"><span id="a:165" class="id"><span id="a:167" class="id">a</span></span></span></span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="b:162" class="idref" href="#b:162"><span class="id" title="binder"><span id="b:164" class="id"><span id="b:166" class="id"><span id="b:168" class="id">b</span></span></span></span></a> : <a class="idref" href="tachis.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="tachis.prob.couplings.html#a:161"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.couplings.html#b:162"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> ) <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <span class="id" title="var">f</span> <a class="idref" href="tachis.prob.couplings.html#a:161"><span class="id" title="variable">a</span></a> <span class="id" title="var">a'</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[| <span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC_scal_r"><span class="id" title="lemma">SeriesC_scal_r</span></a> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> (<a class="idref" href="tachis.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a:169" class="idref" href="#a:169"><span class="id" title="binder"><span id="a:170" class="id"><span id="a:171" class="id"><span id="a:172" class="id">a</span></span></span></span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">(</span></a><span class="id" title="var">μ1</span> <a class="idref" href="tachis.prob.couplings.html#a:169"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <span class="id" title="var">f</span> <a class="idref" href="tachis.prob.couplings.html#a:169"><span class="id" title="variable">a</span></a> <span class="id" title="var">a'</span>)); [<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">HμC</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">Hμ1</span> &amp; <span class="id" title="var">Hμ2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">Hμ1</span> <a class="idref" href="tachis.prob.distribution.html#lmarg_pmf"><span class="id" title="lemma">lmarg_pmf</span></a> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.distribution.html#distr_ext"><span class="id" title="lemma">distr_ext</span></a>; <span class="id" title="tactic">intro</span> <span class="id" title="var">b'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> {1 2}/<a class="idref" href="tachis.prob.distribution.html#pmf"><span class="id" title="projection">pmf</span></a>/=/<a class="idref" href="tachis.prob.distribution.html#dbind_pmf"><span class="id" title="definition">dbind_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="tachis.prob.distribution.html#distr_double_swap_rmarg"><span class="id" title="lemma">distr_double_swap_rmarg</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">setoid_rewrite</span> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC_scal_l"><span class="id" title="lemma">SeriesC_scal_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> (<a class="idref" href="tachis.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="p:173" class="idref" href="#p:173"><span class="id" title="binder"><span id="p:174" class="id"><span id="p:175" class="id"><span id="p:176" class="id">p</span></span></span></span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="var">μ</span> <a class="idref" href="tachis.prob.couplings.html#p:173"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <span class="id" title="var">g</span> <a class="idref" href="tachis.prob.couplings.html#p:173"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.2'"><span class="id" title="notation">.2</span></a> <span class="id" title="var">b'</span>)); <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> (<span class="id" title="var">a</span> &amp; <span class="id" title="var">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rtotal_order"><span class="id" title="lemma">Rtotal_order</span></a> (<span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) 0) <span class="id" title="keyword">as</span> [<span class="id" title="var">Hlt</span> | [<span class="id" title="var">Heqz</span> | <span class="id" title="var">Hgt</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="tachis.prob.distribution.html#pmf_pos"><span class="id" title="projection">pmf_pos</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>); <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heqz</span>. <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hch</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> (<span class="id" title="var">HμS</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="var">Hgt</span>)) <span class="id" title="keyword">as</span> ((<span class="id" title="var">HChL</span> &amp; <span class="id" title="var">HChR</span>) &amp; <span class="id" title="var">HChS</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">HChR</span> <a class="idref" href="tachis.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a> //=. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.countable_sum.html#fubini_pos_seriesC_prod_rl"><span class="id" title="lemma">fubini_pos_seriesC_prod_rl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: { <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_pos"><span class="id" title="lemma">Rmult_le_pos</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: { <span class="id" title="tactic">apply</span> (<a class="idref" href="tachis.prob.countable_sum.html#ex_seriesC_le"><span class="id" title="lemma">ex_seriesC_le</span></a> <span class="id" title="var">_</span> <span class="id" title="var">μ</span>); [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">split</span>; [<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_pos"><span class="id" title="lemma">Rmult_le_pos</span></a>| ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_1_r"><span class="id" title="lemma">Rmult_1_r</span></a>; <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_compat"><span class="id" title="lemma">Rmult_le_compat</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> (<a class="idref" href="tachis.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="b:177" class="idref" href="#b:177"><span class="id" title="binder"><span id="b:179" class="id"><span id="b:181" class="id"><span id="b:183" class="id">b</span></span></span></span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a:178" class="idref" href="#a:178"><span class="id" title="binder"><span id="a:180" class="id"><span id="a:182" class="id"><span id="a:184" class="id">a</span></span></span></span></a> : <a class="idref" href="tachis.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="tachis.prob.couplings.html#a:178"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.couplings.html#b:177"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> ) <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <span class="id" title="var">g</span> <a class="idref" href="tachis.prob.couplings.html#b:177"><span class="id" title="variable">b</span></a> <span class="id" title="var">b'</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ | <span class="id" title="tactic">intro</span> <span class="id" title="var">b</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC_scal_r"><span class="id" title="lemma">SeriesC_scal_r</span></a>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> (<a class="idref" href="tachis.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="b:185" class="idref" href="#b:185"><span class="id" title="binder"><span id="b:186" class="id"><span id="b:187" class="id"><span id="b:188" class="id">b</span></span></span></span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">(</span></a><span class="id" title="var">μ2</span> <a class="idref" href="tachis.prob.couplings.html#b:185"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <span class="id" title="var">g</span> <a class="idref" href="tachis.prob.couplings.html#b:185"><span class="id" title="variable">b</span></a> <span class="id" title="var">b'</span>)); [<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">HμC</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">Hμ1</span> &amp; <span class="id" title="var">Hμ2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">Hμ2</span> <a class="idref" href="tachis.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> (<span class="id" title="var">a'</span> &amp; <span class="id" title="var">b'</span>) <span class="id" title="var">H3</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="tachis.prob.distribution.html#dbind_pos"><span class="id" title="lemma">dbind_pos</span></a> <span class="id" title="var">Ch</span> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a'</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b'</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <span class="id" title="keyword">as</span> (<span class="id" title="var">H4</span> &amp; <span class="id" title="var">H5</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">H4</span> <span class="id" title="var">H3</span>) <span class="id" title="keyword">as</span> ((<span class="id" title="var">a0</span>, <span class="id" title="var">b0</span>) &amp; <span class="id" title="var">H7</span> &amp; <span class="id" title="var">H8</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hch</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a0</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b0</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> (<span class="id" title="var">HμS</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a0</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b0</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="var">H8</span>)) <span class="id" title="keyword">as</span> (<span class="id" title="var">HCh1</span> &amp; <span class="id" title="var">HCh2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">HCh2</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a'</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b'</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="var">H7</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_eq_elim" class="idref" href="#Rcoupl_eq_elim"><span class="id" title="lemma">Rcoupl_eq_elim</span></a> (<a id="66461ca543875df23de53cd36279bab8" class="idref" href="#66461ca543875df23de53cd36279bab8"><span class="id" title="binder">μ1</span></a> <a id="4c25204a8af0e352e9430e8c6811f4a4" class="idref" href="#4c25204a8af0e352e9430e8c6811f4a4"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#66461ca543875df23de53cd36279bab8"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#4c25204a8af0e352e9430e8c6811f4a4"><span class="id" title="variable">μ2</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#924fd3758233021bbb7af913c6a625ce"><span class="id" title="notation">(=)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#66461ca543875df23de53cd36279bab8"><span class="id" title="variable">μ1</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="tachis.prob.couplings.html#4c25204a8af0e352e9430e8c6811f4a4"><span class="id" title="variable">μ2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> (<span class="id" title="var">μ</span> &amp; (<span class="id" title="var">HμL</span> &amp; <span class="id" title="var">HμR</span>) &amp; <span class="id" title="var">HμS</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">HμL</span>, &lt;- <span class="id" title="var">HμR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.distribution.html#distr_ext"><span class="id" title="lemma">distr_ext</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">a1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.distribution.html#lmarg_pmf"><span class="id" title="lemma">lmarg_pmf</span></a> <a class="idref" href="tachis.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">a2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">HμS</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a1</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">a2</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <span class="id" title="keyword">as</span> <span class="id" title="var">HμS12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">HμS</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a2</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">a1</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <span class="id" title="keyword">as</span> <span class="id" title="var">HμS21</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HμS12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HμS21</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rtotal_order"><span class="id" title="lemma">Rtotal_order</span></a> (<span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a1</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">a2</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) (<span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a2</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">a1</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>)) <span class="id" title="keyword">as</span> [<span class="id" title="var">Hlt</span> | [<span class="id" title="var">Heq</span> | <span class="id" title="var">Hgt</span>]]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="tachis.prob.distribution.html#pmf_pos"><span class="id" title="projection">pmf_pos</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a1</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">a2</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a2</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">a1</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> 0) <span class="id" title="keyword">as</span> <span class="id" title="var">H'</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">HμS21</span> <span class="id" title="var">H'</span>); <span class="id" title="tactic">destruct</span> <span class="id" title="var">HμS21</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="tachis.prob.distribution.html#pmf_pos"><span class="id" title="projection">pmf_pos</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a2</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">a1</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a1</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">a2</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> 0) <span class="id" title="keyword">as</span> <span class="id" title="var">H'</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">HμS12</span> <span class="id" title="var">H'</span>); <span class="id" title="tactic">destruct</span> <span class="id" title="var">HμS12</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_eq_sym" class="idref" href="#Rcoupl_eq_sym"><span class="id" title="lemma">Rcoupl_eq_sym</span></a> (<a id="96b8be24b26f80e6b33d2c47bf6177a9" class="idref" href="#96b8be24b26f80e6b33d2c47bf6177a9"><span class="id" title="binder">μ1</span></a> <a id="9766a17a7b4ce16be928ed8a2c739898" class="idref" href="#9766a17a7b4ce16be928ed8a2c739898"><span class="id" title="binder">μ2</span></a>: <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#96b8be24b26f80e6b33d2c47bf6177a9"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#9766a17a7b4ce16be928ed8a2c739898"><span class="id" title="variable">μ2</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#9766a17a7b4ce16be928ed8a2c739898"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#96b8be24b26f80e6b33d2c47bf6177a9"><span class="id" title="variable">μ1</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.couplings.html#Rcoupl_eq_elim"><span class="id" title="lemma">Rcoupl_eq_elim</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hc</span> <span class="id" title="keyword">as</span> -&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.couplings.html#Rcoupl_eq"><span class="id" title="lemma">Rcoupl_eq</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_eq_trans" class="idref" href="#Rcoupl_eq_trans"><span class="id" title="lemma">Rcoupl_eq_trans</span></a> (<a id="b7c9010185607449d8ee92fb0f5572b2" class="idref" href="#b7c9010185607449d8ee92fb0f5572b2"><span class="id" title="binder">μ1</span></a> <a id="1a4ba3d7b1bece9c927f57d4379e3b06" class="idref" href="#1a4ba3d7b1bece9c927f57d4379e3b06"><span class="id" title="binder">μ2</span></a> <a id="88c4b5eb11a5bf0e22af0f5232b19401" class="idref" href="#88c4b5eb11a5bf0e22af0f5232b19401"><span class="id" title="binder">μ3</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#b7c9010185607449d8ee92fb0f5572b2"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#1a4ba3d7b1bece9c927f57d4379e3b06"><span class="id" title="variable">μ2</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#1a4ba3d7b1bece9c927f57d4379e3b06"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#88c4b5eb11a5bf0e22af0f5232b19401"><span class="id" title="variable">μ3</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#b7c9010185607449d8ee92fb0f5572b2"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#88c4b5eb11a5bf0e22af0f5232b19401"><span class="id" title="variable">μ3</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">intros</span> -&gt;%<a class="idref" href="tachis.prob.couplings.html#Rcoupl_eq_elim"><span class="id" title="lemma">Rcoupl_eq_elim</span></a> ?. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_mono" class="idref" href="#Rcoupl_mono"><span class="id" title="lemma">Rcoupl_mono</span></a> (<a id="8736699ef8ba2f96d003fc4c30a45131" class="idref" href="#8736699ef8ba2f96d003fc4c30a45131"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="7aaaba77fb57c76a1597b19a072bafc2" class="idref" href="#7aaaba77fb57c76a1597b19a072bafc2"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a>) (<a id="R:198" class="idref" href="#R:198"><span class="id" title="binder">R</span></a> : <a class="idref" href="tachis.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) (<a id="S:199" class="idref" href="#S:199"><span class="id" title="binder">S</span></a> : <a class="idref" href="tachis.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#8736699ef8ba2f96d003fc4c30a45131"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#7aaaba77fb57c76a1597b19a072bafc2"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#R:198"><span class="id" title="variable">R</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="a:200" class="idref" href="#a:200"><span class="id" title="binder">a</span></a> <a id="b:201" class="idref" href="#b:201"><span class="id" title="binder">b</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.couplings.html#R:198"><span class="id" title="variable">R</span></a> <a class="idref" href="tachis.prob.couplings.html#a:200"><span class="id" title="variable">a</span></a> <a class="idref" href="tachis.prob.couplings.html#b:201"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#S:199"><span class="id" title="variable">S</span></a> <a class="idref" href="tachis.prob.couplings.html#a:200"><span class="id" title="variable">a</span></a> <a class="idref" href="tachis.prob.couplings.html#b:201"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#8736699ef8ba2f96d003fc4c30a45131"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#7aaaba77fb57c76a1597b19a072bafc2"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#S:199"><span class="id" title="variable">S</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">μ</span> [[<span class="id" title="var">HμL</span> <span class="id" title="var">HμR</span>] <span class="id" title="var">HμSupp</span>]] <span class="id" title="var">Hwk</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">μ</span>; <span class="id" title="tactic">split</span>; [<span class="id" title="tactic">split</span>| ]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_swap" class="idref" href="#Rcoupl_swap"><span class="id" title="lemma">Rcoupl_swap</span></a> (<a id="68ebaa1c457f3016f01aba4bdd9ea4b1" class="idref" href="#68ebaa1c457f3016f01aba4bdd9ea4b1"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="1a01a769fe0a72126562b20f533d1044" class="idref" href="#1a01a769fe0a72126562b20f533d1044"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a>) (<a id="R:204" class="idref" href="#R:204"><span class="id" title="binder">R</span></a> : <a class="idref" href="tachis.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#68ebaa1c457f3016f01aba4bdd9ea4b1"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#1a01a769fe0a72126562b20f533d1044"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#R:204"><span class="id" title="variable">R</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#1a01a769fe0a72126562b20f533d1044"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#68ebaa1c457f3016f01aba4bdd9ea4b1"><span class="id" title="variable">μ1</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Program.Basics.html#flip"><span class="id" title="definition">flip</span></a> <a class="idref" href="tachis.prob.couplings.html#R:204"><span class="id" title="variable">R</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> (<span class="id" title="var">μ</span> &amp; ((<span class="id" title="var">HμL</span> &amp; <span class="id" title="var">HμR</span>) &amp; <span class="id" title="var">HμSupp</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span> (<a class="idref" href="tachis.prob.distribution.html#dswap"><span class="id" title="definition">dswap</span></a> <span class="id" title="var">μ</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="tachis.prob.couplings.html#is_Rcoupl"><span class="id" title="definition">is_Rcoupl</span></a> /<a class="idref" href="tachis.prob.couplings.html#is_coupl"><span class="id" title="definition">is_coupl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.distribution.html#lmarg_dswap"><span class="id" title="lemma">lmarg_dswap</span></a> <a class="idref" href="tachis.prob.distribution.html#rmarg_dswap"><span class="id" title="lemma">rmarg_dswap</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="tactic">eauto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [] ?%<a class="idref" href="tachis.prob.distribution.html#dswap_pos"><span class="id" title="lemma">dswap_pos</span></a>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">eapply</span> (<span class="id" title="var">HμSupp</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_inhabited_l" class="idref" href="#Rcoupl_inhabited_l"><span class="id" title="lemma">Rcoupl_inhabited_l</span></a> (<a id="223fb168c87e5649e4d53171aab2a103" class="idref" href="#223fb168c87e5649e4d53171aab2a103"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="ed80eaa9b76847e3e0c896654f867af8" class="idref" href="#ed80eaa9b76847e3e0c896654f867af8"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a>) <a id="R:207" class="idref" href="#R:207"><span class="id" title="binder">R</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#223fb168c87e5649e4d53171aab2a103"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#ed80eaa9b76847e3e0c896654f867af8"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#R:207"><span class="id" title="variable">R</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="tachis.prob.couplings.html#223fb168c87e5649e4d53171aab2a103"><span class="id" title="variable">μ1</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> 0 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a id="a:208" class="idref" href="#a:208"><span class="id" title="binder">a</span></a> <a id="b:209" class="idref" href="#b:209"><span class="id" title="binder">b</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.couplings.html#R:207"><span class="id" title="variable">R</span></a> <a class="idref" href="tachis.prob.couplings.html#a:208"><span class="id" title="variable">a</span></a> <a class="idref" href="tachis.prob.couplings.html#b:209"><span class="id" title="variable">b</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">μ</span> [<span class="id" title="var">Hcpl</span> <span class="id" title="var">HR</span>]] <span class="id" title="var">Hz</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> 0) <span class="id" title="keyword">as</span> <span class="id" title="var">Hsup</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">by</span> <span class="id" title="var">erewrite</span> <a class="idref" href="tachis.prob.couplings.html#is_coupl_mass_l"><span class="id" title="lemma">is_coupl_mass_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC_gtz_ex"><span class="id" title="lemma">SeriesC_gtz_ex</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hsup</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">a</span> <span class="id" title="var">b</span>] <span class="id" title="var">Hμ</span>]; [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_inhabited_r" class="idref" href="#Rcoupl_inhabited_r"><span class="id" title="lemma">Rcoupl_inhabited_r</span></a> (<a id="7e8bb88d4e7edc080f4a09ecc8574f19" class="idref" href="#7e8bb88d4e7edc080f4a09ecc8574f19"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="2a9416ebf950b9bc6c6c1950ac122846" class="idref" href="#2a9416ebf950b9bc6c6c1950ac122846"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a>) <a id="R:212" class="idref" href="#R:212"><span class="id" title="binder">R</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#7e8bb88d4e7edc080f4a09ecc8574f19"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#2a9416ebf950b9bc6c6c1950ac122846"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#R:212"><span class="id" title="variable">R</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="tachis.prob.couplings.html#2a9416ebf950b9bc6c6c1950ac122846"><span class="id" title="variable">μ2</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> 0 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a id="a:213" class="idref" href="#a:213"><span class="id" title="binder">a</span></a> <a id="b:214" class="idref" href="#b:214"><span class="id" title="binder">b</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.couplings.html#R:212"><span class="id" title="variable">R</span></a> <a class="idref" href="tachis.prob.couplings.html#a:213"><span class="id" title="variable">a</span></a> <a class="idref" href="tachis.prob.couplings.html#b:214"><span class="id" title="variable">b</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">μ</span> [<span class="id" title="var">Hcpl</span> <span class="id" title="var">HR</span>]] <span class="id" title="var">Hz</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> 0) <span class="id" title="keyword">as</span> <span class="id" title="var">Hsup</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">by</span> <span class="id" title="var">erewrite</span> <a class="idref" href="tachis.prob.couplings.html#is_coupl_mass_r"><span class="id" title="lemma">is_coupl_mass_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC_gtz_ex"><span class="id" title="lemma">SeriesC_gtz_ex</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hsup</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">a</span> <span class="id" title="var">b</span>] <span class="id" title="var">Hμ</span>]; [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_trivial" class="idref" href="#Rcoupl_trivial"><span class="id" title="lemma">Rcoupl_trivial</span></a> (<a id="8aebff262dfb8dc842abcbbc6b2474f0" class="idref" href="#8aebff262dfb8dc842abcbbc6b2474f0"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="575abad178172e21a6ce5f42591d038f" class="idref" href="#575abad178172e21a6ce5f42591d038f"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a>)    :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="tachis.prob.couplings.html#8aebff262dfb8dc842abcbbc6b2474f0"><span class="id" title="variable">μ1</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 1 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="tachis.prob.couplings.html#575abad178172e21a6ce5f42591d038f"><span class="id" title="variable">μ2</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 1 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#8aebff262dfb8dc842abcbbc6b2474f0"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#575abad178172e21a6ce5f42591d038f"><span class="id" title="variable">μ2</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#::type_scope:'True'"><span class="id" title="notation">True</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hμ1</span> <span class="id" title="var">Hμ2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<a class="idref" href="tachis.prob.distribution.html#dprod"><span class="id" title="definition">dprod</span></a> <span class="id" title="var">μ1</span> <span class="id" title="var">μ2</span>). <span class="id" title="tactic">split</span>; [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.distribution.html#lmarg_dprod"><span class="id" title="lemma">lmarg_dprod</span></a>|<span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.distribution.html#rmarg_dprod"><span class="id" title="lemma">rmarg_dprod</span></a>]; <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_pos_R" class="idref" href="#Rcoupl_pos_R"><span class="id" title="lemma">Rcoupl_pos_R</span></a> (<a id="90f4dd296b026d2680b876c6cf026cb2" class="idref" href="#90f4dd296b026d2680b876c6cf026cb2"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="8b67d84cd7d572537eb25a4cc58b9065" class="idref" href="#8b67d84cd7d572537eb25a4cc58b9065"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a>) <a id="R:219" class="idref" href="#R:219"><span class="id" title="binder">R</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#90f4dd296b026d2680b876c6cf026cb2"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#8b67d84cd7d572537eb25a4cc58b9065"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#R:219"><span class="id" title="variable">R</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#90f4dd296b026d2680b876c6cf026cb2"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#8b67d84cd7d572537eb25a4cc58b9065"><span class="id" title="variable">μ2</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a:220" class="idref" href="#a:220"><span class="id" title="binder">a</span></a> <a id="b:221" class="idref" href="#b:221"><span class="id" title="binder">b</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.couplings.html#R:219"><span class="id" title="variable">R</span></a> <a class="idref" href="tachis.prob.couplings.html#a:220"><span class="id" title="variable">a</span></a> <a class="idref" href="tachis.prob.couplings.html#b:221"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="tachis.prob.couplings.html#90f4dd296b026d2680b876c6cf026cb2"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#a:220"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> 0 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="tachis.prob.couplings.html#8b67d84cd7d572537eb25a4cc58b9065"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#b:221"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> 0).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">μ</span> [[<span class="id" title="var">Hμ1</span> <span class="id" title="var">Hμ2</span>] <span class="id" title="var">HR</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">μ</span>. <span class="id" title="tactic">split</span>; [<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">a</span> <span class="id" title="var">b</span>] <span class="id" title="var">H</span>ρ. <span class="id" title="tactic">split</span>; [<span class="id" title="tactic">auto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">Hμ1</span> -<span class="id" title="var">Hμ2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2!<a class="idref" href="tachis.prob.distribution.html#dmap_pos"><span class="id" title="lemma">dmap_pos</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_dzero_dzero" class="idref" href="#Rcoupl_dzero_dzero"><span class="id" title="lemma">Rcoupl_dzero_dzero</span></a> (<a id="R:222" class="idref" href="#R:222"><span class="id" title="binder">R</span></a> : <a class="idref" href="tachis.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="tachis.prob.distribution.html#dzero"><span class="id" title="definition">dzero</span></a> <a class="idref" href="tachis.prob.distribution.html#dzero"><span class="id" title="definition">dzero</span></a> <a class="idref" href="tachis.prob.couplings.html#R:222"><span class="id" title="variable">R</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <a class="idref" href="tachis.prob.distribution.html#dzero"><span class="id" title="definition">dzero</span></a>. <span class="id" title="tactic">split</span>; [|<span class="id" title="tactic">intros</span>; <span class="id" title="var">inv_distr</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.distribution.html#lmarg_dzero"><span class="id" title="lemma">lmarg_dzero</span></a>|<span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.distribution.html#rmarg_dzero"><span class="id" title="lemma">rmarg_dzero</span></a>].<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_dzero_r_inv" class="idref" href="#Rcoupl_dzero_r_inv"><span class="id" title="lemma">Rcoupl_dzero_r_inv</span></a> <a id="4f83582c214eb433a58f08fb4a18f0a8" class="idref" href="#4f83582c214eb433a58f08fb4a18f0a8"><span class="id" title="binder">μ1</span></a> (<a id="R:224" class="idref" href="#R:224"><span class="id" title="binder">R</span></a> : <a class="idref" href="tachis.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#4f83582c214eb433a58f08fb4a18f0a8"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.distribution.html#dzero"><span class="id" title="definition">dzero</span></a> <a class="idref" href="tachis.prob.couplings.html#R:224"><span class="id" title="variable">R</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#4f83582c214eb433a58f08fb4a18f0a8"><span class="id" title="variable">μ1</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="tachis.prob.distribution.html#dzero"><span class="id" title="definition">dzero</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hz</span>%<a class="idref" href="tachis.prob.couplings.html#Rcoupl_mass_eq"><span class="id" title="lemma">Rcoupl_mass_eq</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.distribution.html#SeriesC_zero_dzero"><span class="id" title="lemma">SeriesC_zero_dzero</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hz</span> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC_0"><span class="id" title="lemma">SeriesC_0</span></a> //.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_dzero_l_inv" class="idref" href="#Rcoupl_dzero_l_inv"><span class="id" title="lemma">Rcoupl_dzero_l_inv</span></a> <a id="b2ce7026df5e000eeb871d223b8d0e52" class="idref" href="#b2ce7026df5e000eeb871d223b8d0e52"><span class="id" title="binder">μ2</span></a> (<a id="R:226" class="idref" href="#R:226"><span class="id" title="binder">R</span></a> : <a class="idref" href="tachis.prob.couplings.html#Rcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="tachis.prob.distribution.html#dzero"><span class="id" title="definition">dzero</span></a> <a class="idref" href="tachis.prob.couplings.html#b2ce7026df5e000eeb871d223b8d0e52"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#R:226"><span class="id" title="variable">R</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#b2ce7026df5e000eeb871d223b8d0e52"><span class="id" title="variable">μ2</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="tachis.prob.distribution.html#dzero"><span class="id" title="definition">dzero</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hz</span>%<a class="idref" href="tachis.prob.couplings.html#Rcoupl_mass_eq"><span class="id" title="lemma">Rcoupl_mass_eq</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.distribution.html#SeriesC_zero_dzero"><span class="id" title="lemma">SeriesC_zero_dzero</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">Hz</span> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC_0"><span class="id" title="lemma">SeriesC_0</span></a> //.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="section">Rcoupl</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_dmap" class="idref" href="#Rcoupl_dmap"><span class="id" title="lemma">Rcoupl_dmap</span></a> `{<a id="H:229" class="idref" href="#H:229"><span class="id" title="binder">Countable</span></a> <a id="A:227" class="idref" href="#A:227"><span class="id" title="binder"><span id="H:229" class="id">A</span></span></a>, <a id="H0:232" class="idref" href="#H0:232"><span class="id" title="binder">Countable</span></a> <a id="B:230" class="idref" href="#B:230"><span class="id" title="binder"><span id="H0:232" class="id">B</span></span></a>, <a id="H1:235" class="idref" href="#H1:235"><span class="id" title="binder">Countable</span></a> <a id="A':233" class="idref" href="#A':233"><span class="id" title="binder"><span id="H1:235" class="id">A'</span></span></a>, <a id="H2:238" class="idref" href="#H2:238"><span class="id" title="binder">Countable</span></a> <a id="B':236" class="idref" href="#B':236"><span class="id" title="binder"><span id="H2:238" class="id">B'</span></span></a>}<br/>
&nbsp;&nbsp;(<a id="f:239" class="idref" href="#f:239"><span class="id" title="binder">f</span></a> : <a class="idref" href="tachis.prob.couplings.html#A:227"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#A':233"><span class="id" title="variable">A'</span></a>) (<a id="g:240" class="idref" href="#g:240"><span class="id" title="binder">g</span></a> : <a class="idref" href="tachis.prob.couplings.html#B:230"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#B':236"><span class="id" title="variable">B'</span></a>) (<a id="84d4f47b8db1273ddafb8263dafcfdb6" class="idref" href="#84d4f47b8db1273ddafb8263dafcfdb6"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#A:227"><span class="id" title="variable">A</span></a>) (<a id="95247d9e9206efc80138a951d1d96a5a" class="idref" href="#95247d9e9206efc80138a951d1d96a5a"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#B:230"><span class="id" title="variable">B</span></a>) (<a id="R:243" class="idref" href="#R:243"><span class="id" title="binder">R</span></a> : <a class="idref" href="tachis.prob.couplings.html#A':233"><span class="id" title="variable">A'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#B':236"><span class="id" title="variable">B'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) :<br/>
&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#84d4f47b8db1273ddafb8263dafcfdb6"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#95247d9e9206efc80138a951d1d96a5a"><span class="id" title="variable">μ2</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a:244" class="idref" href="#a:244"><span class="id" title="binder">a</span></a> <a id="a':245" class="idref" href="#a':245"><span class="id" title="binder">a'</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.couplings.html#R:243"><span class="id" title="variable">R</span></a> (<a class="idref" href="tachis.prob.couplings.html#f:239"><span class="id" title="variable">f</span></a> <a class="idref" href="tachis.prob.couplings.html#a:244"><span class="id" title="variable">a</span></a>) (<a class="idref" href="tachis.prob.couplings.html#g:240"><span class="id" title="variable">g</span></a> <a class="idref" href="tachis.prob.couplings.html#a':245"><span class="id" title="variable">a'</span></a>)) <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> (<a class="idref" href="tachis.prob.distribution.html#dmap"><span class="id" title="definition">dmap</span></a> <a class="idref" href="tachis.prob.couplings.html#f:239"><span class="id" title="variable">f</span></a> <a class="idref" href="tachis.prob.couplings.html#84d4f47b8db1273ddafb8263dafcfdb6"><span class="id" title="variable">μ1</span></a>) (<a class="idref" href="tachis.prob.distribution.html#dmap"><span class="id" title="definition">dmap</span></a> <a class="idref" href="tachis.prob.couplings.html#g:240"><span class="id" title="variable">g</span></a> <a class="idref" href="tachis.prob.couplings.html#95247d9e9206efc80138a951d1d96a5a"><span class="id" title="variable">μ2</span></a>) <a class="idref" href="tachis.prob.couplings.html#R:243"><span class="id" title="variable">R</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hcoupl</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="tachis.prob.distribution.html#dmap"><span class="id" title="definition">dmap</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="tachis.prob.couplings.html#Rcoupl_dbind"><span class="id" title="lemma">Rcoupl_dbind</span></a>; [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="tachis.prob.couplings.html#Rcoupl_dret"><span class="id" title="lemma">Rcoupl_dret</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_dunif" class="idref" href="#Rcoupl_dunif"><span class="id" title="lemma">Rcoupl_dunif</span></a> (<a id="N:246" class="idref" href="#N:246"><span class="id" title="binder">N</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) <a id="f:247" class="idref" href="#f:247"><span class="id" title="binder">f</span></a> `{<a id="H:248" class="idref" href="#H:248"><span class="id" title="binder">Bij</span></a> <a id="H:248" class="idref" href="#H:248"><span class="id" title="binder">(</span></a><a id="H:248" class="idref" href="#H:248"><span class="id" title="binder">fin</span></a> <a id="H:248" class="idref" href="#H:248"><span class="id" title="binder">N</span></a><a id="H:248" class="idref" href="#H:248"><span class="id" title="binder">)</span></a> <a id="H:248" class="idref" href="#H:248"><span class="id" title="binder">(</span></a><a id="H:248" class="idref" href="#H:248"><span class="id" title="binder">fin</span></a> <a id="H:248" class="idref" href="#H:248"><span class="id" title="binder">N</span></a><a id="H:248" class="idref" href="#H:248"><span class="id" title="binder">)</span></a> <a id="H:248" class="idref" href="#H:248"><span class="id" title="binder">f</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> (<a class="idref" href="tachis.prob.distribution.html#dunif"><span class="id" title="definition">dunif</span></a> <a class="idref" href="tachis.prob.couplings.html#N:246"><span class="id" title="variable">N</span></a>) (<a class="idref" href="tachis.prob.distribution.html#dunif"><span class="id" title="definition">dunif</span></a> <a class="idref" href="tachis.prob.couplings.html#N:246"><span class="id" title="variable">N</span></a>) (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="n:249" class="idref" href="#n:249"><span class="id" title="binder">n</span></a> <a id="m:250" class="idref" href="#m:250"><span class="id" title="binder">m</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.couplings.html#m:250"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="tachis.prob.couplings.html#f:247"><span class="id" title="variable">f</span></a> <a class="idref" href="tachis.prob.couplings.html#n:249"><span class="id" title="variable">n</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<a class="idref" href="tachis.prob.distribution.html#dmap"><span class="id" title="definition">dmap</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="x:251" class="idref" href="#x:251"><span class="id" title="binder"><span id="x:252" class="id">x</span></span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="tachis.prob.couplings.html#x:251"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">f</span> <a class="idref" href="tachis.prob.couplings.html#x:251"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) (<a class="idref" href="tachis.prob.distribution.html#dunif"><span class="id" title="definition">dunif</span></a> <span class="id" title="var">N</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="tactic">split</span>|].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="tachis.prob.distribution.html#distr_ext"><span class="id" title="lemma">distr_ext</span></a>=&gt; <span class="id" title="var">y1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.distribution.html#lmarg_pmf"><span class="id" title="lemma">lmarg_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> (<a class="idref" href="tachis.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="y2:253" class="idref" href="#y2:253"><span class="id" title="binder"><span id="y2:254" class="id"><span id="y2:255" class="id"><span id="y2:256" class="id">y2</span></span></span></span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.decidable.html#bool_decide"><span class="id" title="definition">bool_decide</span></a> (<a class="idref" href="tachis.prob.couplings.html#y2:253"><span class="id" title="variable">y2</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">f</span> <span class="id" title="var">y1</span>) <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#2299a6ef56270a66cc1b95489d0f6e3a"><span class="id" title="notation">/</span></a><span class="id" title="var">N</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> 0)); <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span>. <span class="id" title="var">case_bool_decide</span>; <span class="id" title="var">simplify_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="tachis.prob.distribution.html#dmap_unif_nonzero"><span class="id" title="lemma">dmap_unif_nonzero</span></a>; [|<span class="id" title="var">done</span>]. <span class="id" title="tactic">intros</span> ???; <span class="id" title="tactic">by</span> <span class="id" title="var">simplify_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.distribution.html#dmap_unif_zero"><span class="id" title="lemma">dmap_unif_zero</span></a>. <span class="id" title="tactic">intros</span> ? [=]; <span class="id" title="var">simplify_eq</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.distribution.html#dunif_pmf"><span class="id" title="lemma">dunif_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC_singleton"><span class="id" title="lemma">SeriesC_singleton</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="tachis.prob.distribution.html#distr_ext"><span class="id" title="lemma">distr_ext</span></a>=&gt; <span class="id" title="var">y2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> (<a class="idref" href="tachis.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="y1:257" class="idref" href="#y1:257"><span class="id" title="binder"><span id="y1:258" class="id"><span id="y1:259" class="id"><span id="y1:260" class="id">y1</span></span></span></span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.decidable.html#bool_decide"><span class="id" title="definition">bool_decide</span></a> (<span class="id" title="var">f</span> <a class="idref" href="tachis.prob.couplings.html#y1:257"><span class="id" title="variable">y1</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">y2</span>) <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#2299a6ef56270a66cc1b95489d0f6e3a"><span class="id" title="notation">/</span></a><span class="id" title="var">N</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> 0)); <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span>. <span class="id" title="var">case_bool_decide</span>; <span class="id" title="var">simplify_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="tachis.prob.distribution.html#dmap_unif_nonzero"><span class="id" title="lemma">dmap_unif_nonzero</span></a>; [|<span class="id" title="var">done</span>]. <span class="id" title="tactic">intros</span> ???; <span class="id" title="tactic">by</span> <span class="id" title="var">simplify_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.distribution.html#dmap_unif_zero"><span class="id" title="lemma">dmap_unif_zero</span></a>. <span class="id" title="tactic">intros</span> ? [=]; <span class="id" title="var">simplify_eq</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.distribution.html#dunif_pmf"><span class="id" title="lemma">dunif_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="tachis.prob.countable_sum.html#SeriesC_singleton_inj"><span class="id" title="lemma">SeriesC_singleton_inj</span></a> <span class="id" title="var">y2</span> <span class="id" title="var">f</span>); [<span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#surj"><span class="id" title="definition">surj</span></a> <span class="id" title="var">f</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> (<span class="id" title="var">m1</span> &amp; <span class="id" title="var">m2</span>) (<span class="id" title="var">n</span> &amp; [=] &amp; <span class="id" title="var">Hn</span>)%<a class="idref" href="tachis.prob.distribution.html#dmap_pos"><span class="id" title="lemma">dmap_pos</span></a> =&gt;/=. <span class="id" title="tactic">by</span> <span class="id" title="var">simplify_eq</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_fair_coin_dunifP" class="idref" href="#Rcoupl_fair_coin_dunifP"><span class="id" title="lemma">Rcoupl_fair_coin_dunifP</span></a> `{<a id="H:263" class="idref" href="#H:263"><span class="id" title="binder">Countable</span></a> <a id="A:261" class="idref" href="#A:261"><span class="id" title="binder"><span id="H:263" class="id">A</span></span></a>} (<a id="941a92ffaa5bb198652bf548b8b20222" class="idref" href="#941a92ffaa5bb198652bf548b8b20222"><span class="id" title="binder">μ</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#A:261"><span class="id" title="variable">A</span></a>) <a id="R:265" class="idref" href="#R:265"><span class="id" title="binder">R</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="tachis.prob.distribution.html#fair_coin"><span class="id" title="definition">fair_coin</span></a> <a class="idref" href="tachis.prob.couplings.html#941a92ffaa5bb198652bf548b8b20222"><span class="id" title="variable">μ</span></a> <a class="idref" href="tachis.prob.couplings.html#R:265"><span class="id" title="variable">R</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> (<a class="idref" href="tachis.prob.distribution.html#dunifP"><span class="id" title="definition">dunifP</span></a> 1) <a class="idref" href="tachis.prob.couplings.html#941a92ffaa5bb198652bf548b8b20222"><span class="id" title="variable">μ</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="n:266" class="idref" href="#n:266"><span class="id" title="binder">n</span></a> <a id="a:267" class="idref" href="#a:267"><span class="id" title="binder">a</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.couplings.html#R:265"><span class="id" title="variable">R</span></a> (<a class="idref" href="tachis.prelude.stdpp_ext.html#fin_to_bool"><span class="id" title="definition">fin_to_bool</span></a> <a class="idref" href="tachis.prob.couplings.html#n:266"><span class="id" title="variable">n</span></a>) <a class="idref" href="tachis.prob.couplings.html#a:267"><span class="id" title="variable">a</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hcpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="tachis.prob.distribution.html#dunifP"><span class="id" title="definition">dunifP</span></a> 1 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="tachis.prob.distribution.html#dmap"><span class="id" title="definition">dmap</span></a> <a class="idref" href="tachis.prelude.stdpp_ext.html#bool_to_fin"><span class="id" title="definition">bool_to_fin</span></a> <a class="idref" href="tachis.prob.distribution.html#fair_coin"><span class="id" title="definition">fair_coin</span></a>) <span class="id" title="keyword">as</span> -&gt;.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.distribution.html#distr_ext"><span class="id" title="lemma">distr_ext</span></a>=&gt;<span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="tachis.prob.distribution.html#pmf"><span class="id" title="projection">pmf</span></a>/= /<a class="idref" href="tachis.prob.distribution.html#dbind_pmf"><span class="id" title="definition">dbind_pmf</span></a> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC_bool"><span class="id" title="lemma">SeriesC_bool</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="tachis.prob.distribution.html#pmf"><span class="id" title="projection">pmf</span></a>/= /<a class="idref" href="tachis.prob.distribution.html#fair_coin_pmf"><span class="id" title="lemma">fair_coin_pmf</span></a> /<a class="idref" href="tachis.prob.distribution.html#dret_pmf"><span class="id" title="definition">dret_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">inv_fin</span> <span class="id" title="var">n</span>; <span class="id" title="tactic">simpl</span>; [<span class="id" title="var">lra</span>|]=&gt; <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">inv_fin</span> <span class="id" title="var">n</span>; <span class="id" title="tactic">simpl</span>; [<span class="id" title="var">lra</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> 1. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -(<a class="idref" href="tachis.prob.distribution.html#dret_id_right"><span class="id" title="lemma">dret_id_right</span></a> <span class="id" title="var">μ</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.couplings.html#Rcoupl_dmap"><span class="id" title="lemma">Rcoupl_dmap</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">(</span></a><a id="a:268" class="idref" href="#a:268"><span class="id" title="binder"><span id="a:270" class="id">a</span></span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>) (<a id="a':269" class="idref" href="#a':269"><span class="id" title="binder"><span id="a':271" class="id">a'</span></span></a> : <span class="id" title="var">A</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">),</span></a> <span class="id" title="var">R</span> (<a class="idref" href="tachis.prelude.stdpp_ext.html#fin_to_bool"><span class="id" title="definition">fin_to_bool</span></a> (<a class="idref" href="tachis.prelude.stdpp_ext.html#bool_to_fin"><span class="id" title="definition">bool_to_fin</span></a> <a class="idref" href="tachis.prob.couplings.html#a:268"><span class="id" title="variable">a</span></a>)) <a class="idref" href="tachis.prob.couplings.html#a':269"><span class="id" title="variable">a'</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">R</span>) <span class="id" title="keyword">as</span> -&gt;; [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">extensionality</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prelude.stdpp_ext.html#bool_to_fin_to_bool"><span class="id" title="lemma">bool_to_fin_to_bool</span></a> //.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="fair_conv_comb_dbind" class="idref" href="#fair_conv_comb_dbind"><span class="id" title="lemma">fair_conv_comb_dbind</span></a> `{<a id="H:274" class="idref" href="#H:274"><span class="id" title="binder">Countable</span></a> <a id="A:272" class="idref" href="#A:272"><span class="id" title="binder"><span id="H:274" class="id">A</span></span></a>, <a id="H0:277" class="idref" href="#H0:277"><span class="id" title="binder">Countable</span></a> <a id="B:275" class="idref" href="#B:275"><span class="id" title="binder"><span id="H0:277" class="id">B</span></span></a>} (<a id="f:278" class="idref" href="#f:278"><span class="id" title="binder">f</span></a> : <a class="idref" href="tachis.prob.couplings.html#A:272"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#B:275"><span class="id" title="variable">B</span></a>) (<a id="0cf5e5555af7d13127b7d22d0ad3b9d7" class="idref" href="#0cf5e5555af7d13127b7d22d0ad3b9d7"><span class="id" title="binder">μ1</span></a> <a id="2b413d96941e008d6242d95b9c6c84a1" class="idref" href="#2b413d96941e008d6242d95b9c6c84a1"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#A:272"><span class="id" title="variable">A</span></a>):<br/>
&nbsp;&nbsp;<a class="idref" href="tachis.prob.distribution.html#fair_conv_comb"><span class="id" title="definition">fair_conv_comb</span></a> <a class="idref" href="tachis.prob.couplings.html#0cf5e5555af7d13127b7d22d0ad3b9d7"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#2b413d96941e008d6242d95b9c6c84a1"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.distribution.html#1ec27ecb4da8da3d3cbd85a2394dc835"><span class="id" title="notation">≫=</span></a> <a class="idref" href="tachis.prob.couplings.html#f:278"><span class="id" title="variable">f</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="tachis.prob.distribution.html#fair_conv_comb"><span class="id" title="definition">fair_conv_comb</span></a> (<a class="idref" href="tachis.prob.couplings.html#0cf5e5555af7d13127b7d22d0ad3b9d7"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.distribution.html#1ec27ecb4da8da3d3cbd85a2394dc835"><span class="id" title="notation">≫=</span></a> <a class="idref" href="tachis.prob.couplings.html#f:278"><span class="id" title="variable">f</span></a>) (<a class="idref" href="tachis.prob.couplings.html#2b413d96941e008d6242d95b9c6c84a1"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.distribution.html#1ec27ecb4da8da3d3cbd85a2394dc835"><span class="id" title="notation">≫=</span></a> <a class="idref" href="tachis.prob.couplings.html#f:278"><span class="id" title="variable">f</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="tachis.prob.distribution.html#fair_conv_comb"><span class="id" title="definition">fair_conv_comb</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="tachis.prob.distribution.html#dbind_assoc"><span class="id" title="lemma">dbind_assoc</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.couplings.html#Rcoupl_eq_elim"><span class="id" title="lemma">Rcoupl_eq_elim</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="tachis.prob.couplings.html#Rcoupl_dbind"><span class="id" title="lemma">Rcoupl_dbind</span></a>; [| <span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.couplings.html#Rcoupl_eq"><span class="id" title="lemma">Rcoupl_eq</span></a>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> -&gt;.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.couplings.html#Rcoupl_eq"><span class="id" title="lemma">Rcoupl_eq</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="Rcoupl_strength" class="idref" href="#Rcoupl_strength"><span class="id" title="section">Rcoupl_strength</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H:283" class="idref" href="#H:283"><span class="id" title="binder">Countable</span></a> <a id="A:281" class="idref" href="#A:281"><span class="id" title="binder"><span id="H:283" class="id">A</span></span></a>, <a id="H0:286" class="idref" href="#H0:286"><span class="id" title="binder">Countable</span></a> <a id="B:284" class="idref" href="#B:284"><span class="id" title="binder"><span id="H0:286" class="id">B</span></span></a>, <a id="H1:289" class="idref" href="#H1:289"><span class="id" title="binder">Countable</span></a> <a id="D:287" class="idref" href="#D:287"><span class="id" title="binder"><span id="H1:289" class="id">D</span></span></a>, <a id="H2:292" class="idref" href="#H2:292"><span class="id" title="binder">Countable</span></a> <a id="E:290" class="idref" href="#E:290"><span class="id" title="binder"><span id="H2:292" class="id">E</span></span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<a id="006d57969455c95eb36bbdf86bda64a5" class="idref" href="#006d57969455c95eb36bbdf86bda64a5"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl_strength.A"><span class="id" title="variable">A</span></a>) (<a id="d907eea1ce5aa11e64f6d6c2675aaf6e" class="idref" href="#d907eea1ce5aa11e64f6d6c2675aaf6e"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl_strength.B"><span class="id" title="variable">B</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_strength_l" class="idref" href="#Rcoupl_strength_l"><span class="id" title="lemma">Rcoupl_strength_l</span></a> (<a id="R:295" class="idref" href="#R:295"><span class="id" title="binder">R</span></a> : <a class="idref" href="tachis.prob.couplings.html#Rcoupl_strength.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl_strength.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) (<a id="d:296" class="idref" href="#d:296"><span class="id" title="binder">d</span></a> : <a class="idref" href="tachis.prob.couplings.html#Rcoupl_strength.D"><span class="id" title="variable">D</span></a>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#4610bf25777509125aadf87c886bf6bd"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#17621db61b04d0de722ee9be01719362"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#R:295"><span class="id" title="variable">R</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> (<a class="idref" href="tachis.prob.distribution.html#strength_l"><span class="id" title="definition">strength_l</span></a> <a class="idref" href="tachis.prob.couplings.html#d:296"><span class="id" title="variable">d</span></a> <a class="idref" href="tachis.prob.couplings.html#4610bf25777509125aadf87c886bf6bd"><span class="id" title="variable">μ1</span></a>) <a class="idref" href="tachis.prob.couplings.html#17621db61b04d0de722ee9be01719362"><span class="id" title="variable">μ2</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">'</span></a><a id="pat:299" class="idref" href="#pat:299"><span class="id" title="binder">(</span></a><a id="d':298" class="idref" href="#d':298"><span class="id" title="binder"><span id="pat:299" class="id">d'</span></span></a><a id="pat:299" class="idref" href="#pat:299"><span class="id" title="binder">,</span></a> <a id="a:297" class="idref" href="#a:297"><span class="id" title="binder"><span id="pat:299" class="id">a</span></span></a><a id="pat:299" class="idref" href="#pat:299"><span class="id" title="binder">)</span></a> <a id="b:300" class="idref" href="#b:300"><span class="id" title="binder">b</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.couplings.html#d':298"><span class="id" title="variable">d'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="tachis.prob.couplings.html#d:296"><span class="id" title="variable">d</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="tachis.prob.couplings.html#R:295"><span class="id" title="variable">R</span></a> <a class="idref" href="tachis.prob.couplings.html#a:297"><span class="id" title="variable">a</span></a> <a class="idref" href="tachis.prob.couplings.html#b:300"><span class="id" title="variable">b</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="tachis.prob.distribution.html#strength_l"><span class="id" title="definition">strength_l</span></a> /<a class="idref" href="tachis.prob.distribution.html#dmap"><span class="id" title="definition">dmap</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hcpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -(<a class="idref" href="tachis.prob.distribution.html#dret_id_right"><span class="id" title="lemma">dret_id_right</span></a> <a class="idref" href="tachis.prob.couplings.html#17621db61b04d0de722ee9be01719362"><span class="id" title="variable">μ2</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="tachis.prob.couplings.html#Rcoupl_dbind"><span class="id" title="lemma">Rcoupl_dbind</span></a>; [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.couplings.html#Rcoupl_dret"><span class="id" title="lemma">Rcoupl_dret</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_strength" class="idref" href="#Rcoupl_strength"><span class="id" title="lemma">Rcoupl_strength</span></a> (<a id="R:301" class="idref" href="#R:301"><span class="id" title="binder">R</span></a> : <a class="idref" href="tachis.prob.couplings.html#Rcoupl_strength.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl_strength.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) (<a id="d:302" class="idref" href="#d:302"><span class="id" title="binder">d</span></a> : <a class="idref" href="tachis.prob.couplings.html#Rcoupl_strength.D"><span class="id" title="variable">D</span></a>) (<a id="e:303" class="idref" href="#e:303"><span class="id" title="binder">e</span></a> : <a class="idref" href="tachis.prob.couplings.html#Rcoupl_strength.E"><span class="id" title="variable">E</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#4610bf25777509125aadf87c886bf6bd"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#17621db61b04d0de722ee9be01719362"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#R:301"><span class="id" title="variable">R</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> (<a class="idref" href="tachis.prob.distribution.html#strength_l"><span class="id" title="definition">strength_l</span></a> <a class="idref" href="tachis.prob.couplings.html#d:302"><span class="id" title="variable">d</span></a> <a class="idref" href="tachis.prob.couplings.html#4610bf25777509125aadf87c886bf6bd"><span class="id" title="variable">μ1</span></a>) (<a class="idref" href="tachis.prob.distribution.html#strength_l"><span class="id" title="definition">strength_l</span></a> <a class="idref" href="tachis.prob.couplings.html#e:303"><span class="id" title="variable">e</span></a> <a class="idref" href="tachis.prob.couplings.html#17621db61b04d0de722ee9be01719362"><span class="id" title="variable">μ2</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">'</span></a><a id="pat:306" class="idref" href="#pat:306"><span class="id" title="binder">(</span></a><a id="d':305" class="idref" href="#d':305"><span class="id" title="binder"><span id="pat:306" class="id">d'</span></span></a><a id="pat:306" class="idref" href="#pat:306"><span class="id" title="binder">,</span></a> <a id="a:304" class="idref" href="#a:304"><span class="id" title="binder"><span id="pat:306" class="id">a</span></span></a><a id="pat:306" class="idref" href="#pat:306"><span class="id" title="binder">)</span></a> '<a id="pat:309" class="idref" href="#pat:309"><span class="id" title="binder">(</span></a><a id="e':308" class="idref" href="#e':308"><span class="id" title="binder"><span id="pat:309" class="id">e'</span></span></a><a id="pat:309" class="idref" href="#pat:309"><span class="id" title="binder">,</span></a> <a id="b:307" class="idref" href="#b:307"><span class="id" title="binder"><span id="pat:309" class="id">b</span></span></a><a id="pat:309" class="idref" href="#pat:309"><span class="id" title="binder">)</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.couplings.html#d':305"><span class="id" title="variable">d'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="tachis.prob.couplings.html#d:302"><span class="id" title="variable">d</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="tachis.prob.couplings.html#e':308"><span class="id" title="variable">e'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="tachis.prob.couplings.html#e:303"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="tachis.prob.couplings.html#R:301"><span class="id" title="variable">R</span></a> <a class="idref" href="tachis.prob.couplings.html#a:304"><span class="id" title="variable">a</span></a> <a class="idref" href="tachis.prob.couplings.html#b:307"><span class="id" title="variable">b</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="tachis.prob.distribution.html#strength_l"><span class="id" title="definition">strength_l</span></a> /<a class="idref" href="tachis.prob.distribution.html#dmap"><span class="id" title="definition">dmap</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="tachis.prob.couplings.html#Rcoupl_dbind"><span class="id" title="lemma">Rcoupl_dbind</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.couplings.html#Rcoupl_dret"><span class="id" title="lemma">Rcoupl_dret</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="tachis.prob.couplings.html#Rcoupl_strength"><span class="id" title="section">Rcoupl_strength</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="refcoupl" class="idref" href="#refcoupl"><span class="id" title="section">refcoupl</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H:312" class="idref" href="#H:312"><span class="id" title="binder">Countable</span></a> <a id="A:310" class="idref" href="#A:310"><span class="id" title="binder"><span id="H:312" class="id">A</span></span></a>, <a id="H0:315" class="idref" href="#H0:315"><span class="id" title="binder">Countable</span></a> <a id="B:313" class="idref" href="#B:313"><span class="id" title="binder"><span id="H0:315" class="id">B</span></span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<a id="edfc84a11c8d0f27f26e05c1afc1a1af" class="idref" href="#edfc84a11c8d0f27f26e05c1afc1a1af"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#refcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="f90bb8ffe4cee6efca312ee6fd2f158f" class="idref" href="#f90bb8ffe4cee6efca312ee6fd2f158f"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#refcoupl.B"><span class="id" title="variable">B</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="is_refcoupl" class="idref" href="#is_refcoupl"><span class="id" title="definition">is_refcoupl</span></a> (<a id="ba097b4c994b9d57a543944ff16a6e04" class="idref" href="#ba097b4c994b9d57a543944ff16a6e04"><span class="id" title="binder">μ</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> (<a class="idref" href="tachis.prob.couplings.html#refcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="tachis.prob.couplings.html#refcoupl.B"><span class="id" title="variable">B</span></a>)) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.distribution.html#lmarg"><span class="id" title="definition">lmarg</span></a> <a class="idref" href="tachis.prob.couplings.html#ba097b4c994b9d57a543944ff16a6e04"><span class="id" title="variable">μ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="tachis.prob.couplings.html#7a54db6f28655e067446ca617b849410"><span class="id" title="variable">μ1</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="b:319" class="idref" href="#b:319"><span class="id" title="binder">b</span></a> : <a class="idref" href="tachis.prob.couplings.html#refcoupl.B"><span class="id" title="variable">B</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a> <a class="idref" href="tachis.prob.distribution.html#rmarg"><span class="id" title="definition">rmarg</span></a> <a class="idref" href="tachis.prob.couplings.html#ba097b4c994b9d57a543944ff16a6e04"><span class="id" title="variable">μ</span></a> <a class="idref" href="tachis.prob.couplings.html#b:319"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="tachis.prob.couplings.html#70cfe85fac37a080fe61e7eeff50e91f"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#b:319"><span class="id" title="variable">b</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="ex_refcoupl" class="idref" href="#ex_refcoupl"><span class="id" title="definition">ex_refcoupl</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">(</span></a><a id="3881256d2a5a74f0202dcfbbafa0e982" class="idref" href="#3881256d2a5a74f0202dcfbbafa0e982"><span class="id" title="binder">μ</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> (<a class="idref" href="tachis.prob.couplings.html#refcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="tachis.prob.couplings.html#refcoupl.B"><span class="id" title="variable">B</span></a>)<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">),</span></a> <a class="idref" href="tachis.prob.couplings.html#is_refcoupl"><span class="id" title="definition">is_refcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#3881256d2a5a74f0202dcfbbafa0e982"><span class="id" title="variable">μ</span></a>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="tachis.prob.couplings.html#refcoupl"><span class="id" title="section">refcoupl</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="refRcoupl" class="idref" href="#refRcoupl"><span class="id" title="section">refRcoupl</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H:323" class="idref" href="#H:323"><span class="id" title="binder">Countable</span></a> <a id="A:321" class="idref" href="#A:321"><span class="id" title="binder"><span id="H:323" class="id">A</span></span></a>, <a id="H0:326" class="idref" href="#H0:326"><span class="id" title="binder">Countable</span></a> <a id="B:324" class="idref" href="#B:324"><span class="id" title="binder"><span id="H0:326" class="id">B</span></span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<a id="cd4d830e7c1179eb46f03773a682f4cb" class="idref" href="#cd4d830e7c1179eb46f03773a682f4cb"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="829bd77795844fcc8809b9702a6fb21a" class="idref" href="#829bd77795844fcc8809b9702a6fb21a"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a>) (<a id="R:329" class="idref" href="#R:329"><span class="id" title="binder">R</span></a> : <a class="idref" href="tachis.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="is_refRcoupl" class="idref" href="#is_refRcoupl"><span class="id" title="definition">is_refRcoupl</span></a> (<a id="8d5aa194aa739da7b83bfdb2814fde1a" class="idref" href="#8d5aa194aa739da7b83bfdb2814fde1a"><span class="id" title="binder">μ</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> (<a class="idref" href="tachis.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a>)) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#is_refcoupl"><span class="id" title="definition">is_refcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#d1039bc2620b861e186a90ffa48201a9"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#cdb21d605c56261e9c952fe2092cbe76"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#8d5aa194aa739da7b83bfdb2814fde1a"><span class="id" title="variable">μ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="p:331" class="idref" href="#p:331"><span class="id" title="binder">p</span></a> : <a class="idref" href="tachis.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a> <a class="idref" href="tachis.prob.couplings.html#8d5aa194aa739da7b83bfdb2814fde1a"><span class="id" title="variable">μ</span></a> <a class="idref" href="tachis.prob.couplings.html#p:331"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> 0 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.R"><span class="id" title="variable">R</span></a> <a class="idref" href="tachis.prob.couplings.html#p:331"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="tachis.prob.couplings.html#p:331"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.2'"><span class="id" title="notation">.2</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="refRcoupl" class="idref" href="#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">(</span></a><a id="63c832bab03369194fb17f6239e68e4b" class="idref" href="#63c832bab03369194fb17f6239e68e4b"><span class="id" title="binder">μ</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> (<a class="idref" href="tachis.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a>)<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">),</span></a> <a class="idref" href="tachis.prob.couplings.html#is_refRcoupl"><span class="id" title="definition">is_refRcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#63c832bab03369194fb17f6239e68e4b"><span class="id" title="variable">μ</span></a>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="tachis.prob.couplings.html#refRcoupl"><span class="id" title="section">refRcoupl</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="refcoupl" class="idref" href="#refcoupl"><span class="id" title="section">refcoupl</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H:335" class="idref" href="#H:335"><span class="id" title="binder">Countable</span></a> <a id="A:333" class="idref" href="#A:333"><span class="id" title="binder"><span id="H:335" class="id">A</span></span></a>, <a id="H0:338" class="idref" href="#H0:338"><span class="id" title="binder">Countable</span></a> <a id="B:336" class="idref" href="#B:336"><span class="id" title="binder"><span id="H0:338" class="id">B</span></span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<a id="38922bbd4f9c37819ed11a27a05b3632" class="idref" href="#38922bbd4f9c37819ed11a27a05b3632"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#refcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="f79a50f9dc95b9c55b358dcdc3b670bb" class="idref" href="#f79a50f9dc95b9c55b358dcdc3b670bb"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#refcoupl.B"><span class="id" title="variable">B</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="is_refcoupl_dret" class="idref" href="#is_refcoupl_dret"><span class="id" title="lemma">is_refcoupl_dret</span></a> (<a id="a:341" class="idref" href="#a:341"><span class="id" title="binder">a</span></a> : <a class="idref" href="tachis.prob.couplings.html#refcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="b:342" class="idref" href="#b:342"><span class="id" title="binder">b</span></a> : <a class="idref" href="tachis.prob.couplings.html#refcoupl.B"><span class="id" title="variable">B</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#is_refcoupl"><span class="id" title="definition">is_refcoupl</span></a> (<a class="idref" href="tachis.prob.distribution.html#dret"><span class="id" title="definition">dret</span></a> <a class="idref" href="tachis.prob.couplings.html#a:341"><span class="id" title="variable">a</span></a>) (<a class="idref" href="tachis.prob.distribution.html#dret"><span class="id" title="definition">dret</span></a> <a class="idref" href="tachis.prob.couplings.html#b:342"><span class="id" title="variable">b</span></a>) (<a class="idref" href="tachis.prob.distribution.html#dret"><span class="id" title="definition">dret</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="tachis.prob.couplings.html#a:341"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.couplings.html#b:342"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">split</span>; [<span class="id" title="tactic">rewrite</span> /<a class="idref" href="tachis.prob.distribution.html#lmarg"><span class="id" title="definition">lmarg</span></a> <a class="idref" href="tachis.prob.distribution.html#dmap_dret"><span class="id" title="lemma">dmap_dret</span></a> // | <span class="id" title="tactic">rewrite</span> /<a class="idref" href="tachis.prob.distribution.html#rmarg"><span class="id" title="definition">rmarg</span></a> <a class="idref" href="tachis.prob.distribution.html#dmap_dret"><span class="id" title="lemma">dmap_dret</span></a> //]. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="tachis.prob.couplings.html#refcoupl"><span class="id" title="section">refcoupl</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="is_refRcoupl" class="idref" href="#is_refRcoupl"><span class="id" title="section">is_refRcoupl</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H:345" class="idref" href="#H:345"><span class="id" title="binder">Countable</span></a> <a id="A:343" class="idref" href="#A:343"><span class="id" title="binder"><span id="H:345" class="id">A</span></span></a>, <a id="H0:348" class="idref" href="#H0:348"><span class="id" title="binder">Countable</span></a> <a id="B:346" class="idref" href="#B:346"><span class="id" title="binder"><span id="H0:348" class="id">B</span></span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<a id="5bef28a4f1a0979320f1478a468ac22a" class="idref" href="#5bef28a4f1a0979320f1478a468ac22a"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#is_refRcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="2be05a8ff1db277222a9a9dffad15e6a" class="idref" href="#2be05a8ff1db277222a9a9dffad15e6a"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#is_refRcoupl.B"><span class="id" title="variable">B</span></a>) (<a id="R:351" class="idref" href="#R:351"><span class="id" title="binder">R</span></a> : <a class="idref" href="tachis.prob.couplings.html#is_refRcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#is_refRcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) (<a id="c65d1dd4383b3ec3694d4c9b23656324" class="idref" href="#c65d1dd4383b3ec3694d4c9b23656324"><span class="id" title="binder">μ</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> (<a class="idref" href="tachis.prob.couplings.html#is_refRcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="tachis.prob.couplings.html#is_refRcoupl.B"><span class="id" title="variable">B</span></a>)).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="is_refRcoupl_mass_l" class="idref" href="#is_refRcoupl_mass_l"><span class="id" title="lemma">is_refRcoupl_mass_l</span></a> : <a class="idref" href="tachis.prob.couplings.html#is_refRcoupl"><span class="id" title="definition">is_refRcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#6f34c6ba51a1f72419aae715b0c91389"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#443a8cb3a4f3b1df92f6e7bc66f11ef7"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#is_refRcoupl.R"><span class="id" title="variable">R</span></a> <a class="idref" href="tachis.prob.couplings.html#bea3fc71ac219bdaabf47e6ffd2e59da"><span class="id" title="variable">μ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="tachis.prob.couplings.html#bea3fc71ac219bdaabf47e6ffd2e59da"><span class="id" title="variable">μ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="tachis.prob.couplings.html#6f34c6ba51a1f72419aae715b0c91389"><span class="id" title="variable">μ1</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> ([&lt;- <span class="id" title="var">Hr</span>] &amp; <span class="id" title="var">Hμ</span>). <span class="id" title="tactic">rewrite</span> /<a class="idref" href="tachis.prob.distribution.html#lmarg"><span class="id" title="definition">lmarg</span></a> <a class="idref" href="tachis.prob.distribution.html#dmap_mass"><span class="id" title="lemma">dmap_mass</span></a> //. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="is_refRcoupl_mass_r" class="idref" href="#is_refRcoupl_mass_r"><span class="id" title="lemma">is_refRcoupl_mass_r</span></a> : <a class="idref" href="tachis.prob.couplings.html#is_refRcoupl"><span class="id" title="definition">is_refRcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#6f34c6ba51a1f72419aae715b0c91389"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#443a8cb3a4f3b1df92f6e7bc66f11ef7"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#is_refRcoupl.R"><span class="id" title="variable">R</span></a> <a class="idref" href="tachis.prob.couplings.html#bea3fc71ac219bdaabf47e6ffd2e59da"><span class="id" title="variable">μ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="tachis.prob.couplings.html#bea3fc71ac219bdaabf47e6ffd2e59da"><span class="id" title="variable">μ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="tachis.prob.couplings.html#443a8cb3a4f3b1df92f6e7bc66f11ef7"><span class="id" title="variable">μ2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ([<span class="id" title="var">Hl</span> <span class="id" title="var">Hr</span>] &amp; <span class="id" title="var">Hμ</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -(<a class="idref" href="tachis.prob.distribution.html#dmap_mass"><span class="id" title="lemma">dmap_mass</span></a> <a class="idref" href="tachis.prob.couplings.html#bea3fc71ac219bdaabf47e6ffd2e59da"><span class="id" title="variable">μ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC_le"><span class="id" title="lemma">SeriesC_le</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="is_refRcoupl_mass_eq" class="idref" href="#is_refRcoupl_mass_eq"><span class="id" title="lemma">is_refRcoupl_mass_eq</span></a> : <a class="idref" href="tachis.prob.couplings.html#is_refRcoupl"><span class="id" title="definition">is_refRcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#6f34c6ba51a1f72419aae715b0c91389"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#443a8cb3a4f3b1df92f6e7bc66f11ef7"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#is_refRcoupl.R"><span class="id" title="variable">R</span></a> <a class="idref" href="tachis.prob.couplings.html#bea3fc71ac219bdaabf47e6ffd2e59da"><span class="id" title="variable">μ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="tachis.prob.couplings.html#6f34c6ba51a1f72419aae715b0c91389"><span class="id" title="variable">μ1</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="tachis.prob.couplings.html#443a8cb3a4f3b1df92f6e7bc66f11ef7"><span class="id" title="variable">μ2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">Hμ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="tachis.prob.couplings.html#is_refRcoupl_mass_l"><span class="id" title="lemma">is_refRcoupl_mass_l</span></a>; [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.couplings.html#is_refRcoupl_mass_r"><span class="id" title="lemma">is_refRcoupl_mass_r</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="tachis.prob.couplings.html#is_refRcoupl"><span class="id" title="section">is_refRcoupl</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="refRcoupl" class="idref" href="#refRcoupl"><span class="id" title="section">refRcoupl</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H:355" class="idref" href="#H:355"><span class="id" title="binder">Countable</span></a> <a id="A:353" class="idref" href="#A:353"><span class="id" title="binder"><span id="H:355" class="id">A</span></span></a>, <a id="H0:358" class="idref" href="#H0:358"><span class="id" title="binder">Countable</span></a> <a id="B:356" class="idref" href="#B:356"><span class="id" title="binder"><span id="H0:358" class="id">B</span></span></a>}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="refRcoupl_mass_eq" class="idref" href="#refRcoupl_mass_eq"><span class="id" title="lemma">refRcoupl_mass_eq</span></a> (<a id="7384621de8e86e0735454a3489c7edb7" class="idref" href="#7384621de8e86e0735454a3489c7edb7"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="02380bae352c28f25d6f524d55bce0f8" class="idref" href="#02380bae352c28f25d6f524d55bce0f8"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a>) (<a id="R:361" class="idref" href="#R:361"><span class="id" title="binder">R</span></a> : <a class="idref" href="tachis.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#7384621de8e86e0735454a3489c7edb7"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#02380bae352c28f25d6f524d55bce0f8"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#R:361"><span class="id" title="variable">R</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="tachis.prob.couplings.html#7384621de8e86e0735454a3489c7edb7"><span class="id" title="variable">μ1</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="tachis.prob.couplings.html#02380bae352c28f25d6f524d55bce0f8"><span class="id" title="variable">μ2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> (?&amp;?&amp;?). <span class="id" title="tactic">by</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="tachis.prob.couplings.html#is_refRcoupl_mass_eq"><span class="id" title="lemma">is_refRcoupl_mass_eq</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="refRcoupl_eq_elim" class="idref" href="#refRcoupl_eq_elim"><span class="id" title="lemma">refRcoupl_eq_elim</span></a> (<a id="09964499e1599087d9ec88a6ba230c80" class="idref" href="#09964499e1599087d9ec88a6ba230c80"><span class="id" title="binder">μ1</span></a> <a id="3181d4b4b4b6ac791fe2b13f9b40f691" class="idref" href="#3181d4b4b4b6ac791fe2b13f9b40f691"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#09964499e1599087d9ec88a6ba230c80"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#3181d4b4b4b6ac791fe2b13f9b40f691"><span class="id" title="variable">μ2</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#924fd3758233021bbb7af913c6a625ce"><span class="id" title="notation">(=)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="a:364" class="idref" href="#a:364"><span class="id" title="binder">a</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.couplings.html#09964499e1599087d9ec88a6ba230c80"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#a:364"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="tachis.prob.couplings.html#3181d4b4b4b6ac791fe2b13f9b40f691"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#a:364"><span class="id" title="variable">a</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> (<span class="id" title="var">μ</span> &amp; (<span class="id" title="var">HμL</span> &amp; <span class="id" title="var">HμR</span>) &amp; <span class="id" title="var">HμS</span>) <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="tachis.prelude.Reals_ext.html#Rle_Transitive"><span class="id" title="instance">Rle_Transitive</span></a> <span class="id" title="var">_</span> (<a class="idref" href="tachis.prob.distribution.html#rmarg"><span class="id" title="definition">rmarg</span></a> <span class="id" title="var">μ</span> <span class="id" title="var">a</span>) <span class="id" title="var">_</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">HμL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.distribution.html#lmarg_pmf"><span class="id" title="lemma">lmarg_pmf</span></a> <a class="idref" href="tachis.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC_le"><span class="id" title="lemma">SeriesC_le</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span> . <span class="id" title="tactic">specialize</span> (<span class="id" title="var">HμS</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>). <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HμS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rtotal_order"><span class="id" title="lemma">Rtotal_order</span></a> (<span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) 0) <span class="id" title="keyword">as</span> [? | [? | <span class="id" title="var">H3</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="tachis.prob.distribution.html#pmf_pos"><span class="id" title="projection">pmf_pos</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>); <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="tachis.prob.distribution.html#pmf_pos"><span class="id" title="projection">pmf_pos</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>); <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">HμS</span> <span class="id" title="var">H3</span>); <span class="id" title="var">simplify_eq</span>; <span class="id" title="var">lra</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.distribution.html#ex_distr_rmarg"><span class="id" title="lemma">ex_distr_rmarg</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="refRcoupl_from_leq" class="idref" href="#refRcoupl_from_leq"><span class="id" title="lemma">refRcoupl_from_leq</span></a> (<a id="d7d527916996a1a1bccf82fbea188d4f" class="idref" href="#d7d527916996a1a1bccf82fbea188d4f"><span class="id" title="binder">μ1</span></a> <a id="191a491222b4b700896aa978499e68d0" class="idref" href="#191a491222b4b700896aa978499e68d0"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="a:367" class="idref" href="#a:367"><span class="id" title="binder">a</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.couplings.html#d7d527916996a1a1bccf82fbea188d4f"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#a:367"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="tachis.prob.couplings.html#191a491222b4b700896aa978499e68d0"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#a:367"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#d7d527916996a1a1bccf82fbea188d4f"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#191a491222b4b700896aa978499e68d0"><span class="id" title="variable">μ2</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#924fd3758233021bbb7af913c6a625ce"><span class="id" title="notation">(=)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">Hleq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<a class="idref" href="tachis.prob.distribution.html#ddiag"><span class="id" title="definition">ddiag</span></a> <span class="id" title="var">μ1</span>). <span class="id" title="tactic">split</span>;[ <span class="id" title="tactic">split</span>  | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.distribution.html#distr_ext"><span class="id" title="lemma">distr_ext</span></a>; <span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.distribution.html#lmarg_pmf"><span class="id" title="lemma">lmarg_pmf</span></a> {2}/<a class="idref" href="tachis.prob.distribution.html#pmf"><span class="id" title="projection">pmf</span></a>/=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC_singleton'"><span class="id" title="lemma">SeriesC_singleton'</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.distribution.html#ddiag_rmarg"><span class="id" title="lemma">ddiag_rmarg</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">p</span> <span class="id" title="var">Hp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.distribution.html#ddiag_pmf"><span class="id" title="lemma">ddiag_pmf</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_bool_decide</span>; <span class="id" title="tactic">auto</span>; <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="refRcoupl_eq_refl" class="idref" href="#refRcoupl_eq_refl"><span class="id" title="lemma">refRcoupl_eq_refl</span></a> (<a id="b71546053895c2eeab93d3a9578d4dc2" class="idref" href="#b71546053895c2eeab93d3a9578d4dc2"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#b71546053895c2eeab93d3a9578d4dc2"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#b71546053895c2eeab93d3a9578d4dc2"><span class="id" title="variable">μ1</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#924fd3758233021bbb7af913c6a625ce"><span class="id" title="notation">(=)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.couplings.html#refRcoupl_from_leq"><span class="id" title="lemma">refRcoupl_from_leq</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="refRcoupl_eq_trans" class="idref" href="#refRcoupl_eq_trans"><span class="id" title="lemma">refRcoupl_eq_trans</span></a> (<a id="56654825e43de2b7c0d5c36b9057b76a" class="idref" href="#56654825e43de2b7c0d5c36b9057b76a"><span class="id" title="binder">μ1</span></a> <a id="e96a8ab3f15a47ff9a4ea1ea10348ef0" class="idref" href="#e96a8ab3f15a47ff9a4ea1ea10348ef0"><span class="id" title="binder">μ2</span></a> <a id="25803cb15f6f4ed0d18c5ba75ea92c4d" class="idref" href="#25803cb15f6f4ed0d18c5ba75ea92c4d"><span class="id" title="binder">μ3</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#56654825e43de2b7c0d5c36b9057b76a"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#e96a8ab3f15a47ff9a4ea1ea10348ef0"><span class="id" title="variable">μ2</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#924fd3758233021bbb7af913c6a625ce"><span class="id" title="notation">(=)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#e96a8ab3f15a47ff9a4ea1ea10348ef0"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#25803cb15f6f4ed0d18c5ba75ea92c4d"><span class="id" title="variable">μ3</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#924fd3758233021bbb7af913c6a625ce"><span class="id" title="notation">(=)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#56654825e43de2b7c0d5c36b9057b76a"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#25803cb15f6f4ed0d18c5ba75ea92c4d"><span class="id" title="variable">μ3</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#924fd3758233021bbb7af913c6a625ce"><span class="id" title="notation">(=)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H12</span> <span class="id" title="var">H23</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="tachis.prob.couplings.html#refRcoupl_eq_elim"><span class="id" title="lemma">refRcoupl_eq_elim</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H12</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H12'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="tachis.prob.couplings.html#refRcoupl_eq_elim"><span class="id" title="lemma">refRcoupl_eq_elim</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H23</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H23'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.couplings.html#refRcoupl_from_leq"><span class="id" title="lemma">refRcoupl_from_leq</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">eapply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rle_trans"><span class="id" title="lemma">Rle_trans</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="refRcoupl_eq_refRcoupl_unfoldl" class="idref" href="#refRcoupl_eq_refRcoupl_unfoldl"><span class="id" title="lemma">refRcoupl_eq_refRcoupl_unfoldl</span></a> (<a id="b5989c92a42d9791fd6330aae424f28e" class="idref" href="#b5989c92a42d9791fd6330aae424f28e"><span class="id" title="binder">μ1</span></a> <a id="7bb7e1e5437b8e2298ebd5bd4089bc75" class="idref" href="#7bb7e1e5437b8e2298ebd5bd4089bc75"><span class="id" title="binder">μ2</span></a> <a id="ff3e159f0c8b25dedee0a656a8fa40ff" class="idref" href="#ff3e159f0c8b25dedee0a656a8fa40ff"><span class="id" title="binder">μ3</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a>) <a id="R:375" class="idref" href="#R:375"><span class="id" title="binder">R</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#b5989c92a42d9791fd6330aae424f28e"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#7bb7e1e5437b8e2298ebd5bd4089bc75"><span class="id" title="variable">μ2</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#924fd3758233021bbb7af913c6a625ce"><span class="id" title="notation">(=)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#7bb7e1e5437b8e2298ebd5bd4089bc75"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#ff3e159f0c8b25dedee0a656a8fa40ff"><span class="id" title="variable">μ3</span></a> <a class="idref" href="tachis.prob.couplings.html#R:375"><span class="id" title="variable">R</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#b5989c92a42d9791fd6330aae424f28e"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#ff3e159f0c8b25dedee0a656a8fa40ff"><span class="id" title="variable">μ3</span></a> <a class="idref" href="tachis.prob.couplings.html#R:375"><span class="id" title="variable">R</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">intros</span> -&gt;%<a class="idref" href="tachis.prob.couplings.html#Rcoupl_eq_elim"><span class="id" title="lemma">Rcoupl_eq_elim</span></a> ?. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="refRcoupl_eq_refRcoupl_unfoldr" class="idref" href="#refRcoupl_eq_refRcoupl_unfoldr"><span class="id" title="lemma">refRcoupl_eq_refRcoupl_unfoldr</span></a> (<a id="d19d87ac31c3b92eea0f1a56dc34bc3f" class="idref" href="#d19d87ac31c3b92eea0f1a56dc34bc3f"><span class="id" title="binder">μ1</span></a> <a id="671dde4d52da51e187432272258953e9" class="idref" href="#671dde4d52da51e187432272258953e9"><span class="id" title="binder">μ2</span></a> <a id="9ef724d886c793429c2e4fbb245fbdd1" class="idref" href="#9ef724d886c793429c2e4fbb245fbdd1"><span class="id" title="binder">μ3</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a>) <a id="R:379" class="idref" href="#R:379"><span class="id" title="binder">R</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#d19d87ac31c3b92eea0f1a56dc34bc3f"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#671dde4d52da51e187432272258953e9"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#R:379"><span class="id" title="variable">R</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#671dde4d52da51e187432272258953e9"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#9ef724d886c793429c2e4fbb245fbdd1"><span class="id" title="variable">μ3</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#924fd3758233021bbb7af913c6a625ce"><span class="id" title="notation">(=)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#d19d87ac31c3b92eea0f1a56dc34bc3f"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#9ef724d886c793429c2e4fbb245fbdd1"><span class="id" title="variable">μ3</span></a> <a class="idref" href="tachis.prob.couplings.html#R:379"><span class="id" title="variable">R</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">intros</span> ? &lt;-%<a class="idref" href="tachis.prob.couplings.html#Rcoupl_eq_elim"><span class="id" title="lemma">Rcoupl_eq_elim</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_refRcoupl" class="idref" href="#Rcoupl_refRcoupl"><span class="id" title="lemma">Rcoupl_refRcoupl</span></a> (<a id="0789f952ed5a4566311b68381704e27f" class="idref" href="#0789f952ed5a4566311b68381704e27f"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="71d0b33f458e0e4f13331aa58fb59b8e" class="idref" href="#71d0b33f458e0e4f13331aa58fb59b8e"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a>) (<a id="R:382" class="idref" href="#R:382"><span class="id" title="binder">R</span></a> : <a class="idref" href="tachis.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#0789f952ed5a4566311b68381704e27f"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#71d0b33f458e0e4f13331aa58fb59b8e"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#R:382"><span class="id" title="variable">R</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#0789f952ed5a4566311b68381704e27f"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#71d0b33f458e0e4f13331aa58fb59b8e"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#R:382"><span class="id" title="variable">R</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="tachis.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> /<a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> (<span class="id" title="var">μ</span> &amp; ((<span class="id" title="var">HμL</span> &amp; <span class="id" title="var">HμR</span>) &amp; <span class="id" title="var">HμSupp</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">μ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">HμR</span>; <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Rcoupl_refRcoupl'" class="idref" href="#Rcoupl_refRcoupl'"><span class="id" title="lemma">Rcoupl_refRcoupl'</span></a> (<a id="40f8fcc0e359e0df132028c2e987efe1" class="idref" href="#40f8fcc0e359e0df132028c2e987efe1"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="1362468003be55e527c8b93238e7cb06" class="idref" href="#1362468003be55e527c8b93238e7cb06"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a>) (<a id="R:385" class="idref" href="#R:385"><span class="id" title="binder">R</span></a> : <a class="idref" href="tachis.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#40f8fcc0e359e0df132028c2e987efe1"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#1362468003be55e527c8b93238e7cb06"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#R:385"><span class="id" title="variable">R</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#1362468003be55e527c8b93238e7cb06"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#40f8fcc0e359e0df132028c2e987efe1"><span class="id" title="variable">μ1</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Program.Basics.html#flip"><span class="id" title="definition">flip</span></a> <a class="idref" href="tachis.prob.couplings.html#R:385"><span class="id" title="variable">R</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="tachis.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> /<a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> (<span class="id" title="var">μ</span> &amp; ((<span class="id" title="var">HμL</span> &amp; <span class="id" title="var">HμR</span>) &amp; <span class="id" title="var">HμSupp</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<a class="idref" href="tachis.prob.distribution.html#dswap"><span class="id" title="definition">dswap</span></a> <span class="id" title="var">μ</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> [<span class="id" title="var">b</span> <span class="id" title="var">a</span>] [[? ?] [[= &lt;- &lt;-] ?]]%<a class="idref" href="tachis.prob.distribution.html#dmap_pos"><span class="id" title="lemma">dmap_pos</span></a>=&gt;/=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">eapply</span> (<span class="id" title="var">HμSupp</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.distribution.html#lmarg_dswap"><span class="id" title="lemma">lmarg_dswap</span></a> //. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.distribution.html#rmarg_dswap"><span class="id" title="lemma">rmarg_dswap</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">HμL</span> //.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="refRcoupl_dret" class="idref" href="#refRcoupl_dret"><span class="id" title="lemma">refRcoupl_dret</span></a> <a id="a:386" class="idref" href="#a:386"><span class="id" title="binder">a</span></a> <a id="b:387" class="idref" href="#b:387"><span class="id" title="binder">b</span></a> (<a id="R:388" class="idref" href="#R:388"><span class="id" title="binder">R</span></a> : <a class="idref" href="tachis.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#R:388"><span class="id" title="variable">R</span></a> <a class="idref" href="tachis.prob.couplings.html#a:386"><span class="id" title="variable">a</span></a> <a class="idref" href="tachis.prob.couplings.html#b:387"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> (<a class="idref" href="tachis.prob.distribution.html#dret"><span class="id" title="definition">dret</span></a> <a class="idref" href="tachis.prob.couplings.html#a:386"><span class="id" title="variable">a</span></a>) (<a class="idref" href="tachis.prob.distribution.html#dret"><span class="id" title="definition">dret</span></a> <a class="idref" href="tachis.prob.couplings.html#b:387"><span class="id" title="variable">b</span></a>) <a class="idref" href="tachis.prob.couplings.html#R:388"><span class="id" title="variable">R</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">HR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">split</span>; [<span class="id" title="tactic">eapply</span> <a class="idref" href="tachis.prob.couplings.html#is_refcoupl_dret"><span class="id" title="lemma">is_refcoupl_dret</span></a>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [] [=&lt;- &lt;-]%<a class="idref" href="tachis.prob.distribution.html#dret_pos"><span class="id" title="lemma">dret_pos</span></a>. <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="refRcoupl_dbind" class="idref" href="#refRcoupl_dbind"><span class="id" title="lemma">refRcoupl_dbind</span></a>  `{<a id="H1:391" class="idref" href="#H1:391"><span class="id" title="binder">Countable</span></a> <a id="A':389" class="idref" href="#A':389"><span class="id" title="binder"><span id="H1:391" class="id">A'</span></span></a>, <a id="H2:394" class="idref" href="#H2:394"><span class="id" title="binder">Countable</span></a> <a id="B':392" class="idref" href="#B':392"><span class="id" title="binder"><span id="H2:394" class="id">B'</span></span></a>} (<a id="f:395" class="idref" href="#f:395"><span class="id" title="binder">f</span></a> : <a class="idref" href="tachis.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#A':389"><span class="id" title="variable">A'</span></a>) (<a id="g:396" class="idref" href="#g:396"><span class="id" title="binder">g</span></a> : <a class="idref" href="tachis.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#B':392"><span class="id" title="variable">B'</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="f6ff9802fb3776fff1ec78bfe408d537" class="idref" href="#f6ff9802fb3776fff1ec78bfe408d537"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="1a811ac00f23bf4f377ad59eee23c67b" class="idref" href="#1a811ac00f23bf4f377ad59eee23c67b"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a>) (<a id="R:399" class="idref" href="#R:399"><span class="id" title="binder">R</span></a> : <a class="idref" href="tachis.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) (<a id="S:400" class="idref" href="#S:400"><span class="id" title="binder">S</span></a> : <a class="idref" href="tachis.prob.couplings.html#A':389"><span class="id" title="variable">A'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#B':392"><span class="id" title="variable">B'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="a:401" class="idref" href="#a:401"><span class="id" title="binder">a</span></a> <a id="b:402" class="idref" href="#b:402"><span class="id" title="binder">b</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.couplings.html#R:399"><span class="id" title="variable">R</span></a> <a class="idref" href="tachis.prob.couplings.html#a:401"><span class="id" title="variable">a</span></a> <a class="idref" href="tachis.prob.couplings.html#b:402"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> (<a class="idref" href="tachis.prob.couplings.html#f:395"><span class="id" title="variable">f</span></a> <a class="idref" href="tachis.prob.couplings.html#a:401"><span class="id" title="variable">a</span></a>) (<a class="idref" href="tachis.prob.couplings.html#g:396"><span class="id" title="variable">g</span></a> <a class="idref" href="tachis.prob.couplings.html#b:402"><span class="id" title="variable">b</span></a>) <a class="idref" href="tachis.prob.couplings.html#S:400"><span class="id" title="variable">S</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#f6ff9802fb3776fff1ec78bfe408d537"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#1a811ac00f23bf4f377ad59eee23c67b"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#R:399"><span class="id" title="variable">R</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> (<a class="idref" href="tachis.prob.couplings.html#f6ff9802fb3776fff1ec78bfe408d537"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.distribution.html#1ec27ecb4da8da3d3cbd85a2394dc835"><span class="id" title="notation">≫=</span></a> <a class="idref" href="tachis.prob.couplings.html#f:395"><span class="id" title="variable">f</span></a>) (<a class="idref" href="tachis.prob.couplings.html#1a811ac00f23bf4f377ad59eee23c67b"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.distribution.html#1ec27ecb4da8da3d3cbd85a2394dc835"><span class="id" title="notation">≫=</span></a> <a class="idref" href="tachis.prob.couplings.html#g:396"><span class="id" title="variable">g</span></a>) <a class="idref" href="tachis.prob.couplings.html#S:400"><span class="id" title="variable">S</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hfg</span> (<span class="id" title="var">μ</span> &amp; <span class="id" title="var">HμC</span> &amp; <span class="id" title="var">HμS</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> /<a class="idref" href="tachis.prob.couplings.html#is_Rcoupl"><span class="id" title="definition">is_Rcoupl</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hfg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;First&nbsp;we&nbsp;rewrite&nbsp;Hfg&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;use&nbsp;Choice&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="p:403" class="idref" href="#p:403"><span class="id" title="binder"><span id="p:406" class="id">p</span></span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a id="520f898d468379b353fa2852ef3de75a" class="idref" href="#520f898d468379b353fa2852ef3de75a"><span class="id" title="binder"><span id="fb7c501daf94790a890fb4b3ff173088" class="id">μ'</span></span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a> <span class="id" title="var">R</span> <a class="idref" href="tachis.prob.couplings.html#p:403"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="tachis.prob.couplings.html#p:403"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.2'"><span class="id" title="notation">.2</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="tachis.prob.couplings.html#is_refcoupl"><span class="id" title="definition">is_refcoupl</span></a> (<span class="id" title="var">f</span> <a class="idref" href="tachis.prob.couplings.html#p:403"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.1'"><span class="id" title="notation">.1</span></a>) (<span class="id" title="var">g</span> <a class="idref" href="tachis.prob.couplings.html#p:403"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.2'"><span class="id" title="notation">.2</span></a>) <a class="idref" href="tachis.prob.couplings.html#520f898d468379b353fa2852ef3de75a"><span class="id" title="variable">μ'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="q:405" class="idref" href="#q:405"><span class="id" title="binder"><span id="q:408" class="id">q</span></span></a> : <span class="id" title="var">A'</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <span class="id" title="var">B'</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.couplings.html#520f898d468379b353fa2852ef3de75a"><span class="id" title="variable">μ'</span></a> <a class="idref" href="tachis.prob.couplings.html#q:405"><span class="id" title="variable">q</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> 0 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="var">S</span> <a class="idref" href="tachis.prob.couplings.html#q:405"><span class="id" title="variable">q</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="tachis.prob.couplings.html#q:405"><span class="id" title="variable">q</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.2'"><span class="id" title="notation">.2</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hfg'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">HμS</span> <span class="id" title="var">p</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hfg</span> <span class="id" title="var">p</span><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.1'"><span class="id" title="notation">.1</span></a> <span class="id" title="var">p</span><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.2'"><span class="id" title="notation">.2</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="tachis.prelude.classical.html#ExcludedMiddle"><span class="id" title="lemma">ExcludedMiddle</span></a> (<span class="id" title="var">R</span> <span class="id" title="var">p</span><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.1'"><span class="id" title="notation">.1</span></a> <span class="id" title="var">p</span><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.2'"><span class="id" title="notation">.2</span></a>)) <span class="id" title="keyword">as</span> <span class="id" title="var">H3</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">HR</span> | <span class="id" title="var">HnR</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hfg</span> <span class="id" title="var">HR</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hfg</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">μ'</span> &amp; <span class="id" title="var">Hμ'1</span> &amp; <span class="id" title="var">Hμ'2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">μ'</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exists</span> <a class="idref" href="tachis.prob.distribution.html#dzero"><span class="id" title="definition">dzero</span></a>; <span class="id" title="tactic">intro</span> ; <span class="id" title="var">done</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Logic.ClassicalEpsilon.html#choice"><span class="id" title="lemma">ClassicalEpsilon.choice</span></a>  <span class="id" title="tactic">in</span> <span class="id" title="var">Hfg'</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">Ch</span> &amp; <span class="id" title="var">HCh</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="tachis.prob.couplings.html#Rcoupl"><span class="id" title="definition">Rcoupl</span></a> /<a class="idref" href="tachis.prob.couplings.html#is_Rcoupl"><span class="id" title="definition">is_Rcoupl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<a class="idref" href="tachis.prob.distribution.html#dbind"><span class="id" title="definition">dbind</span></a> <span class="id" title="var">Ch</span> <span class="id" title="var">μ</span>); <span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;To&nbsp;prove&nbsp;that&nbsp;the&nbsp;first&nbsp;marginal&nbsp;coincides&nbsp;is&nbsp;a&nbsp;matter&nbsp;of&nbsp;rearranging&nbsp;the&nbsp;sums&nbsp;and&nbsp;using&nbsp;the<br/>
&nbsp;&nbsp;&nbsp;&nbsp;fact&nbsp;that&nbsp;μ&nbsp;and&nbsp;(Ch&nbsp;p)&nbsp;are&nbsp;couplings&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.distribution.html#distr_ext"><span class="id" title="lemma">distr_ext</span></a>; <span class="id" title="tactic">intro</span> <span class="id" title="var">a'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.distribution.html#lmarg_pmf"><span class="id" title="lemma">lmarg_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="tachis.prob.distribution.html#pmf"><span class="id" title="projection">pmf</span></a> /= /<a class="idref" href="tachis.prob.distribution.html#dbind_pmf"><span class="id" title="definition">dbind_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="tachis.prob.distribution.html#distr_double_swap_lmarg"><span class="id" title="lemma">distr_double_swap_lmarg</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">setoid_rewrite</span> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC_scal_l"><span class="id" title="lemma">SeriesC_scal_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> (<a class="idref" href="tachis.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="p:409" class="idref" href="#p:409"><span class="id" title="binder"><span id="p:410" class="id"><span id="p:411" class="id"><span id="p:412" class="id">p</span></span></span></span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="var">μ</span> <a class="idref" href="tachis.prob.couplings.html#p:409"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <span class="id" title="var">f</span> <a class="idref" href="tachis.prob.couplings.html#p:409"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.1'"><span class="id" title="notation">.1</span></a> <span class="id" title="var">a'</span>)); <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> (<span class="id" title="var">a</span> &amp; <span class="id" title="var">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rtotal_order"><span class="id" title="lemma">Rtotal_order</span></a> (<span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) 0) <span class="id" title="keyword">as</span> [<span class="id" title="var">Hlt</span> | [<span class="id" title="var">Heqz</span> | <span class="id" title="var">Hgt</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="tachis.prob.distribution.html#pmf_pos"><span class="id" title="projection">pmf_pos</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>); <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heqz</span>; <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">specialize</span> (<span class="id" title="var">HCh</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> (<span class="id" title="var">HμS</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="var">Hgt</span> )) <span class="id" title="keyword">as</span> ((<span class="id" title="var">HChL</span> &amp; <span class="id" title="var">HChR</span>) &amp; <span class="id" title="var">HChS</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">HChL</span> <a class="idref" href="tachis.prob.distribution.html#lmarg_pmf"><span class="id" title="lemma">lmarg_pmf</span></a> //=. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.countable_sum.html#fubini_pos_seriesC_prod_lr"><span class="id" title="lemma">fubini_pos_seriesC_prod_lr</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: { <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_pos"><span class="id" title="lemma">Rmult_le_pos</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: { <span class="id" title="tactic">apply</span> (<a class="idref" href="tachis.prob.countable_sum.html#ex_seriesC_le"><span class="id" title="lemma">ex_seriesC_le</span></a> <span class="id" title="var">_</span> <span class="id" title="var">μ</span>); [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">split</span>; [<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_pos"><span class="id" title="lemma">Rmult_le_pos</span></a>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_1_r"><span class="id" title="lemma">Rmult_1_r</span></a>; <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_compat"><span class="id" title="lemma">Rmult_le_compat</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> (<a class="idref" href="tachis.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a:413" class="idref" href="#a:413"><span class="id" title="binder"><span id="a:415" class="id"><span id="a:417" class="id"><span id="a:419" class="id">a</span></span></span></span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="b:414" class="idref" href="#b:414"><span class="id" title="binder"><span id="b:416" class="id"><span id="b:418" class="id"><span id="b:420" class="id">b</span></span></span></span></a> : <a class="idref" href="tachis.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="tachis.prob.couplings.html#a:413"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.couplings.html#b:414"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> ) <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <span class="id" title="var">f</span> <a class="idref" href="tachis.prob.couplings.html#a:413"><span class="id" title="variable">a</span></a> <span class="id" title="var">a'</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ | <span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC_scal_r"><span class="id" title="lemma">SeriesC_scal_r</span></a> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> (<a class="idref" href="tachis.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a:421" class="idref" href="#a:421"><span class="id" title="binder"><span id="a:422" class="id"><span id="a:423" class="id"><span id="a:424" class="id">a</span></span></span></span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">(</span></a><span class="id" title="var">μ1</span> <a class="idref" href="tachis.prob.couplings.html#a:421"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <span class="id" title="var">f</span> <a class="idref" href="tachis.prob.couplings.html#a:421"><span class="id" title="variable">a</span></a> <span class="id" title="var">a'</span>)); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">HμC</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">Hμ1</span> &amp; <span class="id" title="var">Hμ2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">Hμ1</span> <a class="idref" href="tachis.prob.distribution.html#lmarg_pmf"><span class="id" title="lemma">lmarg_pmf</span></a> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intro</span> <span class="id" title="var">b'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="tachis.prob.distribution.html#pmf"><span class="id" title="projection">pmf</span></a>/=/<a class="idref" href="tachis.prob.distribution.html#dbind_pmf"><span class="id" title="definition">dbind_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="tachis.prob.distribution.html#distr_double_swap_rmarg"><span class="id" title="lemma">distr_double_swap_rmarg</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> (<a class="idref" href="tachis.prob.countable_sum.html#SeriesC_ext"><span class="id" title="lemma">SeriesC_ext</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="b:425" class="idref" href="#b:425"><span class="id" title="binder"><span id="b:427" class="id"><span id="b:429" class="id"><span id="b:431" class="id">b</span></span></span></span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="var">μ</span> <a class="idref" href="tachis.prob.couplings.html#b:425"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a:426" class="idref" href="#a:426"><span class="id" title="binder"><span id="a:428" class="id"><span id="a:430" class="id"><span id="a:432" class="id">a</span></span></span></span></a> : <span class="id" title="var">A'</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="var">Ch</span> <a class="idref" href="tachis.prob.couplings.html#b:425"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="tachis.prob.couplings.html#a:426"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b'</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>)) );<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ | <span class="id" title="tactic">intro</span> <span class="id" title="var">p</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC_scal_l"><span class="id" title="lemma">SeriesC_scal_l</span></a>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rle_trans"><span class="id" title="lemma">Rle_trans</span></a> <span class="id" title="var">_</span> (<a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="p:433" class="idref" href="#p:433"><span class="id" title="binder"><span id="p:434" class="id">p</span></span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="var">μ</span> <a class="idref" href="tachis.prob.couplings.html#p:433"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <span class="id" title="var">g</span> <a class="idref" href="tachis.prob.couplings.html#p:433"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.2'"><span class="id" title="notation">.2</span></a> <span class="id" title="var">b'</span>)) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC_le"><span class="id" title="lemma">SeriesC_le</span></a>; [ | ]; <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> (<a class="idref" href="tachis.prob.countable_sum.html#ex_seriesC_le"><span class="id" title="lemma">ex_seriesC_le</span></a> <span class="id" title="var">_</span> <span class="id" title="var">μ</span>); [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_pos"><span class="id" title="lemma">Rmult_le_pos</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> -{2}(<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_1_r"><span class="id" title="lemma">Rmult_1_r</span></a> (<span class="id" title="var">μ</span> <span class="id" title="var">_</span>)). <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_compat_l"><span class="id" title="lemma">Rmult_le_compat_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> (<span class="id" title="var">a</span> &amp; <span class="id" title="var">b</span>); <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_pos"><span class="id" title="lemma">Rmult_le_pos</span></a>; [<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a0:435" class="idref" href="#a0:435"><span class="id" title="binder"><span id="a0:436" class="id">a0</span></span></a> : <span class="id" title="var">A'</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="var">Ch</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="tachis.prob.couplings.html#a0:435"><span class="id" title="variable">a0</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b'</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="tachis.prob.distribution.html#rmarg"><span class="id" title="definition">rmarg</span></a> (<span class="id" title="var">Ch</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <span class="id" title="var">b'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> -&gt;; [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rtotal_order"><span class="id" title="lemma">Rtotal_order</span></a> (<span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) 0) <span class="id" title="keyword">as</span> [<span class="id" title="var">Hlt</span> | [<span class="id" title="var">Heqz</span> | <span class="id" title="var">Hgt</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="tachis.prob.distribution.html#pmf_pos"><span class="id" title="projection">pmf_pos</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>); <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heqz</span>; <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">specialize</span> (<span class="id" title="var">HCh</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> (<span class="id" title="var">HμS</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="var">Hgt</span> )) <span class="id" title="keyword">as</span> ((<span class="id" title="var">HChL</span> &amp; <span class="id" title="var">HChR</span>) &amp; <span class="id" title="var">HChS</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">HChR</span> <span class="id" title="var">b'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="tachis.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a> (<span class="id" title="var">Ch</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>)) <span class="id" title="tactic">in</span> <span class="id" title="var">HChR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_compat_l"><span class="id" title="lemma">Rmult_le_compat_l</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.countable_sum.html#fubini_pos_seriesC_prod_rl"><span class="id" title="lemma">fubini_pos_seriesC_prod_rl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: { <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_pos"><span class="id" title="lemma">Rmult_le_pos</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: { <span class="id" title="tactic">apply</span> (<a class="idref" href="tachis.prob.countable_sum.html#ex_seriesC_le"><span class="id" title="lemma">ex_seriesC_le</span></a> <span class="id" title="var">_</span> <span class="id" title="var">μ</span>); [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">split</span>; [<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_pos"><span class="id" title="lemma">Rmult_le_pos</span></a>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_1_r"><span class="id" title="lemma">Rmult_1_r</span></a>; <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_compat"><span class="id" title="lemma">Rmult_le_compat</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC_le"><span class="id" title="lemma">SeriesC_le</span></a>; <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> (<a class="idref" href="tachis.prob.countable_sum.html#ex_seriesC_le"><span class="id" title="lemma">ex_seriesC_le</span></a> <span class="id" title="var">_</span> <span class="id" title="var">μ2</span>); [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_pos"><span class="id" title="lemma">Rmult_le_pos</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_1_r"><span class="id" title="lemma">Rmult_1_r</span></a>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_compat_l"><span class="id" title="lemma">Rmult_le_compat_l</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">b</span>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC_scal_r"><span class="id" title="lemma">SeriesC_scal_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_pos"><span class="id" title="lemma">Rmult_le_pos</span></a>; [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="tachis.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">destruct</span> <span class="id" title="var">HμC</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">HμCL</span> <span class="id" title="var">HμCR</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC_scal_r"><span class="id" title="lemma">SeriesC_scal_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_compat_r"><span class="id" title="lemma">Rmult_le_compat_r</span></a>; [<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">HμCR</span> <span class="id" title="var">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">HμCR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> (<span class="id" title="var">a'</span> &amp; <span class="id" title="var">b'</span>) <span class="id" title="var">H3</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="tachis.prob.distribution.html#dbind_pos"><span class="id" title="lemma">dbind_pos</span></a> <span class="id" title="var">Ch</span> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a'</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b'</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <span class="id" title="keyword">as</span> (<span class="id" title="var">H4</span> &amp; <span class="id" title="var">H5</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">H4</span> <span class="id" title="var">H3</span>) <span class="id" title="keyword">as</span> ((<span class="id" title="var">a0</span>, <span class="id" title="var">b0</span>) &amp; <span class="id" title="var">H7</span> &amp; <span class="id" title="var">H8</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">HCh</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a0</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b0</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> (<span class="id" title="var">HμS</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a0</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b0</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="var">H8</span>)) <span class="id" title="keyword">as</span> (<span class="id" title="var">HCh1</span> &amp; <span class="id" title="var">HCh2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">HCh2</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a'</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b'</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="var">H7</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="refRcoupl_dzero" class="idref" href="#refRcoupl_dzero"><span class="id" title="lemma">refRcoupl_dzero</span></a> (<a id="d76c4fd0433550b5094c9478048fc4ef" class="idref" href="#d76c4fd0433550b5094c9478048fc4ef"><span class="id" title="binder">μ</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a>) (<a id="R:438" class="idref" href="#R:438"><span class="id" title="binder">R</span></a>: <a class="idref" href="tachis.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="tachis.prob.distribution.html#dzero"><span class="id" title="definition">dzero</span></a> <a class="idref" href="tachis.prob.couplings.html#d76c4fd0433550b5094c9478048fc4ef"><span class="id" title="variable">μ</span></a> <a class="idref" href="tachis.prob.couplings.html#R:438"><span class="id" title="variable">R</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <a class="idref" href="tachis.prob.distribution.html#dzero"><span class="id" title="definition">dzero</span></a>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> /<a class="idref" href="tachis.prob.distribution.html#lmarg"><span class="id" title="definition">lmarg</span></a> <a class="idref" href="tachis.prob.distribution.html#dmap_dzero"><span class="id" title="lemma">dmap_dzero</span></a>; <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a> {1}/<a class="idref" href="tachis.prob.distribution.html#pmf"><span class="id" title="projection">pmf</span></a>/=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC_0"><span class="id" title="lemma">SeriesC_0</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> /<a class="idref" href="tachis.prob.distribution.html#pmf"><span class="id" title="projection">pmf</span></a>/=; <span class="id" title="tactic">intros</span>; <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="refRcoupl_mono" class="idref" href="#refRcoupl_mono"><span class="id" title="lemma">refRcoupl_mono</span></a> (<a id="1e89d67e28b05af340785c67e99d8b50" class="idref" href="#1e89d67e28b05af340785c67e99d8b50"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="d0b856dfc81dead92a95d608c58a8c60" class="idref" href="#d0b856dfc81dead92a95d608c58a8c60"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a>) (<a id="R:441" class="idref" href="#R:441"><span class="id" title="binder">R</span></a> : <a class="idref" href="tachis.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) (<a id="S:442" class="idref" href="#S:442"><span class="id" title="binder">S</span></a> : <a class="idref" href="tachis.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="a:443" class="idref" href="#a:443"><span class="id" title="binder">a</span></a> <a id="b:444" class="idref" href="#b:444"><span class="id" title="binder">b</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.couplings.html#R:441"><span class="id" title="variable">R</span></a> <a class="idref" href="tachis.prob.couplings.html#a:443"><span class="id" title="variable">a</span></a> <a class="idref" href="tachis.prob.couplings.html#b:444"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#S:442"><span class="id" title="variable">S</span></a> <a class="idref" href="tachis.prob.couplings.html#a:443"><span class="id" title="variable">a</span></a> <a class="idref" href="tachis.prob.couplings.html#b:444"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#1e89d67e28b05af340785c67e99d8b50"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#d0b856dfc81dead92a95d608c58a8c60"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#R:441"><span class="id" title="variable">R</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#1e89d67e28b05af340785c67e99d8b50"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#d0b856dfc81dead92a95d608c58a8c60"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#S:442"><span class="id" title="variable">S</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hwk</span> [<span class="id" title="var">μ</span> [[<span class="id" title="var">HμL</span> <span class="id" title="var">HμR</span>] <span class="id" title="var">HμSupp</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">μ</span>; <span class="id" title="tactic">split</span>; [<span class="id" title="tactic">split</span>| ]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="refRcoupl_trivial" class="idref" href="#refRcoupl_trivial"><span class="id" title="lemma">refRcoupl_trivial</span></a> (<a id="ce283eed1f30dd2347308b0acb5bee89" class="idref" href="#ce283eed1f30dd2347308b0acb5bee89"><span class="id" title="binder">μ1</span></a> :<a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="90dbb29333125814de63e541d0ff4611" class="idref" href="#90dbb29333125814de63e541d0ff4611"><span class="id" title="binder">μ2</span></a> :<a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="tachis.prob.couplings.html#ce283eed1f30dd2347308b0acb5bee89"><span class="id" title="variable">μ1</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <a class="idref" href="tachis.prob.couplings.html#90dbb29333125814de63e541d0ff4611"><span class="id" title="variable">μ2</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#ce283eed1f30dd2347308b0acb5bee89"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#90dbb29333125814de63e541d0ff4611"><span class="id" title="variable">μ2</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#::type_scope:'True'"><span class="id" title="notation">True</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hμ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="tachis.prob.distribution.html#pmf_SeriesC_ge_0"><span class="id" title="lemma">pmf_SeriesC_ge_0</span></a> <span class="id" title="var">μ1</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rlt_or_le"><span class="id" title="lemma">Rlt_or_le</span></a> 0 (<a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <span class="id" title="var">μ1</span>)); <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="tachis.prob.distribution.html#SeriesC_zero_dzero"><span class="id" title="lemma">SeriesC_zero_dzero</span></a> <span class="id" title="var">μ1</span>); [ | <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rle_antisym"><span class="id" title="lemma">Rle_antisym</span></a>; <span class="id" title="tactic">auto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.couplings.html#refRcoupl_dzero"><span class="id" title="lemma">refRcoupl_dzero</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">assert</span> (0 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <span class="id" title="var">μ2</span>); [<span class="id" title="tactic">apply</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rlt_le_trans"><span class="id" title="lemma">Rlt_le_trans</span></a> <span class="id" title="var">_</span> (<a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <span class="id" title="var">μ1</span>))|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">done</span>|<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( 0 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#2299a6ef56270a66cc1b95489d0f6e3a"><span class="id" title="notation">/</span></a> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <span class="id" title="var">μ2</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#2299a6ef56270a66cc1b95489d0f6e3a"><span class="id" title="notation">/</span></a> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <span class="id" title="var">μ2</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327"><span class="id" title="notation">*</span></a> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> (<a class="idref" href="tachis.prob.distribution.html#dprod"><span class="id" title="definition">dprod</span></a> <span class="id" title="var">μ1</span> <span class="id" title="var">μ2</span>) <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2"><span class="id" title="notation">&lt;=</span></a> 1) <span class="id" title="keyword">as</span> <span class="id" title="var">Hle1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">left</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rinv_0_lt_compat"><span class="id" title="lemma">Rinv_0_lt_compat</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.distribution.html#dprod_mass"><span class="id" title="lemma">dprod_mass</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Raxioms.html#Rmult_comm"><span class="id" title="lemma">Rmult_comm</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Raxioms.html#Rmult_assoc"><span class="id" title="lemma">Rmult_assoc</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rinv_r"><span class="id" title="lemma">Rinv_r</span></a>; [|<span class="id" title="var">lra</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_1_r"><span class="id" title="lemma">Rmult_1_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">done</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span> (<a class="idref" href="tachis.prob.distribution.html#distr_scal"><span class="id" title="definition">distr_scal</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#2299a6ef56270a66cc1b95489d0f6e3a"><span class="id" title="notation">/(</span></a><a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <span class="id" title="var">μ2</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#2299a6ef56270a66cc1b95489d0f6e3a"><span class="id" title="notation">)</span></a>) (<a class="idref" href="tachis.prob.distribution.html#dprod"><span class="id" title="definition">dprod</span></a> <span class="id" title="var">μ1</span> <span class="id" title="var">μ2</span>) <span class="id" title="var">Hle1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [|<span class="id" title="var">done</span>]. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.distribution.html#distr_ext"><span class="id" title="lemma">distr_ext</span></a>. <span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.distribution.html#lmarg_pmf"><span class="id" title="lemma">lmarg_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC_scal_l"><span class="id" title="lemma">SeriesC_scal_l</span></a> -<a class="idref" href="tachis.prob.distribution.html#lmarg_pmf"><span class="id" title="lemma">lmarg_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.distribution.html#lmarg_dprod_pmf"><span class="id" title="lemma">lmarg_dprod_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Raxioms.html#Rmult_comm"><span class="id" title="lemma">Rmult_comm</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Raxioms.html#Rmult_assoc"><span class="id" title="lemma">Rmult_assoc</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rinv_r"><span class="id" title="lemma">Rinv_r</span></a>; <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intro</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC_scal_l"><span class="id" title="lemma">SeriesC_scal_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="tachis.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a> <a class="idref" href="tachis.prob.distribution.html#rmarg_dprod_pmf"><span class="id" title="lemma">rmarg_dprod_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Raxioms.html#Rmult_comm"><span class="id" title="lemma">Rmult_comm</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Raxioms.html#Rmult_assoc"><span class="id" title="lemma">Rmult_assoc</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -{2}(<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_1_r"><span class="id" title="lemma">Rmult_1_r</span></a> (<span class="id" title="var">μ2</span> <span class="id" title="var">b</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.RIneq.html#Rmult_le_compat_l"><span class="id" title="lemma">Rmult_le_compat_l</span></a>; [<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> (<a class="idref" href="http://coquelicot.saclay.inria.fr/html//Coquelicot.Rcomplements.html#Rdiv_le_1"><span class="id" title="lemma">Rdiv_le_1</span></a> (<a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> <span class="id" title="var">μ1</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="refRcoupl_pos_R" class="idref" href="#refRcoupl_pos_R"><span class="id" title="lemma">refRcoupl_pos_R</span></a> (<a id="69c3a935e1939444ddd227203feae024" class="idref" href="#69c3a935e1939444ddd227203feae024"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="68a07e6f552d8913310b926e6a523536" class="idref" href="#68a07e6f552d8913310b926e6a523536"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a>) (<a id="R:449" class="idref" href="#R:449"><span class="id" title="binder">R</span></a> : <a class="idref" href="tachis.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#69c3a935e1939444ddd227203feae024"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#68a07e6f552d8913310b926e6a523536"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#R:449"><span class="id" title="variable">R</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#69c3a935e1939444ddd227203feae024"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#68a07e6f552d8913310b926e6a523536"><span class="id" title="variable">μ2</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a':450" class="idref" href="#a':450"><span class="id" title="binder">a'</span></a> <a id="b':451" class="idref" href="#b':451"><span class="id" title="binder">b'</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.couplings.html#R:449"><span class="id" title="variable">R</span></a> <a class="idref" href="tachis.prob.couplings.html#a':450"><span class="id" title="variable">a'</span></a> <a class="idref" href="tachis.prob.couplings.html#b':451"><span class="id" title="variable">b'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="tachis.prob.couplings.html#69c3a935e1939444ddd227203feae024"><span class="id" title="variable">μ1</span></a> <a class="idref" href="tachis.prob.couplings.html#a':450"><span class="id" title="variable">a'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> 0 <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="tachis.prob.couplings.html#68a07e6f552d8913310b926e6a523536"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#b':451"><span class="id" title="variable">b'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> 0).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">μ</span> [[<span class="id" title="var">Hμ1</span> <span class="id" title="var">Hμ2</span>] <span class="id" title="var">HR</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">μ</span>. <span class="id" title="tactic">split</span>; [<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">a'</span> <span class="id" title="var">b'</span>] <span class="id" title="var">H</span>ρ.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="tactic">eauto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="tachis.prob.countable_sum.html#SeriesC"><span class="id" title="definition">SeriesC</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a:452" class="idref" href="#a:452"><span class="id" title="binder"><span id="a:453" class="id">a</span></span></a> : <a class="idref" href="tachis.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="var">μ</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="tachis.prob.couplings.html#a:452"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b'</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC_pos"><span class="id" title="lemma">SeriesC_pos</span></a>; [<span class="id" title="tactic">eauto</span>| |<span class="id" title="var">done</span>]. <span class="id" title="tactic">by</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="tachis.prob.countable_sum.html#ex_seriesC_rmarg"><span class="id" title="lemma">ex_seriesC_rmarg</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hμ2</span> <span class="id" title="var">b'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.distribution.html#rmarg_pmf"><span class="id" title="lemma">rmarg_pmf</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hμ2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [|<span class="id" title="tactic">simpl</span>; <span class="id" title="var">lra</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">Hμ1</span> <a class="idref" href="tachis.prob.distribution.html#lmarg_pmf"><span class="id" title="lemma">lmarg_pmf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="tachis.prob.countable_sum.html#SeriesC_pos"><span class="id" title="lemma">SeriesC_pos</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="tachis.prob.countable_sum.html#ex_seriesC_lmarg"><span class="id" title="lemma">ex_seriesC_lmarg</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="refRcoupl_dret_trivial" class="idref" href="#refRcoupl_dret_trivial"><span class="id" title="lemma">refRcoupl_dret_trivial</span></a> (<a id="04df482aaa867cce7216c871bb745bd8" class="idref" href="#04df482aaa867cce7216c871bb745bd8"><span class="id" title="binder">μ</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="b:455" class="idref" href="#b:455"><span class="id" title="binder">b</span></a> : <a class="idref" href="tachis.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#04df482aaa867cce7216c871bb745bd8"><span class="id" title="variable">μ</span></a> (<a class="idref" href="tachis.prob.distribution.html#dret"><span class="id" title="definition">dret</span></a> <a class="idref" href="tachis.prob.couplings.html#b:455"><span class="id" title="variable">b</span></a>) (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#::type_scope:'True'"><span class="id" title="notation">True</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="tachis.prob.couplings.html#refRcoupl_trivial"><span class="id" title="lemma">refRcoupl_trivial</span></a>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="tachis.prob.distribution.html#dret_mass"><span class="id" title="lemma">dret_mass</span></a>. <span class="id" title="tactic">eapply</span> <a class="idref" href="tachis.prob.distribution.html#pmf_SeriesC"><span class="id" title="projection">pmf_SeriesC</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="refRcoupl_dret_r_inv" class="idref" href="#refRcoupl_dret_r_inv"><span class="id" title="lemma">refRcoupl_dret_r_inv</span></a> (<a id="54837f4c5eb6a342bdf598f696378b5f" class="idref" href="#54837f4c5eb6a342bdf598f696378b5f"><span class="id" title="binder">μ1</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="b:457" class="idref" href="#b:457"><span class="id" title="binder">b</span></a> : <a class="idref" href="tachis.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a>) (<a id="R:458" class="idref" href="#R:458"><span class="id" title="binder">R</span></a> : <a class="idref" href="tachis.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#54837f4c5eb6a342bdf598f696378b5f"><span class="id" title="variable">μ1</span></a> (<a class="idref" href="tachis.prob.distribution.html#dret"><span class="id" title="definition">dret</span></a> <a class="idref" href="tachis.prob.couplings.html#b:457"><span class="id" title="variable">b</span></a>) <a class="idref" href="tachis.prob.couplings.html#R:458"><span class="id" title="variable">R</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <a class="idref" href="tachis.prob.couplings.html#54837f4c5eb6a342bdf598f696378b5f"><span class="id" title="variable">μ1</span></a> (<a class="idref" href="tachis.prob.distribution.html#dret"><span class="id" title="definition">dret</span></a> <a class="idref" href="tachis.prob.couplings.html#b:457"><span class="id" title="variable">b</span></a>) (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a':459" class="idref" href="#a':459"><span class="id" title="binder">a'</span></a> <a id="b':460" class="idref" href="#b':460"><span class="id" title="binder">b'</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.couplings.html#R:458"><span class="id" title="variable">R</span></a> <a class="idref" href="tachis.prob.couplings.html#a':459"><span class="id" title="variable">a'</span></a> <a class="idref" href="tachis.prob.couplings.html#b':460"><span class="id" title="variable">b'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="tachis.prob.couplings.html#b:457"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="tachis.prob.couplings.html#b':460"><span class="id" title="variable">b'</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ?%(<a class="idref" href="tachis.prob.couplings.html#refRcoupl_pos_R"><span class="id" title="lemma">refRcoupl_pos_R</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="tachis.prob.couplings.html#refRcoupl_mono"><span class="id" title="lemma">refRcoupl_mono</span></a>; [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">intros</span> ?? (?&amp;?&amp; -&gt; %<a class="idref" href="tachis.prob.distribution.html#dret_pos"><span class="id" title="lemma">dret_pos</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="refRcoupl_dret_l_inv" class="idref" href="#refRcoupl_dret_l_inv"><span class="id" title="lemma">refRcoupl_dret_l_inv</span></a> (<a id="4fc580e355fcfb3995352317dd7bfb0b" class="idref" href="#4fc580e355fcfb3995352317dd7bfb0b"><span class="id" title="binder">μ2</span></a> : <a class="idref" href="tachis.prob.distribution.html#distr"><span class="id" title="record">distr</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a>) (<a id="a:462" class="idref" href="#a:462"><span class="id" title="binder">a</span></a> : <a class="idref" href="tachis.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a>) (<a id="R:463" class="idref" href="#R:463"><span class="id" title="binder">R</span></a> : <a class="idref" href="tachis.prob.couplings.html#refRcoupl.A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="tachis.prob.couplings.html#refRcoupl.B"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> (<a class="idref" href="tachis.prob.distribution.html#dret"><span class="id" title="definition">dret</span></a> <a class="idref" href="tachis.prob.couplings.html#a:462"><span class="id" title="variable">a</span></a>) <a class="idref" href="tachis.prob.couplings.html#4fc580e355fcfb3995352317dd7bfb0b"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#R:463"><span class="id" title="variable">R</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="tachis.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> (<a class="idref" href="tachis.prob.distribution.html#dret"><span class="id" title="definition">dret</span></a> <a class="idref" href="tachis.prob.couplings.html#a:462"><span class="id" title="variable">a</span></a>) <a class="idref" href="tachis.prob.couplings.html#4fc580e355fcfb3995352317dd7bfb0b"><span class="id" title="variable">μ2</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a':464" class="idref" href="#a':464"><span class="id" title="binder">a'</span></a> <a id="b':465" class="idref" href="#b':465"><span class="id" title="binder">b'</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="tachis.prob.couplings.html#R:463"><span class="id" title="variable">R</span></a> <a class="idref" href="tachis.prob.couplings.html#a':464"><span class="id" title="variable">a'</span></a> <a class="idref" href="tachis.prob.couplings.html#b':465"><span class="id" title="variable">b'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="tachis.prob.couplings.html#a':464"><span class="id" title="variable">a'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="tachis.prob.couplings.html#a:462"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="tachis.prob.couplings.html#4fc580e355fcfb3995352317dd7bfb0b"><span class="id" title="variable">μ2</span></a> <a class="idref" href="tachis.prob.couplings.html#b':465"><span class="id" title="variable">b'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Reals.Rdefinitions.html#::R_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> 0).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ?%(<a class="idref" href="tachis.prob.couplings.html#refRcoupl_pos_R"><span class="id" title="lemma">refRcoupl_pos_R</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="tachis.prob.couplings.html#refRcoupl_mono"><span class="id" title="lemma">refRcoupl_mono</span></a>; [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">intros</span> ?? (?&amp; -&gt; %<a class="idref" href="tachis.prob.distribution.html#dret_pos"><span class="id" title="lemma">dret_pos</span></a> &amp; ?).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="tachis.prob.couplings.html#refRcoupl"><span class="id" title="section">refRcoupl</span></a>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> <a id="6d1c2ec99ec962f82862cf2642d15ee2" class="idref" href="#6d1c2ec99ec962f82862cf2642d15ee2"><span class="id" title="notation">&quot;</span></a>μ1 '≾' μ2 ':' R" :=<br/>
&nbsp;&nbsp;(<a class="idref" href="tachis.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <span class="id" title="var">μ1</span> <span class="id" title="var">μ2</span> <span class="id" title="var">R</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 100, <span class="id" title="var">μ2</span> <span class="id" title="tactic">at</span> <span class="id" title="var">next</span> <span class="id" title="keyword">level</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">R</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 200,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">format</span> "'[hv' μ1  '/' '≾'  '/' μ2  :  R ']'").<br/>

<br/>
<span class="id" title="keyword">Notation</span> <a id="6ead78d36f492c9660fec45b78207c8c" class="idref" href="#6ead78d36f492c9660fec45b78207c8c"><span class="id" title="notation">&quot;</span></a>μ1 '≿' μ2 ':' R" :=<br/>
&nbsp;&nbsp;(<a class="idref" href="tachis.prob.couplings.html#refRcoupl"><span class="id" title="definition">refRcoupl</span></a> <span class="id" title="var">μ2</span> <span class="id" title="var">μ1</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.1/stdlib//Coq.Program.Basics.html#flip"><span class="id" title="definition">flip</span></a> <span class="id" title="var">R</span>))<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 100, <span class="id" title="var">μ2</span> <span class="id" title="tactic">at</span> <span class="id" title="var">next</span> <span class="id" title="keyword">level</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">R</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 200, <span class="id" title="var">only</span> <span class="id" title="var">parsing</span>).<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/coq-community/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
