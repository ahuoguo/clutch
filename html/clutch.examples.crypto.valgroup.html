<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="resources/coqdoc.css" rel="stylesheet" type="text/css" />
<link href="resources/coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resources/config.js"></script>
<script type="text/javascript" src="resources/coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="../">Project Page</a>
      <a href="./indexpage.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">clutch.examples.crypto.valgroup</h1>

<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">clutch.prelude</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="clutch.prelude.base.html#"><span class="id" title="library">base</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">clutch.program_logic</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="clutch.program_logic.weakestpre.html#"><span class="id" title="library">weakestpre</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">clutch.prob_lang</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="clutch.prob_lang.notation.html#"><span class="id" title="library">notation</span></a> <a class="idref" href="clutch.prob_lang.lang.html#"><span class="id" title="library">lang</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">clutch.rel_logic</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="clutch.rel_logic.model.html#"><span class="id" title="library">model</span></a> <a class="idref" href="clutch.rel_logic.spec_ra.html#"><span class="id" title="library">spec_ra</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">clutch.typing</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="clutch.typing.types.html#"><span class="id" title="library">types</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">clutch</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="clutch.clutch.html#"><span class="id" title="library">clutch</span></a>.<br/>

<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="var">Warnings</span> "-notation-overridden,-ambiguous-paths".<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">mathcomp</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">solvable.cyclic</span> <span class="id" title="library">choice</span> <span class="id" title="library">eqtype</span> <span class="id" title="library">finset</span> <span class="id" title="library">fintype</span> <span class="id" title="library">seq</span><br/>
&nbsp;&nbsp;<span class="id" title="library">ssrbool</span> <span class="id" title="library">ssreflect</span> <span class="id" title="library">zmodp</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">mathcomp</span> <span class="id" title="keyword">Require</span> <span class="id" title="library">ssralg</span>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="module">fingroup</span>.<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="var">Warnings</span> "notation-overridden,ambiguous-paths".<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="var">Bullet</span> <span class="id" title="var">Behavior</span> "Strict Subproofs".<br/>

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">group_scope</span>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="module">fingroup.fingroup</span>.<br/>
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Notation</span> "'cval'" := (<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.val"><span class="id" title="inductive">prob_lang.val</span></a>).<br/>

<br/>
<span class="id" title="keyword">Class</span> <a id="val_group" class="idref" href="#val_group"><span class="id" title="record">val_group</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">Val_group</span> { <a id="vgG" class="idref" href="#vgG"><span class="id" title="projection">vgG</span></a> : <span class="id" title="abbreviation">finGroupType</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <a id="vgval" class="idref" href="#vgval"><span class="id" title="projection">vgval</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#vgG:2"><span class="id" title="method">vgG</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#:::'cval'"><span class="id" title="notation">cval</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <a id="vgval_inj" class="idref" href="#vgval_inj"><span class="id" title="projection">vgval_inj</span></a> : <span class="id" title="class">Inj</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#vgval:3"><span class="id" title="method">vgval</span></a> }.<br/>

<br/>
<span class="comment">(*&nbsp;Both&nbsp;of&nbsp;the&nbsp;below&nbsp;seem&nbsp;necessary&nbsp;since&nbsp;there&nbsp;is&nbsp;a&nbsp;subtle&nbsp;difference&nbsp;in&nbsp;the<br/>
&nbsp;&nbsp;&nbsp;domain&nbsp;type&nbsp;DOM,&nbsp;despite&nbsp;the&nbsp;two&nbsp;being&nbsp;convertible.&nbsp;*)</span><br/>
#[<span class="id" title="var">nonuniform</span>] <span class="id" title="keyword">Coercion</span> <a id="vgval_as" class="idref" href="#vgval_as"><span class="id" title="definition">vgval_as</span></a> {<a id="vg:5" class="idref" href="#vg:5"><span class="id" title="binder">vg</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#val_group"><span class="id" title="class">val_group</span></a>}<br/>
&nbsp;&nbsp;(<a id="x:6" class="idref" href="#x:6"><span class="id" title="binder">x</span></a> : <span class="id" title="definition">FinGroup.arg_sort</span> (<span class="id" title="projection">FinGroup.base</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#vgG"><span class="id" title="method">vgG</span></a>)) : <a class="idref" href="clutch.examples.crypto.valgroup.html#:::'cval'"><span class="id" title="notation">cval</span></a> := <a class="idref" href="clutch.examples.crypto.valgroup.html#vgval"><span class="id" title="method">vgval</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#x:6"><span class="id" title="variable">x</span></a>.<br/>
#[<span class="id" title="var">nonuniform</span>] <span class="id" title="keyword">Coercion</span> <a id="vgval_s" class="idref" href="#vgval_s"><span class="id" title="definition">vgval_s</span></a> {<a id="vg:7" class="idref" href="#vg:7"><span class="id" title="binder">vg</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#val_group"><span class="id" title="class">val_group</span></a>}<br/>
&nbsp;&nbsp;(<a id="x:8" class="idref" href="#x:8"><span class="id" title="binder">x</span></a> : <span class="id" title="projection">FinGroup.sort</span> (<span class="id" title="projection">FinGroup.base</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#vgG"><span class="id" title="method">vgG</span></a>)) : <a class="idref" href="clutch.examples.crypto.valgroup.html#:::'cval'"><span class="id" title="notation">cval</span></a> := <a class="idref" href="clutch.examples.crypto.valgroup.html#vgval"><span class="id" title="method">vgval</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#x:8"><span class="id" title="variable">x</span></a>.<br/>

<br/>
<span class="id" title="keyword">Class</span> <a id="clutch_group_struct" class="idref" href="#clutch_group_struct"><span class="id" title="record">clutch_group_struct</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">Clutch_group_struct</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <a id="vunit" class="idref" href="#vunit"><span class="id" title="projection">vunit</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#:::'cval'"><span class="id" title="notation">cval</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <a id="vinv" class="idref" href="#vinv"><span class="id" title="projection">vinv</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#:::'cval'"><span class="id" title="notation">cval</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <a id="vmult" class="idref" href="#vmult"><span class="id" title="projection">vmult</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#:::'cval'"><span class="id" title="notation">cval</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <a id="int_of_vg" class="idref" href="#int_of_vg"><span class="id" title="projection">int_of_vg</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#:::'cval'"><span class="id" title="notation">cval</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <a id="vg_of_int" class="idref" href="#vg_of_int"><span class="id" title="projection">vg_of_int</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#:::'cval'"><span class="id" title="notation">cval</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <a id="9082db16b85b8b97e7d84dbc62092956" class="idref" href="#9082db16b85b8b97e7d84dbc62092956"><span class="id" title="projection">τ</span></a><a id="9082db16b85b8b97e7d84dbc62092956" class="idref" href="#9082db16b85b8b97e7d84dbc62092956"><span class="id" title="projection">G</span></a> : <a class="idref" href="clutch.typing.types.html#type"><span class="id" title="inductive">type</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <a id="vunit_typed" class="idref" href="#vunit_typed"><span class="id" title="projection">vunit_typed</span></a> : <a class="idref" href="clutch.typing.types.html#val_typed"><span class="id" title="inductive">val_typed</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#vunit:10"><span class="id" title="method">vunit</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#3473c383b1ac954a564ad01a12c5639d"><span class="id" title="method">τ</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#3473c383b1ac954a564ad01a12c5639d"><span class="id" title="method">G</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <a id="vinv_typed" class="idref" href="#vinv_typed"><span class="id" title="projection">vinv_typed</span></a> : <a class="idref" href="clutch.typing.types.html#val_typed"><span class="id" title="inductive">val_typed</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#vinv:11"><span class="id" title="method">vinv</span></a> (<a class="idref" href="clutch.examples.crypto.valgroup.html#3473c383b1ac954a564ad01a12c5639d"><span class="id" title="method">τ</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#3473c383b1ac954a564ad01a12c5639d"><span class="id" title="method">G</span></a> <a class="idref" href="clutch.typing.types.html#cf2aa254e4c9f9cb95db860c4555acd5"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#3473c383b1ac954a564ad01a12c5639d"><span class="id" title="method">τ</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#3473c383b1ac954a564ad01a12c5639d"><span class="id" title="method">G</span></a>)%<span class="id" title="var">ty</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <a id="vmult_typed" class="idref" href="#vmult_typed"><span class="id" title="projection">vmult_typed</span></a> : <a class="idref" href="clutch.typing.types.html#val_typed"><span class="id" title="inductive">val_typed</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#vmult:12"><span class="id" title="method">vmult</span></a> (<a class="idref" href="clutch.examples.crypto.valgroup.html#3473c383b1ac954a564ad01a12c5639d"><span class="id" title="method">τ</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#3473c383b1ac954a564ad01a12c5639d"><span class="id" title="method">G</span></a> <a class="idref" href="clutch.typing.types.html#cf2aa254e4c9f9cb95db860c4555acd5"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#3473c383b1ac954a564ad01a12c5639d"><span class="id" title="method">τ</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#3473c383b1ac954a564ad01a12c5639d"><span class="id" title="method">G</span></a> <a class="idref" href="clutch.typing.types.html#cf2aa254e4c9f9cb95db860c4555acd5"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#3473c383b1ac954a564ad01a12c5639d"><span class="id" title="method">τ</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#3473c383b1ac954a564ad01a12c5639d"><span class="id" title="method">G</span></a>)%<span class="id" title="var">ty</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <a id="int_of_vg_typed" class="idref" href="#int_of_vg_typed"><span class="id" title="projection">int_of_vg_typed</span></a> : <a class="idref" href="clutch.typing.types.html#val_typed"><span class="id" title="inductive">val_typed</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#int_of_vg:13"><span class="id" title="method">int_of_vg</span></a> (<a class="idref" href="clutch.examples.crypto.valgroup.html#3473c383b1ac954a564ad01a12c5639d"><span class="id" title="method">τ</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#3473c383b1ac954a564ad01a12c5639d"><span class="id" title="method">G</span></a> <a class="idref" href="clutch.typing.types.html#cf2aa254e4c9f9cb95db860c4555acd5"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.typing.types.html#TInt"><span class="id" title="constructor">TInt</span></a>)%<span class="id" title="var">ty</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <a id="vg_of_int_typed" class="idref" href="#vg_of_int_typed"><span class="id" title="projection">vg_of_int_typed</span></a> : <a class="idref" href="clutch.typing.types.html#val_typed"><span class="id" title="inductive">val_typed</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int:14"><span class="id" title="method">vg_of_int</span></a> (<a class="idref" href="clutch.typing.types.html#TInt"><span class="id" title="constructor">TInt</span></a> <a class="idref" href="clutch.typing.types.html#cf2aa254e4c9f9cb95db860c4555acd5"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.typing.types.html#2599395bdcdbb2edbbcec60bbf1ebff1"><span class="id" title="notation">()</span></a> <a class="idref" href="clutch.typing.types.html#b06448a1e61637d1227556b716988eba"><span class="id" title="notation">+</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#3473c383b1ac954a564ad01a12c5639d"><span class="id" title="method">τ</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#3473c383b1ac954a564ad01a12c5639d"><span class="id" title="method">G</span></a>)%<span class="id" title="var">ty</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>

<br/>
<span class="comment">(*&nbsp;In&nbsp;some&nbsp;cases&nbsp;(Zpˣ),&nbsp;we&nbsp;might&nbsp;want&nbsp;to&nbsp;use&nbsp;exponentiation&nbsp;to&nbsp;define<br/>
&nbsp;&nbsp;&nbsp;inversion,&nbsp;so&nbsp;we&nbsp;expose&nbsp;a&nbsp;bare&nbsp;version&nbsp;parametrised&nbsp;by&nbsp;only&nbsp;the&nbsp;unit&nbsp;and<br/>
&nbsp;&nbsp;&nbsp;multiplication&nbsp;instead&nbsp;of&nbsp;the&nbsp;whole&nbsp;group&nbsp;structure.&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <a id="vexp'" class="idref" href="#vexp'"><span class="id" title="definition">vexp'</span></a> (<a id="vunit:21" class="idref" href="#vunit:21"><span class="id" title="binder">vunit</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#:::'cval'"><span class="id" title="notation">cval</span></a>) (<a id="vmult:22" class="idref" href="#vmult:22"><span class="id" title="binder">vmult</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#:::'cval'"><span class="id" title="notation">cval</span></a>) : <a class="idref" href="clutch.examples.crypto.valgroup.html#:::'cval'"><span class="id" title="notation">cval</span></a> := <a class="idref" href="clutch.prob_lang.notation.html#704630d98f03f1fa6c74ab29b9831803"><span class="id" title="notation">λ</span></a><a class="idref" href="clutch.prob_lang.notation.html#704630d98f03f1fa6c74ab29b9831803"><span class="id" title="notation">:</span></a>"a"<a class="idref" href="clutch.prob_lang.notation.html#704630d98f03f1fa6c74ab29b9831803"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.prob_lang.notation.html#906ea9e6f897046b3c4410ec24b8ddef"><span class="id" title="notation">rec</span></a><a class="idref" href="clutch.prob_lang.notation.html#906ea9e6f897046b3c4410ec24b8ddef"><span class="id" title="notation">:</span></a> "vexp" "n" <a class="idref" href="clutch.prob_lang.notation.html#906ea9e6f897046b3c4410ec24b8ddef"><span class="id" title="notation">:=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a><a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">:</span></a> "n" <a class="idref" href="clutch.prob_lang.notation.html#959e055f1ab3ff54c36dde10824af025"><span class="id" title="notation">≤</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>0 <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#vunit:21"><span class="id" title="variable">vunit</span></a> <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'if:'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">let</span></a><a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:</span></a> "x" <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">:=</span></a> "vexp" ("n" <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a>1) <a class="idref" href="clutch.prob_lang.notation.html#f2a86cf1716b42d91300f888867d22e8"><span class="id" title="notation">in</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#vmult:22"><span class="id" title="variable">vmult</span></a> "a" "x".<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="vexp" class="idref" href="#vexp"><span class="id" title="definition">vexp</span></a> `{<a id="H:23" class="idref" href="#H:23"><span class="id" title="binder">!</span></a><a id="H:23" class="idref" href="#H:23"><span class="id" title="binder">clutch_group_struct</span></a>} : <a class="idref" href="clutch.examples.crypto.valgroup.html#:::'cval'"><span class="id" title="notation">cval</span></a> := <a class="idref" href="clutch.examples.crypto.valgroup.html#vexp'"><span class="id" title="definition">vexp'</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#vunit"><span class="id" title="method">vunit</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#vmult"><span class="id" title="method">vmult</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="lrel_G" class="idref" href="#lrel_G"><span class="id" title="definition">lrel_G</span></a> `{<a id="H:25" class="idref" href="#H:25"><span class="id" title="binder">clutchRGS</span></a> <a id="H:25" class="idref" href="#H:25"><span class="id" title="binder">Σ</span></a>} {<a id="vg:26" class="idref" href="#vg:26"><span class="id" title="binder">vg</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#val_group"><span class="id" title="class">val_group</span></a>} : <a class="idref" href="clutch.rel_logic.model.html#lrel"><span class="id" title="record">lrel</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#0ff5eed445d72e1c5ccedcdae1755936"><span class="id" title="variable">Σ</span></a><br/>
&nbsp;&nbsp;:= <a class="idref" href="clutch.rel_logic.model.html#LRel"><span class="id" title="constructor">LRel</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="w1:27" class="idref" href="#w1:27"><span class="id" title="binder">w1</span></a> <a id="w2:28" class="idref" href="#w2:28"><span class="id" title="binder">w2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="notation">∃</span> <a id="a:29" class="idref" href="#a:29"><span class="id" title="binder">a</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#vgG"><span class="id" title="method">vgG</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">⌜</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#w1:27"><span class="id" title="variable">w1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#a:29"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#w2:28"><span class="id" title="variable">w2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#a:29"><span class="id" title="variable">a</span></a> <span class="id" title="notation">⌝</span>)%<span class="id" title="var">I</span>.<br/>

<br/>
<span class="id" title="keyword">Class</span> <a id="clutch_group" class="idref" href="#clutch_group"><span class="id" title="record">clutch_group</span></a> `{<a id="H:31" class="idref" href="#H:31"><span class="id" title="binder">clutchRGS</span></a> <a id="H:31" class="idref" href="#H:31"><span class="id" title="binder">Σ</span></a>} {<a id="vg:32" class="idref" href="#vg:32"><span class="id" title="binder">vg</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#val_group"><span class="id" title="class">val_group</span></a>} {<a id="cg:33" class="idref" href="#cg:33"><span class="id" title="binder">cg</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#clutch_group_struct"><span class="id" title="class">clutch_group_struct</span></a>} :=<br/>
&nbsp;&nbsp;<span class="id" title="var">Clutch_group</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <a id="int_of_vg_lrel_G" class="idref" href="#int_of_vg_lrel_G"><span class="id" title="projection">int_of_vg_lrel_G</span></a> : <span class="id" title="notation">⊢</span> (<a class="idref" href="clutch.examples.crypto.valgroup.html#lrel_G"><span class="id" title="definition">lrel_G</span></a> <a class="idref" href="clutch.rel_logic.model.html#198b3df6111d1e335bfbd02615def5fc"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.rel_logic.model.html#lrel_int"><span class="id" title="definition">lrel_int</span></a>)%<span class="id" title="var">lrel</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#int_of_vg"><span class="id" title="method">int_of_vg</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#int_of_vg"><span class="id" title="method">int_of_vg</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <a id="vg_of_int_lrel_G" class="idref" href="#vg_of_int_lrel_G"><span class="id" title="projection">vg_of_int_lrel_G</span></a> : <span class="id" title="notation">⊢</span> (<a class="idref" href="clutch.rel_logic.model.html#lrel_int"><span class="id" title="definition">lrel_int</span></a> <a class="idref" href="clutch.rel_logic.model.html#198b3df6111d1e335bfbd02615def5fc"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.rel_logic.model.html#198b3df6111d1e335bfbd02615def5fc"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.rel_logic.model.html#0926557fff3a7c5de6f38fcac599a96f"><span class="id" title="notation">()</span></a> <a class="idref" href="clutch.rel_logic.model.html#952b32b7bba24b7eee4a974ec810fdbc"><span class="id" title="notation">+</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#lrel_G"><span class="id" title="definition">lrel_G</span></a><a class="idref" href="clutch.rel_logic.model.html#198b3df6111d1e335bfbd02615def5fc"><span class="id" title="notation">)</span></a>)%<span class="id" title="var">lrel</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int"><span class="id" title="method">vg_of_int</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int"><span class="id" title="method">vg_of_int</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <a id="50f2714a7f2dfdc0a4d82352d527fdc3" class="idref" href="#50f2714a7f2dfdc0a4d82352d527fdc3"><span class="id" title="projection">τ</span></a><a id="50f2714a7f2dfdc0a4d82352d527fdc3" class="idref" href="#50f2714a7f2dfdc0a4d82352d527fdc3"><span class="id" title="projection">G_subtype</span></a> <a id="v1:37" class="idref" href="#v1:37"><span class="id" title="binder">v1</span></a> <a id="v2:38" class="idref" href="#v2:38"><span class="id" title="binder">v2</span></a> <a id="7f0895c743f0486b5b933db4f3049b7c" class="idref" href="#7f0895c743f0486b5b933db4f3049b7c"><span class="id" title="binder">Δ</span></a> : <span class="id" title="notation">⊢</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#lrel_G"><span class="id" title="definition">lrel_G</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#v1:37"><span class="id" title="variable">v1</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#v2:38"><span class="id" title="variable">v2</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="clutch.typing.interp.html#interp"><span class="id" title="definition">interp</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#9082db16b85b8b97e7d84dbc62092956"><span class="id" title="method">τ</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#9082db16b85b8b97e7d84dbc62092956"><span class="id" title="method">G</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#7f0895c743f0486b5b933db4f3049b7c"><span class="id" title="variable">Δ</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#v1:37"><span class="id" title="variable">v1</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#v2:38"><span class="id" title="variable">v2</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <a id="is_unit" class="idref" href="#is_unit"><span class="id" title="projection">is_unit</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#vunit"><span class="id" title="method">vunit</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <a id="is_inv" class="idref" href="#is_inv"><span class="id" title="projection">is_inv</span></a> (<a id="x:42" class="idref" href="#x:42"><span class="id" title="binder">x</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#vgG"><span class="id" title="method">vgG</span></a>) : <span class="id" title="notation">⊢</span> <span class="id" title="notation">WP</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#vinv"><span class="id" title="method">vinv</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#x:42"><span class="id" title="variable">x</span></a> <span class="id" title="notation">{{</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">(</span></a><a id="v:43" class="idref" href="#v:43"><span class="id" title="binder">v</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#:::'cval'"><span class="id" title="notation">cval</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">),</span></a> <span class="id" title="notation">⌜</span><a class="idref" href="clutch.examples.crypto.valgroup.html#v:43"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#x:42"><span class="id" title="variable">x</span></a><span class="id" title="notation">^-1</span><span class="id" title="notation">⌝</span> <span class="id" title="notation">}}</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <a id="is_spec_inv" class="idref" href="#is_spec_inv"><span class="id" title="projection">is_spec_inv</span></a> (<a id="x:45" class="idref" href="#x:45"><span class="id" title="binder">x</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#vgG"><span class="id" title="method">vgG</span></a>) <a id="K:46" class="idref" href="#K:46"><span class="id" title="binder">K</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.rel_logic.spec_ra.html#refines_right"><span class="id" title="definition">refines_right</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#K:46"><span class="id" title="variable">K</span></a> (<a class="idref" href="clutch.examples.crypto.valgroup.html#vinv"><span class="id" title="method">vinv</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#x:45"><span class="id" title="variable">x</span></a>) <span class="id" title="notation">={</span><span class="id" title="notation">⊤</span><span class="id" title="notation">}=∗</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#refines_right"><span class="id" title="definition">refines_right</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#K:46"><span class="id" title="variable">K</span></a> (<a class="idref" href="clutch.examples.crypto.valgroup.html#x:45"><span class="id" title="variable">x</span></a><span class="id" title="notation">^-1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <a id="is_mult" class="idref" href="#is_mult"><span class="id" title="projection">is_mult</span></a> (<a id="x:48" class="idref" href="#x:48"><span class="id" title="binder">x</span></a> <a id="y:49" class="idref" href="#y:49"><span class="id" title="binder">y</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#vgG"><span class="id" title="method">vgG</span></a>) : <span class="id" title="notation">⊢</span> <span class="id" title="notation">WP</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#vmult"><span class="id" title="method">vmult</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#x:48"><span class="id" title="variable">x</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#y:49"><span class="id" title="variable">y</span></a> <span class="id" title="notation">{{</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">(</span></a><a id="v:50" class="idref" href="#v:50"><span class="id" title="binder">v</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#:::'cval'"><span class="id" title="notation">cval</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">),</span></a> <span class="id" title="notation">⌜</span><a class="idref" href="clutch.examples.crypto.valgroup.html#v:50"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> (<a class="idref" href="clutch.examples.crypto.valgroup.html#x:48"><span class="id" title="variable">x</span></a> <span class="id" title="notation">*</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#y:49"><span class="id" title="variable">y</span></a>)%<span class="id" title="var">g</span><span class="id" title="notation">⌝</span> <span class="id" title="notation">}}</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <a id="is_spec_mult" class="idref" href="#is_spec_mult"><span class="id" title="projection">is_spec_mult</span></a> (<a id="x:52" class="idref" href="#x:52"><span class="id" title="binder">x</span></a> <a id="y:53" class="idref" href="#y:53"><span class="id" title="binder">y</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#vgG"><span class="id" title="method">vgG</span></a>) <a id="K:54" class="idref" href="#K:54"><span class="id" title="binder">K</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.rel_logic.spec_ra.html#refines_right"><span class="id" title="definition">refines_right</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#K:54"><span class="id" title="variable">K</span></a> (<a class="idref" href="clutch.examples.crypto.valgroup.html#vmult"><span class="id" title="method">vmult</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#x:52"><span class="id" title="variable">x</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#y:53"><span class="id" title="variable">y</span></a>) <span class="id" title="notation">={</span><span class="id" title="notation">⊤</span><span class="id" title="notation">}=∗</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#refines_right"><span class="id" title="definition">refines_right</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#K:54"><span class="id" title="variable">K</span></a> (<a class="idref" href="clutch.examples.crypto.valgroup.html#x:52"><span class="id" title="variable">x</span></a> <span class="id" title="notation">*</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#y:53"><span class="id" title="variable">y</span></a>)%<span class="id" title="var">g</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="vexp_typed" class="idref" href="#vexp_typed"><span class="id" title="definition">vexp_typed</span></a> `{<a id="H:56" class="idref" href="#H:56"><span class="id" title="binder">!</span></a><a id="H:56" class="idref" href="#H:56"><span class="id" title="binder">clutch_group_struct</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="clutch.typing.types.html#val_typed"><span class="id" title="inductive">val_typed</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#vexp"><span class="id" title="definition">vexp</span></a> (<a class="idref" href="clutch.examples.crypto.valgroup.html#9082db16b85b8b97e7d84dbc62092956"><span class="id" title="method">τ</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#9082db16b85b8b97e7d84dbc62092956"><span class="id" title="method">G</span></a> <a class="idref" href="clutch.typing.types.html#cf2aa254e4c9f9cb95db860c4555acd5"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.typing.types.html#TInt"><span class="id" title="constructor">TInt</span></a> <a class="idref" href="clutch.typing.types.html#cf2aa254e4c9f9cb95db860c4555acd5"><span class="id" title="notation">→</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#9082db16b85b8b97e7d84dbc62092956"><span class="id" title="method">τ</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#9082db16b85b8b97e7d84dbc62092956"><span class="id" title="method">G</span></a>)%<span class="id" title="var">ty</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#vexp"><span class="id" title="definition">vexp</span></a>, <a class="idref" href="clutch.examples.crypto.valgroup.html#vexp'"><span class="id" title="definition">vexp'</span></a> ; <span class="id" title="var">tychk</span> ; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">using</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#vunit_typed"><span class="id" title="method">vunit_typed</span></a>, <a class="idref" href="clutch.examples.crypto.valgroup.html#vmult_typed"><span class="id" title="method">vmult_typed</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
#[<span class="id" title="var">export</span>] <span class="id" title="keyword">Hint</span> <span class="id" title="keyword">Extern</span> 0 (<a class="idref" href="clutch.typing.types.html#val_typed"><span class="id" title="inductive">val_typed</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#vunit"><span class="id" title="method">vunit</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#9082db16b85b8b97e7d84dbc62092956"><span class="id" title="method">τ</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#9082db16b85b8b97e7d84dbc62092956"><span class="id" title="method">G</span></a>) =&gt; <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#vunit_typed"><span class="id" title="method">vunit_typed</span></a> : <span class="id" title="var">core</span>.<br/>
#[<span class="id" title="var">export</span>] <span class="id" title="keyword">Hint</span> <span class="id" title="keyword">Extern</span> 0 (<a class="idref" href="clutch.typing.types.html#val_typed"><span class="id" title="inductive">val_typed</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#vmult"><span class="id" title="method">vmult</span></a> <span class="id" title="var">_</span>) =&gt; <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#vmult_typed"><span class="id" title="method">vmult_typed</span></a> : <span class="id" title="var">core</span>.<br/>
#[<span class="id" title="var">export</span>] <span class="id" title="keyword">Hint</span> <span class="id" title="keyword">Extern</span> 0 (<a class="idref" href="clutch.typing.types.html#val_typed"><span class="id" title="inductive">val_typed</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#vexp"><span class="id" title="definition">vexp</span></a> <span class="id" title="var">_</span>) =&gt; <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#vexp_typed"><span class="id" title="definition">vexp_typed</span></a> : <span class="id" title="var">core</span>.<br/>
#[<span class="id" title="var">export</span>] <span class="id" title="keyword">Hint</span> <span class="id" title="keyword">Extern</span> 0 (<a class="idref" href="clutch.typing.types.html#val_typed"><span class="id" title="inductive">val_typed</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#int_of_vg"><span class="id" title="method">int_of_vg</span></a> <span class="id" title="var">_</span>) =&gt; <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#int_of_vg_typed"><span class="id" title="method">int_of_vg_typed</span></a> : <span class="id" title="var">core</span>.<br/>
#[<span class="id" title="var">export</span>] <span class="id" title="keyword">Hint</span> <span class="id" title="keyword">Extern</span> 0 (<a class="idref" href="clutch.typing.types.html#val_typed"><span class="id" title="inductive">val_typed</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int"><span class="id" title="method">vg_of_int</span></a> <span class="id" title="var">_</span>) =&gt; <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_int_typed"><span class="id" title="method">vg_of_int_typed</span></a> : <span class="id" title="var">core</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="vg_of_cg" class="idref" href="#vg_of_cg"><span class="id" title="definition">vg_of_cg</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> {<a id="cb0630687a5a3dec7d46ec6926ccb84b" class="idref" href="#cb0630687a5a3dec7d46ec6926ccb84b"><span class="id" title="binder">Σ</span></a> <a id="c60c29c5c60880b83291ceb587f2a8e7" class="idref" href="#c60c29c5c60880b83291ceb587f2a8e7"><span class="id" title="binder">HΣ</span></a>} <a id="vg:59" class="idref" href="#vg:59"><span class="id" title="binder">vg</span></a> <a id="cg:60" class="idref" href="#cg:60"><span class="id" title="binder">cg</span></a> (<a id="G:61" class="idref" href="#G:61"><span class="id" title="binder">G</span></a> : @<a class="idref" href="clutch.examples.crypto.valgroup.html#clutch_group"><span class="id" title="class">clutch_group</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#cb0630687a5a3dec7d46ec6926ccb84b"><span class="id" title="variable">Σ</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#c60c29c5c60880b83291ceb587f2a8e7"><span class="id" title="variable">HΣ</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#vg:59"><span class="id" title="variable">vg</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#cg:60"><span class="id" title="variable">cg</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">),</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#vg:59"><span class="id" title="variable">vg</span></a>.<br/>
<span class="id" title="keyword">Coercion</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_cg"><span class="id" title="definition">vg_of_cg</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_cg"><span class="id" title="definition">:</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_cg"><span class="id" title="definition">clutch_group</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_cg"><span class="id" title="definition">&gt;-&gt;</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#vg_of_cg"><span class="id" title="definition">val_group</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;vg&nbsp;is&nbsp;generated&nbsp;by&nbsp;g.&nbsp;We&nbsp;further&nbsp;include&nbsp;the&nbsp;assumption&nbsp;that&nbsp;vg&nbsp;is<br/>
&nbsp;&nbsp;&nbsp;nontrivial,&nbsp;i.e.&nbsp;of&nbsp;size&nbsp;at&nbsp;least&nbsp;2,&nbsp;since&nbsp;this&nbsp;allows&nbsp;us&nbsp;to&nbsp;work&nbsp;with<br/>
&nbsp;&nbsp;&nbsp;mathcomp's&nbsp;'Z_p&nbsp;type&nbsp;of&nbsp;integers&nbsp;modulo&nbsp;p&nbsp;(taking&nbsp;p&nbsp;:=&nbsp;[g]). *)</span><br/>
<span class="id" title="keyword">Class</span> <a id="clutch_group_generator" class="idref" href="#clutch_group_generator"><span class="id" title="record">clutch_group_generator</span></a> {<a id="vg:62" class="idref" href="#vg:62"><span class="id" title="binder">vg</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#val_group"><span class="id" title="class">val_group</span></a>} :=<br/>
&nbsp;&nbsp;<span class="id" title="var">Clutch_group_generator</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <a id="g" class="idref" href="#g"><span class="id" title="projection">g</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#vgG"><span class="id" title="method">vgG</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <a id="n''" class="idref" href="#n''"><span class="id" title="projection">n''</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <a id="g_nontriv" class="idref" href="#g_nontriv"><span class="id" title="projection">g_nontriv</span></a> : <span class="id" title="notation">#[</span><a class="idref" href="clutch.examples.crypto.valgroup.html#g:64"><span class="id" title="method">g</span></a><span class="id" title="notation">]</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#n'':65"><span class="id" title="method">n''</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <a id="g_generator" class="idref" href="#g_generator"><span class="id" title="projection">g_generator</span></a> : <span class="id" title="definition">generator</span> <span class="id" title="notation">[</span><span class="id" title="notation">set</span><span class="id" title="notation">:</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#vgG"><span class="id" title="method">vgG</span></a><span class="id" title="notation">]</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#g:64"><span class="id" title="method">g</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>

<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="var">Default</span> <span class="id" title="keyword">Proof</span> <span class="id" title="var">Using</span> "Type*".<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="facts" class="idref" href="#facts"><span class="id" title="section">facts</span></a>.<br/>

<br/>
<span class="id" title="keyword">Context</span> `{<a id="clutchRGS0:69" class="idref" href="#clutchRGS0:69"><span class="id" title="binder">!</span></a><a id="clutchRGS0:69" class="idref" href="#clutchRGS0:69"><span class="id" title="binder">clutchRGS</span></a> <a id="clutchRGS0:69" class="idref" href="#clutchRGS0:69"><span class="id" title="binder">Σ</span></a>}.<br/>

<br/>
<span class="id" title="keyword">Context</span> {<a id="vg:70" class="idref" href="#vg:70"><span class="id" title="binder">vg</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#val_group"><span class="id" title="class">val_group</span></a>}.<br/>
<span class="id" title="keyword">Context</span> {<a id="cg:71" class="idref" href="#cg:71"><span class="id" title="binder">cg</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#clutch_group_struct"><span class="id" title="class">clutch_group_struct</span></a>}.<br/>
<span class="id" title="keyword">Context</span> {<a id="G:72" class="idref" href="#G:72"><span class="id" title="binder">G</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#clutch_group"><span class="id" title="class">clutch_group</span></a> (<span class="id" title="var">vg</span>:=<a class="idref" href="clutch.examples.crypto.valgroup.html#facts.vg"><span class="id" title="variable">vg</span></a>) (<span class="id" title="var">cg</span>:=<a class="idref" href="clutch.examples.crypto.valgroup.html#facts.cg"><span class="id" title="variable">cg</span></a>)}.<br/>
<span class="id" title="keyword">Context</span> {<a id="cgg:73" class="idref" href="#cgg:73"><span class="id" title="binder">cgg</span></a> : @<a class="idref" href="clutch.examples.crypto.valgroup.html#clutch_group_generator"><span class="id" title="class">clutch_group_generator</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#facts.vg"><span class="id" title="variable">vg</span></a>}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="refines_inv_l" class="idref" href="#refines_inv_l"><span class="id" title="lemma">refines_inv_l</span></a> <a id="E:74" class="idref" href="#E:74"><span class="id" title="binder">E</span></a> <a id="K:75" class="idref" href="#K:75"><span class="id" title="binder">K</span></a> <a id="A:76" class="idref" href="#A:76"><span class="id" title="binder">A</span></a> (<a id="a:77" class="idref" href="#a:77"><span class="id" title="binder">a</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#vgG"><span class="id" title="method">vgG</span></a>) <a id="t:78" class="idref" href="#t:78"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.model.html#refines"><span class="id" title="definition">refines</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#E:74"><span class="id" title="variable">E</span></a> (<a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">ectxi_language.fill</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#K:75"><span class="id" title="variable">K</span></a> (<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.Val"><span class="id" title="constructor">Val</span></a> (<a class="idref" href="clutch.examples.crypto.valgroup.html#a:77"><span class="id" title="variable">a</span></a><span class="id" title="notation">^-1</span>)%<span class="id" title="var">g</span>)) <a class="idref" href="clutch.examples.crypto.valgroup.html#t:78"><span class="id" title="variable">t</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#A:76"><span class="id" title="variable">A</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="clutch.rel_logic.model.html#refines"><span class="id" title="definition">refines</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#E:74"><span class="id" title="variable">E</span></a> (<a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">ectxi_language.fill</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#K:75"><span class="id" title="variable">K</span></a> (<a class="idref" href="clutch.examples.crypto.valgroup.html#vinv"><span class="id" title="method">vinv</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#a:77"><span class="id" title="variable">a</span></a>)) <a class="idref" href="clutch.examples.crypto.valgroup.html#t:78"><span class="id" title="variable">t</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#A:76"><span class="id" title="variable">A</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H". <span class="id" title="var">rel_apply_l</span> <a class="idref" href="clutch.rel_logic.rel_rules.html#refines_wp_l"><span class="id" title="lemma">refines_wp_l</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.program_logic.weakestpre.html#wp_frame_wand"><span class="id" title="lemma">wp_frame_wand</span></a> <span class="id" title="notation">with</span> "H"<span class="id" title="notation">)</span>. <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.program_logic.weakestpre.html#wp_mono"><span class="id" title="lemma">wp_mono</span></a> <span class="id" title="notation">$!</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.examples.crypto.valgroup.html#is_inv"><span class="id" title="method">is_inv</span></a> <span class="id" title="var">a</span><span class="id" title="notation">))</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">iIntros</span> ; <span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="refines_inv_r" class="idref" href="#refines_inv_r"><span class="id" title="lemma">refines_inv_r</span></a> <a id="E:79" class="idref" href="#E:79"><span class="id" title="binder">E</span></a> <a id="K:80" class="idref" href="#K:80"><span class="id" title="binder">K</span></a> <a id="A:81" class="idref" href="#A:81"><span class="id" title="binder">A</span></a> (<a id="a:82" class="idref" href="#a:82"><span class="id" title="binder">a</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#vgG"><span class="id" title="method">vgG</span></a>) <a id="t:83" class="idref" href="#t:83"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.model.html#refines"><span class="id" title="definition">refines</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#E:79"><span class="id" title="variable">E</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#t:83"><span class="id" title="variable">t</span></a> (<a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">ectxi_language.fill</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#K:80"><span class="id" title="variable">K</span></a> (<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.Val"><span class="id" title="constructor">Val</span></a> (<a class="idref" href="clutch.examples.crypto.valgroup.html#a:82"><span class="id" title="variable">a</span></a><span class="id" title="notation">^-1</span>)%<span class="id" title="var">g</span>)) <a class="idref" href="clutch.examples.crypto.valgroup.html#A:81"><span class="id" title="variable">A</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="clutch.rel_logic.model.html#refines"><span class="id" title="definition">refines</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#E:79"><span class="id" title="variable">E</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#t:83"><span class="id" title="variable">t</span></a> (<a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">ectxi_language.fill</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#K:80"><span class="id" title="variable">K</span></a> (<a class="idref" href="clutch.examples.crypto.valgroup.html#vinv"><span class="id" title="method">vinv</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#a:82"><span class="id" title="variable">a</span></a>)) <a class="idref" href="clutch.examples.crypto.valgroup.html#A:81"><span class="id" title="variable">A</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H". <span class="id" title="var">rel_apply_r</span> <a class="idref" href="clutch.rel_logic.rel_rules.html#refines_steps_r"><span class="id" title="lemma">refines_steps_r</span></a> =&gt; //.<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (?). <span class="id" title="var">iApply</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#is_spec_inv"><span class="id" title="method">is_spec_inv</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="refines_mult_l" class="idref" href="#refines_mult_l"><span class="id" title="lemma">refines_mult_l</span></a> <a id="E:84" class="idref" href="#E:84"><span class="id" title="binder">E</span></a> <a id="K:85" class="idref" href="#K:85"><span class="id" title="binder">K</span></a> <a id="A:86" class="idref" href="#A:86"><span class="id" title="binder">A</span></a> (<a id="a:87" class="idref" href="#a:87"><span class="id" title="binder">a</span></a> <a id="b:88" class="idref" href="#b:88"><span class="id" title="binder">b</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#vgG"><span class="id" title="method">vgG</span></a>) <a id="t:89" class="idref" href="#t:89"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.model.html#refines"><span class="id" title="definition">refines</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#E:84"><span class="id" title="variable">E</span></a> (<a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">ectxi_language.fill</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#K:85"><span class="id" title="variable">K</span></a> (<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.Val"><span class="id" title="constructor">Val</span></a> (<a class="idref" href="clutch.examples.crypto.valgroup.html#a:87"><span class="id" title="variable">a</span></a> <span class="id" title="notation">*</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#b:88"><span class="id" title="variable">b</span></a>)%<span class="id" title="var">g</span>)) <a class="idref" href="clutch.examples.crypto.valgroup.html#t:89"><span class="id" title="variable">t</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#A:86"><span class="id" title="variable">A</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="clutch.rel_logic.model.html#refines"><span class="id" title="definition">refines</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#E:84"><span class="id" title="variable">E</span></a> (<a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">ectxi_language.fill</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#K:85"><span class="id" title="variable">K</span></a> (<a class="idref" href="clutch.examples.crypto.valgroup.html#vmult"><span class="id" title="method">vmult</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#a:87"><span class="id" title="variable">a</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#b:88"><span class="id" title="variable">b</span></a>)) <a class="idref" href="clutch.examples.crypto.valgroup.html#t:89"><span class="id" title="variable">t</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#A:86"><span class="id" title="variable">A</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H". <span class="id" title="var">rel_apply_l</span> <a class="idref" href="clutch.rel_logic.rel_rules.html#refines_wp_l"><span class="id" title="lemma">refines_wp_l</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.program_logic.weakestpre.html#wp_frame_wand"><span class="id" title="lemma">wp_frame_wand</span></a> <span class="id" title="notation">with</span> "H"<span class="id" title="notation">)</span>. <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.program_logic.weakestpre.html#wp_mono"><span class="id" title="lemma">wp_mono</span></a> <span class="id" title="notation">$!</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.examples.crypto.valgroup.html#is_mult"><span class="id" title="method">is_mult</span></a> <span class="id" title="var">a</span> <span class="id" title="var">b</span><span class="id" title="notation">))</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">iIntros</span> ; <span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="refines_mult_r" class="idref" href="#refines_mult_r"><span class="id" title="lemma">refines_mult_r</span></a> <a id="E:90" class="idref" href="#E:90"><span class="id" title="binder">E</span></a> <a id="K:91" class="idref" href="#K:91"><span class="id" title="binder">K</span></a> <a id="A:92" class="idref" href="#A:92"><span class="id" title="binder">A</span></a> (<a id="a:93" class="idref" href="#a:93"><span class="id" title="binder">a</span></a> <a id="b:94" class="idref" href="#b:94"><span class="id" title="binder">b</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#vgG"><span class="id" title="method">vgG</span></a>) <a id="t:95" class="idref" href="#t:95"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.model.html#refines"><span class="id" title="definition">refines</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#E:90"><span class="id" title="variable">E</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#t:95"><span class="id" title="variable">t</span></a> (<a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">ectxi_language.fill</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#K:91"><span class="id" title="variable">K</span></a> (<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.Val"><span class="id" title="constructor">Val</span></a> (<a class="idref" href="clutch.examples.crypto.valgroup.html#a:93"><span class="id" title="variable">a</span></a> <span class="id" title="notation">*</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#b:94"><span class="id" title="variable">b</span></a>)%<span class="id" title="var">g</span>)) <a class="idref" href="clutch.examples.crypto.valgroup.html#A:92"><span class="id" title="variable">A</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="clutch.rel_logic.model.html#refines"><span class="id" title="definition">refines</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#E:90"><span class="id" title="variable">E</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#t:95"><span class="id" title="variable">t</span></a> (<a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">ectxi_language.fill</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#K:91"><span class="id" title="variable">K</span></a> (<a class="idref" href="clutch.examples.crypto.valgroup.html#vmult"><span class="id" title="method">vmult</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#a:93"><span class="id" title="variable">a</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#b:94"><span class="id" title="variable">b</span></a>)) <a class="idref" href="clutch.examples.crypto.valgroup.html#A:92"><span class="id" title="variable">A</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H". <span class="id" title="var">rel_apply_r</span> <a class="idref" href="clutch.rel_logic.rel_rules.html#refines_steps_r"><span class="id" title="lemma">refines_steps_r</span></a> =&gt; //.<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (?). <span class="id" title="var">iApply</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#is_spec_mult"><span class="id" title="method">is_spec_mult</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Fact</span> <a id="is_exp" class="idref" href="#is_exp"><span class="id" title="lemma">is_exp</span></a> (<a id="b:96" class="idref" href="#b:96"><span class="id" title="binder">b</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#vgG"><span class="id" title="method">vgG</span></a>) (<a id="x:97" class="idref" href="#x:97"><span class="id" title="binder">x</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) :<br/>
&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <span class="id" title="notation">True</span> <span class="id" title="notation">}}}</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#vexp"><span class="id" title="definition">vexp</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#b:96"><span class="id" title="variable">b</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#x:97"><span class="id" title="variable">x</span></a> <span class="id" title="notation">{{{</span> <a id="v:98" class="idref" href="#v:98"><span class="id" title="binder">v</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">RET</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.examples.crypto.valgroup.html#v:98"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">:</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#:::'cval'"><span class="id" title="notation">cval</span></a><span class="id" title="notation">);</span> <span class="id" title="notation">⌜</span><a class="idref" href="clutch.examples.crypto.valgroup.html#v:98"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> (<a class="idref" href="clutch.examples.crypto.valgroup.html#b:96"><span class="id" title="variable">b</span></a> <span class="id" title="notation">^+</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#x:97"><span class="id" title="variable">x</span></a>)%<span class="id" title="var">g</span><span class="id" title="notation">⌝</span> <span class="id" title="notation">}}}</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#vexp"><span class="id" title="definition">vexp</span></a>, <a class="idref" href="clutch.examples.crypto.valgroup.html#vexp'"><span class="id" title="definition">vexp'</span></a>. <span class="id" title="var">iIntros</span> (? <span class="id" title="var">_</span>) "hlog".<br/>
&nbsp;&nbsp;<span class="id" title="var">wp_pure</span>. <span class="id" title="var">wp_pure</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iInduction</span> <span class="id" title="var">x</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">x</span>] "IH" <span class="id" title="keyword">forall</span> (<span class="id" title="var">Φ</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#is_unit"><span class="id" title="method">is_unit</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> ("hlog").<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">expg0</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">do</span> 4 <span class="id" title="var">wp_pure</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_bind</span> ((<a class="idref" href="clutch.prob_lang.notation.html#3b4611ead68c65413f980c1d4a390696"><span class="id" title="notation">rec</span></a><a class="idref" href="clutch.prob_lang.notation.html#3b4611ead68c65413f980c1d4a390696"><span class="id" title="notation">:</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="clutch.prob_lang.notation.html#3b4611ead68c65413f980c1d4a390696"><span class="id" title="notation">:=</span></a> <span class="id" title="var">_</span>)%<span class="id" title="var">V</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">-</span></a> 1)%<span class="id" title="var">Z</span> <span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.of_nat"><span class="id" title="definition">Z.of_nat</span></a> <span class="id" title="var">x</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> "IH".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span>. <span class="id" title="var">wp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.program_logic.weakestpre.html#wp_frame_wand"><span class="id" title="lemma">wp_frame_wand</span></a> <span class="id" title="notation">with</span> "hlog"<span class="id" title="notation">)</span>. <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.program_logic.weakestpre.html#wp_mono"><span class="id" title="lemma">wp_mono</span></a> <span class="id" title="notation">$!</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.examples.crypto.valgroup.html#is_mult"><span class="id" title="method">is_mult</span></a> <span class="id" title="var">b</span> <span class="id" title="var">v</span><span class="id" title="notation">))</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (??) "hlog" ; <span class="id" title="tactic">subst</span>. <span class="id" title="var">iApply</span> "hlog".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">expgS</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Fact</span> <a id="is_spec_exp" class="idref" href="#is_spec_exp"><span class="id" title="lemma">is_spec_exp</span></a> (<a id="b:99" class="idref" href="#b:99"><span class="id" title="binder">b</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#vgG"><span class="id" title="method">vgG</span></a>) (<a id="x:100" class="idref" href="#x:100"><span class="id" title="binder">x</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) <a id="K:101" class="idref" href="#K:101"><span class="id" title="binder">K</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="clutch.rel_logic.spec_ra.html#refines_right"><span class="id" title="definition">refines_right</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#K:101"><span class="id" title="variable">K</span></a> (<a class="idref" href="clutch.examples.crypto.valgroup.html#vexp"><span class="id" title="definition">vexp</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#b:99"><span class="id" title="variable">b</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#x:100"><span class="id" title="variable">x</span></a>) <span class="id" title="notation">={</span><span class="id" title="notation">⊤</span><span class="id" title="notation">}=∗</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#refines_right"><span class="id" title="definition">refines_right</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#K:101"><span class="id" title="variable">K</span></a> (<a class="idref" href="clutch.examples.crypto.valgroup.html#b:99"><span class="id" title="variable">b</span></a> <span class="id" title="notation">^+</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#x:100"><span class="id" title="variable">x</span></a>)%<span class="id" title="var">g</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#vexp"><span class="id" title="definition">vexp</span></a>, <a class="idref" href="clutch.examples.crypto.valgroup.html#vexp'"><span class="id" title="definition">vexp'</span></a>. <span class="id" title="var">iIntros</span> "hlog".<br/>
&nbsp;&nbsp;<span class="id" title="var">tp_pure</span>. <span class="id" title="var">tp_pure</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iInduction</span> <span class="id" title="var">x</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">x</span>] "IH" <span class="id" title="keyword">forall</span> (<span class="id" title="var">K</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="var">tp_pures</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#is_unit"><span class="id" title="method">is_unit</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> ("hlog").<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">do</span> 4 <span class="id" title="var">tp_pure</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">tp_bind</span> ((<a class="idref" href="clutch.prob_lang.notation.html#3b4611ead68c65413f980c1d4a390696"><span class="id" title="notation">rec</span></a><a class="idref" href="clutch.prob_lang.notation.html#3b4611ead68c65413f980c1d4a390696"><span class="id" title="notation">:</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="clutch.prob_lang.notation.html#3b4611ead68c65413f980c1d4a390696"><span class="id" title="notation">:=</span></a> <span class="id" title="var">_</span>)%<span class="id" title="var">V</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">-</span></a> 1)%<span class="id" title="var">Z</span> <span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.of_nat"><span class="id" title="definition">Z.of_nat</span></a> <span class="id" title="var">x</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.rel_logic.rel_rules.html#refines_right_bind"><span class="id" title="lemma">refines_right_bind</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSpecialize</span> <span class="id" title="notation">(</span>"IH" <span class="id" title="notation">with</span> "hlog"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> "IH" <span class="id" title="keyword">as</span> "IH".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="clutch.rel_logic.rel_rules.html#refines_right_bind"><span class="id" title="lemma">refines_right_bind</span></a> =&gt; /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">tp_pures</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#is_spec_mult"><span class="id" title="method">is_spec_mult</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">expgS</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="refines_exp_l" class="idref" href="#refines_exp_l"><span class="id" title="lemma">refines_exp_l</span></a> <a id="E:102" class="idref" href="#E:102"><span class="id" title="binder">E</span></a> <a id="K:103" class="idref" href="#K:103"><span class="id" title="binder">K</span></a> <a id="A:104" class="idref" href="#A:104"><span class="id" title="binder">A</span></a> (<a id="b:105" class="idref" href="#b:105"><span class="id" title="binder">b</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#vgG"><span class="id" title="method">vgG</span></a>) (<a id="p:106" class="idref" href="#p:106"><span class="id" title="binder">p</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) <a id="t:107" class="idref" href="#t:107"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.model.html#refines"><span class="id" title="definition">refines</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#E:102"><span class="id" title="variable">E</span></a> (<a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">ectxi_language.fill</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#K:103"><span class="id" title="variable">K</span></a> (<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.Val"><span class="id" title="constructor">Val</span></a> (<a class="idref" href="clutch.examples.crypto.valgroup.html#b:105"><span class="id" title="variable">b</span></a> <span class="id" title="notation">^+</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#p:106"><span class="id" title="variable">p</span></a>)%<span class="id" title="var">g</span>)) <a class="idref" href="clutch.examples.crypto.valgroup.html#t:107"><span class="id" title="variable">t</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#A:104"><span class="id" title="variable">A</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="clutch.rel_logic.model.html#refines"><span class="id" title="definition">refines</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#E:102"><span class="id" title="variable">E</span></a> (<a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">ectxi_language.fill</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#K:103"><span class="id" title="variable">K</span></a> (<a class="idref" href="clutch.examples.crypto.valgroup.html#vexp"><span class="id" title="definition">vexp</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#b:105"><span class="id" title="variable">b</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#p:106"><span class="id" title="variable">p</span></a>)) <a class="idref" href="clutch.examples.crypto.valgroup.html#t:107"><span class="id" title="variable">t</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#A:104"><span class="id" title="variable">A</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H". <span class="id" title="var">rel_apply_l</span> <a class="idref" href="clutch.rel_logic.rel_rules.html#refines_wp_l"><span class="id" title="lemma">refines_wp_l</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iApply</span> (<a class="idref" href="clutch.examples.crypto.valgroup.html#is_exp"><span class="id" title="lemma">is_exp</span></a> <span class="id" title="var">b</span> <span class="id" title="var">p</span>) =&gt; //. <span class="id" title="var">iModIntro</span> ; <span class="id" title="var">iIntros</span> (<span class="id" title="var">v</span>) "-&gt;" =&gt; //.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="refines_exp_r" class="idref" href="#refines_exp_r"><span class="id" title="lemma">refines_exp_r</span></a> <a id="E:108" class="idref" href="#E:108"><span class="id" title="binder">E</span></a> <a id="K:109" class="idref" href="#K:109"><span class="id" title="binder">K</span></a> <a id="A:110" class="idref" href="#A:110"><span class="id" title="binder">A</span></a> (<a id="b:111" class="idref" href="#b:111"><span class="id" title="binder">b</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#vgG"><span class="id" title="method">vgG</span></a>) (<a id="p:112" class="idref" href="#p:112"><span class="id" title="binder">p</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) <a id="t:113" class="idref" href="#t:113"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.model.html#refines"><span class="id" title="definition">refines</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#E:108"><span class="id" title="variable">E</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#t:113"><span class="id" title="variable">t</span></a> (<a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">ectxi_language.fill</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#K:109"><span class="id" title="variable">K</span></a> (<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.Val"><span class="id" title="constructor">Val</span></a> (<a class="idref" href="clutch.examples.crypto.valgroup.html#b:111"><span class="id" title="variable">b</span></a> <span class="id" title="notation">^+</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#p:112"><span class="id" title="variable">p</span></a>)%<span class="id" title="var">g</span>)) <a class="idref" href="clutch.examples.crypto.valgroup.html#A:110"><span class="id" title="variable">A</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="clutch.rel_logic.model.html#refines"><span class="id" title="definition">refines</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#E:108"><span class="id" title="variable">E</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#t:113"><span class="id" title="variable">t</span></a> (<a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">ectxi_language.fill</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#K:109"><span class="id" title="variable">K</span></a> (<a class="idref" href="clutch.examples.crypto.valgroup.html#vexp"><span class="id" title="definition">vexp</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#b:111"><span class="id" title="variable">b</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#p:112"><span class="id" title="variable">p</span></a>)) <a class="idref" href="clutch.examples.crypto.valgroup.html#A:110"><span class="id" title="variable">A</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H". <span class="id" title="var">rel_apply_r</span> <a class="idref" href="clutch.rel_logic.rel_rules.html#refines_steps_r"><span class="id" title="lemma">refines_steps_r</span></a> =&gt; //.<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (?). <span class="id" title="var">iApply</span> (<a class="idref" href="clutch.examples.crypto.valgroup.html#is_spec_exp"><span class="id" title="lemma">is_spec_exp</span></a> <span class="id" title="var">b</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="log_g" class="idref" href="#log_g"><span class="id" title="lemma">log_g</span></a><br/>
&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="v:114" class="idref" href="#v:114"><span class="id" title="binder">v</span></a> : <a class="idref" href="clutch.examples.crypto.valgroup.html#vgG"><span class="id" title="method">vgG</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a id="k:115" class="idref" href="#k:115"><span class="id" title="binder">k</span></a> : <span class="id" title="abbreviation">fin</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#n''"><span class="id" title="method">n''</span></a>))<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a> (<a class="idref" href="clutch.examples.crypto.valgroup.html#v:114"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#g"><span class="id" title="method">g</span></a><span class="id" title="notation">^+</span><a class="idref" href="clutch.examples.crypto.valgroup.html#k:115"><span class="id" title="variable">k</span></a>)%<span class="id" title="var">g</span>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#g_nontriv"><span class="id" title="method">g_nontriv</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#g_generator"><span class="id" title="method">g_generator</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">generator</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">v</span> ; <span class="id" title="tactic">destruct</span> (@<span class="id" title="lemma">cyclePmin</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#vgG"><span class="id" title="method">vgG</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#g"><span class="id" title="method">g</span></a> <span class="id" title="var">v</span>).<br/>
&nbsp;&nbsp;2: {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">hx</span> : <span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <span class="id" title="notation">#[</span><a class="idref" href="clutch.examples.crypto.valgroup.html#g"><span class="id" title="method">g</span></a><span class="id" title="notation">]</span>%<span class="id" title="var">g</span>) <span class="id" title="tactic">by</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> /<span class="id" title="lemma">ssrnat.leP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#g_nontriv"><span class="id" title="method">g_nontriv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">hx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="abbreviation">nat_to_fin</span> <span class="id" title="var">hx</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">fin_to_nat_to_fin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="notation">[</span><span class="id" title="notation">set</span><span class="id" title="notation">:</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#vgG"><span class="id" title="method">vgG</span></a><span class="id" title="notation">]</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">cycle</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#g"><span class="id" title="method">g</span></a>)%<span class="id" title="var">g</span> <span class="id" title="keyword">as</span> &lt;-.<br/>
&nbsp;&nbsp;2: <span class="id" title="tactic">apply</span> <span class="id" title="lemma">in_setT</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">destruct</span> (@<span class="id" title="lemma">eqtype.eqP</span> <span class="id" title="var">_</span> <span class="id" title="notation">[</span><span class="id" title="notation">set</span><span class="id" title="notation">:</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#vgG"><span class="id" title="method">vgG</span></a><span class="id" title="notation">]</span> (<span class="id" title="definition">cycle</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#g"><span class="id" title="method">g</span></a>)).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#facts"><span class="id" title="section">facts</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;fast&nbsp;tactics&nbsp;to&nbsp;simplify&nbsp;inversion&nbsp;*)</span><br/>
<span class="id" title="keyword">Tactic Notation</span> "rel_inv_l" :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- <span class="id" title="definition">environments.envs_entails</span> <span class="id" title="var">_</span> (<a class="idref" href="clutch.rel_logic.model.html#refines"><span class="id" title="definition">refines</span></a> <span class="id" title="var">_</span> ?<span class="id" title="var">e</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">e</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="keyword">context</span>[<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.App"><span class="id" title="constructor">App</span></a> (<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#vinv"><span class="id" title="method">vinv</span></a>) (<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.Val"><span class="id" title="constructor">Val</span></a> ?<span class="id" title="var">a</span>)] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rel_apply_l</span> (<a class="idref" href="clutch.examples.crypto.valgroup.html#refines_inv_l"><span class="id" title="lemma">refines_inv_l</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">a</span> <span class="id" title="var">_</span>) =&gt; //<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> "rel_inv_l: no vinv / group element found"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> "rel_inv_l: not proving a refinement"<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "rel_inv_r" :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- <span class="id" title="definition">environments.envs_entails</span> <span class="id" title="var">_</span> (<a class="idref" href="clutch.rel_logic.model.html#refines"><span class="id" title="definition">refines</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ?<span class="id" title="var">e</span> <span class="id" title="var">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">e</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="keyword">context</span>[<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.App"><span class="id" title="constructor">App</span></a> (<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#vinv"><span class="id" title="method">vinv</span></a>) (<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.Val"><span class="id" title="constructor">Val</span></a> ?<span class="id" title="var">a</span>)] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rel_apply_r</span> (<a class="idref" href="clutch.examples.crypto.valgroup.html#refines_inv_r"><span class="id" title="lemma">refines_inv_r</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">a</span> <span class="id" title="var">_</span>) =&gt; //<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> "rel_inv_r: no vinv / group element found"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> "rel_inv_r: not proving a refinement"<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="comment">(*&nbsp;fast&nbsp;tactics&nbsp;to&nbsp;simplify&nbsp;multiplications&nbsp;*)</span><br/>
<span class="id" title="keyword">Tactic Notation</span> "rel_mult_l" :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- <span class="id" title="definition">environments.envs_entails</span> <span class="id" title="var">_</span> (<a class="idref" href="clutch.rel_logic.model.html#refines"><span class="id" title="definition">refines</span></a> <span class="id" title="var">_</span> ?<span class="id" title="var">e</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">e</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="keyword">context</span>[<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.App"><span class="id" title="constructor">App</span></a> (<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.App"><span class="id" title="constructor">App</span></a> (<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#vmult"><span class="id" title="method">vmult</span></a>) (<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.Val"><span class="id" title="constructor">Val</span></a> ?<span class="id" title="var">a</span>)) (<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.Val"><span class="id" title="constructor">Val</span></a> ?<span class="id" title="var">b</span>)] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rel_apply_l</span> (<a class="idref" href="clutch.examples.crypto.valgroup.html#refines_mult_l"><span class="id" title="lemma">refines_mult_l</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">_</span>) =&gt; //<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> "rel_mult_l: no vmult / v1 / v2 found"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> "rel_mult_l: not proving a refinement"<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "rel_mult_r" :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- <span class="id" title="definition">environments.envs_entails</span> <span class="id" title="var">_</span> (<a class="idref" href="clutch.rel_logic.model.html#refines"><span class="id" title="definition">refines</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ?<span class="id" title="var">e</span> <span class="id" title="var">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">e</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="keyword">context</span>[<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.App"><span class="id" title="constructor">App</span></a> (<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.App"><span class="id" title="constructor">App</span></a> (<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#vmult"><span class="id" title="method">vmult</span></a>) (<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.Val"><span class="id" title="constructor">Val</span></a> ?<span class="id" title="var">a</span>)) (<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.Val"><span class="id" title="constructor">Val</span></a> ?<span class="id" title="var">b</span>)] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rel_apply_r</span> (<a class="idref" href="clutch.examples.crypto.valgroup.html#refines_mult_r"><span class="id" title="lemma">refines_mult_r</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">_</span>) =&gt; //<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> "rel_mult_r: no vmult / v1 / v2 found"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> "rel_mult_r: not proving a refinement"<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="comment">(*&nbsp;fast&nbsp;tactics&nbsp;to&nbsp;simplify&nbsp;exponentials&nbsp;*)</span><br/>
<span class="id" title="keyword">Tactic Notation</span> "rel_exp_l" :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- <span class="id" title="definition">environments.envs_entails</span> <span class="id" title="var">_</span> (<a class="idref" href="clutch.rel_logic.model.html#refines"><span class="id" title="definition">refines</span></a> <span class="id" title="var">_</span> ?<span class="id" title="var">e</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">e</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="keyword">context</span>[<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.App"><span class="id" title="constructor">App</span></a> (<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.App"><span class="id" title="constructor">App</span></a> (<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#vexp"><span class="id" title="definition">vexp</span></a>) (<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.Val"><span class="id" title="constructor">Val</span></a> ?<span class="id" title="var">b</span>)) (<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#(</span></a><a class="idref" href="clutch.prob_lang.lang.html#prob_lang.LitInt"><span class="id" title="constructor">LitInt</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.of_nat"><span class="id" title="definition">Z.of_nat</span></a> ?<span class="id" title="var">p</span>)<a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">)</span></a>)] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rel_apply_l</span> (<a class="idref" href="clutch.examples.crypto.valgroup.html#refines_exp_l"><span class="id" title="lemma">refines_exp_l</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">b</span> <span class="id" title="var">p</span> <span class="id" title="var">_</span>) =&gt; //<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> "rel_exp_l: no vexp / base / exponent found"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> "rel_exp_l: not proving a refinement"<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "rel_exp_r" :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- <span class="id" title="definition">environments.envs_entails</span> <span class="id" title="var">_</span> (<a class="idref" href="clutch.rel_logic.model.html#refines"><span class="id" title="definition">refines</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ?<span class="id" title="var">e</span> <span class="id" title="var">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">e</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="keyword">context</span>[<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.App"><span class="id" title="constructor">App</span></a> (<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.App"><span class="id" title="constructor">App</span></a> (<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#vexp"><span class="id" title="definition">vexp</span></a>) (<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.Val"><span class="id" title="constructor">Val</span></a> ?<span class="id" title="var">b</span>)) (<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#(</span></a><a class="idref" href="clutch.prob_lang.lang.html#prob_lang.LitInt"><span class="id" title="constructor">LitInt</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.of_nat"><span class="id" title="definition">Z.of_nat</span></a> ?<span class="id" title="var">p</span>)<a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">)</span></a>)] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rel_apply_r</span> (<a class="idref" href="clutch.examples.crypto.valgroup.html#refines_exp_r"><span class="id" title="lemma">refines_exp_r</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">b</span> <span class="id" title="var">p</span> <span class="id" title="var">_</span>) =&gt; //<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> "rel_exp_r: no vexp / base / exponent found"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> "rel_exp_r: not proving a refinement"<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <a id="valgroup_tactics" class="idref" href="#valgroup_tactics"><span class="id" title="module">valgroup_tactics</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span> <span class="id" title="var">rel_pures</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iStartProof</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="var">iredpuresr</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">first</span> [<span class="id" title="var">rel_exp_r</span> | <span class="id" title="var">rel_mult_r</span> | <span class="id" title="var">rel_inv_r</span>]) ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="var">iredpuresl</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">first</span> [<span class="id" title="var">rel_exp_l</span> | <span class="id" title="var">rel_mult_l</span> | <span class="id" title="var">rel_inv_l</span>]).<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;TODO:&nbsp;make&nbsp;this&nbsp;into&nbsp;a&nbsp;general&nbsp;purpose&nbsp;tactic&nbsp;for&nbsp;solving&nbsp;log.&nbsp;rel.s&nbsp;at&nbsp;base<br/>
&nbsp;&nbsp;&nbsp;type,&nbsp;and&nbsp;add&nbsp;a&nbsp;clause&nbsp;to&nbsp;use&nbsp;a&nbsp;hint&nbsp;database&nbsp;to&nbsp;which&nbsp;local&nbsp;solutions&nbsp;such<br/>
&nbsp;&nbsp;&nbsp;as&nbsp;τG_subtype&nbsp;can&nbsp;be&nbsp;added.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span> <span class="id" title="var">rel_vals'</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="definition">environments.envs_entails</span> <span class="id" title="var">_</span> (<span class="id" title="var">_</span> (<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.InjRV"><span class="id" title="constructor">InjRV</span></a> <span class="id" title="var">_</span>) (<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.InjRV"><span class="id" title="constructor">InjRV</span></a> <span class="id" title="var">_</span>)) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">_</span>,<span class="id" title="var">_</span> ; <span class="id" title="var">iRight</span> ; <span class="id" title="var">iSplit</span> ; [<span class="id" title="tactic">eauto</span>|<span class="id" title="var">iSplit</span> ; <span class="id" title="tactic">eauto</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="definition">environments.envs_entails</span> <span class="id" title="var">_</span> (<span class="id" title="var">_</span> (<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.InjLV"><span class="id" title="constructor">InjLV</span></a> <span class="id" title="var">_</span>) (<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.InjLV"><span class="id" title="constructor">InjLV</span></a> <span class="id" title="var">_</span>)) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">_</span>,<span class="id" title="var">_</span> ; <span class="id" title="var">iLeft</span> ; <span class="id" title="var">iSplit</span> ; [<span class="id" title="tactic">eauto</span>|<span class="id" title="var">iSplit</span> ; <span class="id" title="tactic">eauto</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="definition">environments.envs_entails</span> <span class="id" title="var">_</span> (<span class="id" title="var">_</span> <a class="idref" href="clutch.prob_lang.notation.html#cc14470b8443804ba405fa710525256d"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span> <a class="idref" href="clutch.prob_lang.notation.html#cc14470b8443804ba405fa710525256d"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span><a class="idref" href="clutch.prob_lang.notation.html#cc14470b8443804ba405fa710525256d"><span class="id" title="notation">)</span></a>%<span class="id" title="var">V</span> <a class="idref" href="clutch.prob_lang.notation.html#cc14470b8443804ba405fa710525256d"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span> <a class="idref" href="clutch.prob_lang.notation.html#cc14470b8443804ba405fa710525256d"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span><a class="idref" href="clutch.prob_lang.notation.html#cc14470b8443804ba405fa710525256d"><span class="id" title="notation">)</span></a>%<span class="id" title="var">V</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">_</span>,<span class="id" title="var">_</span>,<span class="id" title="var">_</span>,<span class="id" title="var">_</span> ; <span class="id" title="var">iSplit</span> ; [<span class="id" title="tactic">eauto</span>|<span class="id" title="var">iSplit</span> ; [<span class="id" title="tactic">eauto</span> | <span class="id" title="var">iSplit</span>]]<br/>
    | |- <span class="id" title="definition">environments.envs_entails</span> <span class="id" title="var">_</span> (<span class="id" title="var">_</span> (<span class="id" title="var">_</span> (<a class="idref" href="clutch.typing.interp.html#interp"><span class="id" title="definition">interp</span></a> <a class="idref" href="clutch.examples.crypto.valgroup.html#9082db16b85b8b97e7d84dbc62092956"><span class="id" title="method">τ</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#9082db16b85b8b97e7d84dbc62092956"><span class="id" title="method">G</span></a>) <span class="id" title="var">_</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#50f2714a7f2dfdc0a4d82352d527fdc3"><span class="id" title="method">τ</span></a><a class="idref" href="clutch.examples.crypto.valgroup.html#50f2714a7f2dfdc0a4d82352d527fdc3"><span class="id" title="method">G_subtype</span></a> ; <span class="id" title="tactic">eauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> "rel_vals: case not covered"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span> <span class="id" title="var">rel_vals</span> := <span class="id" title="var">rel_values</span> ; <span class="id" title="tactic">repeat</span> <span class="id" title="var">iModIntro</span> ; <span class="id" title="tactic">repeat</span> (<span class="id" title="var">rel_vals'</span> ; <span class="id" title="tactic">eauto</span>).<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#valgroup_tactics"><span class="id" title="module">valgroup_tactics</span></a>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <a id="valgroup_notation" class="idref" href="#valgroup_notation"><span class="id" title="module">valgroup_notation</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Notation</span> <a id="201a4374e413a582b090bede08aafac0" class="idref" href="#201a4374e413a582b090bede08aafac0"><span class="id" title="notation">&quot;</span></a>e1 · e2" := (<a class="idref" href="clutch.examples.crypto.valgroup.html#vmult"><span class="id" title="method">vmult</span></a> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 40) : <span class="id" title="var">expr_scope</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Notation</span> <a id="337b5428d1d6251fba159943e837fb7b" class="idref" href="#337b5428d1d6251fba159943e837fb7b"><span class="id" title="notation">&quot;</span></a>e ^-1" := (<a class="idref" href="clutch.examples.crypto.valgroup.html#vinv"><span class="id" title="method">vinv</span></a> <span class="id" title="var">e</span>) : <span class="id" title="var">expr_scope</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Notation</span> <a id="f1970a6c2d131dee839d9a93197e874c" class="idref" href="#f1970a6c2d131dee839d9a93197e874c"><span class="id" title="notation">&quot;</span></a>e1 ^ e2" := (<a class="idref" href="clutch.examples.crypto.valgroup.html#vexp"><span class="id" title="definition">vexp</span></a> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span>) : <span class="id" title="var">expr_scope</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Notation</span> <a id="f02567bd8aca590eaffb67a29bcff176" class="idref" href="#f02567bd8aca590eaffb67a29bcff176"><span class="id" title="notation">&quot;</span></a>e1 ^- e2" := <a class="idref" href="clutch.examples.crypto.valgroup.html#337b5428d1d6251fba159943e837fb7b"><span class="id" title="notation">(</span></a><span class="id" title="var">e1</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#f1970a6c2d131dee839d9a93197e874c"><span class="id" title="notation">^</span></a> <span class="id" title="var">e2</span><a class="idref" href="clutch.examples.crypto.valgroup.html#337b5428d1d6251fba159943e837fb7b"><span class="id" title="notation">)^-1</span></a>%<span class="id" title="var">E</span> : <span class="id" title="var">expr_scope</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="clutch.examples.crypto.valgroup.html#valgroup_notation"><span class="id" title="module">valgroup_notation</span></a>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/coq-community/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
