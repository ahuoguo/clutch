<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="resources/coqdoc.css" rel="stylesheet" type="text/css" />
<link href="resources/coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resources/config.js"></script>
<script type="text/javascript" src="resources/coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="../">Project Page</a>
      <a href="./indexpage.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">clutch.rel_logic.spec_rules</h1>

<div class="code">
</div>

<div class="doc">
Rules for updating the specification program. 
</div>
<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">stdpp</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">namespaces</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.proofmode</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">proofmode</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">clutch.prelude</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="clutch.prelude.stdpp_ext.html#"><span class="id" title="library">stdpp_ext</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">clutch.program_logic</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="clutch.program_logic.lifting.html#"><span class="id" title="library">lifting</span></a> <a class="idref" href="clutch.program_logic.ectx_lifting.html#"><span class="id" title="library">ectx_lifting</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">clutch.prob_lang</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="clutch.prob_lang.lang.html#"><span class="id" title="library">lang</span></a> <a class="idref" href="clutch.prob_lang.notation.html#"><span class="id" title="library">notation</span></a> <a class="idref" href="clutch.prob_lang.tactics.html#"><span class="id" title="library">tactics</span></a> <a class="idref" href="clutch.prob_lang.metatheory.html#"><span class="id" title="library">metatheory</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">clutch.rel_logic</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="clutch.rel_logic.primitive_laws.html#"><span class="id" title="library">primitive_laws</span></a> <a class="idref" href="clutch.rel_logic.spec_ra.html#"><span class="id" title="library">spec_ra</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="rules" class="idref" href="#rules"><span class="id" title="section">rules</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="clutchGS0:2" class="idref" href="#clutchGS0:2"><span class="id" title="binder">!</span></a><a id="clutchGS0:2" class="idref" href="#clutchGS0:2"><span class="id" title="binder">clutchGS</span></a> <a id="clutchGS0:2" class="idref" href="#clutchGS0:2"><span class="id" title="binder">Σ</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#46d4b81335c9d28804dace193ae9e17f"><span class="id" title="variable">Σ</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">Φ</span> : <a class="idref" href="clutch.prob_lang.lang.html#prob_lang.val"><span class="id" title="inductive">val</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#46d4b81335c9d28804dace193ae9e17f"><span class="id" title="variable">Σ</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> σ : <a class="idref" href="clutch.prob_lang.lang.html#prob_lang.state"><span class="id" title="record">state</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">e</span> : <a class="idref" href="clutch.prob_lang.lang.html#prob_lang.expr"><span class="id" title="inductive">expr</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">v</span> : <a class="idref" href="clutch.prob_lang.lang.html#prob_lang.val"><span class="id" title="inductive">val</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">l</span> : <a class="idref" href="clutch.prob_lang.locations.html#loc"><span class="id" title="record">loc</span></a>.<br/>

<br/>
</div>

<div class="doc">
Pure reductions 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="step_pure" class="idref" href="#step_pure"><span class="id" title="lemma">step_pure</span></a> <a id="E:3" class="idref" href="#E:3"><span class="id" title="binder">E</span></a> <a id="K:4" class="idref" href="#K:4"><span class="id" title="binder">K</span></a> <a id="e:5" class="idref" href="#e:5"><span class="id" title="binder">e</span></a> <a id="e':6" class="idref" href="#e':6"><span class="id" title="binder">e'</span></a> (<a id="P:7" class="idref" href="#P:7"><span class="id" title="binder">P</span></a> : <span class="id" title="keyword">Prop</span>) <a id="n:8" class="idref" href="#n:8"><span class="id" title="binder">n</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.rel_logic.spec_rules.html#P:7"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.program_logic.language.html#PureExec"><span class="id" title="class">PureExec</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#P:7"><span class="id" title="variable">P</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#n:8"><span class="id" title="variable">n</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#e:5"><span class="id" title="variable">e</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#e':6"><span class="id" title="variable">e'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="instance">nclose</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#specN"><span class="id" title="definition">specN</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#E:3"><span class="id" title="variable">E</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.rel_logic.spec_ra.html#spec_ctx"><span class="id" title="definition">spec_ctx</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#39726a285d21e5558b05ca4123ecd5f5"><span class="id" title="notation">⤇</span></a> <a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#K:4"><span class="id" title="variable">K</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#e:5"><span class="id" title="variable">e</span></a> <span class="id" title="notation">={</span><a class="idref" href="clutch.rel_logic.spec_rules.html#E:3"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#spec_ctx"><span class="id" title="definition">spec_ctx</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#39726a285d21e5558b05ca4123ecd5f5"><span class="id" title="notation">⤇</span></a> <a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#K:4"><span class="id" title="variable">K</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#e':6"><span class="id" title="variable">e'</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">HP</span> <span class="id" title="var">Hex</span> ?) "[#Hspec Hj]". <span class="id" title="var">iFrame</span> "Hspec".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iInv</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#specN"><span class="id" title="definition">specN</span></a> <span class="id" title="keyword">as</span> (ρ <span class="id" title="var">e0</span> σ0 <span class="id" title="var">m</span>) "&gt;(Hspec0 &amp; %Hexec &amp; Hauth &amp; Hheap &amp; Htapes)" "Hclose".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.spec_ra.html#spec_prog_auth_frag_agree"><span class="id" title="lemma">spec_prog_auth_frag_agree</span></a> <span class="id" title="notation">with</span> "Hauth Hj"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %-&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.spec_ra.html#spec_prog_update"><span class="id" title="lemma">spec_prog_update</span></a> (<a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <span class="id" title="var">K</span> <span class="id" title="var">e'</span>) <span class="id" title="notation">with</span> "Hauth Hj"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hauth Hj]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span> "Hj". <span class="id" title="var">iApply</span> "Hclose". <span class="id" title="var">iNext</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, (<span class="id" title="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="clutch.program_logic.exec.html#exec_PureExec_ctx"><span class="id" title="lemma">exec_PureExec_ctx</span></a> (<a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <span class="id" title="var">K</span>) <span class="id" title="var">P</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Alloc, load, and store 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="step_alloc" class="idref" href="#step_alloc"><span class="id" title="lemma">step_alloc</span></a> <a id="E:9" class="idref" href="#E:9"><span class="id" title="binder">E</span></a> <a id="K:10" class="idref" href="#K:10"><span class="id" title="binder">K</span></a> <a id="e:11" class="idref" href="#e:11"><span class="id" title="binder">e</span></a> <a id="v:12" class="idref" href="#v:12"><span class="id" title="binder">v</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.program_logic.language.html#IntoVal"><span class="id" title="class">IntoVal</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#e:11"><span class="id" title="variable">e</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#v:12"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="instance">nclose</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#specN"><span class="id" title="definition">specN</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#E:9"><span class="id" title="variable">E</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.rel_logic.spec_ra.html#spec_ctx"><span class="id" title="definition">spec_ctx</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#39726a285d21e5558b05ca4123ecd5f5"><span class="id" title="notation">⤇</span></a> <a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#K:10"><span class="id" title="variable">K</span></a> (<a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'ref'_x"><span class="id" title="notation">ref</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#e:11"><span class="id" title="variable">e</span></a>) <span class="id" title="notation">={</span><a class="idref" href="clutch.rel_logic.spec_rules.html#E:9"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span> <span class="id" title="notation">∃</span> <a id="l:13" class="idref" href="#l:13"><span class="id" title="binder">l</span></a><span class="id" title="notation">,</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#spec_ctx"><span class="id" title="definition">spec_ctx</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#39726a285d21e5558b05ca4123ecd5f5"><span class="id" title="notation">⤇</span></a> <a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#K:10"><span class="id" title="variable">K</span></a> (<a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.rel_logic.spec_rules.html#l:13"><span class="id" title="variable">l</span></a>) <span class="id" title="notation">∗</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#l:13"><span class="id" title="variable">l</span></a> <a class="idref" href="clutch.rel_logic.spec_ra.html#0326014f985dcbdf069e6962e826748b"><span class="id" title="notation">↦ₛ</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#v:12"><span class="id" title="variable">v</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (&lt;-?) "[#Hinv Hj]". <span class="id" title="var">iFrame</span> "Hinv".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iInv</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#specN"><span class="id" title="definition">specN</span></a> <span class="id" title="keyword">as</span> (ρ <span class="id" title="var">e</span> σ <span class="id" title="var">m</span>) "&gt;(Hspec0 &amp; %Hexec &amp; Hauth &amp; Hheap &amp; Htapes)" "Hclose".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.spec_ra.html#spec_prog_auth_frag_agree"><span class="id" title="lemma">spec_prog_auth_frag_agree</span></a> <span class="id" title="notation">with</span> "Hauth Hj"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %-&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">l</span> := <a class="idref" href="clutch.prob_lang.locations.html#fresh_loc"><span class="id" title="definition">fresh_loc</span></a> σ.(<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.heap"><span class="id" title="projection">heap</span></a>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.spec_ra.html#spec_prog_update"><span class="id" title="lemma">spec_prog_update</span></a> (<a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <span class="id" title="var">K</span> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><span class="id" title="var">l</span>) <span class="id" title="notation">with</span> "Hauth Hj"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hauth Hj]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><span class="id" title="lemma">ghost_map_insert</span> <span class="id" title="var">l</span> <span class="id" title="var">v</span> <span class="id" title="notation">with</span> "Hheap"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hheap Hl]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="lemma">not_elem_of_dom</span>, <a class="idref" href="clutch.prob_lang.locations.html#fresh_loc_is_fresh"><span class="id" title="lemma">fresh_loc_is_fresh</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">l</span>. <span class="id" title="var">iFrame</span>. <span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"Hclose" <span class="id" title="notation">with</span> "[-]"<span class="id" title="notation">)</span>; [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.rel_logic.spec_ra.html#spec_inv"><span class="id" title="definition">spec_inv</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, (<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.state_upd_heap"><span class="id" title="definition">state_upd_heap</span></a> <span class="id" title="notation">&lt;[</span><span class="id" title="var">l</span><span class="id" title="notation">:=</span><span class="id" title="var">v</span><span class="id" title="notation">]&gt;</span> σ), <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="clutch.program_logic.exec.html#exec_det_step_ctx"><span class="id" title="lemma">exec_det_step_ctx</span></a>; [<span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>| |<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">solve_step</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="step_load" class="idref" href="#step_load"><span class="id" title="lemma">step_load</span></a> <a id="E:14" class="idref" href="#E:14"><span class="id" title="binder">E</span></a> <a id="K:15" class="idref" href="#K:15"><span class="id" title="binder">K</span></a> <a id="l:16" class="idref" href="#l:16"><span class="id" title="binder">l</span></a> <a id="q:17" class="idref" href="#q:17"><span class="id" title="binder">q</span></a> <a id="v:18" class="idref" href="#v:18"><span class="id" title="binder">v</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="instance">nclose</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#specN"><span class="id" title="definition">specN</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#E:14"><span class="id" title="variable">E</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.rel_logic.spec_ra.html#spec_ctx"><span class="id" title="definition">spec_ctx</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#39726a285d21e5558b05ca4123ecd5f5"><span class="id" title="notation">⤇</span></a> <a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#K:15"><span class="id" title="variable">K</span></a> (<a class="idref" href="clutch.prob_lang.notation.html#569b74bc432a2b233b93ae1b45418e26"><span class="id" title="notation">!</span></a><a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.rel_logic.spec_rules.html#l:16"><span class="id" title="variable">l</span></a>) <span class="id" title="notation">∗</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#l:16"><span class="id" title="variable">l</span></a> <a class="idref" href="clutch.rel_logic.spec_ra.html#e730e42c5e8de925c5934d80eba35f6f"><span class="id" title="notation">↦ₛ{</span></a><a class="idref" href="clutch.rel_logic.spec_rules.html#q:17"><span class="id" title="variable">q</span></a><a class="idref" href="clutch.rel_logic.spec_ra.html#e730e42c5e8de925c5934d80eba35f6f"><span class="id" title="notation">}</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#v:18"><span class="id" title="variable">v</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">={</span><a class="idref" href="clutch.rel_logic.spec_rules.html#E:14"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#spec_ctx"><span class="id" title="definition">spec_ctx</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#39726a285d21e5558b05ca4123ecd5f5"><span class="id" title="notation">⤇</span></a> <a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#K:15"><span class="id" title="variable">K</span></a> (<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.of_val"><span class="id" title="abbreviation">of_val</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#v:18"><span class="id" title="variable">v</span></a>) <span class="id" title="notation">∗</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#l:16"><span class="id" title="variable">l</span></a> <a class="idref" href="clutch.rel_logic.spec_ra.html#e730e42c5e8de925c5934d80eba35f6f"><span class="id" title="notation">↦ₛ{</span></a><a class="idref" href="clutch.rel_logic.spec_rules.html#q:17"><span class="id" title="variable">q</span></a><a class="idref" href="clutch.rel_logic.spec_ra.html#e730e42c5e8de925c5934d80eba35f6f"><span class="id" title="notation">}</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#v:18"><span class="id" title="variable">v</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (?) "(#Hinv &amp; Hj &amp; Hl)". <span class="id" title="var">iFrame</span> "Hinv".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iInv</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#specN"><span class="id" title="definition">specN</span></a> <span class="id" title="keyword">as</span> (ρ <span class="id" title="var">e</span> σ <span class="id" title="var">m</span>) "&gt;(Hspec0 &amp; %Hexec &amp; Hauth &amp; Hheap &amp; Htapes)" "Hclose".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.spec_ra.html#spec_prog_auth_frag_agree"><span class="id" title="lemma">spec_prog_auth_frag_agree</span></a> <span class="id" title="notation">with</span> "Hauth Hj"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %-&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.spec_ra.html#spec_prog_update"><span class="id" title="lemma">spec_prog_update</span></a> (<a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <span class="id" title="var">K</span> <span class="id" title="var">v</span>) <span class="id" title="notation">with</span> "Hauth Hj"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hauth Hj]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">ghost_map_lookup</span> <span class="id" title="notation">with</span> "Hheap Hl"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"Hclose" <span class="id" title="notation">with</span> "[-]"<span class="id" title="notation">)</span>; [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iExists</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="clutch.program_logic.exec.html#exec_det_step_ctx"><span class="id" title="lemma">exec_det_step_ctx</span></a>; [<span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>| |<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">solve_step</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="step_store" class="idref" href="#step_store"><span class="id" title="lemma">step_store</span></a> <a id="E:19" class="idref" href="#E:19"><span class="id" title="binder">E</span></a> <a id="K:20" class="idref" href="#K:20"><span class="id" title="binder">K</span></a> <a id="l:21" class="idref" href="#l:21"><span class="id" title="binder">l</span></a> <a id="v':22" class="idref" href="#v':22"><span class="id" title="binder">v'</span></a> <a id="e:23" class="idref" href="#e:23"><span class="id" title="binder">e</span></a> <a id="v:24" class="idref" href="#v:24"><span class="id" title="binder">v</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.program_logic.language.html#IntoVal"><span class="id" title="class">IntoVal</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#e:23"><span class="id" title="variable">e</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#v:24"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="instance">nclose</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#specN"><span class="id" title="definition">specN</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#E:19"><span class="id" title="variable">E</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.rel_logic.spec_ra.html#spec_ctx"><span class="id" title="definition">spec_ctx</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#39726a285d21e5558b05ca4123ecd5f5"><span class="id" title="notation">⤇</span></a> <a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#K:20"><span class="id" title="variable">K</span></a> (<a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.rel_logic.spec_rules.html#l:21"><span class="id" title="variable">l</span></a> <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:x_'&lt;-'_x"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#e:23"><span class="id" title="variable">e</span></a>) <span class="id" title="notation">∗</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#l:21"><span class="id" title="variable">l</span></a> <a class="idref" href="clutch.rel_logic.spec_ra.html#0326014f985dcbdf069e6962e826748b"><span class="id" title="notation">↦ₛ</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#v':22"><span class="id" title="variable">v'</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">={</span><a class="idref" href="clutch.rel_logic.spec_rules.html#E:19"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#spec_ctx"><span class="id" title="definition">spec_ctx</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#39726a285d21e5558b05ca4123ecd5f5"><span class="id" title="notation">⤇</span></a> <a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#K:20"><span class="id" title="variable">K</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.prob_lang.notation.html#3127c6bc552ca21a494fc6e3474a507d"><span class="id" title="notation">()</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#l:21"><span class="id" title="variable">l</span></a> <a class="idref" href="clutch.rel_logic.spec_ra.html#0326014f985dcbdf069e6962e826748b"><span class="id" title="notation">↦ₛ</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#v:24"><span class="id" title="variable">v</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (&lt;-?) "(#Hinv &amp; Hj &amp; Hl)". <span class="id" title="var">iFrame</span> "Hinv".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iInv</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#specN"><span class="id" title="definition">specN</span></a> <span class="id" title="keyword">as</span> (ρ <span class="id" title="var">e</span> σ <span class="id" title="var">m</span>) "&gt;(Hspec0 &amp; %Hexec &amp; Hauth &amp; Hheap &amp; Htapes)" "Hclose".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.spec_ra.html#spec_prog_auth_frag_agree"><span class="id" title="lemma">spec_prog_auth_frag_agree</span></a> <span class="id" title="notation">with</span> "Hauth Hj"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %-&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.spec_ra.html#spec_prog_update"><span class="id" title="lemma">spec_prog_update</span></a> (<a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <span class="id" title="var">K</span> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.prob_lang.notation.html#3127c6bc552ca21a494fc6e3474a507d"><span class="id" title="notation">()</span></a>) <span class="id" title="notation">with</span> "Hauth Hj"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hauth Hj]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">ghost_map_lookup</span> <span class="id" title="notation">with</span> "Hheap Hl"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><span class="id" title="lemma">ghost_map_update</span> <span class="id" title="var">v</span> <span class="id" title="notation">with</span> "Hheap Hl"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hheap Hl]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"Hclose" <span class="id" title="notation">with</span> "[-]"<span class="id" title="notation">)</span>; [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iExists</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, (<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.state_upd_heap"><span class="id" title="definition">state_upd_heap</span></a> <span class="id" title="notation">&lt;[</span><span class="id" title="var">l</span><span class="id" title="notation">:=</span><span class="id" title="var">v</span><span class="id" title="notation">]&gt;</span> σ), <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="clutch.program_logic.exec.html#exec_det_step_ctx"><span class="id" title="lemma">exec_det_step_ctx</span></a>; [<span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>| |<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">solve_step</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
AllocTape and Rand (non-empty tape)  
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="step_alloctape" class="idref" href="#step_alloctape"><span class="id" title="lemma">step_alloctape</span></a> <a id="E:25" class="idref" href="#E:25"><span class="id" title="binder">E</span></a> <a id="K:26" class="idref" href="#K:26"><span class="id" title="binder">K</span></a> <a id="N:27" class="idref" href="#N:27"><span class="id" title="binder">N</span></a> <a id="z:28" class="idref" href="#z:28"><span class="id" title="binder">z</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="class">TCEq</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#N:27"><span class="id" title="variable">N</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.to_nat"><span class="id" title="definition">Z.to_nat</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#z:28"><span class="id" title="variable">z</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="instance">nclose</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#specN"><span class="id" title="definition">specN</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#E:25"><span class="id" title="variable">E</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.rel_logic.spec_ra.html#spec_ctx"><span class="id" title="definition">spec_ctx</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#39726a285d21e5558b05ca4123ecd5f5"><span class="id" title="notation">⤇</span></a> <a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#K:26"><span class="id" title="variable">K</span></a> (<a class="idref" href="clutch.prob_lang.notation.html#alloc"><span class="id" title="abbreviation">alloc</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.rel_logic.spec_rules.html#z:28"><span class="id" title="variable">z</span></a>) <span class="id" title="notation">={</span><a class="idref" href="clutch.rel_logic.spec_rules.html#E:25"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span> <span class="id" title="notation">∃</span> <a id="l:29" class="idref" href="#l:29"><span class="id" title="binder">l</span></a><span class="id" title="notation">,</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#spec_ctx"><span class="id" title="definition">spec_ctx</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#39726a285d21e5558b05ca4123ecd5f5"><span class="id" title="notation">⤇</span></a> <a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#K:26"><span class="id" title="variable">K</span></a> (<a class="idref" href="clutch.prob_lang.notation.html#3c0d92df4cb553f56e51c75fd64a5753"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.prob_lang.notation.html#3c0d92df4cb553f56e51c75fd64a5753"><span class="id" title="notation">lbl</span></a><a class="idref" href="clutch.prob_lang.notation.html#3c0d92df4cb553f56e51c75fd64a5753"><span class="id" title="notation">:</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#l:29"><span class="id" title="variable">l</span></a>) <span class="id" title="notation">∗</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#l:29"><span class="id" title="variable">l</span></a> <a class="idref" href="clutch.rel_logic.spec_ra.html#537f9bfe1a4246c42baec6fa8e98c8aa"><span class="id" title="notation">↪ₛ</span></a> <a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.rel_logic.spec_rules.html#N:27"><span class="id" title="variable">N</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (-&gt; ?) "[#Hinv Hj]". <span class="id" title="var">iFrame</span> "Hinv".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iInv</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#specN"><span class="id" title="definition">specN</span></a> <span class="id" title="keyword">as</span> (ρ <span class="id" title="var">e</span> σ <span class="id" title="var">m</span>) "&gt;(Hspec0 &amp; %Hexec &amp; Hauth &amp; Hheap &amp; Htapes)" "Hclose".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.spec_ra.html#spec_prog_auth_frag_agree"><span class="id" title="lemma">spec_prog_auth_frag_agree</span></a> <span class="id" title="notation">with</span> "Hauth Hj"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %-&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.spec_ra.html#spec_prog_update"><span class="id" title="lemma">spec_prog_update</span></a> (<a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <span class="id" title="var">K</span> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#(</span></a><a class="idref" href="clutch.prob_lang.lang.html#prob_lang.LitLbl"><span class="id" title="constructor">LitLbl</span></a> (<a class="idref" href="clutch.prob_lang.locations.html#fresh_loc"><span class="id" title="definition">fresh_loc</span></a> σ.(<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.tapes"><span class="id" title="projection">tapes</span></a>))<a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">)</span></a>) <span class="id" title="notation">with</span> "Hauth Hj"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hauth Hj]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><span class="id" title="lemma">ghost_map_insert</span> (<a class="idref" href="clutch.prob_lang.locations.html#fresh_loc"><span class="id" title="definition">fresh_loc</span></a> σ.(<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.tapes"><span class="id" title="projection">tapes</span></a>)) (<a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">:</span></a> <a class="idref" href="clutch.prob_lang.lang.html#prob_lang.tape"><span class="id" title="definition">tape</span></a>) <span class="id" title="notation">with</span> "Htapes"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Htapes Hl]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="lemma">not_elem_of_dom</span>, <a class="idref" href="clutch.prob_lang.locations.html#fresh_loc_is_fresh"><span class="id" title="lemma">fresh_loc_is_fresh</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> (<a class="idref" href="clutch.prob_lang.locations.html#fresh_loc"><span class="id" title="definition">fresh_loc</span></a> σ.(<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.tapes"><span class="id" title="projection">tapes</span></a>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"Hclose" <span class="id" title="notation">with</span> "[-]"<span class="id" title="notation">)</span>; [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, (<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.state_upd_tapes"><span class="id" title="definition">state_upd_tapes</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="clutch.prob_lang.locations.html#fresh_loc"><span class="id" title="definition">fresh_loc</span></a> σ.(<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.tapes"><span class="id" title="projection">tapes</span></a>)<span class="id" title="notation">:=</span><span class="id" title="var">_</span><span class="id" title="notation">]&gt;</span> σ), <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="clutch.program_logic.exec.html#exec_det_step_ctx"><span class="id" title="lemma">exec_det_step_ctx</span></a>; [<span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>| |<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;TODO:&nbsp;fix&nbsp;tactic&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">solve_step</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.distribution.html#dret_1_1"><span class="id" title="lemma">dret_1_1</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="step_rand" class="idref" href="#step_rand"><span class="id" title="lemma">step_rand</span></a> <a id="E:30" class="idref" href="#E:30"><span class="id" title="binder">E</span></a> <a id="K:31" class="idref" href="#K:31"><span class="id" title="binder">K</span></a> <a id="l:32" class="idref" href="#l:32"><span class="id" title="binder">l</span></a> <a id="N:33" class="idref" href="#N:33"><span class="id" title="binder">N</span></a> <a id="z:34" class="idref" href="#z:34"><span class="id" title="binder">z</span></a> <a id="n:35" class="idref" href="#n:35"><span class="id" title="binder">n</span></a> <a id="ns:36" class="idref" href="#ns:36"><span class="id" title="binder">ns</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="class">TCEq</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#N:33"><span class="id" title="variable">N</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.to_nat"><span class="id" title="definition">Z.to_nat</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#z:34"><span class="id" title="variable">z</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="instance">nclose</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#specN"><span class="id" title="definition">specN</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#E:30"><span class="id" title="variable">E</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.rel_logic.spec_ra.html#spec_ctx"><span class="id" title="definition">spec_ctx</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#39726a285d21e5558b05ca4123ecd5f5"><span class="id" title="notation">⤇</span></a> <a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#K:31"><span class="id" title="variable">K</span></a> (<a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'rand'_x_'from'_x"><span class="id" title="notation">rand</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.rel_logic.spec_rules.html#z:34"><span class="id" title="variable">z</span></a> <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'rand'_x_'from'_x"><span class="id" title="notation">from</span></a> <a class="idref" href="clutch.prob_lang.notation.html#3c0d92df4cb553f56e51c75fd64a5753"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.prob_lang.notation.html#3c0d92df4cb553f56e51c75fd64a5753"><span class="id" title="notation">lbl</span></a><a class="idref" href="clutch.prob_lang.notation.html#3c0d92df4cb553f56e51c75fd64a5753"><span class="id" title="notation">:</span></a><a class="idref" href="clutch.rel_logic.spec_rules.html#l:32"><span class="id" title="variable">l</span></a>) <span class="id" title="notation">∗</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#l:32"><span class="id" title="variable">l</span></a> <a class="idref" href="clutch.rel_logic.spec_ra.html#537f9bfe1a4246c42baec6fa8e98c8aa"><span class="id" title="notation">↪ₛ</span></a> <a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.rel_logic.spec_rules.html#N:33"><span class="id" title="variable">N</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">;</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#n:35"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#ns:36"><span class="id" title="variable">ns</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">={</span><a class="idref" href="clutch.rel_logic.spec_rules.html#E:30"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#spec_ctx"><span class="id" title="definition">spec_ctx</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#39726a285d21e5558b05ca4123ecd5f5"><span class="id" title="notation">⤇</span></a> <a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#K:31"><span class="id" title="variable">K</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.rel_logic.spec_rules.html#n:35"><span class="id" title="variable">n</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#l:32"><span class="id" title="variable">l</span></a> <a class="idref" href="clutch.rel_logic.spec_ra.html#537f9bfe1a4246c42baec6fa8e98c8aa"><span class="id" title="notation">↪ₛ</span></a> <a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.rel_logic.spec_rules.html#N:33"><span class="id" title="variable">N</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">;</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#ns:36"><span class="id" title="variable">ns</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (-&gt; ?) "(#Hinv &amp; Hj &amp; Hl)". <span class="id" title="var">iFrame</span> "Hinv".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iInv</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#specN"><span class="id" title="definition">specN</span></a> <span class="id" title="keyword">as</span> (ρ <span class="id" title="var">e</span> σ <span class="id" title="var">m</span>) "&gt;(Hspec0 &amp; %Hexec &amp; Hauth &amp; Hheap &amp; Htapes)" "Hclose".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.spec_ra.html#spec_prog_auth_frag_agree"><span class="id" title="lemma">spec_prog_auth_frag_agree</span></a> <span class="id" title="notation">with</span> "Hauth Hj"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %-&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.spec_ra.html#spec_prog_update"><span class="id" title="lemma">spec_prog_update</span></a> (<a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <span class="id" title="var">K</span> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><span class="id" title="var">n</span>) <span class="id" title="notation">with</span> "Hauth Hj"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hauth Hj]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">ghost_map_lookup</span> <span class="id" title="notation">with</span> "Htapes Hl"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><span class="id" title="lemma">ghost_map_update</span> (<a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">;</span></a> <span class="id" title="var">ns</span><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">:</span></a> <a class="idref" href="clutch.prob_lang.lang.html#prob_lang.tape"><span class="id" title="definition">tape</span></a>) <span class="id" title="notation">with</span> "Htapes Hl"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Htapes Hl]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"Hclose" <span class="id" title="notation">with</span> "[-]"<span class="id" title="notation">)</span>; [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iExists</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, (<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.state_upd_tapes"><span class="id" title="definition">state_upd_tapes</span></a> <span class="id" title="notation">&lt;[</span><span class="id" title="var">l</span><span class="id" title="notation">:=</span><span class="id" title="var">_</span><span class="id" title="notation">]&gt;</span> σ), <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="clutch.program_logic.exec.html#exec_det_step_ctx"><span class="id" title="lemma">exec_det_step_ctx</span></a>; [<span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>| |<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;TODO:&nbsp;fix&nbsp;tactic&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">solve_step</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bool_decide_eq_true_2</span> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.distribution.html#dret_1_1"><span class="id" title="lemma">dret_1_1</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
RHS <span class="inlinecode"><span class="id" title="var">rand</span></span> 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_rand_r" class="idref" href="#wp_rand_r"><span class="id" title="lemma">wp_rand_r</span></a> <a id="N:37" class="idref" href="#N:37"><span class="id" title="binder">N</span></a> <a id="z:38" class="idref" href="#z:38"><span class="id" title="binder">z</span></a> <a id="E:39" class="idref" href="#E:39"><span class="id" title="binder">E</span></a> <a id="e:40" class="idref" href="#e:40"><span class="id" title="binder">e</span></a> <a id="K:41" class="idref" href="#K:41"><span class="id" title="binder">K</span></a> <a id="65a052a1179f3a2a95c5f3ae82617b94" class="idref" href="#65a052a1179f3a2a95c5f3ae82617b94"><span class="id" title="binder">Φ</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="class">TCEq</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#N:37"><span class="id" title="variable">N</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.to_nat"><span class="id" title="definition">Z.to_nat</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#z:38"><span class="id" title="variable">z</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.to_val"><span class="id" title="definition">to_val</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#e:40"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="instance">nclose</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#specN"><span class="id" title="definition">specN</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#E:39"><span class="id" title="variable">E</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.rel_logic.spec_ra.html#spec_ctx"><span class="id" title="definition">spec_ctx</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#39726a285d21e5558b05ca4123ecd5f5"><span class="id" title="notation">⤇</span></a> <a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#K:41"><span class="id" title="variable">K</span></a> (<a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'rand'_x_'from'_x"><span class="id" title="notation">rand</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.rel_logic.spec_rules.html#z:38"><span class="id" title="variable">z</span></a> <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'rand'_x_'from'_x"><span class="id" title="notation">from</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.prob_lang.notation.html#3127c6bc552ca21a494fc6e3474a507d"><span class="id" title="notation">()</span></a>) <span class="id" title="notation">∗</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="n:43" class="idref" href="#n:43"><span class="id" title="binder">n</span></a> : <span class="id" title="abbreviation">fin</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#N:37"><span class="id" title="variable">N</span></a>)<span class="id" title="notation">,</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#39726a285d21e5558b05ca4123ecd5f5"><span class="id" title="notation">⤇</span></a> <a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#K:41"><span class="id" title="variable">K</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.rel_logic.spec_rules.html#n:43"><span class="id" title="variable">n</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">WP</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#e:40"><span class="id" title="variable">e</span></a> <span class="id" title="notation">@</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#E:39"><span class="id" title="variable">E</span></a> <span class="id" title="notation">{{</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#65a052a1179f3a2a95c5f3ae82617b94"><span class="id" title="variable">Φ</span></a> <span class="id" title="notation">}}</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <span class="id" title="notation">WP</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#e:40"><span class="id" title="variable">e</span></a> <span class="id" title="notation">@</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#E:39"><span class="id" title="variable">E</span></a> <span class="id" title="notation">{{</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#65a052a1179f3a2a95c5f3ae82617b94"><span class="id" title="variable">Φ</span></a> <span class="id" title="notation">}}</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (-&gt; <span class="id" title="var">He</span> <span class="id" title="var">HE</span>) "(#Hinv &amp; Hj &amp; Hwp)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="clutch.program_logic.lifting.html#wp_lift_step_fupd_couple"><span class="id" title="lemma">wp_lift_step_fupd_couple</span></a>; [<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ1 <span class="id" title="var">e1'</span> σ1') "[[Hh1 Ht1] Hauth2]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iInv</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#specN"><span class="id" title="definition">specN</span></a> <span class="id" title="keyword">as</span> (ρ' <span class="id" title="var">e0'</span> σ0' <span class="id" title="var">m</span>) "&gt;(Hspec0 &amp; %Hexec &amp; Hauth &amp; Hheap &amp; Htapes)" "Hclose".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.spec_ra.html#spec_interp_auth_frag_agree"><span class="id" title="lemma">spec_interp_auth_frag_agree</span></a> <span class="id" title="notation">with</span> "Hauth2 Hspec0"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %&lt;-.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.spec_ra.html#spec_prog_auth_frag_agree"><span class="id" title="lemma">spec_prog_auth_frag_agree</span></a> <span class="id" title="notation">with</span> "Hauth Hj"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %-&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">fupd_mask_intro</span>; [<span class="id" title="var">set_solver</span>|]; <span class="id" title="var">iIntros</span> "Hclose'".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="clutch.program_logic.weakestpre.html#exec_coupl_det_r"><span class="id" title="lemma">exec_coupl_det_r</span></a>; [<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Do&nbsp;a&nbsp;(trivially)&nbsp;coupled&nbsp;<span class="inlinecode"><span class="id" title="var">prim_step</span></span>&nbsp;on&nbsp;the&nbsp;right&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> (<a class="idref" href="clutch.program_logic.weakestpre.html#exec_coupl_exec_r"><span class="id" title="lemma">exec_coupl_exec_r</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <span class="id" title="var">_</span> '<a id="pat:50" class="idref" href="#pat:50"><span class="id" title="binder">(</span></a><a id="pat:50" class="idref" href="#pat:50"><span class="id" title="binder">e2'</span></a><a id="pat:50" class="idref" href="#pat:50"><span class="id" title="binder">,</span></a> <a id="pat:50" class="idref" href="#pat:50"><span class="id" title="binder">σ2')</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a id="n:51" class="idref" href="#n:51"><span class="id" title="binder">n</span></a> : <span class="id" title="abbreviation">fin</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">_</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.rel_logic.spec_rules.html#e2':45"><span class="id" title="variable">e2'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#d7624edf63de9af8ec3a1e2ac2eb290d"><span class="id" title="variable">σ2'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <span class="id" title="var">K</span> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.rel_logic.spec_rules.html#n:47"><span class="id" title="variable">n</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> σ0'<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>), 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.program_logic.exec.html#exec_1"><span class="id" title="lemma">exec_1</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.program_logic.exec.html#prim_step_or_val_no_val"><span class="id" title="lemma">prim_step_or_val_no_val</span></a> /=; [|<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.program_logic.ectxi_language.html#fill_not_val"><span class="id" title="lemma">fill_not_val</span></a>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -(<a class="idref" href="clutch.prob.distribution.html#dret_id_right"><span class="id" title="lemma">dret_id_right</span></a> (<a class="idref" href="clutch.prob.distribution.html#dret"><span class="id" title="definition">dret</span></a> <span class="id" title="var">_</span>)) <a class="idref" href="clutch.program_logic.language.html#fill_dmap"><span class="id" title="method">fill_dmap</span></a> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="clutch.prob.couplings.html#Rcoupl_dbind"><span class="id" title="lemma">Rcoupl_dbind</span></a> =&gt; /=; [|<span class="id" title="tactic">by</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="clutch.prob_lang.metatheory.html#Rcoupl_rand_r"><span class="id" title="lemma">Rcoupl_rand_r</span></a>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">e2</span> σ2] (<span class="id" title="var">e2'</span> &amp; σ2') (? &amp; [= -&gt; -&gt;] &amp; [= -&gt; -&gt;]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.couplings.html#Rcoupl_dret"><span class="id" title="lemma">Rcoupl_dret</span></a>=&gt;/=. <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ2 <span class="id" title="var">e2'</span> (<span class="id" title="var">n</span> &amp; [= -&gt; -&gt;])).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.spec_ra.html#spec_interp_update"><span class="id" title="lemma">spec_interp_update</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <span class="id" title="var">K</span> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> σ0'<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="notation">with</span> "Hauth2 Hspec0"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hspec Hspec0]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.spec_ra.html#spec_prog_update"><span class="id" title="lemma">spec_prog_update</span></a> (<a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <span class="id" title="var">K</span> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><span class="id" title="var">n</span>) <span class="id" title="notation">with</span> "Hauth Hj"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hauth Hj]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">simplify_map_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> "Hclose'" <span class="id" title="keyword">as</span> "_".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"Hclose" <span class="id" title="notation">with</span> "[Hauth Hheap Hspec0 Htapes]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "_".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iModIntro</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.rel_logic.spec_ra.html#spec_inv"><span class="id" title="definition">spec_inv</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, 0. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.program_logic.exec.html#exec_O"><span class="id" title="lemma">exec_O</span></a> <a class="idref" href="clutch.prob.distribution.html#dret_1_1"><span class="id" title="lemma">dret_1_1</span></a> //. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSpecialize</span> <span class="id" title="notation">(</span>"Hwp" <span class="id" title="notation">with</span> "Hj"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="clutch.program_logic.weakestpre.html#wp_unfold"><span class="id" title="lemma">wp_unfold</span></a> /<a class="idref" href="clutch.program_logic.weakestpre.html#wp_pre"><span class="id" title="definition">wp_pre</span></a> /= <span class="id" title="var">He</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"Hwp" <span class="id" title="notation">$!</span> <span class="id" title="var">_</span> <span class="id" title="notation">with</span> "[$Hh1 $Hspec $Ht1]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "Hwp".<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
RHS <span class="inlinecode"><span class="id" title="var">rand</span>(<span class="id" title="var">α</span>)</span> with empty tape  
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_rand_empty_r" class="idref" href="#wp_rand_empty_r"><span class="id" title="lemma">wp_rand_empty_r</span></a> <a id="N:52" class="idref" href="#N:52"><span class="id" title="binder">N</span></a> <a id="z:53" class="idref" href="#z:53"><span class="id" title="binder">z</span></a> <a id="E:54" class="idref" href="#E:54"><span class="id" title="binder">E</span></a> <a id="e:55" class="idref" href="#e:55"><span class="id" title="binder">e</span></a> <a id="K:56" class="idref" href="#K:56"><span class="id" title="binder">K</span></a> <a id="cb56bbc9bd2a9a795741a0fbb16a1e54" class="idref" href="#cb56bbc9bd2a9a795741a0fbb16a1e54"><span class="id" title="binder">α</span></a> <a id="0618d5b603e04f37f770076df7e6d13a" class="idref" href="#0618d5b603e04f37f770076df7e6d13a"><span class="id" title="binder">Φ</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="class">TCEq</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#N:52"><span class="id" title="variable">N</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.to_nat"><span class="id" title="definition">Z.to_nat</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#z:53"><span class="id" title="variable">z</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.to_val"><span class="id" title="definition">to_val</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#e:55"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="instance">nclose</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#specN"><span class="id" title="definition">specN</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#E:54"><span class="id" title="variable">E</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.rel_logic.spec_ra.html#spec_ctx"><span class="id" title="definition">spec_ctx</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#39726a285d21e5558b05ca4123ecd5f5"><span class="id" title="notation">⤇</span></a> <a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#K:56"><span class="id" title="variable">K</span></a> (<a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'rand'_x_'from'_x"><span class="id" title="notation">rand</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.rel_logic.spec_rules.html#z:53"><span class="id" title="variable">z</span></a> <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'rand'_x_'from'_x"><span class="id" title="notation">from</span></a> <a class="idref" href="clutch.prob_lang.notation.html#3c0d92df4cb553f56e51c75fd64a5753"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.prob_lang.notation.html#3c0d92df4cb553f56e51c75fd64a5753"><span class="id" title="notation">lbl</span></a><a class="idref" href="clutch.prob_lang.notation.html#3c0d92df4cb553f56e51c75fd64a5753"><span class="id" title="notation">:</span></a><a class="idref" href="clutch.rel_logic.spec_rules.html#cb56bbc9bd2a9a795741a0fbb16a1e54"><span class="id" title="variable">α</span></a>) <span class="id" title="notation">∗</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#cb56bbc9bd2a9a795741a0fbb16a1e54"><span class="id" title="variable">α</span></a> <a class="idref" href="clutch.rel_logic.spec_ra.html#537f9bfe1a4246c42baec6fa8e98c8aa"><span class="id" title="notation">↪ₛ</span></a> <a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.rel_logic.spec_rules.html#N:52"><span class="id" title="variable">N</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">)</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.spec_rules.html#cb56bbc9bd2a9a795741a0fbb16a1e54"><span class="id" title="variable">α</span></a> <a class="idref" href="clutch.rel_logic.spec_ra.html#537f9bfe1a4246c42baec6fa8e98c8aa"><span class="id" title="notation">↪ₛ</span></a> <a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.rel_logic.spec_rules.html#N:52"><span class="id" title="variable">N</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">)</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#spec_ctx"><span class="id" title="definition">spec_ctx</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">∃</span> <a id="n:59" class="idref" href="#n:59"><span class="id" title="binder">n</span></a> : <span class="id" title="abbreviation">fin</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#N:52"><span class="id" title="variable">N</span></a>)<span class="id" title="notation">,</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#39726a285d21e5558b05ca4123ecd5f5"><span class="id" title="notation">⤇</span></a> <a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#K:56"><span class="id" title="variable">K</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.rel_logic.spec_rules.html#n:59"><span class="id" title="variable">n</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span> <span class="id" title="notation">WP</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#e:55"><span class="id" title="variable">e</span></a> <span class="id" title="notation">@</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#E:54"><span class="id" title="variable">E</span></a> <span class="id" title="notation">{{</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#0618d5b603e04f37f770076df7e6d13a"><span class="id" title="variable">Φ</span></a> <span class="id" title="notation">}}</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <span class="id" title="notation">WP</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#e:55"><span class="id" title="variable">e</span></a> <span class="id" title="notation">@</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#E:54"><span class="id" title="variable">E</span></a> <span class="id" title="notation">{{</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#0618d5b603e04f37f770076df7e6d13a"><span class="id" title="variable">Φ</span></a> <span class="id" title="notation">}}</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (-&gt; <span class="id" title="var">He</span> <span class="id" title="var">HE</span>) "(#Hinv &amp; Hj &amp; Hα &amp; Hwp)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="clutch.program_logic.lifting.html#wp_lift_step_fupd_couple"><span class="id" title="lemma">wp_lift_step_fupd_couple</span></a>; [<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ1 <span class="id" title="var">e1'</span> σ1') "[[Hh1 Ht1] Hauth2]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iInv</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#specN"><span class="id" title="definition">specN</span></a> <span class="id" title="keyword">as</span> (ρ' <span class="id" title="var">e0'</span> σ0' <span class="id" title="var">m</span>) "&gt;(Hspec0 &amp; %Hexec &amp; Hauth &amp; Hheap &amp; Htapes)" "Hclose".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.spec_ra.html#spec_interp_auth_frag_agree"><span class="id" title="lemma">spec_interp_auth_frag_agree</span></a> <span class="id" title="notation">with</span> "Hauth2 Hspec0"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %&lt;-.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">ghost_map_lookup</span> <span class="id" title="notation">with</span> "Htapes Hα"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %<span class="id" title="var">Hαsome</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.spec_ra.html#spec_prog_auth_frag_agree"><span class="id" title="lemma">spec_prog_auth_frag_agree</span></a> <span class="id" title="notation">with</span> "Hauth Hj"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %-&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">fupd_mask_intro</span>; [<span class="id" title="var">set_solver</span>|]; <span class="id" title="var">iIntros</span> "Hclose'".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="clutch.program_logic.weakestpre.html#exec_coupl_det_r"><span class="id" title="lemma">exec_coupl_det_r</span></a>; [<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Do&nbsp;a&nbsp;(trivially)&nbsp;coupled&nbsp;<span class="inlinecode"><span class="id" title="var">prim_step</span></span>&nbsp;on&nbsp;the&nbsp;right&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> (<a class="idref" href="clutch.program_logic.weakestpre.html#exec_coupl_exec_r"><span class="id" title="lemma">exec_coupl_exec_r</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <span class="id" title="var">_</span> '<a id="pat:66" class="idref" href="#pat:66"><span class="id" title="binder">(</span></a><a id="pat:66" class="idref" href="#pat:66"><span class="id" title="binder">e2'</span></a><a id="pat:66" class="idref" href="#pat:66"><span class="id" title="binder">,</span></a> <a id="pat:66" class="idref" href="#pat:66"><span class="id" title="binder">σ2')</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a id="n:67" class="idref" href="#n:67"><span class="id" title="binder">n</span></a> : <span class="id" title="abbreviation">fin</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">_</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.rel_logic.spec_rules.html#e2':61"><span class="id" title="variable">e2'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#6a5372f1b38cc7466cf79f710de9895d"><span class="id" title="variable">σ2'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <span class="id" title="var">K</span> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.rel_logic.spec_rules.html#n:63"><span class="id" title="variable">n</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> σ0'<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>), 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.program_logic.exec.html#exec_1"><span class="id" title="lemma">exec_1</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.program_logic.exec.html#prim_step_or_val_no_val"><span class="id" title="lemma">prim_step_or_val_no_val</span></a> /=; [|<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.program_logic.ectxi_language.html#fill_not_val"><span class="id" title="lemma">fill_not_val</span></a>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -(<a class="idref" href="clutch.prob.distribution.html#dret_id_right"><span class="id" title="lemma">dret_id_right</span></a> (<a class="idref" href="clutch.prob.distribution.html#dret"><span class="id" title="definition">dret</span></a> <span class="id" title="var">_</span>)) <a class="idref" href="clutch.program_logic.language.html#fill_dmap"><span class="id" title="method">fill_dmap</span></a> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="clutch.prob.couplings.html#Rcoupl_dbind"><span class="id" title="lemma">Rcoupl_dbind</span></a> =&gt; /=; [|<span class="id" title="tactic">by</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="clutch.prob_lang.metatheory.html#Rcoupl_rand_empty_r"><span class="id" title="lemma">Rcoupl_rand_empty_r</span></a>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">e2</span> σ2] (<span class="id" title="var">e2'</span> &amp; σ2') (? &amp; [= -&gt; -&gt;] &amp; [= -&gt; -&gt;]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.couplings.html#Rcoupl_dret"><span class="id" title="lemma">Rcoupl_dret</span></a>=&gt;/=. <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ2 <span class="id" title="var">e2'</span> (<span class="id" title="var">n</span> &amp; [= -&gt; -&gt;])).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.spec_ra.html#spec_interp_update"><span class="id" title="lemma">spec_interp_update</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <span class="id" title="var">K</span> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> σ0'<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="notation">with</span> "Hauth2 Hspec0"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hspec Hspec0]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.spec_ra.html#spec_prog_update"><span class="id" title="lemma">spec_prog_update</span></a> (<a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <span class="id" title="var">K</span> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><span class="id" title="var">n</span>) <span class="id" title="notation">with</span> "Hauth Hj"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hauth Hj]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">simplify_map_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> "Hclose'" <span class="id" title="keyword">as</span> "_".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"Hclose" <span class="id" title="notation">with</span> "[Hauth Hheap Hspec0 Htapes]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "_".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iModIntro</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.rel_logic.spec_ra.html#spec_inv"><span class="id" title="definition">spec_inv</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, 0. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.program_logic.exec.html#exec_O"><span class="id" title="lemma">exec_O</span></a> <a class="idref" href="clutch.prob.distribution.html#dret_1_1"><span class="id" title="lemma">dret_1_1</span></a> //. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSpecialize</span> <span class="id" title="notation">(</span>"Hwp" <span class="id" title="notation">with</span> "[$Hα $Hinv Hj]"<span class="id" title="notation">)</span>; [<span class="id" title="tactic">eauto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="clutch.program_logic.weakestpre.html#wp_unfold"><span class="id" title="lemma">wp_unfold</span></a> /<a class="idref" href="clutch.program_logic.weakestpre.html#wp_pre"><span class="id" title="definition">wp_pre</span></a> /= <span class="id" title="var">He</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"Hwp" <span class="id" title="notation">$!</span> <span class="id" title="var">_</span> <span class="id" title="notation">with</span> "[$Hh1 $Hspec $Ht1]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "Hwp".<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
RHS <span class="inlinecode"><span class="id" title="var">rand</span>(<span class="id" title="var">α</span>)</span> with wrong tape  
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_rand_wrong_tape_r" class="idref" href="#wp_rand_wrong_tape_r"><span class="id" title="lemma">wp_rand_wrong_tape_r</span></a> <a id="N:68" class="idref" href="#N:68"><span class="id" title="binder">N</span></a> <a id="M:69" class="idref" href="#M:69"><span class="id" title="binder">M</span></a> <a id="z:70" class="idref" href="#z:70"><span class="id" title="binder">z</span></a> <a id="E:71" class="idref" href="#E:71"><span class="id" title="binder">E</span></a> <a id="e:72" class="idref" href="#e:72"><span class="id" title="binder">e</span></a> <a id="K:73" class="idref" href="#K:73"><span class="id" title="binder">K</span></a> <a id="2424dcb618f8259fee69f8bcaf3dabe9" class="idref" href="#2424dcb618f8259fee69f8bcaf3dabe9"><span class="id" title="binder">α</span></a> <a id="55a363c26a6fcf2d71bcdfc5ad742b27" class="idref" href="#55a363c26a6fcf2d71bcdfc5ad742b27"><span class="id" title="binder">Φ</span></a> <a id="ns:76" class="idref" href="#ns:76"><span class="id" title="binder">ns</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="class">TCEq</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#N:68"><span class="id" title="variable">N</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.to_nat"><span class="id" title="definition">Z.to_nat</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#z:70"><span class="id" title="variable">z</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.rel_logic.spec_rules.html#N:68"><span class="id" title="variable">N</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#M:69"><span class="id" title="variable">M</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.prob_lang.lang.html#prob_lang.to_val"><span class="id" title="definition">to_val</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#e:72"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="instance">nclose</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#specN"><span class="id" title="definition">specN</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#E:71"><span class="id" title="variable">E</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.rel_logic.spec_ra.html#spec_ctx"><span class="id" title="definition">spec_ctx</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#39726a285d21e5558b05ca4123ecd5f5"><span class="id" title="notation">⤇</span></a> <a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#K:73"><span class="id" title="variable">K</span></a> (<a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'rand'_x_'from'_x"><span class="id" title="notation">rand</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.rel_logic.spec_rules.html#z:70"><span class="id" title="variable">z</span></a> <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'rand'_x_'from'_x"><span class="id" title="notation">from</span></a> <a class="idref" href="clutch.prob_lang.notation.html#3c0d92df4cb553f56e51c75fd64a5753"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.prob_lang.notation.html#3c0d92df4cb553f56e51c75fd64a5753"><span class="id" title="notation">lbl</span></a><a class="idref" href="clutch.prob_lang.notation.html#3c0d92df4cb553f56e51c75fd64a5753"><span class="id" title="notation">:</span></a><a class="idref" href="clutch.rel_logic.spec_rules.html#2424dcb618f8259fee69f8bcaf3dabe9"><span class="id" title="variable">α</span></a>) <span class="id" title="notation">∗</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#2424dcb618f8259fee69f8bcaf3dabe9"><span class="id" title="variable">α</span></a> <a class="idref" href="clutch.rel_logic.spec_ra.html#537f9bfe1a4246c42baec6fa8e98c8aa"><span class="id" title="notation">↪ₛ</span></a> <a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.rel_logic.spec_rules.html#M:69"><span class="id" title="variable">M</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">;</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#ns:76"><span class="id" title="variable">ns</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">)</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.spec_rules.html#2424dcb618f8259fee69f8bcaf3dabe9"><span class="id" title="variable">α</span></a> <a class="idref" href="clutch.rel_logic.spec_ra.html#537f9bfe1a4246c42baec6fa8e98c8aa"><span class="id" title="notation">↪ₛ</span></a> <a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.rel_logic.spec_rules.html#M:69"><span class="id" title="variable">M</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">;</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#ns:76"><span class="id" title="variable">ns</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">)</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#spec_ctx"><span class="id" title="definition">spec_ctx</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">∃</span> <a id="n:77" class="idref" href="#n:77"><span class="id" title="binder">n</span></a> : <span class="id" title="abbreviation">fin</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#N:68"><span class="id" title="variable">N</span></a>)<span class="id" title="notation">,</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#39726a285d21e5558b05ca4123ecd5f5"><span class="id" title="notation">⤇</span></a> <a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#K:73"><span class="id" title="variable">K</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.rel_logic.spec_rules.html#n:77"><span class="id" title="variable">n</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span> <span class="id" title="notation">WP</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#e:72"><span class="id" title="variable">e</span></a> <span class="id" title="notation">@</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#E:71"><span class="id" title="variable">E</span></a> <span class="id" title="notation">{{</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#55a363c26a6fcf2d71bcdfc5ad742b27"><span class="id" title="variable">Φ</span></a> <span class="id" title="notation">}}</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <span class="id" title="notation">WP</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#e:72"><span class="id" title="variable">e</span></a> <span class="id" title="notation">@</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#E:71"><span class="id" title="variable">E</span></a> <span class="id" title="notation">{{</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#55a363c26a6fcf2d71bcdfc5ad742b27"><span class="id" title="variable">Φ</span></a> <span class="id" title="notation">}}</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (-&gt; ? <span class="id" title="var">He</span> <span class="id" title="var">HE</span>) "(#Hinv &amp; Hj &amp; Hα &amp; Hwp)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="clutch.program_logic.lifting.html#wp_lift_step_fupd_couple"><span class="id" title="lemma">wp_lift_step_fupd_couple</span></a>; [<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ1 <span class="id" title="var">e1'</span> σ1') "[[Hh1 Ht1] Hauth2]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iInv</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#specN"><span class="id" title="definition">specN</span></a> <span class="id" title="keyword">as</span> (ρ' <span class="id" title="var">e0'</span> σ0' <span class="id" title="var">m</span>) "&gt;(Hspec0 &amp; %Hexec &amp; Hauth &amp; Hheap &amp; Htapes)" "Hclose".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.spec_ra.html#spec_interp_auth_frag_agree"><span class="id" title="lemma">spec_interp_auth_frag_agree</span></a> <span class="id" title="notation">with</span> "Hauth2 Hspec0"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %&lt;-.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">ghost_map_lookup</span> <span class="id" title="notation">with</span> "Htapes Hα"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %<span class="id" title="var">Hαsome</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.spec_ra.html#spec_prog_auth_frag_agree"><span class="id" title="lemma">spec_prog_auth_frag_agree</span></a> <span class="id" title="notation">with</span> "Hauth Hj"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %-&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">fupd_mask_intro</span>; [<span class="id" title="var">set_solver</span>|]; <span class="id" title="var">iIntros</span> "Hclose'".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="clutch.program_logic.weakestpre.html#exec_coupl_det_r"><span class="id" title="lemma">exec_coupl_det_r</span></a>; [<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Do&nbsp;a&nbsp;(trivially)&nbsp;coupled&nbsp;<span class="inlinecode"><span class="id" title="var">prim_step</span></span>&nbsp;on&nbsp;the&nbsp;right&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> (<a class="idref" href="clutch.program_logic.weakestpre.html#exec_coupl_exec_r"><span class="id" title="lemma">exec_coupl_exec_r</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <span class="id" title="var">_</span> '<a id="pat:84" class="idref" href="#pat:84"><span class="id" title="binder">(</span></a><a id="pat:84" class="idref" href="#pat:84"><span class="id" title="binder">e2'</span></a><a id="pat:84" class="idref" href="#pat:84"><span class="id" title="binder">,</span></a> <a id="pat:84" class="idref" href="#pat:84"><span class="id" title="binder">σ2')</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a id="n:85" class="idref" href="#n:85"><span class="id" title="binder">n</span></a> : <span class="id" title="abbreviation">fin</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">_</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.rel_logic.spec_rules.html#e2':79"><span class="id" title="variable">e2'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#25f8ded1f92d62e3118e066e7437cddc"><span class="id" title="variable">σ2'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <span class="id" title="var">K</span> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.rel_logic.spec_rules.html#n:81"><span class="id" title="variable">n</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> σ0'<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>), 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.program_logic.exec.html#exec_1"><span class="id" title="lemma">exec_1</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.program_logic.exec.html#prim_step_or_val_no_val"><span class="id" title="lemma">prim_step_or_val_no_val</span></a> /=; [|<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="clutch.program_logic.ectxi_language.html#fill_not_val"><span class="id" title="lemma">fill_not_val</span></a>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -(<a class="idref" href="clutch.prob.distribution.html#dret_id_right"><span class="id" title="lemma">dret_id_right</span></a> (<a class="idref" href="clutch.prob.distribution.html#dret"><span class="id" title="definition">dret</span></a> <span class="id" title="var">_</span>)) <a class="idref" href="clutch.program_logic.language.html#fill_dmap"><span class="id" title="method">fill_dmap</span></a> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="clutch.prob.couplings.html#Rcoupl_dbind"><span class="id" title="lemma">Rcoupl_dbind</span></a> =&gt; /=; [|<span class="id" title="tactic">by</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="clutch.prob_lang.metatheory.html#Rcoupl_rand_wrong_r"><span class="id" title="lemma">Rcoupl_rand_wrong_r</span></a>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">e2</span> σ2] (<span class="id" title="var">e2'</span> &amp; σ2') (? &amp; [= -&gt; -&gt;] &amp; [= -&gt; -&gt;]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="clutch.prob.couplings.html#Rcoupl_dret"><span class="id" title="lemma">Rcoupl_dret</span></a>=&gt;/=. <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ2 <span class="id" title="var">e2'</span> (<span class="id" title="var">n</span> &amp; [= -&gt; -&gt;])).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.spec_ra.html#spec_interp_update"><span class="id" title="lemma">spec_interp_update</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <span class="id" title="var">K</span> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> σ0'<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="notation">with</span> "Hauth2 Hspec0"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hspec Hspec0]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.spec_ra.html#spec_prog_update"><span class="id" title="lemma">spec_prog_update</span></a> (<a class="idref" href="clutch.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <span class="id" title="var">K</span> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><span class="id" title="var">n</span>) <span class="id" title="notation">with</span> "Hauth Hj"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hauth Hj]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">simplify_map_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> "Hclose'" <span class="id" title="keyword">as</span> "_".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"Hclose" <span class="id" title="notation">with</span> "[Hauth Hheap Hspec0 Htapes]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "_".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iModIntro</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="clutch.rel_logic.spec_ra.html#spec_inv"><span class="id" title="definition">spec_inv</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, 0. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="clutch.program_logic.exec.html#exec_O"><span class="id" title="lemma">exec_O</span></a> <a class="idref" href="clutch.prob.distribution.html#dret_1_1"><span class="id" title="lemma">dret_1_1</span></a> //. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSpecialize</span> <span class="id" title="notation">(</span>"Hwp" <span class="id" title="notation">with</span> "[$Hα $Hinv Hj]"<span class="id" title="notation">)</span>; [<span class="id" title="tactic">eauto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="clutch.program_logic.weakestpre.html#wp_unfold"><span class="id" title="lemma">wp_unfold</span></a> /<a class="idref" href="clutch.program_logic.weakestpre.html#wp_pre"><span class="id" title="definition">wp_pre</span></a> /= <span class="id" title="var">He</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"Hwp" <span class="id" title="notation">$!</span> <span class="id" title="var">_</span> <span class="id" title="notation">with</span> "[$Hh1 $Hspec $Ht1]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "Hwp".<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab76"></a><h1 class="section">Corollaries about <span class="inlinecode"><a class="idref" href="clutch.rel_logic.spec_ra.html#refines_right"><span class="id" title="definition">refines_right</span></a></span></h1>

</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="refines_right_alloctape" class="idref" href="#refines_right_alloctape"><span class="id" title="lemma">refines_right_alloctape</span></a> <a id="E:86" class="idref" href="#E:86"><span class="id" title="binder">E</span></a> <a id="K:87" class="idref" href="#K:87"><span class="id" title="binder">K</span></a> <a id="N:88" class="idref" href="#N:88"><span class="id" title="binder">N</span></a> <a id="z:89" class="idref" href="#z:89"><span class="id" title="binder">z</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="class">TCEq</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#N:88"><span class="id" title="variable">N</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.to_nat"><span class="id" title="definition">Z.to_nat</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#z:89"><span class="id" title="variable">z</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="instance">nclose</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#specN"><span class="id" title="definition">specN</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#E:86"><span class="id" title="variable">E</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.rel_logic.spec_ra.html#refines_right"><span class="id" title="definition">refines_right</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#K:87"><span class="id" title="variable">K</span></a> (<a class="idref" href="clutch.prob_lang.notation.html#alloc"><span class="id" title="abbreviation">alloc</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.rel_logic.spec_rules.html#z:89"><span class="id" title="variable">z</span></a>) <span class="id" title="notation">={</span><a class="idref" href="clutch.rel_logic.spec_rules.html#E:86"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span> <span class="id" title="notation">∃</span> <a id="l:90" class="idref" href="#l:90"><span class="id" title="binder">l</span></a><span class="id" title="notation">,</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#refines_right"><span class="id" title="definition">refines_right</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#K:87"><span class="id" title="variable">K</span></a> (<a class="idref" href="clutch.prob_lang.notation.html#3c0d92df4cb553f56e51c75fd64a5753"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.prob_lang.notation.html#3c0d92df4cb553f56e51c75fd64a5753"><span class="id" title="notation">lbl</span></a><a class="idref" href="clutch.prob_lang.notation.html#3c0d92df4cb553f56e51c75fd64a5753"><span class="id" title="notation">:</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#l:90"><span class="id" title="variable">l</span></a>) <span class="id" title="notation">∗</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#l:90"><span class="id" title="variable">l</span></a> <a class="idref" href="clutch.rel_logic.spec_ra.html#537f9bfe1a4246c42baec6fa8e98c8aa"><span class="id" title="notation">↪ₛ</span></a> <a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.rel_logic.spec_rules.html#N:88"><span class="id" title="variable">N</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (??) "(?&amp;?)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.spec_rules.html#step_alloctape"><span class="id" title="lemma">step_alloctape</span></a> <span class="id" title="notation">with</span> "[$]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">l</span>) "(?&amp;?)"; [<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">_</span>; <span class="id" title="tactic">by</span> <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="refines_right_rand" class="idref" href="#refines_right_rand"><span class="id" title="lemma">refines_right_rand</span></a> <a id="E:91" class="idref" href="#E:91"><span class="id" title="binder">E</span></a> <a id="K:92" class="idref" href="#K:92"><span class="id" title="binder">K</span></a> <a id="l:93" class="idref" href="#l:93"><span class="id" title="binder">l</span></a> <a id="N:94" class="idref" href="#N:94"><span class="id" title="binder">N</span></a> <a id="z:95" class="idref" href="#z:95"><span class="id" title="binder">z</span></a> <a id="n:96" class="idref" href="#n:96"><span class="id" title="binder">n</span></a> <a id="ns:97" class="idref" href="#ns:97"><span class="id" title="binder">ns</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="class">TCEq</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#N:94"><span class="id" title="variable">N</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.to_nat"><span class="id" title="definition">Z.to_nat</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#z:95"><span class="id" title="variable">z</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="instance">nclose</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#specN"><span class="id" title="definition">specN</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#E:91"><span class="id" title="variable">E</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.rel_logic.spec_rules.html#l:93"><span class="id" title="variable">l</span></a> <a class="idref" href="clutch.rel_logic.spec_ra.html#537f9bfe1a4246c42baec6fa8e98c8aa"><span class="id" title="notation">↪ₛ</span></a> <a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.rel_logic.spec_rules.html#N:94"><span class="id" title="variable">N</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">;</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#n:96"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#ns:97"><span class="id" title="variable">ns</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">)</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="clutch.rel_logic.spec_ra.html#refines_right"><span class="id" title="definition">refines_right</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#K:92"><span class="id" title="variable">K</span></a> (<a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'rand'_x_'from'_x"><span class="id" title="notation">rand</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.rel_logic.spec_rules.html#z:95"><span class="id" title="variable">z</span></a> <a class="idref" href="clutch.prob_lang.notation.html#::expr_scope:'rand'_x_'from'_x"><span class="id" title="notation">from</span></a> <a class="idref" href="clutch.prob_lang.notation.html#3c0d92df4cb553f56e51c75fd64a5753"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.prob_lang.notation.html#3c0d92df4cb553f56e51c75fd64a5753"><span class="id" title="notation">lbl</span></a><a class="idref" href="clutch.prob_lang.notation.html#3c0d92df4cb553f56e51c75fd64a5753"><span class="id" title="notation">:</span></a><a class="idref" href="clutch.rel_logic.spec_rules.html#l:93"><span class="id" title="variable">l</span></a>) <span class="id" title="notation">={</span><a class="idref" href="clutch.rel_logic.spec_rules.html#E:91"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span> <a class="idref" href="clutch.rel_logic.spec_ra.html#refines_right"><span class="id" title="definition">refines_right</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#K:92"><span class="id" title="variable">K</span></a> <a class="idref" href="clutch.prob_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="clutch.rel_logic.spec_rules.html#n:96"><span class="id" title="variable">n</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#l:93"><span class="id" title="variable">l</span></a> <a class="idref" href="clutch.rel_logic.spec_ra.html#537f9bfe1a4246c42baec6fa8e98c8aa"><span class="id" title="notation">↪ₛ</span></a> <a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">(</span></a><a class="idref" href="clutch.rel_logic.spec_rules.html#N:94"><span class="id" title="variable">N</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">;</span></a> <a class="idref" href="clutch.rel_logic.spec_rules.html#ns:97"><span class="id" title="variable">ns</span></a><a class="idref" href="clutch.prelude.stdpp_ext.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (??) "? (?&amp;?)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><a class="idref" href="clutch.rel_logic.spec_rules.html#step_rand"><span class="id" title="lemma">step_rand</span></a> <span class="id" title="notation">with</span> "[$]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "(?&amp;?&amp;?)"; [<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="clutch.rel_logic.spec_rules.html#rules"><span class="id" title="section">rules</span></a>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/coq-community/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
